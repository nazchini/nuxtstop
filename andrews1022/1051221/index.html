<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>An Extensive Comparison of Gatsby & Next.js (While Rebuilding My Portfolio)</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>An Extensive Comparison of Gatsby & Next.js (While Rebuilding My Portfolio)</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/gatsby" class="tag" data-v-70afb46a>
          #gatsby
        </a><a href="/nuxtstop/t/nextjs" class="tag" data-v-70afb46a>
          #nextjs
        </a><a href="/nuxtstop/t/typescript" class="tag" data-v-70afb46a>
          #typescript
        </a><a href="/nuxtstop/t/contentful" class="tag" data-v-70afb46a>
          #contentful
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--IKvACsR---/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/o8a8afcdejc3fn036vw3.jpg" alt="An Extensive Comparison of Gatsby & Next.js (While Rebuilding My Portfolio)" data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            9
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Apr 15</time></div></header> <div class="content" data-v-70afb46a><p>I was looking at my developer portfolio recently and decided it could use an update. While I kept it up to date with my most recent projects that I wanted to showcase, I wasn't a fan of the look anymore. I also thought it would be nice to use <a href="https://www.contentful.com/">Contentful</a> as a <a href="https://en.wikipedia.org/wiki/Headless_content_management_system">headless CMS</a> to manage the content of the site, as well as fetch and display a couple of my most recent blog posts from here on dev.to.</p>

<p>I've mostly used <a href="https://www.gatsbyjs.com/">Gatsby</a> both at work and for personal projects, and I've been wanting to learn more about <a href="https://nextjs.org/">Next.js</a> and become more familiar with using it, so I took this opportunity to start rebuilding my portfolio using both of these frameworks. I had a list of requirements in mind, so along the way I noted my experience with both frameworks and I want to share that experience with you here. Perhaps you will find it helpful the next time you need to decide which framework to use.</p>

<h2>
  <a name="requirements" href="#requirements">
  </a>
  Requirements
</h2>

<p>I like to keep my portfolio nice and simple. The order of the sections are:</p>

<ul>
<li>Hero (including nav)</li>
<li>Projects</li>
<li>About Me</li>
<li>Blog Posts</li>
<li>Contact</li>
<li>Footer</li>
</ul>

<p>It's a single page, so I will not be looking to create dynamic routes / pages for any of my content. I would consider doing so for the blog posts since Contentful has a Markdown text box, and on dev.to you write in Markdown, so it would just be a copy paste. However, I wanted to see what would be considered best practice / convention for both:</p>

<ul>
<li>Fetching content from Contentful using GraphQL</li>
<li>Fetching blog posts from the dev.to API using the good ol' <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a>
</li>
</ul>

<p>A few other things I wanted to compare between the two were:</p>

<ul>
<li>Downloading and starting with a basic boilerplate with TypeScript support</li>
<li>Integrating <a href="https://styled-components.com/">styled-components</a>
</li>
<li>A few points regarding Contentful:

<ul>
<li>The use of environment variables</li>
<li>Using webhooks to automatically update the hosted site whenever I make a change in Contentful</li>
<li>Similarly, how changes in Contentful appear during local development</li>
<li>Local development experience</li>
<li>Using fragments for reusable queries</li>
</ul>


</li>
<li>Optimizing images from Contentful</li>
<li>How easy is it to host a Gatsby and Next.js site</li>
</ul>

<p>I also want to note that my intention wasn't to <em>fully</em> rebuild my portfolio with each, but more so I wanted to get the scaffolding done, compare my notes as well as any pros and cons of the requirements I've listed above, and from there I'll decide which one I plan to proceed with to complete the project.</p>

<p>I simply created 2 new branches on my existing portfolio repo, which I aptly named <code>gatsby</code> and <code>next</code>, and worked with each framework on their respective branch. In hindsight, it would've been <em>much</em> easier to just work with framework each in their own folders in isolation. Oh well! ¯\_(ツ)_/¯</p>

<p>So, let's get started!</p>

<h2>
  <a name="boilerplate" href="#boilerplate">
  </a>
  Boilerplate
</h2>

<p>To start, I looked at what possible starter / boilerplates both frameworks offered. While both offer Contentful based starters, they are not in TypeScript OOTB. So, I decided upon using their basic TypeScript starter and building it up from there. That way, I have as close as a starting point for each as possible.</p>

<p>Next.js has supported TypeScript for a while now, but thankfully Gatsby also now has full TypeScript support too. Not just with pages and components, which they also have supported for a while now, but all of the Gatsby API files (<code>gatsby-browser</code>, <code>gatsby-node</code>, etc.) can also be written in TypeScript as of Gatsby <a href="https://www.gatsbyjs.com/docs/reference/release-notes/v4.8/">v4.8</a> and <a href="https://www.gatsbyjs.com/docs/reference/release-notes/v4.9/">4.9</a>.</p>

<p>For Gatsby, you can run the command:</p>

<p><code>npm init gatsby -ts</code></p>

<p>And for Next.js you can run the command:</p>

<p><code>npx create-next-app@latest --ts</code></p>

<p>A quick, minor note regarding Gatsby: in the <a href="https://www.gatsbyjs.com/docs/how-to/custom-configuration/typescript/">documentation</a> it says to run <code>npm init gatsby</code> and select TypeScript as your language when prompted. Or you can run <code>npm init gatsby -ts</code> to skip that question. In my experience, that is not true. When you run <code>npm init gatsby -ts</code>, you still have to select TypeScript as your language. So, it doesn't matter whether or not you include the <code>-ts</code> flag.</p>

<p>For Next.js, there is no questionnaire during setup, and I actually don't mind this at all, and it kind of makes sense if you think about it. Gatsby is focused on creating fast, static sites using headless CMSs. As such, it gives you a few options to pick from during setup in the CLI, as well as a few options for styling your app.</p>

<p>With Next, since it is a hybrid framework and it can be used for much more than static headless CMS-based sites, including a questionnaire is not ideal because there are just <em>so</em> many things to consider. Perhaps including a step for styling would be nice, and some other common inclusions such as linting, but I think it's fine without one.</p>

<p>Either way, both startup just fine after running <code>npm run dev</code>!</p>

<h2>
  <a name="styled-components" href="#styled-components">
  </a>
  Styled Components
</h2>

<p>This is where things start to get interesting. <a href="https://styled-components.com/">styled-components</a> is my go to approach for styling React apps myself. Otherwise, I usually go with Material UI (now <a href="https://mui.com/">MUI</a>) or <a href="https://react-bootstrap.github.io/">React Bootstrap</a>.</p>

<p>Implementing styled-components into Gatsby and Next are quite different.</p>

<p>First, let's take a look at Gatsby.</p>

<h3>
  <a name="gatsby" href="#gatsby">
  </a>
  Gatsby
</h3>

<p>With Gatsby, you will need to install the following NPM packages:</p>

<ul>
<li><code>babel-plugin-styled-components</code></li>
<li><code>gatsby-plugin-styled-components</code></li>
<li><code>styled-components</code></li>
</ul>

<p>And if you're using TypeScript like I do, then the <code>@types</code> package from DefinitelyTyped as well:</p>

<ul>
<li><code>@types/styled-components</code></li>
</ul>

<p>So, in total 3-4 packages. From there, you simply need to add <code>gatsby-plugin-styled-components</code> to your <code>plugins</code> array inside your <code>gatsby-config</code> file. After that, I typically create a <code>styles</code> folder inside the <code>src</code> folder, and then inside the <code>styles</code> folder I create 2 files:</p>

<ul>
<li><code>GlobalStyle.ts</code></li>
<li><code>theme.ts</code></li>
</ul>

<p><code>theme.ts</code> will hold variables for the project such as colours, font sizes, breakpoints, etc. Here's the starting code I typically use:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">theme</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">mediaQueries</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">desktopHD</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1920px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">desktopMedium</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1680px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">desktopSmall</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1440px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">laptop</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1366px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">laptopSmall</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1280px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">tabletLandscape</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 1024px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">tabletMedium</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 900px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">tabletPortrait</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 768px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileXLarge</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 640px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileLarge</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 576px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileMedium</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 480px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileSmall</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 415px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileXSmall</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 375px)</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">mobileTiny</span><span class="p">:</span> <span class="dl">'</span><span class="s1">only screen and (max-width: 325px)</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">shades</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">white</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#fff</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">black</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#000</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">greys</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// add any greys here</span>
  <span class="p">},</span>
  <span class="na">colors</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">primary</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// add primary colors here</span>
    <span class="p">},</span>
    <span class="na">secondary</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// add secondary colors here</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">fonts</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// add font-families here</span>
  <span class="p">},</span>
  <span class="na">fontWeights</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">thin</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="na">extraLight</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="na">light</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
    <span class="na">normal</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="na">medium</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
    <span class="na">semiBold</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="na">bold</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
    <span class="na">extraBold</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span>
    <span class="na">black</span><span class="p">:</span> <span class="mi">900</span>
  <span class="p">},</span>
  <span class="na">fontSizes</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// add font sizes here</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">theme</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And <code>GlobalStyle.ts</code> will use the <code>createGlobalStyle</code> helper function to create a <code>GlobalStyle</code> component. This component will house global styles and any styling resets you want to include. Here is what I typically start with:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createGlobalStyle</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">theme</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./theme</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// destructured theme properties</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">mediaQueries</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">theme</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">GlobalStyle</span> <span class="o">=</span> <span class="nx">createGlobalStyle</span><span class="s2">`
  html {
    box-sizing: border-box;
    font-size: 100%;

    @media </span><span class="p">${</span><span class="nx">mediaQueries</span><span class="p">.</span><span class="nx">desktopSmall</span><span class="p">}</span><span class="s2"> {
      font-size: 87.5%;
    }
  }

  body {
    /* add custom font-family here */
    line-height: 1;
  }

  *,
  *::before,
  *::after {
    box-sizing: inherit;
    color: inherit;
    font-size: inherit;
    -webkit-font-smoothing: antialiased;
    margin: 0;
    padding: 0;
  }

  button,
  input,
  textarea {
    /* add custom font-family here */
  }

  img,
  svg {
    border: 0;
    display: block;
    height: auto;
    max-width: 100%;
  }

  a {
    &:link,
    &:visited {
      text-decoration: none;
    }

    @media (hover) {
      &:hover,
      &:active,
      &:focus {
        outline: 0;
        text-decoration: underline;
      }
    }
  }

  ol,
  ul {
    list-style: none;
  }

  blockquote,
  q {
    quotes: none;
  }

  blockquote:before,
  blockquote:after,
  q:before,
  q:after {
    content: '';
    content: none;
  }

  table {
    border-collapse: collapse;
    border-spacing: 0;
  }

  audio,
  canvas,
  video {
    display: inline-block;
    max-width: 100%;
    zoom: 1;
  }
`</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">GlobalStyle</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>From here, we open the <code>Layout</code> component and wrap everything with the <code>ThemeProvider</code> component provided by <code>styled-components</code>. <code>ThemeProvider</code> must have a <code>theme</code> prop, so we can import the <code>theme</code> above. We will also place the <code>GlobalStyle</code> component as a child inside the <code>ThemeProvider</code>. In the end, your <code>Layout</code> file should look something like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">Layout</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span><span class="p">,</span> <span class="nx">title</span> <span class="p">})</span> <span class="o">=></span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">ThemeProvider</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">></span>
    <span class="o">&lt;</span><span class="nx">GlobalStyle</span> <span class="o">/></span>

    <span class="o">&lt;</span><span class="nx">Seo</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span>
    <span class="o">&lt;</span><span class="nx">Navigation</span> <span class="o">/></span>

    <span class="o">&lt;</span><span class="nx">main</span><span class="o">></span><span class="p">{</span><span class="nx">children</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/main</span><span class="err">>
</span>
    <span class="o">&lt;</span><span class="nx">Footer</span> <span class="o">/></span>
  <span class="o">&lt;</span><span class="sr">/ThemeProvider</span><span class="err">>
</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And that's it! Now, any styled components we create will have access to our theme via <code>props.theme</code> like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=></span> <span class="nx">props</span><span class="p">.</span><span class="nx">theme</span><span class="p">.</span><span class="nx">shades</span><span class="p">.</span><span class="nx">white</span><span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And just as a quick note, we can use destructuring to shorten it a bit:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{({</span> <span class="nx">theme</span> <span class="p">})</span> <span class="o">=></span> <span class="nx">theme</span><span class="p">.</span><span class="nx">shades</span><span class="p">.</span><span class="nx">white</span><span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>In the end, a pretty quick setup! Now let's take a look at Next.js.</p>

<h3>
  <a name="nextjs" href="#nextjs">
  </a>
  Next.js
</h3>

<p>With Next.js, we install all the same packages we would with Gatsby, except <code>gatsby-plugin-styled-components</code> of course.</p>

<p>From there, we can create a <code>styles</code> folder and also create the <code>GlobalStyle.ts</code> & <code>theme.ts</code> files as we did with Gatsby.</p>

<p>Next, while with Next.js you would typically have a <code>Layout</code> component, you actually do not want to wrap that component with <code>ThemeProvider</code>. Instead, you want to wrap everything in the <code>_app.tsx</code> file in the <code>pages</code> folder like so:</p>

<p>Before:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">MyApp</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="o">=></span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">pageProps</span><span class="p">}</span> <span class="sr">/></span><span class="err">;
</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">MyApp</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>After:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">MyApp</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">ThemeProvider</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">></span>
    <span class="o">&lt;</span><span class="nx">Layout</span><span class="o">></span>
      <span class="o">&lt;</span><span class="nx">GlobalStyle</span> <span class="o">/></span>
      <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">pageProps</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">>
</span>  <span class="o">&lt;</span><span class="sr">/ThemeProvider</span><span class="err">>
</span><span class="p">);</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">MyApp</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And we're done! Actually, no we're not. At this point, using styled-components will work just fine...sort of. If you either:</p>

<ul>
<li>Manually refresh the page in the browser</li>
<li>Host this project, on Vercel or Netlify, for example</li>
</ul>

<p>The styles will likely break. This is because the server-side rendering does <em>not</em> fetch the styles before rendering the page. To correct this issue, we need to inject server-side rendered styles to the <code>head</code> so it can render the page and its styles correctly.</p>

<p>Inside the <code>pages</code> folder, we need to create a file called <code>_document.tsx</code>. In that file, you will need this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// next</span>
<span class="k">import</span> <span class="nx">Document</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Head</span><span class="p">,</span> <span class="nx">Html</span><span class="p">,</span> <span class="nx">Main</span><span class="p">,</span> <span class="nx">NextScript</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">next/document</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">DocumentContext</span><span class="p">,</span> <span class="nx">DocumentInitialProps</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">next/document</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// styled components</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ServerStyleSheet</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">MyDocument</span> <span class="kd">extends</span> <span class="nx">Document</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">getInitialProps</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">:</span> <span class="nx">DocumentContext</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DocumentInitialProps</span><span class="o">></span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ServerStyleSheet</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">originalRenderPage</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">renderPage</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">renderPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=></span>
        <span class="nx">originalRenderPage</span><span class="p">({</span>
          <span class="na">enhanceApp</span><span class="p">:</span> <span class="p">(</span><span class="nx">App</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=></span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">collectStyles</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="sr">/></span><span class="err">)
</span>        <span class="p">});</span>

      <span class="kd">const</span> <span class="nx">initialProps</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Document</span><span class="p">.</span><span class="nx">getInitialProps</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>

      <span class="k">return</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">initialProps</span><span class="p">,</span>
        <span class="na">styles</span><span class="p">:</span> <span class="p">(</span>
          <span class="o">&lt;></span>
            <span class="p">{</span><span class="nx">initialProps</span><span class="p">.</span><span class="nx">styles</span><span class="p">}</span>
            <span class="p">{</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getStyleElement</span><span class="p">()}</span>
          <span class="o">&lt;</span><span class="sr">/</span><span class="err">>
</span>        <span class="p">)</span>
      <span class="p">};</span>
    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
      <span class="nx">sheet</span><span class="p">.</span><span class="nx">seal</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Html</span><span class="o">></span>
        <span class="o">&lt;</span><span class="nx">Head</span><span class="o">></span>
          <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="dl">'</span><span class="s1">preconnect</span><span class="dl">'</span> <span class="nx">href</span><span class="o">=</span><span class="dl">'</span><span class="s1">https://fonts.googleapis.com</span><span class="dl">'</span> <span class="o">/></span>
          <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="dl">'</span><span class="s1">preconnect</span><span class="dl">'</span> <span class="nx">href</span><span class="o">=</span><span class="dl">'</span><span class="s1">https://fonts.gstatic.com</span><span class="dl">'</span> <span class="nx">crossOrigin</span><span class="o">=</span><span class="dl">'</span><span class="s1">true</span><span class="dl">'</span> <span class="o">/></span>
          <span class="o">&lt;</span><span class="nx">link</span>
            <span class="nx">href</span><span class="o">=</span><span class="dl">'</span><span class="s1">https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap</span><span class="dl">'</span>
            <span class="nx">rel</span><span class="o">=</span><span class="dl">'</span><span class="s1">stylesheet</span><span class="dl">'</span>
          <span class="o">/></span>
        <span class="o">&lt;</span><span class="sr">/Head</span><span class="err">>
</span>        <span class="o">&lt;</span><span class="nx">body</span><span class="o">></span>
          <span class="o">&lt;</span><span class="nx">Main</span> <span class="o">/></span>
          <span class="o">&lt;</span><span class="nx">NextScript</span> <span class="o">/></span>
        <span class="o">&lt;</span><span class="sr">/body</span><span class="err">>
</span>      <span class="o">&lt;</span><span class="sr">/Html</span><span class="err">>
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">MyDocument</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>A <strong>BIG</strong> shoutout to Nicolás M. Pardo here on dev.to as he posted this in a comments section from a different article and it saved the day! And as you can see, I also just added the necessary code to include links to Google Fonts. If you don't need that, you can simply get rid of it.</p>

<p>Now we just need to restart the server and everything should be a-ok!</p>

<h2>
  <a name="contentful" href="#contentful">
  </a>
  Contentful
</h2>

<p>In this section, we'll take a look at a few key areas:</p>

<ul>
<li>The use of environment variables</li>
<li>Querying data from Contentful using GraphQL</li>
<li>The use of webhooks</li>
<li>Local development experience</li>
<li>Using fragments for reusable queries</li>
</ul>

<h3>
  <a name="the-use-of-environment-variables" href="#the-use-of-environment-variables">
  </a>
  The use of environment variables
</h3>

<p>Somewhat disappointingly, while going through the setup for Gatsby, after selecting Contentful as your headless CMS, the necessary <code>.env</code> files are not created as part of the setup. And with Next, you will need to set them up manually yourself.</p>

<p>Now to be fair to both, if you use the <a href="https://github.com/contentful/starter-gatsby-blog">starter-gatsby-blog</a> from Contentful themselves, the new <a href="https://github.com/gatsbyjs/gatsby-starter-contentful-homepage">gatsby-starter-contentful-homepage</a> from Gatsby, or the Next.js Contentful <a href="https://github.com/vercel/next.js/tree/canary/examples/cms-contentful">example</a>, these do use environment variables. It's just these basic starters that do not.</p>

<p>For Next.js, you simply need to create a <code>.env.local</code> file, and add in your variables like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>VARIABLE_NAME=VALUE
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then restart your local dev server if it is currently running so Next.js can load in the variables. You should see <code>Loaded from env</code> in your terminal after the local dev server starts up.</p>

<p>For Gatsby, create 2 files:</p>

<ul>
<li><code>.env.development</code></li>
<li><code>.env.production</code></li>
</ul>

<p>Add in the same variables in both files and you will be good to go.</p>

<h3>
  <a name="querying-data-from-contentful-using-graphql" href="#querying-data-from-contentful-using-graphql">
  </a>
  Querying data from Contentful using GraphQL
</h3>

<p>Both frameworks take a similar approach to querying data from Contentful using GraphQL. To <em>greatly</em> oversimplify things, the process essentially boils down to:</p>

<ul>
<li>Make a query using GraphQL</li>
<li>Pass that returned data to your components as props</li>
<li>Display the data in your components</li>
</ul>

<p>How each framework does that is of course different, and we'll explore it in further detail below.</p>

<p>But first, one thing I do want to give big props to is Gatsby's implementation of the GraphiQL playground. Specifically, including an Explorer. I have to admit, I have taken this for granted, as it makes structuring queries so, so much easier.</p>

<p>With Next.js, I ended up using the GraphiQL playground provided by Contentful themselves. You can view it here:</p>

<p><a href="https://graphql.contentful.com/content/v1/spaces/YOUR_SPACE_ID_HERE/explore?access_token=YOUR_ACCESS_TOKEN_HERE">https://graphql.contentful.com/content/v1/spaces/YOUR_SPACE_ID_HERE/explore?access_token=YOUR_ACCESS_TOKEN_HERE</a></p>

<p>Just make sure to update the placeholders with your actual Contentful Space ID and Access Token.</p>

<h4>
  <a name="gatsby" href="#gatsby">
  </a>
  Gatsby
</h4>

<p>With Gatsby, querying data from Contentful using GraphQL is very straightforward. In your page component file, you add your GraphQL query typically beneath the <code>export default</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// component code up here...</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Home</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query HomePageQuery {
    contentfulHero(id: { eq: "ID_HERE" }) {
      title
      tagline
      backgroundImage {
        id
        description
        gatsbyImageData
      }
    }
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>In this example, I'm querying data from a specific Hero model I created, and I want the values from the <code>title</code>, <code>tagline</code>, and <code>backgroundImage</code> fields. I'll be discussing images in more detail later on.</p>

<p>To actually consume this data, the page component can access the returned data via the <code>data</code> prop. From there, you can pass it down as a <code>prop</code> to the corresponding component like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">Home</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">location</span> <span class="p">}:</span> <span class="nx">PageProps</span><span class="o">&lt;</span><span class="nx">GraphQLResult</span><span class="o">></span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="c1">// just double check...</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">data: </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Layout</span> <span class="nx">title</span><span class="o">=</span><span class="dl">'</span><span class="s1">Home</span><span class="dl">'</span><span class="o">></span>
      <span class="o">&lt;</span><span class="nx">Hero</span> <span class="nx">contentfulData</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">>
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With TypeScript, we can also type out how the response will look. The name I've always used is <code>GraphQLResult</code>, but you can name it whatever you like. The type for this is just above the component like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">type</span> <span class="nx">GraphQLResult</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">contentfulHero</span><span class="p">:</span> <span class="nx">ContentfulHero</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">Home</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">location</span> <span class="p">}:</span> <span class="nx">PageProps</span><span class="o">&lt;</span><span class="nx">GraphQLResult</span><span class="o">></span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="c1">// just double check...</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">data: </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Layout</span> <span class="nx">title</span><span class="o">=</span><span class="dl">'</span><span class="s1">Home</span><span class="dl">'</span><span class="o">></span>
      <span class="o">&lt;</span><span class="nx">Hero</span> <span class="nx">contentfulData</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">>
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I like to keep my types in a separate folder, so I import <code>ContentfulHero</code> wherever I need it. The type looks like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">IGatsbyImageData</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">gatsby-plugin-image</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContentfulHero</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">title</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">tagline</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">backgroundImage</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">description</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">gatsbyImageData</span><span class="p">:</span> <span class="nx">IGatsbyImageData</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And the Hero component can also use this type for <code>props</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">type</span> <span class="nx">HeroProps</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">contentfulData</span><span class="p">:</span> <span class="nx">ContentfulHero</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">Hero</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">contentfulData</span> <span class="p">}:</span> <span class="nx">HeroProps</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">'</span><span class="s1">wrapper</span><span class="dl">'</span><span class="o">></span>
    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">></span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="nx">p</span><span class="o">></span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">tagline</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">>
</span>  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">>
</span><span class="p">);</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Hero</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This way I have full type checking for my data, as well as some nice auto-completion when using the data in my component.</p>

<p>There are some tools you can use to automatically generate the types for your GraphQL Schema, such as <a href="https://www.graphql-code-generator.com/">GraphQL Code Generator</a>. However, since this is a fairly small project, and I am the only dev working on it, I don't mind setting things up manually myself.</p>

<h4>
  <a name="nextjs" href="#nextjs">
  </a>
  Next.js
</h4>

<p>With Next.js, the process is quite similar. However, there are multiple ways to query data with Next.js:</p>

<ul>
<li>React hooks at the component level (<code>useEffect</code> with an <code>async</code> function is a common approach)</li>
<li>
<code>getStaticProps()</code> at the page level</li>
<li>
<code>getServerSideProps()</code> at the page level</li>
<li>
<code>useSWR()</code> hook at the component level</li>
</ul>

<p>For my purposes, since this is a static portfolio site, I will be using the <code>getStaticProps()</code> function. As outlined in the Next.js <a href="https://nextjs.org/docs/basic-features/data-fetching/get-static-props">documentation</a>, if the data is coming from a headless CMS, then <code>getStaticProps()</code> is a great choice. Check out the documentation on how the function works if you are not familiar with it, as I do not have the courage to explain it since I am still new to it.</p>

<p>Inside this function, we can make our request. This <a href="https://www.youtube.com/watch?v=bMRQgguzBLs&t=1613s">video</a> from the Contentful YouTube channel was very helpful, and required minimal modification for TypeScript.</p>

<p>In the video, Lee recommends using the <code>graphql-request</code> package. And I have to say, as a first time user, I quite liked it! I will definitely look to use this again in the future!</p>

<p>To start, we will need to import <code>GraphQLClient</code> & <code>gql</code> from <code>graphql-request</code> as named imports:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLClient</span><span class="p">,</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-request</span><span class="dl">'</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then inside the <code>getStaticProps()</code> function, we can start with the following:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`https://graphql.contentful.com/content/v1/spaces/</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_SPACE_ID</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_ACCESS_TOKEN</span><span class="p">}</span><span class="s2">`</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">graphQLClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLClient</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Notice the value for <code>endpoint</code> is different than that of the URL you would visit in the browser!</p>

<p>Next, we can use the <code>gql</code> function to write our GraphQL Query, and we'll see some noticeable differences:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  {
    hero(id: "ID_HERE") {
      backgroundImage {
        sys {
          id
        }
        description
        height
        url
        width
      }
      tagline
      title
    }
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The first is actually <code>ID_HERE</code>. When using the Explorer in Gatsby's GraphiQL playground, you can either use the ContentfulId or Id. The latter looks like this:</p>

<p><code>a1a1a1a1-a1a1-a1a1-a1a1-a1a1a1a1a1a1</code></p>

<p>Where the As and 1s could be any combination of letters and numbers. With Next.js, you don't get this type of ID. Instead, you simply use the <code>ENTRY ID</code> for whichever piece of content you are querying for.</p>

<p>To see this <code>ENTRY ID</code>, select any piece of content you have created in Contentful. Then on the right-hand sidebar menu, select the <code>Info</code> tab. Second from the top is the <code>ENTRY ID</code>. In all fairness, you could also use this in your GraphQL queries with Gatsby as well. I've always just used the long-form id above out of habit.</p>

<p>The next difference are the fields we can query for the image. We'll need these files to pass them on to Next.js's <code>&lt;Image /></code> component. Again, we'll discuss each framework's approach to images and image optimization later.</p>

<p>Finally, store the returned data in a variable like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">ContentfulResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphQLClient</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">homePageQuery</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then return in a props object:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">data</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here, I am using the ES6 object shorthand where if the key and value are the same, we can write like I have above instead of like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">data</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>So all together, <code>getStaticProps()</code> looks like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">getStaticProps</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// get contentful data</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`https://graphql.contentful.com/content/v1/spaces/</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_SPACE_ID</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_ACCESS_TOKEN</span><span class="p">}</span><span class="s2">`</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">graphQLClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLClient</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
    query HomepageQuery {
      hero(id: "ID_HERE") {
        backgroundImage {
          sys {
            id
          }
          description
          height
          url
          width
        }
        tagline
        title
      }
    }
  `</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">ContentfulResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphQLClient</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">homePageQuery</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
      <span class="nx">data</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now in the <code>Home</code> page component, we can access this <code>data</code> prop like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span><span class="o">&lt;</span><span class="nx">HomeProps</span><span class="o">></span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">data: </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nc">Hero</span> <span class="p">/></span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And to be clear, <code>data</code> is just the name I chose. I could've called it <code>hero</code> if I wanted to, and accessed it via a <code>hero</code> prop instead. I like using <code>data</code> because I'll be adding on to the GraphQL query later on querying for multiple pieces of content. So, <code>data</code> is just a generic variable name I like to use, and comes from the habit of using Gatsby.</p>

<p>And just like before with Gatsby, we pass the data down to the corresponding component:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span><span class="o">&lt;</span><span class="nx">HomeProps</span><span class="o">></span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">data: </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nc">Hero</span> <span class="na">contentfulData</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="si">}</span> <span class="p">/></span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And that's it! That's how we can query data from Contentful with both frameworks with GraphQL. Personally, I don't really have a preference. I think both are perfectly fine.</p>

<p>And as a quick side note, I would extract the querying logic in <code>getStaticProps()</code> into a separate file and folder to make the code inside <code>getStaticProps()</code> cleaner, as well as make the query a bit more reusable. It would require some modification, but it would make for a good starting point.</p>

<h3>
  <a name="the-use-of-webhooks" href="#the-use-of-webhooks">
  </a>
  The use of webhooks
</h3>

<p>When it comes to hosting, whether you choose Netlify, Gatsby Cloud, or Vercel, they all have options to set up both environment variables, as well as webhooks that you can use with Contentful. This way, whenever you make a change, or mutliple changes, in Contentful, the site will rebuild with the latest data.</p>

<h3>
  <a name="local-development-experience" href="#local-development-experience">
  </a>
  Local development experience
</h3>

<p>An interesting note here is that with Gatsby, during local development, whenever you make a change in Contentful, it will <em>not</em> appear while the local dev server is running. You must restart the server, and clean the <code>public</code> and <code>.cache</code> folders as well. So, I would recommend adjusting the <code>dev</code> script in <code>package.json</code> to the following:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight json"><code><span class="nl">"clean"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gatsby clean"</span><span class="err">,</span><span class="w">
</span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm run clean && gatsby develop"</span><span class="err">,</span><span class="w">
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This is because Gatsby will run your GraphQL queries during build time, and not run time. Therefore, a restart is required.</p>

<p>With Next.js however, you simply need to manually refresh the page in the browser, and any changes will be seen.</p>

<h3>
  <a name="using-fragments-for-reusable-queries" href="#using-fragments-for-reusable-queries">
  </a>
  Using fragments for reusable queries
</h3>

<p>The great thing about querying data with GraphQL is you can use something called <a href="https://graphql.org/learn/queries/#fragments">fragments</a>. Fragments help by cutting down on repeated query fields.</p>

<h4>
  <a name="gatsby" href="#gatsby">
  </a>
  Gatsby
</h4>

<p>With Gatsby, creating reusable fragments is very straightforward. In the <code>src</code> folder, I typically create another folder called <code>graphql</code>. In the <code>graphql</code> folder, I then create a file called <code>fragments.ts</code>. Here, let's create a highly reusable fragment for fields for an image:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">imageFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  fragment ImageFields on ContentfulAsset {
    id
    description
    gatsbyImageData(placeholder: BLURRED)
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>What's so nice about this is that Gatsby <em>automatically</em> exports these queries to the global scope. So, these fragments are available in any other GraphQL query in the entire project! We can even use our fragments in other fragments!</p>

<p>And just as a quick side note, I like to include <code>id</code> here even if I'm only querying for a single image because in the instance I <em>do</em> query for multiple images, I have the <code>id</code>'s ready to use for mapping over the array and using them as the value for the <code>key</code> prop.</p>

<p>Now, let's say for example we have a standard 50/50 model, with <code>heading</code> & <code>copy</code> on the left and an <code>image</code> on the right. For the fragment, it would look something like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">fiftyFiftyFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  fragment FiftyFiftyFields on ContentfulFiftyFifty {
    id
    heading
    copy {
      copy
    }
    image {
      ...ImageFields
    }
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now we can use this fragment in the <code>HomePageQuery</code>, for example, like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query HomePageQuery {
    firstFiftyFifty: contentfulFiftyFifty(id: { eq: "ID_1_HERE" }) {
      ...FiftyFiftyFields
    }
    secondFiftyFifty: contentfulFiftyFifty(id: { eq: "ID_2_HERE" }) {
      ...FiftyFiftyFields
    }
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>In this example, we can also see <a href="https://graphql.org/learn/queries/#aliases">aliases</a> being used. Aliases let you rename the result of a field to anything you want. This is helpful for when you are querying the same thing but with different arguments.</p>

<p>So, combining fragments and aliases really help make our queries shorter, cleaner, and easier to read and write.</p>

<h4>
  <a name="nextjs" href="#nextjs">
  </a>
  Next.js
</h4>

<p>With Next.js, while we don't get automatic global scoped fragments, we can still create and use them, just with a little bit of extra work.</p>

<p>We can start with the same process by creating a <code>fragments.ts</code> file inside of a <code>graphql</code> folder. Let's create a reusable Image fragment:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-request</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">FRAGMENT_IMAGE</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  fragment ImageFields on Asset {
    sys {
      id
    }
    description
    height
    url
    width
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now back in the index page file, inside <code>getStaticProps()</code> and then inside our <code>gql</code> template string, we can go from this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  query HomepageQuery {
    hero(id: "ID_HERE") {
      backgroundImage {
        sys {
          id
        }
        description
        height
        url
        width
      }
      tagline
      title
    }
  }

  # fragments
  </span><span class="p">${</span><span class="nx">FRAGMENT_IMAGE</span><span class="p">}</span><span class="s2">
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>To this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  query HomepageQuery {
    hero(id: "ID_HERE") {
      backgroundImage {
        ...ImageFields
      }
      tagline
      title
    }
  }

  # fragments
  </span><span class="p">${</span><span class="nx">FRAGMENT_IMAGE</span><span class="p">}</span><span class="s2">
  # make sure to import this!
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>It may not look very powerful right now when querying a single piece of content, but I'm sure you can imagine if this homepage had say 8-10 sections, all of them containing images, having the same fields repeated over and over again would make the query very long and rather difficult to traverse.</p>

<h2>
  <a name="image-optimization" href="#image-optimization">
  </a>
  Image Optimization
</h2>

<p>Both frameworks come with image optimization OOTB in the form of components. Next.js has <a href="https://nextjs.org/docs/api-reference/next/image">&lt;Image /></a>, and Gatsby has both <a href="https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage">&lt;StaticImage /></a> and <a href="https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage">&lt;GatsbyImage /></a>.</p>

<p>Let's explore their differences:</p>

<h3>
  <a name="gatsby" href="#gatsby">
  </a>
  Gatsby
</h3>

<p>Gatsby comes with 2 different image components. When you should use which? The answer to that is very simple.</p>

<p>Is the image you're using the same every time the component is rendered? For example, the site logo, or any other picture located within the project locally? Then use <code>&lt;StaticImage /></code>.</p>

<p>Is the image you're using going to be passed into a component as a <code>prop</code>, and / or coming from an external source, such as Contentful? Then use <code>&lt;GatsbyImage /></code>.</p>

<p>Since this article is all about Contentful, we'll be focusing on <code>&lt;GatsbyImage /></code>!</p>

<p>In the GraphiQL playground, whenever you want to query for an image (or multiple images), I'd recommend getting the following fields:</p>

<ul>
<li><code>id</code></li>
<li><code>description</code></li>
<li><code>gatsbyImageData</code></li>
</ul>

<p>With this, we can create a reusable fragment for querying those fields on images (known as Assets in Contentful):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">imageFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  fragment ImageFields on ContentfulAsset {
    id
    description
    gatsbyImageData(placeholder: BLURRED)
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>When you execute the query with these fields, you'll see a <em>ton</em> of data for the gatsbyImageData field. But don't worry, the <code>&lt;GatsbyImage /></code> component will handle all of that for us!</p>

<p>You would use that data like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">GatsbyImage</span> <span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">gatsbyImageData</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>You can see in my fragment above I also added <code>(placeholder: BLURRED)</code>. This will do as the wording suggests! It will blur the image until the full res version is ready to use. This will help cut down on page load time and help improve performance.</p>

<h3>
  <a name="nextjs" href="#nextjs">
  </a>
  Next.js
</h3>

<p>With Next.js, we get a single <code>&lt;Image /></code> component that we can use for both static and dynamic images. And very similarly to Gatsby, as long as we pass it the right data for its various props, it will handle all the heavy lifting for us!</p>

<p>And just like with Gatsby, we can create a highly reusable fragment like we did above in the previous section to query certain fields from Contentful. We would then use that data like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Image</span>
  <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span>
  <span class="nx">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span>
  <span class="nx">width</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">width</span><span class="p">}</span>
  <span class="nx">height</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">height</span><span class="p">}</span>
<span class="sr">/</span><span class="err">>
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And that's it! Well...sort of. With Next.js, there is one more step. We have to add the domain these images are coming from to an array in our <code>next.config.js</code> file. This array holds an array of <code>domains</code> that are whitelisted. This tells Next.js that it is ok to fetch the images from these external sources and optimize them:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="cm">/** @type {import('next').NextConfig} */</span>
<span class="kd">const</span> <span class="nx">nextConfig</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">images</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">domains</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">images.ctfassets.net</span><span class="dl">'</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="na">reactStrictMode</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">nextConfig</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Ok, <em>now</em> we have optimized images from Contentful!</p>

<h2>
  <a name="blog-posts" href="#blog-posts">
  </a>
  Blog Posts
</h2>

<p>Now that I'm writing blog posts here on dev.to, I wanted to incorporate them into my portfolio as well. While Contentful does have a Markdown text box that I could just copy and paste the post into and create dynamic routes with either framework, I was more interested in how I would query data from 2 different data sources using 2 different methods:</p>

<ul>
<li>Querying content from Contentful using GraphQL</li>
<li>Querying posts from dev.to using REST API w/ Fetch</li>
</ul>

<p>Let's take a look!</p>

<h3>
  <a name="gatsby" href="#gatsby">
  </a>
  Gatsby
</h3>

<p>With Gatsby, I had an assumption of how I would query for my blog posts, and after some research (aka quick Googling), it seems like my assumption was correct.</p>

<p>I created a BlogPosts component, and inside that component I made the fetch call like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">BlogPosts</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">posts</span><span class="p">,</span> <span class="nx">setPosts</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">DevPost</span><span class="p">[]</span><span class="o">></span><span class="p">([]);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span> <span class="nx">setIsLoading</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">fetchBlogPosts</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://dev.to/api/articles?username=andrews1022</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="na">data</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

    <span class="nx">setPosts</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

    <span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">fetchBlogPosts</span><span class="p">();</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">></span>Posts<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
        <span class="si">{</span><span class="nx">isLoading</span> <span class="p">?</span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nt">p</span><span class="p">></span>Loading...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">></span>
        <span class="p">)</span> <span class="p">:</span> <span class="p">(</span>
          <span class="nx">posts</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">post</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">></span>
              <span class="p">&lt;</span><span class="nt">p</span><span class="p">></span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">></span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
          <span class="p">))</span>
        <span class="p">)</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now I realize I don't have error handling in the form of an error state, or a cleanup in my <code>useEffect</code>, but that's ok since I'm just trying things out before making any large commitments.</p>

<p>This is a pretty standard approach:</p>

<ul>
<li>Have state for the data, loading, and error</li>
<li>Write an async function that queries the data, and updates the various pieces of state accordingly</li>
<li>In the useEffect hook, call the async function and have an empty array of dependencies so this function will only be executed once when the component is first mounted / rendered</li>
</ul>

<p>And that's it! My blog post titles display just fine. With Next.js though, that's where things get a little spicy.</p>

<h3>
  <a name="nextjs" href="#nextjs">
  </a>
  Next.js
</h3>

<p>With Next.js, we can take advantage of the <code>getStaticProps()</code> function and add this additional request below the GraphQL query to Contentful and return it alongside the <code>data</code> like so:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">getStaticProps</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// make the contentful query up here...</span>

  <span class="c1">// get dev.to data</span>
  <span class="kd">const</span> <span class="nx">postsResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://dev.to/api/articles?username=andrews1022</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">posts</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">postsResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
      <span class="nx">data</span><span class="p">,</span>
      <span class="nx">posts</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Again, I realize there isn't any error handling here, this is just for the sake of demonstration purposes. And in case I didn't mention earlier, the <code>DevPost</code> type is a custom type I created.</p>

<p>With these posts, I can pass them down to my BlogPosts component:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">BlogPosts</span> <span class="nx">posts</span><span class="o">=</span><span class="p">{</span><span class="nx">posts</span><span class="p">}</span> <span class="sr">/</span><span class="err">>
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And then loop over them and display them like so (just the <code>title</code> for now to make sure things are working):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">type</span> <span class="nx">BlogPostsProps</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">posts</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[];</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">BlogPosts</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">posts</span> <span class="p">}:</span> <span class="nx">BlogPostsProps</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">></span>Posts<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">></span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
        <span class="si">{</span><span class="nx">posts</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">post</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">></span>
            <span class="p">&lt;</span><span class="nt">p</span><span class="p">></span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">></span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
        <span class="p">))</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Why I think this is spicy is because since Next.js pre-renders the page at build time using the props returned by <code>getStaticProps()</code>, there is no awkward <code>Loading...</code> text or spinner being shown temporarily. Everything is just...there! I'm still getting used to Next.js, so I probably didn't explain that very well but I just think it's neat (insert <a href="https://i.kym-cdn.com/photos/images/newsfeed/001/498/880/572.jpg">Marge Simpson meme</a> here)!</p>

<h2>
  <a name="hosting" href="#hosting">
  </a>
  Hosting
</h2>

<p>Hosting is dead simple no matter which you pick. Each framework has their own hosting service which they recommend:</p>

<p><a href="https://www.gatsbyjs.com/products/cloud/">Gatsby Cloud</a> for Gatsby projects, and <a href="https://vercel.com/">Vercel</a> for Next.js projects.</p>

<p>You could also use <a href="https://www.netlify.com/">Netlify</a> if you wish.</p>

<p>Whichever you pick, you can select your project from GitHub (once you have given it authorization to do so), and the service will automatically build and host the site for you!</p>

<p>And as previously mentioned, you can include environment variables for your Contentful API keys, as well as setup webhooks with Contentful.</p>

<h2>
  <a name="final-thoughts" href="#final-thoughts">
  </a>
  Final Thoughts
</h2>

<p>Whew, that was a lot! If you made it this far, thank you so much for reading this post. I had a lot of fun researching and trying out the various points I mentioned here, and it was great to try out and learn more about Next.js some more as well.</p>

<p>My goal for this article was to simply show you each framework's approach for common tasks and let you decide which approach(es) you do or don't like. Personally, I'm going to stick with Next.js to build out the rest of my portfolio simply because I want to become more familiar with it and learn more about it.</p>

<p>In my opinion, for a simple static like this, you really can't go wrong with either framework. If you have more experience with one over the other, I would recommend trying the other and see what you think. I provided my experience here and I hope you found it useful.</p>

<p>Cheers!</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/andrews1022/an-unnecessarily-extensive-comparison-of-gatsby-nextjs-while-rebuilding-my-portfolio-58f2" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,n,a,e,t){return a.type_of="article",a.id=1051221,a.title="An Extensive Comparison of Gatsby & Next.js (While Rebuilding My Portfolio)",a.description="I was looking at my developer portfolio recently and decided it could use an update. While I kept it...",a.readable_publish_date="Apr 15",a.slug="an-unnecessarily-extensive-comparison-of-gatsby-nextjs-while-rebuilding-my-portfolio-58f2",a.path="/andrews1022/an-unnecessarily-extensive-comparison-of-gatsby-nextjs-while-rebuilding-my-portfolio-58f2",a.url=e,a.comments_count=0,a.public_reactions_count=9,a.collection_id=s,a.published_timestamp=n,a.positive_reactions_count=9,a.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--IKvACsR---/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/o8a8afcdejc3fn036vw3.jpg",a.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--Up92FClJ--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/o8a8afcdejc3fn036vw3.jpg",a.canonical_url=e,a.created_at="2022-04-11T04:24:42Z",a.edited_at="2022-04-15T18:01:13Z",a.crossposted_at=s,a.published_at=n,a.last_comment_at=n,a.reading_time_minutes=21,a.tag_list="gatsby, nextjs, typescript, contentful",a.tags=["gatsby","nextjs","typescript","contentful"],a.body_html='<p>I was looking at my developer portfolio recently and decided it could use an update. While I kept it up to date with my most recent projects that I wanted to showcase, I wasn\'t a fan of the look anymore. I also thought it would be nice to use <a href="https://www.contentful.com/">Contentful</a> as a <a href="https://en.wikipedia.org/wiki/Headless_content_management_system">headless CMS</a> to manage the content of the site, as well as fetch and display a couple of my most recent blog posts from here on dev.to.</p>\n\n<p>I\'ve mostly used <a href="https://www.gatsbyjs.com/">Gatsby</a> both at work and for personal projects, and I\'ve been wanting to learn more about <a href="https://nextjs.org/">Next.js</a> and become more familiar with using it, so I took this opportunity to start rebuilding my portfolio using both of these frameworks. I had a list of requirements in mind, so along the way I noted my experience with both frameworks and I want to share that experience with you here. Perhaps you will find it helpful the next time you need to decide which framework to use.</p>\n\n<h2>\n  <a name="requirements" href="#requirements">\n  </a>\n  Requirements\n</h2>\n\n<p>I like to keep my portfolio nice and simple. The order of the sections are:</p>\n\n<ul>\n<li>Hero (including nav)</li>\n<li>Projects</li>\n<li>About Me</li>\n<li>Blog Posts</li>\n<li>Contact</li>\n<li>Footer</li>\n</ul>\n\n<p>It\'s a single page, so I will not be looking to create dynamic routes / pages for any of my content. I would consider doing so for the blog posts since Contentful has a Markdown text box, and on dev.to you write in Markdown, so it would just be a copy paste. However, I wanted to see what would be considered best practice / convention for both:</p>\n\n<ul>\n<li>Fetching content from Contentful using GraphQL</li>\n<li>Fetching blog posts from the dev.to API using the good ol\' <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a>\n</li>\n</ul>\n\n<p>A few other things I wanted to compare between the two were:</p>\n\n<ul>\n<li>Downloading and starting with a basic boilerplate with TypeScript support</li>\n<li>Integrating <a href="https://styled-components.com/">styled-components</a>\n</li>\n<li>A few points regarding Contentful:\n\n<ul>\n<li>The use of environment variables</li>\n<li>Using webhooks to automatically update the hosted site whenever I make a change in Contentful</li>\n<li>Similarly, how changes in Contentful appear during local development</li>\n<li>Local development experience</li>\n<li>Using fragments for reusable queries</li>\n</ul>\n\n\n</li>\n<li>Optimizing images from Contentful</li>\n<li>How easy is it to host a Gatsby and Next.js site</li>\n</ul>\n\n<p>I also want to note that my intention wasn\'t to <em>fully</em> rebuild my portfolio with each, but more so I wanted to get the scaffolding done, compare my notes as well as any pros and cons of the requirements I\'ve listed above, and from there I\'ll decide which one I plan to proceed with to complete the project.</p>\n\n<p>I simply created 2 new branches on my existing portfolio repo, which I aptly named <code>gatsby</code> and <code>next</code>, and worked with each framework on their respective branch. In hindsight, it would\'ve been <em>much</em> easier to just work with framework each in their own folders in isolation. Oh well! ¯\\_(ツ)_/¯</p>\n\n<p>So, let\'s get started!</p>\n\n<h2>\n  <a name="boilerplate" href="#boilerplate">\n  </a>\n  Boilerplate\n</h2>\n\n<p>To start, I looked at what possible starter / boilerplates both frameworks offered. While both offer Contentful based starters, they are not in TypeScript OOTB. So, I decided upon using their basic TypeScript starter and building it up from there. That way, I have as close as a starting point for each as possible.</p>\n\n<p>Next.js has supported TypeScript for a while now, but thankfully Gatsby also now has full TypeScript support too. Not just with pages and components, which they also have supported for a while now, but all of the Gatsby API files (<code>gatsby-browser</code>, <code>gatsby-node</code>, etc.) can also be written in TypeScript as of Gatsby <a href="https://www.gatsbyjs.com/docs/reference/release-notes/v4.8/">v4.8</a> and <a href="https://www.gatsbyjs.com/docs/reference/release-notes/v4.9/">4.9</a>.</p>\n\n<p>For Gatsby, you can run the command:</p>\n\n<p><code>npm init gatsby -ts</code></p>\n\n<p>And for Next.js you can run the command:</p>\n\n<p><code>npx create-next-app@latest --ts</code></p>\n\n<p>A quick, minor note regarding Gatsby: in the <a href="https://www.gatsbyjs.com/docs/how-to/custom-configuration/typescript/">documentation</a> it says to run <code>npm init gatsby</code> and select TypeScript as your language when prompted. Or you can run <code>npm init gatsby -ts</code> to skip that question. In my experience, that is not true. When you run <code>npm init gatsby -ts</code>, you still have to select TypeScript as your language. So, it doesn\'t matter whether or not you include the <code>-ts</code> flag.</p>\n\n<p>For Next.js, there is no questionnaire during setup, and I actually don\'t mind this at all, and it kind of makes sense if you think about it. Gatsby is focused on creating fast, static sites using headless CMSs. As such, it gives you a few options to pick from during setup in the CLI, as well as a few options for styling your app.</p>\n\n<p>With Next, since it is a hybrid framework and it can be used for much more than static headless CMS-based sites, including a questionnaire is not ideal because there are just <em>so</em> many things to consider. Perhaps including a step for styling would be nice, and some other common inclusions such as linting, but I think it\'s fine without one.</p>\n\n<p>Either way, both startup just fine after running <code>npm run dev</code>!</p>\n\n<h2>\n  <a name="styled-components" href="#styled-components">\n  </a>\n  Styled Components\n</h2>\n\n<p>This is where things start to get interesting. <a href="https://styled-components.com/">styled-components</a> is my go to approach for styling React apps myself. Otherwise, I usually go with Material UI (now <a href="https://mui.com/">MUI</a>) or <a href="https://react-bootstrap.github.io/">React Bootstrap</a>.</p>\n\n<p>Implementing styled-components into Gatsby and Next are quite different.</p>\n\n<p>First, let\'s take a look at Gatsby.</p>\n\n<h3>\n  <a name="gatsby" href="#gatsby">\n  </a>\n  Gatsby\n</h3>\n\n<p>With Gatsby, you will need to install the following NPM packages:</p>\n\n<ul>\n<li><code>babel-plugin-styled-components</code></li>\n<li><code>gatsby-plugin-styled-components</code></li>\n<li><code>styled-components</code></li>\n</ul>\n\n<p>And if you\'re using TypeScript like I do, then the <code>@types</code> package from DefinitelyTyped as well:</p>\n\n<ul>\n<li><code>@types/styled-components</code></li>\n</ul>\n\n<p>So, in total 3-4 packages. From there, you simply need to add <code>gatsby-plugin-styled-components</code> to your <code>plugins</code> array inside your <code>gatsby-config</code> file. After that, I typically create a <code>styles</code> folder inside the <code>src</code> folder, and then inside the <code>styles</code> folder I create 2 files:</p>\n\n<ul>\n<li><code>GlobalStyle.ts</code></li>\n<li><code>theme.ts</code></li>\n</ul>\n\n<p><code>theme.ts</code> will hold variables for the project such as colours, font sizes, breakpoints, etc. Here\'s the starting code I typically use:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">theme</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">mediaQueries</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">desktopHD</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1920px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">desktopMedium</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1680px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">desktopSmall</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1440px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">laptop</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1366px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">laptopSmall</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1280px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">tabletLandscape</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 1024px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">tabletMedium</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 900px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">tabletPortrait</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 768px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileXLarge</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 640px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileLarge</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 576px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileMedium</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 480px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileSmall</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 415px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileXSmall</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 375px)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">mobileTiny</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">only screen and (max-width: 325px)</span><span class="dl">\'</span>\n  <span class="p">},</span>\n  <span class="na">shades</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">white</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">#fff</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">black</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">#000</span><span class="dl">\'</span>\n  <span class="p">},</span>\n  <span class="na">greys</span><span class="p">:</span> <span class="p">{</span>\n    <span class="c1">// add any greys here</span>\n  <span class="p">},</span>\n  <span class="na">colors</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">primary</span><span class="p">:</span> <span class="p">{</span>\n      <span class="c1">// add primary colors here</span>\n    <span class="p">},</span>\n    <span class="na">secondary</span><span class="p">:</span> <span class="p">{</span>\n      <span class="c1">// add secondary colors here</span>\n    <span class="p">}</span>\n  <span class="p">},</span>\n  <span class="na">fonts</span><span class="p">:</span> <span class="p">{</span>\n    <span class="c1">// add font-families here</span>\n  <span class="p">},</span>\n  <span class="na">fontWeights</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">thin</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>\n    <span class="na">extraLight</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>\n    <span class="na">light</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>\n    <span class="na">normal</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>\n    <span class="na">medium</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>\n    <span class="na">semiBold</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>\n    <span class="na">bold</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>\n    <span class="na">extraBold</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span>\n    <span class="na">black</span><span class="p">:</span> <span class="mi">900</span>\n  <span class="p">},</span>\n  <span class="na">fontSizes</span><span class="p">:</span> <span class="p">{</span>\n    <span class="c1">// add font sizes here</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">theme</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And <code>GlobalStyle.ts</code> will use the <code>createGlobalStyle</code> helper function to create a <code>GlobalStyle</code> component. This component will house global styles and any styling resets you want to include. Here is what I typically start with:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createGlobalStyle</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">styled-components</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">theme</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./theme</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// destructured theme properties</span>\n<span class="kd">const</span> <span class="p">{</span> <span class="nx">mediaQueries</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">theme</span><span class="p">;</span>\n\n<span class="kd">const</span> <span class="nx">GlobalStyle</span> <span class="o">=</span> <span class="nx">createGlobalStyle</span><span class="s2">`\n  html {\n    box-sizing: border-box;\n    font-size: 100%;\n\n    @media </span><span class="p">${</span><span class="nx">mediaQueries</span><span class="p">.</span><span class="nx">desktopSmall</span><span class="p">}</span><span class="s2"> {\n      font-size: 87.5%;\n    }\n  }\n\n  body {\n    /* add custom font-family here */\n    line-height: 1;\n  }\n\n  *,\n  *::before,\n  *::after {\n    box-sizing: inherit;\n    color: inherit;\n    font-size: inherit;\n    -webkit-font-smoothing: antialiased;\n    margin: 0;\n    padding: 0;\n  }\n\n  button,\n  input,\n  textarea {\n    /* add custom font-family here */\n  }\n\n  img,\n  svg {\n    border: 0;\n    display: block;\n    height: auto;\n    max-width: 100%;\n  }\n\n  a {\n    &amp;:link,\n    &amp;:visited {\n      text-decoration: none;\n    }\n\n    @media (hover) {\n      &amp;:hover,\n      &amp;:active,\n      &amp;:focus {\n        outline: 0;\n        text-decoration: underline;\n      }\n    }\n  }\n\n  ol,\n  ul {\n    list-style: none;\n  }\n\n  blockquote,\n  q {\n    quotes: none;\n  }\n\n  blockquote:before,\n  blockquote:after,\n  q:before,\n  q:after {\n    content: \'\';\n    content: none;\n  }\n\n  table {\n    border-collapse: collapse;\n    border-spacing: 0;\n  }\n\n  audio,\n  canvas,\n  video {\n    display: inline-block;\n    max-width: 100%;\n    zoom: 1;\n  }\n`</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">GlobalStyle</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>From here, we open the <code>Layout</code> component and wrap everything with the <code>ThemeProvider</code> component provided by <code>styled-components</code>. <code>ThemeProvider</code> must have a <code>theme</code> prop, so we can import the <code>theme</code> above. We will also place the <code>GlobalStyle</code> component as a child inside the <code>ThemeProvider</code>. In the end, your <code>Layout</code> file should look something like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">Layout</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span><span class="p">,</span> <span class="nx">title</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>\n  <span class="o">&lt;</span><span class="nx">ThemeProvider</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">&gt;</span>\n    <span class="o">&lt;</span><span class="nx">GlobalStyle</span> <span class="o">/&gt;</span>\n\n    <span class="o">&lt;</span><span class="nx">Seo</span> <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span>\n    <span class="o">&lt;</span><span class="nx">Navigation</span> <span class="o">/&gt;</span>\n\n    <span class="o">&lt;</span><span class="nx">main</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">children</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/main</span><span class="err">&gt;\n</span>\n    <span class="o">&lt;</span><span class="nx">Footer</span> <span class="o">/&gt;</span>\n  <span class="o">&lt;</span><span class="sr">/ThemeProvider</span><span class="err">&gt;\n</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And that\'s it! Now, any styled components we create will have access to our theme via <code>props.theme</code> like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">props</span><span class="p">.</span><span class="nx">theme</span><span class="p">.</span><span class="nx">shades</span><span class="p">.</span><span class="nx">white</span><span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And just as a quick note, we can use destructuring to shorten it a bit:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="p">:</span> <span class="nx">$</span><span class="p">{({</span> <span class="nx">theme</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">shades</span><span class="p">.</span><span class="nx">white</span><span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>In the end, a pretty quick setup! Now let\'s take a look at Next.js.</p>\n\n<h3>\n  <a name="nextjs" href="#nextjs">\n  </a>\n  Next.js\n</h3>\n\n<p>With Next.js, we install all the same packages we would with Gatsby, except <code>gatsby-plugin-styled-components</code> of course.</p>\n\n<p>From there, we can create a <code>styles</code> folder and also create the <code>GlobalStyle.ts</code> &amp; <code>theme.ts</code> files as we did with Gatsby.</p>\n\n<p>Next, while with Next.js you would typically have a <code>Layout</code> component, you actually do not want to wrap that component with <code>ThemeProvider</code>. Instead, you want to wrap everything in the <code>_app.tsx</code> file in the <code>pages</code> folder like so:</p>\n\n<p>Before:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">MyApp</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">pageProps</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;\n</span>\n<span class="k">export</span> <span class="k">default</span> <span class="nx">MyApp</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>After:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">MyApp</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n  <span class="o">&lt;</span><span class="nx">ThemeProvider</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">&gt;</span>\n    <span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span>\n      <span class="o">&lt;</span><span class="nx">GlobalStyle</span> <span class="o">/&gt;</span>\n      <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">pageProps</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">&gt;\n</span>  <span class="o">&lt;</span><span class="sr">/ThemeProvider</span><span class="err">&gt;\n</span><span class="p">);</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">MyApp</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And we\'re done! Actually, no we\'re not. At this point, using styled-components will work just fine...sort of. If you either:</p>\n\n<ul>\n<li>Manually refresh the page in the browser</li>\n<li>Host this project, on Vercel or Netlify, for example</li>\n</ul>\n\n<p>The styles will likely break. This is because the server-side rendering does <em>not</em> fetch the styles before rendering the page. To correct this issue, we need to inject server-side rendered styles to the <code>head</code> so it can render the page and its styles correctly.</p>\n\n<p>Inside the <code>pages</code> folder, we need to create a file called <code>_document.tsx</code>. In that file, you will need this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// next</span>\n<span class="k">import</span> <span class="nx">Document</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Head</span><span class="p">,</span> <span class="nx">Html</span><span class="p">,</span> <span class="nx">Main</span><span class="p">,</span> <span class="nx">NextScript</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">next/document</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">DocumentContext</span><span class="p">,</span> <span class="nx">DocumentInitialProps</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">next/document</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// styled components</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ServerStyleSheet</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">styled-components</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="kd">class</span> <span class="nx">MyDocument</span> <span class="kd">extends</span> <span class="nx">Document</span> <span class="p">{</span>\n  <span class="k">static</span> <span class="nx">getInitialProps</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">:</span> <span class="nx">DocumentContext</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DocumentInitialProps</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ServerStyleSheet</span><span class="p">();</span>\n    <span class="kd">const</span> <span class="nx">originalRenderPage</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">renderPage</span><span class="p">;</span>\n\n    <span class="k">try</span> <span class="p">{</span>\n      <span class="nx">ctx</span><span class="p">.</span><span class="nx">renderPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span>\n        <span class="nx">originalRenderPage</span><span class="p">({</span>\n          <span class="na">enhanceApp</span><span class="p">:</span> <span class="p">(</span><span class="nx">App</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">collectStyles</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">)\n</span>        <span class="p">});</span>\n\n      <span class="kd">const</span> <span class="nx">initialProps</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Document</span><span class="p">.</span><span class="nx">getInitialProps</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>\n\n      <span class="k">return</span> <span class="p">{</span>\n        <span class="p">...</span><span class="nx">initialProps</span><span class="p">,</span>\n        <span class="na">styles</span><span class="p">:</span> <span class="p">(</span>\n          <span class="o">&lt;&gt;</span>\n            <span class="p">{</span><span class="nx">initialProps</span><span class="p">.</span><span class="nx">styles</span><span class="p">}</span>\n            <span class="p">{</span><span class="nx">sheet</span><span class="p">.</span><span class="nx">getStyleElement</span><span class="p">()}</span>\n          <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;\n</span>        <span class="p">)</span>\n      <span class="p">};</span>\n    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>\n      <span class="nx">sheet</span><span class="p">.</span><span class="nx">seal</span><span class="p">();</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n\n  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="p">(</span>\n      <span class="o">&lt;</span><span class="nx">Html</span><span class="o">&gt;</span>\n        <span class="o">&lt;</span><span class="nx">Head</span><span class="o">&gt;</span>\n          <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="dl">\'</span><span class="s1">preconnect</span><span class="dl">\'</span> <span class="nx">href</span><span class="o">=</span><span class="dl">\'</span><span class="s1">https://fonts.googleapis.com</span><span class="dl">\'</span> <span class="o">/&gt;</span>\n          <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="dl">\'</span><span class="s1">preconnect</span><span class="dl">\'</span> <span class="nx">href</span><span class="o">=</span><span class="dl">\'</span><span class="s1">https://fonts.gstatic.com</span><span class="dl">\'</span> <span class="nx">crossOrigin</span><span class="o">=</span><span class="dl">\'</span><span class="s1">true</span><span class="dl">\'</span> <span class="o">/&gt;</span>\n          <span class="o">&lt;</span><span class="nx">link</span>\n            <span class="nx">href</span><span class="o">=</span><span class="dl">\'</span><span class="s1">https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&amp;display=swap</span><span class="dl">\'</span>\n            <span class="nx">rel</span><span class="o">=</span><span class="dl">\'</span><span class="s1">stylesheet</span><span class="dl">\'</span>\n          <span class="o">/&gt;</span>\n        <span class="o">&lt;</span><span class="sr">/Head</span><span class="err">&gt;\n</span>        <span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>\n          <span class="o">&lt;</span><span class="nx">Main</span> <span class="o">/&gt;</span>\n          <span class="o">&lt;</span><span class="nx">NextScript</span> <span class="o">/&gt;</span>\n        <span class="o">&lt;</span><span class="sr">/body</span><span class="err">&gt;\n</span>      <span class="o">&lt;</span><span class="sr">/Html</span><span class="err">&gt;\n</span>    <span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">MyDocument</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>A <strong>BIG</strong> shoutout to Nicolás M. Pardo here on dev.to as he posted this in a comments section from a different article and it saved the day! And as you can see, I also just added the necessary code to include links to Google Fonts. If you don\'t need that, you can simply get rid of it.</p>\n\n<p>Now we just need to restart the server and everything should be a-ok!</p>\n\n<h2>\n  <a name="contentful" href="#contentful">\n  </a>\n  Contentful\n</h2>\n\n<p>In this section, we\'ll take a look at a few key areas:</p>\n\n<ul>\n<li>The use of environment variables</li>\n<li>Querying data from Contentful using GraphQL</li>\n<li>The use of webhooks</li>\n<li>Local development experience</li>\n<li>Using fragments for reusable queries</li>\n</ul>\n\n<h3>\n  <a name="the-use-of-environment-variables" href="#the-use-of-environment-variables">\n  </a>\n  The use of environment variables\n</h3>\n\n<p>Somewhat disappointingly, while going through the setup for Gatsby, after selecting Contentful as your headless CMS, the necessary <code>.env</code> files are not created as part of the setup. And with Next, you will need to set them up manually yourself.</p>\n\n<p>Now to be fair to both, if you use the <a href="https://github.com/contentful/starter-gatsby-blog">starter-gatsby-blog</a> from Contentful themselves, the new <a href="https://github.com/gatsbyjs/gatsby-starter-contentful-homepage">gatsby-starter-contentful-homepage</a> from Gatsby, or the Next.js Contentful <a href="https://github.com/vercel/next.js/tree/canary/examples/cms-contentful">example</a>, these do use environment variables. It\'s just these basic starters that do not.</p>\n\n<p>For Next.js, you simply need to create a <code>.env.local</code> file, and add in your variables like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>VARIABLE_NAME=VALUE\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then restart your local dev server if it is currently running so Next.js can load in the variables. You should see <code>Loaded from env</code> in your terminal after the local dev server starts up.</p>\n\n<p>For Gatsby, create 2 files:</p>\n\n<ul>\n<li><code>.env.development</code></li>\n<li><code>.env.production</code></li>\n</ul>\n\n<p>Add in the same variables in both files and you will be good to go.</p>\n\n<h3>\n  <a name="querying-data-from-contentful-using-graphql" href="#querying-data-from-contentful-using-graphql">\n  </a>\n  Querying data from Contentful using GraphQL\n</h3>\n\n<p>Both frameworks take a similar approach to querying data from Contentful using GraphQL. To <em>greatly</em> oversimplify things, the process essentially boils down to:</p>\n\n<ul>\n<li>Make a query using GraphQL</li>\n<li>Pass that returned data to your components as props</li>\n<li>Display the data in your components</li>\n</ul>\n\n<p>How each framework does that is of course different, and we\'ll explore it in further detail below.</p>\n\n<p>But first, one thing I do want to give big props to is Gatsby\'s implementation of the GraphiQL playground. Specifically, including an Explorer. I have to admit, I have taken this for granted, as it makes structuring queries so, so much easier.</p>\n\n<p>With Next.js, I ended up using the GraphiQL playground provided by Contentful themselves. You can view it here:</p>\n\n<p><a href="https://graphql.contentful.com/content/v1/spaces/YOUR_SPACE_ID_HERE/explore?access_token=YOUR_ACCESS_TOKEN_HERE">https://graphql.contentful.com/content/v1/spaces/YOUR_SPACE_ID_HERE/explore?access_token=YOUR_ACCESS_TOKEN_HERE</a></p>\n\n<p>Just make sure to update the placeholders with your actual Contentful Space ID and Access Token.</p>\n\n<h4>\n  <a name="gatsby" href="#gatsby">\n  </a>\n  Gatsby\n</h4>\n\n<p>With Gatsby, querying data from Contentful using GraphQL is very straightforward. In your page component file, you add your GraphQL query typically beneath the <code>export default</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// component code up here...</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">Home</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  query HomePageQuery {\n    contentfulHero(id: { eq: "ID_HERE" }) {\n      title\n      tagline\n      backgroundImage {\n        id\n        description\n        gatsbyImageData\n      }\n    }\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>In this example, I\'m querying data from a specific Hero model I created, and I want the values from the <code>title</code>, <code>tagline</code>, and <code>backgroundImage</code> fields. I\'ll be discussing images in more detail later on.</p>\n\n<p>To actually consume this data, the page component can access the returned data via the <code>data</code> prop. From there, you can pass it down as a <code>prop</code> to the corresponding component like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">Home</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">location</span> <span class="p">}:</span> <span class="nx">PageProps</span><span class="o">&lt;</span><span class="nx">GraphQLResult</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="c1">// just double check...</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">\'</span><span class="s1">data: </span><span class="dl">\'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="o">&lt;</span><span class="nx">Layout</span> <span class="nx">title</span><span class="o">=</span><span class="dl">\'</span><span class="s1">Home</span><span class="dl">\'</span><span class="o">&gt;</span>\n      <span class="o">&lt;</span><span class="nx">Hero</span> <span class="nx">contentfulData</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">&gt;\n</span>  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With TypeScript, we can also type out how the response will look. The name I\'ve always used is <code>GraphQLResult</code>, but you can name it whatever you like. The type for this is just above the component like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">type</span> <span class="nx">GraphQLResult</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">contentfulHero</span><span class="p">:</span> <span class="nx">ContentfulHero</span><span class="p">;</span>\n<span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">Home</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">location</span> <span class="p">}:</span> <span class="nx">PageProps</span><span class="o">&lt;</span><span class="nx">GraphQLResult</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="c1">// just double check...</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">\'</span><span class="s1">data: </span><span class="dl">\'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="o">&lt;</span><span class="nx">Layout</span> <span class="nx">title</span><span class="o">=</span><span class="dl">\'</span><span class="s1">Home</span><span class="dl">\'</span><span class="o">&gt;</span>\n      <span class="o">&lt;</span><span class="nx">Hero</span> <span class="nx">contentfulData</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">&gt;\n</span>  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>I like to keep my types in a separate folder, so I import <code>ContentfulHero</code> wherever I need it. The type looks like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">IGatsbyImageData</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">gatsby-plugin-image</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContentfulHero</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">title</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>\n  <span class="nl">tagline</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>\n  <span class="nl">backgroundImage</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>\n    <span class="nl">description</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>\n    <span class="nl">gatsbyImageData</span><span class="p">:</span> <span class="nx">IGatsbyImageData</span><span class="p">;</span>\n  <span class="p">};</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And the Hero component can also use this type for <code>props</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">type</span> <span class="nx">HeroProps</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">contentfulData</span><span class="p">:</span> <span class="nx">ContentfulHero</span><span class="p">;</span>\n<span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">Hero</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">contentfulData</span> <span class="p">}:</span> <span class="nx">HeroProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">\'</span><span class="s1">wrapper</span><span class="dl">\'</span><span class="o">&gt;</span>\n    <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">tagline</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;\n</span>  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;\n</span><span class="p">);</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">Hero</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>This way I have full type checking for my data, as well as some nice auto-completion when using the data in my component.</p>\n\n<p>There are some tools you can use to automatically generate the types for your GraphQL Schema, such as <a href="https://www.graphql-code-generator.com/">GraphQL Code Generator</a>. However, since this is a fairly small project, and I am the only dev working on it, I don\'t mind setting things up manually myself.</p>\n\n<h4>\n  <a name="nextjs" href="#nextjs">\n  </a>\n  Next.js\n</h4>\n\n<p>With Next.js, the process is quite similar. However, there are multiple ways to query data with Next.js:</p>\n\n<ul>\n<li>React hooks at the component level (<code>useEffect</code> with an <code>async</code> function is a common approach)</li>\n<li>\n<code>getStaticProps()</code> at the page level</li>\n<li>\n<code>getServerSideProps()</code> at the page level</li>\n<li>\n<code>useSWR()</code> hook at the component level</li>\n</ul>\n\n<p>For my purposes, since this is a static portfolio site, I will be using the <code>getStaticProps()</code> function. As outlined in the Next.js <a href="https://nextjs.org/docs/basic-features/data-fetching/get-static-props">documentation</a>, if the data is coming from a headless CMS, then <code>getStaticProps()</code> is a great choice. Check out the documentation on how the function works if you are not familiar with it, as I do not have the courage to explain it since I am still new to it.</p>\n\n<p>Inside this function, we can make our request. This <a href="https://www.youtube.com/watch?v=bMRQgguzBLs&amp;t=1613s">video</a> from the Contentful YouTube channel was very helpful, and required minimal modification for TypeScript.</p>\n\n<p>In the video, Lee recommends using the <code>graphql-request</code> package. And I have to say, as a first time user, I quite liked it! I will definitely look to use this again in the future!</p>\n\n<p>To start, we will need to import <code>GraphQLClient</code> &amp; <code>gql</code> from <code>graphql-request</code> as named imports:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLClient</span><span class="p">,</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">graphql-request</span><span class="dl">\'</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then inside the <code>getStaticProps()</code> function, we can start with the following:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`https://graphql.contentful.com/content/v1/spaces/</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_SPACE_ID</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>\n\n<span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_ACCESS_TOKEN</span><span class="p">}</span><span class="s2">`</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">graphQLClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLClient</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Notice the value for <code>endpoint</code> is different than that of the URL you would visit in the browser!</p>\n\n<p>Next, we can use the <code>gql</code> function to write our GraphQL Query, and we\'ll see some noticeable differences:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`\n  {\n    hero(id: "ID_HERE") {\n      backgroundImage {\n        sys {\n          id\n        }\n        description\n        height\n        url\n        width\n      }\n      tagline\n      title\n    }\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The first is actually <code>ID_HERE</code>. When using the Explorer in Gatsby\'s GraphiQL playground, you can either use the ContentfulId or Id. The latter looks like this:</p>\n\n<p><code>a1a1a1a1-a1a1-a1a1-a1a1-a1a1a1a1a1a1</code></p>\n\n<p>Where the As and 1s could be any combination of letters and numbers. With Next.js, you don\'t get this type of ID. Instead, you simply use the <code>ENTRY ID</code> for whichever piece of content you are querying for.</p>\n\n<p>To see this <code>ENTRY ID</code>, select any piece of content you have created in Contentful. Then on the right-hand sidebar menu, select the <code>Info</code> tab. Second from the top is the <code>ENTRY ID</code>. In all fairness, you could also use this in your GraphQL queries with Gatsby as well. I\'ve always just used the long-form id above out of habit.</p>\n\n<p>The next difference are the fields we can query for the image. We\'ll need these files to pass them on to Next.js\'s <code>&lt;Image /&gt;</code> component. Again, we\'ll discuss each framework\'s approach to images and image optimization later.</p>\n\n<p>Finally, store the returned data in a variable like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">ContentfulResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphQLClient</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">homePageQuery</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then return in a props object:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>\n  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">data</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here, I am using the ES6 object shorthand where if the key and value are the same, we can write like I have above instead of like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">return</span> <span class="p">{</span>\n  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">data</span><span class="p">:</span> <span class="nx">data</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>So all together, <code>getStaticProps()</code> looks like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">getStaticProps</span><span class="p">()</span> <span class="p">{</span>\n  <span class="c1">// get contentful data</span>\n  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`https://graphql.contentful.com/content/v1/spaces/</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_SPACE_ID</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>\n    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>\n      <span class="na">authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CONTENTFUL_ACCESS_TOKEN</span><span class="p">}</span><span class="s2">`</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n\n  <span class="kd">const</span> <span class="nx">graphQLClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLClient</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`\n    query HomepageQuery {\n      hero(id: "ID_HERE") {\n        backgroundImage {\n          sys {\n            id\n          }\n          description\n          height\n          url\n          width\n        }\n        tagline\n        title\n      }\n    }\n  `</span><span class="p">;</span>\n\n  <span class="kd">const</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">ContentfulResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphQLClient</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">homePageQuery</span><span class="p">);</span>\n\n  <span class="k">return</span> <span class="p">{</span>\n    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nx">data</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now in the <code>Home</code> page component, we can access this <code>data</code> prop like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span><span class="o">&lt;</span><span class="nx">HomeProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">\'</span><span class="s1">data: </span><span class="dl">\'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nc">Hero</span> <span class="p">/&gt;</span>\n    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And to be clear, <code>data</code> is just the name I chose. I could\'ve called it <code>hero</code> if I wanted to, and accessed it via a <code>hero</code> prop instead. I like using <code>data</code> because I\'ll be adding on to the GraphQL query later on querying for multiple pieces of content. So, <code>data</code> is just a generic variable name I like to use, and comes from the habit of using Gatsby.</p>\n\n<p>And just like before with Gatsby, we pass the data down to the corresponding component:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span><span class="o">&lt;</span><span class="nx">HomeProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">\'</span><span class="s1">data: </span><span class="dl">\'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nc">Hero</span> <span class="na">contentfulData</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">contentfulHero</span><span class="si">}</span> <span class="p">/&gt;</span>\n    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And that\'s it! That\'s how we can query data from Contentful with both frameworks with GraphQL. Personally, I don\'t really have a preference. I think both are perfectly fine.</p>\n\n<p>And as a quick side note, I would extract the querying logic in <code>getStaticProps()</code> into a separate file and folder to make the code inside <code>getStaticProps()</code> cleaner, as well as make the query a bit more reusable. It would require some modification, but it would make for a good starting point.</p>\n\n<h3>\n  <a name="the-use-of-webhooks" href="#the-use-of-webhooks">\n  </a>\n  The use of webhooks\n</h3>\n\n<p>When it comes to hosting, whether you choose Netlify, Gatsby Cloud, or Vercel, they all have options to set up both environment variables, as well as webhooks that you can use with Contentful. This way, whenever you make a change, or mutliple changes, in Contentful, the site will rebuild with the latest data.</p>\n\n<h3>\n  <a name="local-development-experience" href="#local-development-experience">\n  </a>\n  Local development experience\n</h3>\n\n<p>An interesting note here is that with Gatsby, during local development, whenever you make a change in Contentful, it will <em>not</em> appear while the local dev server is running. You must restart the server, and clean the <code>public</code> and <code>.cache</code> folders as well. So, I would recommend adjusting the <code>dev</code> script in <code>package.json</code> to the following:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight json"><code><span class="nl">"clean"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gatsby clean"</span><span class="err">,</span><span class="w">\n</span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm run clean &amp;&amp; gatsby develop"</span><span class="err">,</span><span class="w">\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>This is because Gatsby will run your GraphQL queries during build time, and not run time. Therefore, a restart is required.</p>\n\n<p>With Next.js however, you simply need to manually refresh the page in the browser, and any changes will be seen.</p>\n\n<h3>\n  <a name="using-fragments-for-reusable-queries" href="#using-fragments-for-reusable-queries">\n  </a>\n  Using fragments for reusable queries\n</h3>\n\n<p>The great thing about querying data with GraphQL is you can use something called <a href="https://graphql.org/learn/queries/#fragments">fragments</a>. Fragments help by cutting down on repeated query fields.</p>\n\n<h4>\n  <a name="gatsby" href="#gatsby">\n  </a>\n  Gatsby\n</h4>\n\n<p>With Gatsby, creating reusable fragments is very straightforward. In the <code>src</code> folder, I typically create another folder called <code>graphql</code>. In the <code>graphql</code> folder, I then create a file called <code>fragments.ts</code>. Here, let\'s create a highly reusable fragment for fields for an image:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">imageFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  fragment ImageFields on ContentfulAsset {\n    id\n    description\n    gatsbyImageData(placeholder: BLURRED)\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>What\'s so nice about this is that Gatsby <em>automatically</em> exports these queries to the global scope. So, these fragments are available in any other GraphQL query in the entire project! We can even use our fragments in other fragments!</p>\n\n<p>And just as a quick side note, I like to include <code>id</code> here even if I\'m only querying for a single image because in the instance I <em>do</em> query for multiple images, I have the <code>id</code>\'s ready to use for mapping over the array and using them as the value for the <code>key</code> prop.</p>\n\n<p>Now, let\'s say for example we have a standard 50/50 model, with <code>heading</code> &amp; <code>copy</code> on the left and an <code>image</code> on the right. For the fragment, it would look something like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">fiftyFiftyFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  fragment FiftyFiftyFields on ContentfulFiftyFifty {\n    id\n    heading\n    copy {\n      copy\n    }\n    image {\n      ...ImageFields\n    }\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now we can use this fragment in the <code>HomePageQuery</code>, for example, like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  query HomePageQuery {\n    firstFiftyFifty: contentfulFiftyFifty(id: { eq: "ID_1_HERE" }) {\n      ...FiftyFiftyFields\n    }\n    secondFiftyFifty: contentfulFiftyFifty(id: { eq: "ID_2_HERE" }) {\n      ...FiftyFiftyFields\n    }\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>In this example, we can also see <a href="https://graphql.org/learn/queries/#aliases">aliases</a> being used. Aliases let you rename the result of a field to anything you want. This is helpful for when you are querying the same thing but with different arguments.</p>\n\n<p>So, combining fragments and aliases really help make our queries shorter, cleaner, and easier to read and write.</p>\n\n<h4>\n  <a name="nextjs" href="#nextjs">\n  </a>\n  Next.js\n</h4>\n\n<p>With Next.js, while we don\'t get automatic global scoped fragments, we can still create and use them, just with a little bit of extra work.</p>\n\n<p>We can start with the same process by creating a <code>fragments.ts</code> file inside of a <code>graphql</code> folder. Let\'s create a reusable Image fragment:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">graphql-request</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">FRAGMENT_IMAGE</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`\n  fragment ImageFields on Asset {\n    sys {\n      id\n    }\n    description\n    height\n    url\n    width\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now back in the index page file, inside <code>getStaticProps()</code> and then inside our <code>gql</code> template string, we can go from this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`\n  query HomepageQuery {\n    hero(id: "ID_HERE") {\n      backgroundImage {\n        sys {\n          id\n        }\n        description\n        height\n        url\n        width\n      }\n      tagline\n      title\n    }\n  }\n\n  # fragments\n  </span><span class="p">${</span><span class="nx">FRAGMENT_IMAGE</span><span class="p">}</span><span class="s2">\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>To this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">homePageQuery</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`\n  query HomepageQuery {\n    hero(id: "ID_HERE") {\n      backgroundImage {\n        ...ImageFields\n      }\n      tagline\n      title\n    }\n  }\n\n  # fragments\n  </span><span class="p">${</span><span class="nx">FRAGMENT_IMAGE</span><span class="p">}</span><span class="s2">\n  # make sure to import this!\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>It may not look very powerful right now when querying a single piece of content, but I\'m sure you can imagine if this homepage had say 8-10 sections, all of them containing images, having the same fields repeated over and over again would make the query very long and rather difficult to traverse.</p>\n\n<h2>\n  <a name="image-optimization" href="#image-optimization">\n  </a>\n  Image Optimization\n</h2>\n\n<p>Both frameworks come with image optimization OOTB in the form of components. Next.js has <a href="https://nextjs.org/docs/api-reference/next/image">&lt;Image /&gt;</a>, and Gatsby has both <a href="https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage">&lt;StaticImage /&gt;</a> and <a href="https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage">&lt;GatsbyImage /&gt;</a>.</p>\n\n<p>Let\'s explore their differences:</p>\n\n<h3>\n  <a name="gatsby" href="#gatsby">\n  </a>\n  Gatsby\n</h3>\n\n<p>Gatsby comes with 2 different image components. When you should use which? The answer to that is very simple.</p>\n\n<p>Is the image you\'re using the same every time the component is rendered? For example, the site logo, or any other picture located within the project locally? Then use <code>&lt;StaticImage /&gt;</code>.</p>\n\n<p>Is the image you\'re using going to be passed into a component as a <code>prop</code>, and / or coming from an external source, such as Contentful? Then use <code>&lt;GatsbyImage /&gt;</code>.</p>\n\n<p>Since this article is all about Contentful, we\'ll be focusing on <code>&lt;GatsbyImage /&gt;</code>!</p>\n\n<p>In the GraphiQL playground, whenever you want to query for an image (or multiple images), I\'d recommend getting the following fields:</p>\n\n<ul>\n<li><code>id</code></li>\n<li><code>description</code></li>\n<li><code>gatsbyImageData</code></li>\n</ul>\n\n<p>With this, we can create a reusable fragment for querying those fields on images (known as Assets in Contentful):<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">imageFields</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  fragment ImageFields on ContentfulAsset {\n    id\n    description\n    gatsbyImageData(placeholder: BLURRED)\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>When you execute the query with these fields, you\'ll see a <em>ton</em> of data for the gatsbyImageData field. But don\'t worry, the <code>&lt;GatsbyImage /&gt;</code> component will handle all of that for us!</p>\n\n<p>You would use that data like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">GatsbyImage</span> <span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">gatsbyImageData</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">contentfulData</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>You can see in my fragment above I also added <code>(placeholder: BLURRED)</code>. This will do as the wording suggests! It will blur the image until the full res version is ready to use. This will help cut down on page load time and help improve performance.</p>\n\n<h3>\n  <a name="nextjs" href="#nextjs">\n  </a>\n  Next.js\n</h3>\n\n<p>With Next.js, we get a single <code>&lt;Image /&gt;</code> component that we can use for both static and dynamic images. And very similarly to Gatsby, as long as we pass it the right data for its various props, it will handle all the heavy lifting for us!</p>\n\n<p>And just like with Gatsby, we can create a highly reusable fragment like we did above in the previous section to query certain fields from Contentful. We would then use that data like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Image</span>\n  <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span>\n  <span class="nx">alt</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span>\n  <span class="nx">width</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">width</span><span class="p">}</span>\n  <span class="nx">height</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="p">.</span><span class="nx">height</span><span class="p">}</span>\n<span class="sr">/</span><span class="err">&gt;\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And that\'s it! Well...sort of. With Next.js, there is one more step. We have to add the domain these images are coming from to an array in our <code>next.config.js</code> file. This array holds an array of <code>domains</code> that are whitelisted. This tells Next.js that it is ok to fetch the images from these external sources and optimize them:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="cm">/** @type {import(\'next\').NextConfig} */</span>\n<span class="kd">const</span> <span class="nx">nextConfig</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">images</span><span class="p">:</span> <span class="p">{</span>\n    <span class="na">domains</span><span class="p">:</span> <span class="p">[</span><span class="dl">\'</span><span class="s1">images.ctfassets.net</span><span class="dl">\'</span><span class="p">]</span>\n  <span class="p">},</span>\n  <span class="na">reactStrictMode</span><span class="p">:</span> <span class="kc">true</span>\n<span class="p">};</span>\n\n<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">nextConfig</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Ok, <em>now</em> we have optimized images from Contentful!</p>\n\n<h2>\n  <a name="blog-posts" href="#blog-posts">\n  </a>\n  Blog Posts\n</h2>\n\n<p>Now that I\'m writing blog posts here on dev.to, I wanted to incorporate them into my portfolio as well. While Contentful does have a Markdown text box that I could just copy and paste the post into and create dynamic routes with either framework, I was more interested in how I would query data from 2 different data sources using 2 different methods:</p>\n\n<ul>\n<li>Querying content from Contentful using GraphQL</li>\n<li>Querying posts from dev.to using REST API w/ Fetch</li>\n</ul>\n\n<p>Let\'s take a look!</p>\n\n<h3>\n  <a name="gatsby" href="#gatsby">\n  </a>\n  Gatsby\n</h3>\n\n<p>With Gatsby, I had an assumption of how I would query for my blog posts, and after some research (aka quick Googling), it seems like my assumption was correct.</p>\n\n<p>I created a BlogPosts component, and inside that component I made the fetch call like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">BlogPosts</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">posts</span><span class="p">,</span> <span class="nx">setPosts</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">DevPost</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">([]);</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">isLoading</span><span class="p">,</span> <span class="nx">setIsLoading</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">fetchBlogPosts</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>\n\n    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">https://dev.to/api/articles?username=andrews1022</span><span class="dl">\'</span><span class="p">);</span>\n    <span class="kd">const</span> <span class="na">data</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>\n\n    <span class="nx">setPosts</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>\n\n    <span class="nx">setIsLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>\n  <span class="p">};</span>\n\n  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">fetchBlogPosts</span><span class="p">();</span>\n  <span class="p">},</span> <span class="p">[]);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Posts<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n        <span class="si">{</span><span class="nx">isLoading</span> <span class="p">?</span> <span class="p">(</span>\n          <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Loading...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>\n        <span class="p">)</span> <span class="p">:</span> <span class="p">(</span>\n          <span class="nx">posts</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">post</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">&gt;</span>\n              <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>\n            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n          <span class="p">))</span>\n        <span class="p">)</span><span class="si">}</span>\n      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now I realize I don\'t have error handling in the form of an error state, or a cleanup in my <code>useEffect</code>, but that\'s ok since I\'m just trying things out before making any large commitments.</p>\n\n<p>This is a pretty standard approach:</p>\n\n<ul>\n<li>Have state for the data, loading, and error</li>\n<li>Write an async function that queries the data, and updates the various pieces of state accordingly</li>\n<li>In the useEffect hook, call the async function and have an empty array of dependencies so this function will only be executed once when the component is first mounted / rendered</li>\n</ul>\n\n<p>And that\'s it! My blog post titles display just fine. With Next.js though, that\'s where things get a little spicy.</p>\n\n<h3>\n  <a name="nextjs" href="#nextjs">\n  </a>\n  Next.js\n</h3>\n\n<p>With Next.js, we can take advantage of the <code>getStaticProps()</code> function and add this additional request below the GraphQL query to Contentful and return it alongside the <code>data</code> like so:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">getStaticProps</span><span class="p">()</span> <span class="p">{</span>\n  <span class="c1">// make the contentful query up here...</span>\n\n  <span class="c1">// get dev.to data</span>\n  <span class="kd">const</span> <span class="nx">postsResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">https://dev.to/api/articles?username=andrews1022</span><span class="dl">\'</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="nx">posts</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">postsResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>\n\n  <span class="k">return</span> <span class="p">{</span>\n    <span class="na">props</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nx">data</span><span class="p">,</span>\n      <span class="nx">posts</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Again, I realize there isn\'t any error handling here, this is just for the sake of demonstration purposes. And in case I didn\'t mention earlier, the <code>DevPost</code> type is a custom type I created.</p>\n\n<p>With these posts, I can pass them down to my BlogPosts component:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">BlogPosts</span> <span class="nx">posts</span><span class="o">=</span><span class="p">{</span><span class="nx">posts</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And then loop over them and display them like so (just the <code>title</code> for now to make sure things are working):<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">type</span> <span class="nx">BlogPostsProps</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">posts</span><span class="p">:</span> <span class="nx">DevPost</span><span class="p">[];</span>\n<span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">BlogPosts</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">posts</span> <span class="p">}:</span> <span class="nx">BlogPostsProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Posts<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>\n      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>\n        <span class="si">{</span><span class="nx">posts</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">post</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">&gt;</span>\n            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">post</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>\n          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n        <span class="p">))</span><span class="si">}</span>\n      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Why I think this is spicy is because since Next.js pre-renders the page at build time using the props returned by <code>getStaticProps()</code>, there is no awkward <code>Loading...</code> text or spinner being shown temporarily. Everything is just...there! I\'m still getting used to Next.js, so I probably didn\'t explain that very well but I just think it\'s neat (insert <a href="https://i.kym-cdn.com/photos/images/newsfeed/001/498/880/572.jpg">Marge Simpson meme</a> here)!</p>\n\n<h2>\n  <a name="hosting" href="#hosting">\n  </a>\n  Hosting\n</h2>\n\n<p>Hosting is dead simple no matter which you pick. Each framework has their own hosting service which they recommend:</p>\n\n<p><a href="https://www.gatsbyjs.com/products/cloud/">Gatsby Cloud</a> for Gatsby projects, and <a href="https://vercel.com/">Vercel</a> for Next.js projects.</p>\n\n<p>You could also use <a href="https://www.netlify.com/">Netlify</a> if you wish.</p>\n\n<p>Whichever you pick, you can select your project from GitHub (once you have given it authorization to do so), and the service will automatically build and host the site for you!</p>\n\n<p>And as previously mentioned, you can include environment variables for your Contentful API keys, as well as setup webhooks with Contentful.</p>\n\n<h2>\n  <a name="final-thoughts" href="#final-thoughts">\n  </a>\n  Final Thoughts\n</h2>\n\n<p>Whew, that was a lot! If you made it this far, thank you so much for reading this post. I had a lot of fun researching and trying out the various points I mentioned here, and it was great to try out and learn more about Next.js some more as well.</p>\n\n<p>My goal for this article was to simply show you each framework\'s approach for common tasks and let you decide which approach(es) you do or don\'t like. Personally, I\'m going to stick with Next.js to build out the rest of my portfolio simply because I want to become more familiar with it and learn more about it.</p>\n\n<p>In my opinion, for a simple static like this, you really can\'t go wrong with either framework. If you have more experience with one over the other, I would recommend trying the other and see what you think. I provided my experience here and I hope you found it useful.</p>\n\n<p>Cheers!</p>\n\n',a.body_markdown="I was looking at my developer portfolio recently and decided it could use an update. While I kept it up to date with my most recent projects that I wanted to showcase, I wasn't a fan of the look anymore. I also thought it would be nice to use [Contentful](https://www.contentful.com/) as a [headless CMS](https://en.wikipedia.org/wiki/Headless_content_management_system) to manage the content of the site, as well as fetch and display a couple of my most recent blog posts from here on dev.to.\n\nI've mostly used [Gatsby](https://www.gatsbyjs.com/) both at work and for personal projects, and I've been wanting to learn more about [Next.js](https://nextjs.org/) and become more familiar with using it, so I took this opportunity to start rebuilding my portfolio using both of these frameworks. I had a list of requirements in mind, so along the way I noted my experience with both frameworks and I want to share that experience with you here. Perhaps you will find it helpful the next time you need to decide which framework to use.\n\n## Requirements\n\nI like to keep my portfolio nice and simple. The order of the sections are:\n\n- Hero (including nav)\n- Projects\n- About Me\n- Blog Posts\n- Contact\n- Footer\n\nIt's a single page, so I will not be looking to create dynamic routes / pages for any of my content. I would consider doing so for the blog posts since Contentful has a Markdown text box, and on dev.to you write in Markdown, so it would just be a copy paste. However, I wanted to see what would be considered best practice / convention for both:\n\n- Fetching content from Contentful using GraphQL\n- Fetching blog posts from the dev.to API using the good ol' [Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)\n\nA few other things I wanted to compare between the two were:\n\n- Downloading and starting with a basic boilerplate with TypeScript support\n- Integrating [styled-components](https://styled-components.com/)\n- A few points regarding Contentful:\n  - The use of environment variables\n  - Using webhooks to automatically update the hosted site whenever I make a change in Contentful\n  - Similarly, how changes in Contentful appear during local development\n  - Local development experience\n  - Using fragments for reusable queries\n- Optimizing images from Contentful\n- How easy is it to host a Gatsby and Next.js site\n\nI also want to note that my intention wasn't to _fully_ rebuild my portfolio with each, but more so I wanted to get the scaffolding done, compare my notes as well as any pros and cons of the requirements I've listed above, and from there I'll decide which one I plan to proceed with to complete the project.\n\nI simply created 2 new branches on my existing portfolio repo, which I aptly named `gatsby` and `next`, and worked with each framework on their respective branch. In hindsight, it would've been _much_ easier to just work with framework each in their own folders in isolation. Oh well! ¯\\\\\\_(ツ)\\_/¯\n\nSo, let's get started!\n\n## Boilerplate\n\nTo start, I looked at what possible starter / boilerplates both frameworks offered. While both offer Contentful based starters, they are not in TypeScript OOTB. So, I decided upon using their basic TypeScript starter and building it up from there. That way, I have as close as a starting point for each as possible.\n\nNext.js has supported TypeScript for a while now, but thankfully Gatsby also now has full TypeScript support too. Not just with pages and components, which they also have supported for a while now, but all of the Gatsby API files (`gatsby-browser`, `gatsby-node`, etc.) can also be written in TypeScript as of Gatsby [v4.8](https://www.gatsbyjs.com/docs/reference/release-notes/v4.8/) and [4.9](https://www.gatsbyjs.com/docs/reference/release-notes/v4.9/).\n\nFor Gatsby, you can run the command:\n\n`npm init gatsby -ts`\n\nAnd for Next.js you can run the command:\n\n`npx create-next-app@latest --ts`\n\nA quick, minor note regarding Gatsby: in the [documentation](https://www.gatsbyjs.com/docs/how-to/custom-configuration/typescript/) it says to run `npm init gatsby` and select TypeScript as your language when prompted. Or you can run `npm init gatsby -ts` to skip that question. In my experience, that is not true. When you run `npm init gatsby -ts`, you still have to select TypeScript as your language. So, it doesn't matter whether or not you include the `-ts` flag.\n\nFor Next.js, there is no questionnaire during setup, and I actually don't mind this at all, and it kind of makes sense if you think about it. Gatsby is focused on creating fast, static sites using headless CMSs. As such, it gives you a few options to pick from during setup in the CLI, as well as a few options for styling your app.\n\nWith Next, since it is a hybrid framework and it can be used for much more than static headless CMS-based sites, including a questionnaire is not ideal because there are just _so_ many things to consider. Perhaps including a step for styling would be nice, and some other common inclusions such as linting, but I think it's fine without one.\n\nEither way, both startup just fine after running `npm run dev`!\n\n## Styled Components\n\nThis is where things start to get interesting. [styled-components](https://styled-components.com/) is my go to approach for styling React apps myself. Otherwise, I usually go with Material UI (now [MUI](https://mui.com/)) or [React Bootstrap](https://react-bootstrap.github.io/).\n\nImplementing styled-components into Gatsby and Next are quite different.\n\nFirst, let's take a look at Gatsby.\n\n### Gatsby\n\nWith Gatsby, you will need to install the following NPM packages:\n\n- `babel-plugin-styled-components`\n- `gatsby-plugin-styled-components`\n- `styled-components`\n\nAnd if you're using TypeScript like I do, then the `@types` package from DefinitelyTyped as well:\n\n- `@types/styled-components`\n\nSo, in total 3-4 packages. From there, you simply need to add `gatsby-plugin-styled-components` to your `plugins` array inside your `gatsby-config` file. After that, I typically create a `styles` folder inside the `src` folder, and then inside the `styles` folder I create 2 files:\n\n- `GlobalStyle.ts`\n- `theme.ts`\n\n`theme.ts` will hold variables for the project such as colours, font sizes, breakpoints, etc. Here's the starting code I typically use:\n\n```js\nconst theme = {\n  mediaQueries: {\n    desktopHD: 'only screen and (max-width: 1920px)',\n    desktopMedium: 'only screen and (max-width: 1680px)',\n    desktopSmall: 'only screen and (max-width: 1440px)',\n    laptop: 'only screen and (max-width: 1366px)',\n    laptopSmall: 'only screen and (max-width: 1280px)',\n    tabletLandscape: 'only screen and (max-width: 1024px)',\n    tabletMedium: 'only screen and (max-width: 900px)',\n    tabletPortrait: 'only screen and (max-width: 768px)',\n    mobileXLarge: 'only screen and (max-width: 640px)',\n    mobileLarge: 'only screen and (max-width: 576px)',\n    mobileMedium: 'only screen and (max-width: 480px)',\n    mobileSmall: 'only screen and (max-width: 415px)',\n    mobileXSmall: 'only screen and (max-width: 375px)',\n    mobileTiny: 'only screen and (max-width: 325px)'\n  },\n  shades: {\n    white: '#fff',\n    black: '#000'\n  },\n  greys: {\n    // add any greys here\n  },\n  colors: {\n    primary: {\n      // add primary colors here\n    },\n    secondary: {\n      // add secondary colors here\n    }\n  },\n  fonts: {\n    // add font-families here\n  },\n  fontWeights: {\n    thin: 100,\n    extraLight: 200,\n    light: 300,\n    normal: 400,\n    medium: 500,\n    semiBold: 600,\n    bold: 700,\n    extraBold: 800,\n    black: 900\n  },\n  fontSizes: {\n    // add font sizes here\n  }\n};\n\nexport default theme;\n```\n\nAnd `GlobalStyle.ts` will use the `createGlobalStyle` helper function to create a `GlobalStyle` component. This component will house global styles and any styling resets you want to include. Here is what I typically start with:\n\n```js\nimport { createGlobalStyle } from 'styled-components';\nimport theme from './theme';\n\n// destructured theme properties\nconst { mediaQueries } = theme;\n\nconst GlobalStyle = createGlobalStyle`\n  html {\n    box-sizing: border-box;\n    font-size: 100%;\n\n    @media ${mediaQueries.desktopSmall} {\n      font-size: 87.5%;\n    }\n  }\n\n  body {\n    /* add custom font-family here */\n    line-height: 1;\n  }\n\n  *,\n  *::before,\n  *::after {\n    box-sizing: inherit;\n    color: inherit;\n    font-size: inherit;\n    -webkit-font-smoothing: antialiased;\n    margin: 0;\n    padding: 0;\n  }\n\n  button,\n  input,\n  textarea {\n    /* add custom font-family here */\n  }\n\n  img,\n  svg {\n    border: 0;\n    display: block;\n    height: auto;\n    max-width: 100%;\n  }\n\n  a {\n    &:link,\n    &:visited {\n      text-decoration: none;\n    }\n\n    @media (hover) {\n      &:hover,\n      &:active,\n      &:focus {\n        outline: 0;\n        text-decoration: underline;\n      }\n    }\n  }\n\n  ol,\n  ul {\n    list-style: none;\n  }\n\n  blockquote,\n  q {\n    quotes: none;\n  }\n\n  blockquote:before,\n  blockquote:after,\n  q:before,\n  q:after {\n    content: '';\n    content: none;\n  }\n\n  table {\n    border-collapse: collapse;\n    border-spacing: 0;\n  }\n\n  audio,\n  canvas,\n  video {\n    display: inline-block;\n    max-width: 100%;\n    zoom: 1;\n  }\n`;\n\nexport default GlobalStyle;\n```\n\nFrom here, we open the `Layout` component and wrap everything with the `ThemeProvider` component provided by `styled-components`. `ThemeProvider` must have a `theme` prop, so we can import the `theme` above. We will also place the `GlobalStyle` component as a child inside the `ThemeProvider`. In the end, your `Layout` file should look something like this:\n\n```js\nconst Layout = ({ children, title }) => (\n  <ThemeProvider theme={theme}>\n    <GlobalStyle />\n\n    <Seo title={title} />\n\n    <Navigation />\n\n    <main>{children}</main>\n\n    <Footer />\n  </ThemeProvider>\n);\n```\n\nAnd that's it! Now, any styled components we create will have access to our theme via `props.theme` like so:\n\n```js\nbackground-color: ${(props) => props.theme.shades.white};\n```\n\nAnd just as a quick note, we can use destructuring to shorten it a bit:\n\n```js\nbackground-color: ${({ theme }) => theme.shades.white};\n```\n\nIn the end, a pretty quick setup! Now let's take a look at Next.js.\n\n### Next.js\n\nWith Next.js, we install all the same packages we would with Gatsby, except `gatsby-plugin-styled-components` of course.\n\nFrom there, we can create a `styles` folder and also create the `GlobalStyle.ts` & `theme.ts` files as we did with Gatsby.\n\nNext, while with Next.js you would typically have a `Layout` component, you actually do not want to wrap that component with `ThemeProvider`. Instead, you want to wrap everything in the `_app.tsx` file in the `pages` folder like so:\n\nBefore:\n\n```js\nconst MyApp = ({ Component, pageProps }: AppProps) => <Component {...pageProps} />;\n\nexport default MyApp;\n```\n\nAfter:\n\n```js\nconst MyApp = ({ Component, pageProps }: AppProps) => (\n  <ThemeProvider theme={theme}>\n    <Layout>\n      <GlobalStyle />\n      <Component {...pageProps} />\n    </Layout>\n  </ThemeProvider>\n);\n\nexport default MyApp;\n```\n\nAnd we're done! Actually, no we're not. At this point, using styled-components will work just fine...sort of. If you either:\n\n- Manually refresh the page in the browser\n- Host this project, on Vercel or Netlify, for example\n\nThe styles will likely break. This is because the server-side rendering does _not_ fetch the styles before rendering the page. To correct this issue, we need to inject server-side rendered styles to the `head` so it can render the page and its styles correctly.\n\nInside the `pages` folder, we need to create a file called `_document.tsx`. In that file, you will need this:\n\n```ts\n// next\nimport Document, { Head, Html, Main, NextScript } from 'next/document';\nimport type { DocumentContext, DocumentInitialProps } from 'next/document';\n\n// styled components\nimport { ServerStyleSheet } from 'styled-components';\n\nclass MyDocument extends Document {\n  static getInitialProps = async (ctx: DocumentContext): Promise<DocumentInitialProps> => {\n    const sheet = new ServerStyleSheet();\n    const originalRenderPage = ctx.renderPage;\n\n    try {\n      ctx.renderPage = () =>\n        originalRenderPage({\n          enhanceApp: (App) => (props) => sheet.collectStyles(<App {...props} />)\n        });\n\n      const initialProps = await Document.getInitialProps(ctx);\n\n      return {\n        ...initialProps,\n        styles: (\n          <>\n            {initialProps.styles}\n            {sheet.getStyleElement()}\n          </>\n        )\n      };\n    } finally {\n      sheet.seal();\n    }\n  };\n\n  render() {\n    return (\n      <Html>\n        <Head>\n          <link rel='preconnect' href='https://fonts.googleapis.com' />\n          <link rel='preconnect' href='https://fonts.gstatic.com' crossOrigin='true' />\n          <link\n            href='https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap'\n            rel='stylesheet'\n          />\n        </Head>\n        <body>\n          <Main />\n          <NextScript />\n        </body>\n      </Html>\n    );\n  }\n}\n\nexport default MyDocument;\n```\n\nA **BIG** shoutout to Nicolás M. Pardo here on dev.to as he posted this in a comments section from a different article and it saved the day! And as you can see, I also just added the necessary code to include links to Google Fonts. If you don't need that, you can simply get rid of it.\n\nNow we just need to restart the server and everything should be a-ok!\n\n## Contentful\n\nIn this section, we'll take a look at a few key areas:\n\n- The use of environment variables\n- Querying data from Contentful using GraphQL\n- The use of webhooks\n- Local development experience\n- Using fragments for reusable queries\n\n### The use of environment variables\n\nSomewhat disappointingly, while going through the setup for Gatsby, after selecting Contentful as your headless CMS, the necessary `.env` files are not created as part of the setup. And with Next, you will need to set them up manually yourself.\n\nNow to be fair to both, if you use the [starter-gatsby-blog](https://github.com/contentful/starter-gatsby-blog) from Contentful themselves, the new [gatsby-starter-contentful-homepage](https://github.com/gatsbyjs/gatsby-starter-contentful-homepage) from Gatsby, or the Next.js Contentful [example](https://github.com/vercel/next.js/tree/canary/examples/cms-contentful), these do use environment variables. It's just these basic starters that do not.\n\nFor Next.js, you simply need to create a `.env.local` file, and add in your variables like so:\n\n```\nVARIABLE_NAME=VALUE\n```\n\nThen restart your local dev server if it is currently running so Next.js can load in the variables. You should see `Loaded from env` in your terminal after the local dev server starts up.\n\nFor Gatsby, create 2 files:\n\n- `.env.development`\n- `.env.production`\n\nAdd in the same variables in both files and you will be good to go.\n\n### Querying data from Contentful using GraphQL\n\nBoth frameworks take a similar approach to querying data from Contentful using GraphQL. To _greatly_ oversimplify things, the process essentially boils down to:\n\n- Make a query using GraphQL\n- Pass that returned data to your components as props\n- Display the data in your components\n\nHow each framework does that is of course different, and we'll explore it in further detail below.\n\nBut first, one thing I do want to give big props to is Gatsby's implementation of the GraphiQL playground. Specifically, including an Explorer. I have to admit, I have taken this for granted, as it makes structuring queries so, so much easier.\n\nWith Next.js, I ended up using the GraphiQL playground provided by Contentful themselves. You can view it here:\n\nhttps://graphql.contentful.com/content/v1/spaces/YOUR_SPACE_ID_HERE/explore?access_token=YOUR_ACCESS_TOKEN_HERE\n\nJust make sure to update the placeholders with your actual Contentful Space ID and Access Token.\n\n#### Gatsby\n\nWith Gatsby, querying data from Contentful using GraphQL is very straightforward. In your page component file, you add your GraphQL query typically beneath the `export default`:\n\n```js\n// component code up here...\n\nexport default Home;\n\nexport const homePageQuery = graphql`\n  query HomePageQuery {\n    contentfulHero(id: { eq: \"ID_HERE\" }) {\n      title\n      tagline\n      backgroundImage {\n        id\n        description\n        gatsbyImageData\n      }\n    }\n  }\n`;\n```\n\nIn this example, I'm querying data from a specific Hero model I created, and I want the values from the `title`, `tagline`, and `backgroundImage` fields. I'll be discussing images in more detail later on.\n\nTo actually consume this data, the page component can access the returned data via the `data` prop. From there, you can pass it down as a `prop` to the corresponding component like so:\n\n```ts\nconst Home = ({ data, location }: PageProps<GraphQLResult>) => {\n  // just double check...\n  console.log('data: ', data);\n\n  return (\n    <Layout title='Home'>\n      <Hero contentfulData={data.contentfulHero} />\n    </Layout>\n  );\n};\n```\n\nWith TypeScript, we can also type out how the response will look. The name I've always used is `GraphQLResult`, but you can name it whatever you like. The type for this is just above the component like so:\n\n```ts\ntype GraphQLResult = {\n  contentfulHero: ContentfulHero;\n};\n\nconst Home = ({ data, location }: PageProps<GraphQLResult>) => {\n  // just double check...\n  console.log('data: ', data);\n\n  return (\n    <Layout title='Home'>\n      <Hero contentfulData={data.contentfulHero} />\n    </Layout>\n  );\n};\n```\n\nI like to keep my types in a separate folder, so I import `ContentfulHero` wherever I need it. The type looks like this:\n\n```ts\nimport type { IGatsbyImageData } from 'gatsby-plugin-image';\n\nexport type ContentfulHero = {\n  title: string;\n  tagline: string;\n  backgroundImage: {\n    id: string;\n    description: string;\n    gatsbyImageData: IGatsbyImageData;\n  };\n};\n```\n\nAnd the Hero component can also use this type for `props`:\n\n```ts\ntype HeroProps = {\n  contentfulData: ContentfulHero;\n};\n\nconst Hero = ({ contentfulData }: HeroProps) => (\n  <div className='wrapper'>\n    <h1>{contentfulData.title}</h1>\n    <p>{contentfulData.tagline}</p>\n  </div>\n);\n\nexport default Hero;\n```\n\nThis way I have full type checking for my data, as well as some nice auto-completion when using the data in my component.\n\nThere are some tools you can use to automatically generate the types for your GraphQL Schema, such as [GraphQL Code Generator](https://www.graphql-code-generator.com/). However, since this is a fairly small project, and I am the only dev working on it, I don't mind setting things up manually myself.\n\n#### Next.js\n\nWith Next.js, the process is quite similar. However, there are multiple ways to query data with Next.js:\n\n- React hooks at the component level (`useEffect` with an `async` function is a common approach)\n- `getStaticProps()` at the page level\n- `getServerSideProps()` at the page level\n- `useSWR()` hook at the component level\n\nFor my purposes, since this is a static portfolio site, I will be using the `getStaticProps()` function. As outlined in the Next.js [documentation](https://nextjs.org/docs/basic-features/data-fetching/get-static-props), if the data is coming from a headless CMS, then `getStaticProps()` is a great choice. Check out the documentation on how the function works if you are not familiar with it, as I do not have the courage to explain it since I am still new to it.\n\nInside this function, we can make our request. This [video](https://www.youtube.com/watch?v=bMRQgguzBLs&t=1613s) from the Contentful YouTube channel was very helpful, and required minimal modification for TypeScript.\n\nIn the video, Lee recommends using the `graphql-request` package. And I have to say, as a first time user, I quite liked it! I will definitely look to use this again in the future!\n\nTo start, we will need to import `GraphQLClient` & `gql` from `graphql-request` as named imports:\n\n```js\nimport { GraphQLClient, gql } from 'graphql-request';\n```\n\nThen inside the `getStaticProps()` function, we can start with the following:\n\n```ts\nconst endpoint = `https://graphql.contentful.com/content/v1/spaces/${process.env.CONTENTFUL_SPACE_ID}`;\n\nconst options = {\n  headers: {\n    authorization: `Bearer ${process.env.CONTENTFUL_ACCESS_TOKEN}`\n  }\n};\n\nconst graphQLClient = new GraphQLClient(endpoint, options);\n```\n\nNotice the value for `endpoint` is different than that of the URL you would visit in the browser!\n\nNext, we can use the `gql` function to write our GraphQL Query, and we'll see some noticeable differences:\n\n```js\nconst homePageQuery = gql`\n  {\n    hero(id: \"ID_HERE\") {\n      backgroundImage {\n        sys {\n          id\n        }\n        description\n        height\n        url\n        width\n      }\n      tagline\n      title\n    }\n  }\n`;\n```\n\nThe first is actually `ID_HERE`. When using the Explorer in Gatsby's GraphiQL playground, you can either use the ContentfulId or Id. The latter looks like this:\n\n`a1a1a1a1-a1a1-a1a1-a1a1-a1a1a1a1a1a1`\n\nWhere the As and 1s could be any combination of letters and numbers. With Next.js, you don't get this type of ID. Instead, you simply use the `ENTRY ID` for whichever piece of content you are querying for.\n\nTo see this `ENTRY ID`, select any piece of content you have created in Contentful. Then on the right-hand sidebar menu, select the `Info` tab. Second from the top is the `ENTRY ID`. In all fairness, you could also use this in your GraphQL queries with Gatsby as well. I've always just used the long-form id above out of habit.\n\nThe next difference are the fields we can query for the image. We'll need these files to pass them on to Next.js's `<Image />` component. Again, we'll discuss each framework's approach to images and image optimization later.\n\nFinally, store the returned data in a variable like so:\n\n```ts\nconst data: ContentfulResponse = await graphQLClient.request(homePageQuery);\n```\n\nThen return in a props object:\n\n```ts\nreturn {\n  props: {\n    data\n  }\n};\n```\n\nHere, I am using the ES6 object shorthand where if the key and value are the same, we can write like I have above instead of like this:\n\n```ts\nreturn {\n  props: {\n    data: data\n  }\n};\n```\n\nSo all together, `getStaticProps()` looks like this:\n\n```ts\nexport async function getStaticProps() {\n  // get contentful data\n  const endpoint = `https://graphql.contentful.com/content/v1/spaces/${process.env.CONTENTFUL_SPACE_ID}`;\n  const options = {\n    headers: {\n      authorization: `Bearer ${process.env.CONTENTFUL_ACCESS_TOKEN}`\n    }\n  };\n\n  const graphQLClient = new GraphQLClient(endpoint, options);\n\n  const homePageQuery = gql`\n    query HomepageQuery {\n      hero(id: \"ID_HERE\") {\n        backgroundImage {\n          sys {\n            id\n          }\n          description\n          height\n          url\n          width\n        }\n        tagline\n        title\n      }\n    }\n  `;\n\n  const data: ContentfulResponse = await graphQLClient.request(homePageQuery);\n\n  return {\n    props: {\n      data\n    }\n  };\n}\n```\n\nNow in the `Home` page component, we can access this `data` prop like so:\n\n```tsx\nconst Home: NextPage<HomeProps> = ({ data }) => {\n  console.log('data: ', data);\n\n  return (\n    <div>\n      <Hero />\n    </div>\n  );\n};\n```\n\nAnd to be clear, `data` is just the name I chose. I could've called it `hero` if I wanted to, and accessed it via a `hero` prop instead. I like using `data` because I'll be adding on to the GraphQL query later on querying for multiple pieces of content. So, `data` is just a generic variable name I like to use, and comes from the habit of using Gatsby.\n\nAnd just like before with Gatsby, we pass the data down to the corresponding component:\n\n```tsx\nconst Home: NextPage<HomeProps> = ({ data }) => {\n  console.log('data: ', data);\n\n  return (\n    <div>\n      <Hero contentfulData={data.contentfulHero} />\n    </div>\n  );\n};\n```\n\nAnd that's it! That's how we can query data from Contentful with both frameworks with GraphQL. Personally, I don't really have a preference. I think both are perfectly fine.\n\nAnd as a quick side note, I would extract the querying logic in `getStaticProps()` into a separate file and folder to make the code inside `getStaticProps()` cleaner, as well as make the query a bit more reusable. It would require some modification, but it would make for a good starting point.\n\n### The use of webhooks\n\nWhen it comes to hosting, whether you choose Netlify, Gatsby Cloud, or Vercel, they all have options to set up both environment variables, as well as webhooks that you can use with Contentful. This way, whenever you make a change, or mutliple changes, in Contentful, the site will rebuild with the latest data.\n\n### Local development experience\n\nAn interesting note here is that with Gatsby, during local development, whenever you make a change in Contentful, it will _not_ appear while the local dev server is running. You must restart the server, and clean the `public` and `.cache` folders as well. So, I would recommend adjusting the `dev` script in `package.json` to the following:\n\n```json\n\"clean\": \"gatsby clean\",\n\"dev\": \"npm run clean && gatsby develop\",\n```\n\nThis is because Gatsby will run your GraphQL queries during build time, and not run time. Therefore, a restart is required.\n\nWith Next.js however, you simply need to manually refresh the page in the browser, and any changes will be seen.\n\n### Using fragments for reusable queries\n\nThe great thing about querying data with GraphQL is you can use something called [fragments](https://graphql.org/learn/queries/#fragments). Fragments help by cutting down on repeated query fields.\n\n#### Gatsby\n\nWith Gatsby, creating reusable fragments is very straightforward. In the `src` folder, I typically create another folder called `graphql`. In the `graphql` folder, I then create a file called `fragments.ts`. Here, let's create a highly reusable fragment for fields for an image:\n\n```ts\nexport const imageFields = graphql`\n  fragment ImageFields on ContentfulAsset {\n    id\n    description\n    gatsbyImageData(placeholder: BLURRED)\n  }\n`;\n```\n\nWhat's so nice about this is that Gatsby _automatically_ exports these queries to the global scope. So, these fragments are available in any other GraphQL query in the entire project! We can even use our fragments in other fragments!\n\nAnd just as a quick side note, I like to include `id` here even if I'm only querying for a single image because in the instance I _do_ query for multiple images, I have the `id`'s ready to use for mapping over the array and using them as the value for the `key` prop.\n\nNow, let's say for example we have a standard 50/50 model, with `heading` & `copy` on the left and an `image` on the right. For the fragment, it would look something like this:\n\n```ts\nexport const fiftyFiftyFields = graphql`\n  fragment FiftyFiftyFields on ContentfulFiftyFifty {\n    id\n    heading\n    copy {\n      copy\n    }\n    image {\n      ...ImageFields\n    }\n  }\n`;\n```\n\nNow we can use this fragment in the `HomePageQuery`, for example, like so:\n\n```ts\nexport const homePageQuery = graphql`\n  query HomePageQuery {\n    firstFiftyFifty: contentfulFiftyFifty(id: { eq: \"ID_1_HERE\" }) {\n      ...FiftyFiftyFields\n    }\n    secondFiftyFifty: contentfulFiftyFifty(id: { eq: \"ID_2_HERE\" }) {\n      ...FiftyFiftyFields\n    }\n  }\n`;\n```\n\nIn this example, we can also see [aliases](https://graphql.org/learn/queries/#aliases) being used. Aliases let you rename the result of a field to anything you want. This is helpful for when you are querying the same thing but with different arguments.\n\nSo, combining fragments and aliases really help make our queries shorter, cleaner, and easier to read and write.\n\n#### Next.js\n\nWith Next.js, while we don't get automatic global scoped fragments, we can still create and use them, just with a little bit of extra work.\n\nWe can start with the same process by creating a `fragments.ts` file inside of a `graphql` folder. Let's create a reusable Image fragment:\n\n```ts\nimport { gql } from 'graphql-request';\n\nexport const FRAGMENT_IMAGE = gql`\n  fragment ImageFields on Asset {\n    sys {\n      id\n    }\n    description\n    height\n    url\n    width\n  }\n`;\n```\n\nNow back in the index page file, inside `getStaticProps()` and then inside our `gql` template string, we can go from this:\n\n```ts\nconst homePageQuery = gql`\n  query HomepageQuery {\n    hero(id: \"ID_HERE\") {\n      backgroundImage {\n        sys {\n          id\n        }\n        description\n        height\n        url\n        width\n      }\n      tagline\n      title\n    }\n  }\n\n  # fragments\n  ${FRAGMENT_IMAGE}\n`;\n```\n\nTo this:\n\n```ts\nconst homePageQuery = gql`\n  query HomepageQuery {\n    hero(id: \"ID_HERE\") {\n      backgroundImage {\n        ...ImageFields\n      }\n      tagline\n      title\n    }\n  }\n\n  # fragments\n  ${FRAGMENT_IMAGE}\n  # make sure to import this!\n`;\n```\n\nIt may not look very powerful right now when querying a single piece of content, but I'm sure you can imagine if this homepage had say 8-10 sections, all of them containing images, having the same fields repeated over and over again would make the query very long and rather difficult to traverse.\n\n## Image Optimization\n\nBoth frameworks come with image optimization OOTB in the form of components. Next.js has [\\<Image />](https://nextjs.org/docs/api-reference/next/image), and Gatsby has both [\\<StaticImage />](https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage) and [\\<GatsbyImage />](https://www.gatsbyjs.com/docs/reference/built-in-components/gatsby-plugin-image/#staticimage).\n\nLet's explore their differences:\n\n### Gatsby\n\nGatsby comes with 2 different image components. When you should use which? The answer to that is very simple.\n\nIs the image you're using the same every time the component is rendered? For example, the site logo, or any other picture located within the project locally? Then use `<StaticImage />`.\n\nIs the image you're using going to be passed into a component as a `prop`, and / or coming from an external source, such as Contentful? Then use `<GatsbyImage />`.\n\nSince this article is all about Contentful, we'll be focusing on `<GatsbyImage />`!\n\nIn the GraphiQL playground, whenever you want to query for an image (or multiple images), I'd recommend getting the following fields:\n\n- `id`\n- `description`\n- `gatsbyImageData`\n\nWith this, we can create a reusable fragment for querying those fields on images (known as Assets in Contentful):\n\n```ts\nexport const imageFields = graphql`\n  fragment ImageFields on ContentfulAsset {\n    id\n    description\n    gatsbyImageData(placeholder: BLURRED)\n  }\n`;\n```\n\nWhen you execute the query with these fields, you'll see a _ton_ of data for the gatsbyImageData field. But don't worry, the `<GatsbyImage />` component will handle all of that for us!\n\nYou would use that data like so:\n\n```js\n<GatsbyImage image={contentfulData.image.gatsbyImageData} alt={contentfulData.image.description} />\n```\n\nYou can see in my fragment above I also added `(placeholder: BLURRED)`. This will do as the wording suggests! It will blur the image until the full res version is ready to use. This will help cut down on page load time and help improve performance.\n\n### Next.js\n\nWith Next.js, we get a single `<Image />` component that we can use for both static and dynamic images. And very similarly to Gatsby, as long as we pass it the right data for its various props, it will handle all the heavy lifting for us!\n\nAnd just like with Gatsby, we can create a highly reusable fragment like we did above in the previous section to query certain fields from Contentful. We would then use that data like so:\n\n```ts\n<Image\n  src={data.hero.backgroundImage.url}\n  alt={data.hero.backgroundImage.description}\n  width={data.hero.backgroundImage.width}\n  height={data.hero.backgroundImage.height}\n/>\n```\n\nAnd that's it! Well...sort of. With Next.js, there is one more step. We have to add the domain these images are coming from to an array in our `next.config.js` file. This array holds an array of `domains` that are whitelisted. This tells Next.js that it is ok to fetch the images from these external sources and optimize them:\n\n```js\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    domains: ['images.ctfassets.net']\n  },\n  reactStrictMode: true\n};\n\nmodule.exports = nextConfig;\n```\n\nOk, _now_ we have optimized images from Contentful!\n\n## Blog Posts\n\nNow that I'm writing blog posts here on dev.to, I wanted to incorporate them into my portfolio as well. While Contentful does have a Markdown text box that I could just copy and paste the post into and create dynamic routes with either framework, I was more interested in how I would query data from 2 different data sources using 2 different methods:\n\n- Querying content from Contentful using GraphQL\n- Querying posts from dev.to using REST API w/ Fetch\n\nLet's take a look!\n\n### Gatsby\n\nWith Gatsby, I had an assumption of how I would query for my blog posts, and after some research (aka quick Googling), it seems like my assumption was correct.\n\nI created a BlogPosts component, and inside that component I made the fetch call like so:\n\n```tsx\nconst BlogPosts = () => {\n  const [posts, setPosts] = useState<DevPost[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const fetchBlogPosts = async () => {\n    setIsLoading(true);\n\n    const response = await fetch('https://dev.to/api/articles?username=andrews1022');\n    const data: DevPost[] = await response.json();\n\n    setPosts(data);\n\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    fetchBlogPosts();\n  }, []);\n\n  return (\n    <div>\n      <h2>Posts</h2>\n      <div>\n        {isLoading ? (\n          <p>Loading...</p>\n        ) : (\n          posts.map((post) => (\n            <div key={post.id}>\n              <p>{post.title}</p>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n};\n```\n\nNow I realize I don't have error handling in the form of an error state, or a cleanup in my `useEffect`, but that's ok since I'm just trying things out before making any large commitments.\n\nThis is a pretty standard approach:\n\n- Have state for the data, loading, and error\n- Write an async function that queries the data, and updates the various pieces of state accordingly\n- In the useEffect hook, call the async function and have an empty array of dependencies so this function will only be executed once when the component is first mounted / rendered\n\nAnd that's it! My blog post titles display just fine. With Next.js though, that's where things get a little spicy.\n\n### Next.js\n\nWith Next.js, we can take advantage of the `getStaticProps()` function and add this additional request below the GraphQL query to Contentful and return it alongside the `data` like so:\n\n```ts\nexport async function getStaticProps() {\n  // make the contentful query up here...\n\n  // get dev.to data\n  const postsResponse = await fetch('https://dev.to/api/articles?username=andrews1022');\n  const posts: DevPost[] = await postsResponse.json();\n\n  return {\n    props: {\n      data,\n      posts\n    }\n  };\n}\n```\n\nAgain, I realize there isn't any error handling here, this is just for the sake of demonstration purposes. And in case I didn't mention earlier, the `DevPost` type is a custom type I created.\n\nWith these posts, I can pass them down to my BlogPosts component:\n\n```js\n<BlogPosts posts={posts} />\n```\n\nAnd then loop over them and display them like so (just the `title` for now to make sure things are working):\n\n```tsx\ntype BlogPostsProps = {\n  posts: DevPost[];\n};\n\nconst BlogPosts = ({ posts }: BlogPostsProps) => {\n  return (\n    <div>\n      <h2>Posts</h2>\n      <div>\n        {posts.map((post) => (\n          <div key={post.id}>\n            <p>{post.title}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n```\n\nWhy I think this is spicy is because since Next.js pre-renders the page at build time using the props returned by `getStaticProps()`, there is no awkward `Loading...` text or spinner being shown temporarily. Everything is just...there! I'm still getting used to Next.js, so I probably didn't explain that very well but I just think it's neat (insert [Marge Simpson meme](https://i.kym-cdn.com/photos/images/newsfeed/001/498/880/572.jpg) here)!\n\n## Hosting\n\nHosting is dead simple no matter which you pick. Each framework has their own hosting service which they recommend:\n\n[Gatsby Cloud](https://www.gatsbyjs.com/products/cloud/) for Gatsby projects, and [Vercel](https://vercel.com/) for Next.js projects.\n\nYou could also use [Netlify](https://www.netlify.com/) if you wish.\n\nWhichever you pick, you can select your project from GitHub (once you have given it authorization to do so), and the service will automatically build and host the site for you!\n\nAnd as previously mentioned, you can include environment variables for your Contentful API keys, as well as setup webhooks with Contentful.\n\n## Final Thoughts\n\nWhew, that was a lot! If you made it this far, thank you so much for reading this post. I had a lot of fun researching and trying out the various points I mentioned here, and it was great to try out and learn more about Next.js some more as well.\n\nMy goal for this article was to simply show you each framework's approach for common tasks and let you decide which approach(es) you do or don't like. Personally, I'm going to stick with Next.js to build out the rest of my portfolio simply because I want to become more familiar with it and learn more about it.\n\nIn my opinion, for a simple static like this, you really can't go wrong with either framework. If you have more experience with one over the other, I would recommend trying the other and see what you think. I provided my experience here and I hope you found it useful.\n\nCheers!",a.user={name:"Andrew Shearer",username:t,twitter_username:s,github_username:t,website_url:"https://andrewshearerdevportfolio.netlify.app/",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--2uJUy3K5--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/822204/6e474048-30e3-45de-b3f5-1ec860d878e3.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--_OQ0GOMI--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/822204/6e474048-30e3-45de-b3f5-1ec860d878e3.jpeg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:a}},error:s,state:{currentArticle:a},serverRendered:!0,routePath:"/andrews1022/1051221",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:s}}}}(null,"2022-04-15T15:58:54Z",{},"https://dev.to/andrews1022/an-unnecessarily-extensive-comparison-of-gatsby-nextjs-while-rebuilding-my-portfolio-58f2","andrews1022")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
