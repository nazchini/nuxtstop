<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/pulumi" class="tag" data-v-70afb46a>
          #pulumi
        </a><a href="/nuxtstop/t/fullstack" class="tag" data-v-70afb46a>
          #fullstack
        </a><a href="/nuxtstop/t/mern" class="tag" data-v-70afb46a>
          #mern
        </a><a href="/nuxtstop/t/digitalocean" class="tag" data-v-70afb46a>
          #digitalocean
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--4o8GYKcN--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/qu9erqi66s6uw9c7h1hl.png" alt="Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean" data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            9
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Mar 14</time></div></header> <div class="content" data-v-70afb46a><p>As a developer, I get lots of ideas for web apps—little things, mostly: nifty ways to keep track of my kids' allowances, habit trackers, shopping lists. Most of them, however, never see the light of day, and not just because I'm lazy; I also tend to get hung up trying to decide what to use for the technology stack.</p>

<p>And as a JavaScript developer, I certainly have options—too many, in fact, and that's part of the problem. Having roughly a hundred and fifty million libraries and frameworks to choose from is definitely better than having none, but at the same time, all that choice can make the actual choosing rather difficult. Which is why, when I just want to get something done, I'll often reach for a combination of tools known as <a href="https://www.mongodb.com/mern-stack">the MERN stack</a>.</p>

<p>MERN-stack apps are three-tier web apps built with <a href="https://www.mongodb.com/">MongoDB</a>, <a href="https://expressjs.com/">Express</a>, <a href="https://reactjs.org/">React</a>, and <a href="https://nodejs.org/">Node.js</a>. You can read all about them <a href="https://www.mongodb.com/mern-stack">in the MongoDB docs</a>, but the gist is that they allow you use one language—JavaScript (or TypeScript, if you like)—to manage all three layers of the application stack: the front end as a single-page app built statically with React, the back end as a REST API managed with Express, and the database as a collection of JSON-like documents with MongoDB. MERN might not <em>always</em> the right tool for the job, but for the kinds of apps I tend to find myself building, it generally works out pretty well.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8nlc5TzF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/tiers.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8nlc5TzF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/tiers.png" alt="The tiers of a typical web application: front end, back end, and database" loading="lazy" width="880" height="592"></a></p>

<p>Still, once I'm <em>finished</em> building my app, I'm often faced with a whole other problem: figuring out how to get the app off of my laptop and onto the web.</p>

<p>The cloud hasn't made this an easy task for developers. Choosing a cloud provider, deciding which resources to use (and how to use them), setting up networking, debugging permissions, navigating billing, and all the rest, can be overwhelming—and that's before you've given a single thought to anything having to do with automation or infrastructure as code. What we want, I think, is to be able to focus on our apps, and we're ready to ship, push our code to a repository and wait patiently for a URL to emerge that we can paste into a browser and have everything <em>just work</em>.</p>

<p>Which is why I was so delighted when I discovered <a href="https://www.digitalocean.com/products/app-platform">DigitalOcean's App Platform</a>.</p>

<p>If you've used DigitalOcean before, you know it's all about making infrastructure more accessible to developers. What you may not know, though, or at least I didn't myself until recently, is that you can do a lot more with DigitalOcean than just <a href="https://www.digitalocean.com/products/droplets">virtual machines</a>. A <a href="https://www.digitalocean.com/blog/introducing-digitalocean-app-platform-reimagining-paas-to-make-it-simpler-for-you-to-build-deploy-and-scale-apps">fairly new</a>, fully-managed platform service (think <a href="https://heroku.com">Heroku</a>), App Platform gives you a set of high-level abstractions built to align with the tiers of a typical web application, which means you can focus on what you care about most—your app—and leave the infrastructure and its management to someone else. It's a compelling option for anyone looking to deploy and manage any web application (MERN or otherwise), and as you'll see, with Pulumi and a little bit of code, you can easily do so without ever having to leave the comfort of your IDE.</p>

<p>So let's build ourselves a MERN app and deploy it on DigitalOcean with Pulumi. Given the goal is to focus primarily on the infrastructure and how to code it, we'll start with a pre-baked web application (a simple grocery list), and we'll map its tiers to App Platform constructs and wire everything up with Pulumi.</p>

<h2>
  <a name="first-steps-setting-up" href="#first-steps-setting-up">
  </a>
  First steps: setting up
</h2>

<p>The code for this walkthrough is <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">available as a template repository on GitHub</a>, so if you want to follow along (and you should!), you should <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/generate">grab a copy of your own</a> to work with by forking the repository or creating a new one from the template. Once you've done that, you should also:</p>

<ul>
<li>
<a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">Clone the repository</a> to your local machine.</li>
<li>
<a href="https://www.pulumi.com/docs/get-started/install">Install Pulumi</a> and <a href="https://nodejs.org/">Node.js</a>.</li>
<li>
<a href="//cloud.digitalocean.com/">Sign into DigitalOcean</a> and obtain a <a href="https://cloud.digitalocean.com/account/api/tokens">personal access token</a> with read-write permissions.</li>
<li>Grant DigitalOcean access to your GitHub repository by <a href="https://cloud.digitalocean.com/apps">visiting the Apps page</a>, choosing Create App, and following the steps to install DigitalOcean's GitHub app.</li>
<li>Optionally, if you'd like to develop the application locally as well, <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/">install and configure MongoDB Community Edition</a>.</li>
</ul>

<p>One thing to note: Since we'll be provisioning real DigitalOcean resources, there's a chance you could incur a slight cost for what you use. However, as we'll be using the least expensive plan settings available, and tearing everything down when we're through, that cost shouldn't amount to more than a few pennies or so.</p>

<p>Let's get started.</p>

<h2>
  <a name="cloning-and-inspecting-the-repository" href="#cloning-and-inspecting-the-repository">
  </a>
  Cloning and inspecting the repository
</h2>

<p>Once you've cloned your copy of the template repository and navigated to the root, you'll see a couple of files and folders that look something like this:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code>├── frontend
├── backend
└── package.json
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The <code>frontend</code> folder contains the React application, and its job is to render the list of groceries and give you something to interact with (to add items, check them off, delete them, and so on). The scaffolding for the app was generated with a tool called <a href="https://vitejs.dev/">Vite</a>, and all of its logic—form fields, click handlers, API calls, etc.—is contained in <code>src/App.tsx</code>.</p>

<p>The <code>backend</code> folder contains the Express application that defines the REST API. It sets up four API <a href="https://expressjs.com/en/guide/routing.html">routes</a> to handle the <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations you'd expect in an app like this one:</p>

<ul>
<li>
<code>GET /api/items</code> fetches all items from the database and returns them as a JSON array.</li>
<li>
<code>POST /api/items</code> accepts a new item and writes it to the database.</li>
<li>
<code>PUT /api/items/:id</code> updates an existing item (to toggle its checked/unchecked status).</li>
<li>
<code>DELETE /api/items/:id</code> deletes an item from the database.</li>
</ul>

<p>The back end supports three configurable properties as well, all of which are exposed as optional environment variables:</p>

<ul>
<li>
<code>BACKEND_SERVICE_PORT</code>, which defaults to <code>8000</code>
</li>
<li>
<code>BACKEND_ROUTE_PREFIX</code>, which defaults to <code>/api</code>
</li>
<li>
<code>DATABASE_URL</code>, which defaults to <code>mongodb://127.0.0.1</code> for local development</li>
</ul>

<h2>
  <a name="running-the-application-locally-optional" href="#running-the-application-locally-optional">
  </a>
  Running the application locally (optional)
</h2>

<p>You don't have to do this, but if you'd like to, here's how. After <a href="https://docs.mongodb.com/manual/administration/install-community/">installing MongoDB and starting the service</a> (which should be listening by default on port <code>27107</code>), you can install all front-end and back-end dependencies and start the development server:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>npm <span class="nb">install</span>
<span class="nv">$ </span>npm start
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With the development server running, you can browse to <a href="http://localhost:3000">http://localhost:3000</a> and see the app:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--aCCe24hD--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--aCCe24hD--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost.png" alt="The application running in a browser on localhost" loading="lazy" width="880" height="516"></a></p>

<p>The front-end and back-end dev servers are set up to compile your TypeScript to JavaScript automatically, and the front-end server is configured to proxy the back-end service (which runs at <code>http://localhost:8000</code>) at a root-relative path of <code>/api</code>. Proxying the API in this way lets you avoid having to wrestle with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>-related issues, and as you'll see when we deploy to DigitalOcean later, App Platform conveniently supports the same configuration out of the box.</p>

<p>Try adding a few items and marking them off, just to make sure everything's working as expected. If you've got a MongoDB client installed as well—I generally use <a href="https://www.mongodb.com/products/compass">MongoDB Compass</a>—you should be able to find the <code>grocery-list</code> database and see the <code>items</code> collection filling up with delicious foods:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vHPcX1G3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost-db.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vHPcX1G3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost-db.png" alt="MongoDB Compass, showing the grocery-list database and the items collection" loading="lazy" width="880" height="536"></a></p>

<p>Now let's have a look at how to go about deploying this stuff.</p>

<h2>
  <a name="charting-a-course" href="#charting-a-course">
  </a>
  Charting a course
</h2>

<p>Earlier I mentioned that every cloud provider handles application deployment a little differently, sometimes in multiple ways, and that's true for DigitalOcean as well. You <em>could</em> deploy the front end as a <a href="https://www.digitalocean.com/products/spaces">DigitalOcean Space</a>, or both the front end and back end (and even the database) as a <a href="https://www.digitalocean.com/products/droplets">DigitalOcean Droplet</a>. But given the shape of this application, the best fit is really is <a href="https://docs.digitalocean.com/products/app-platform/concepts/">App Platform</a>, for several reasons.</p>

<p>One is that because App Platform apps are comprised these high-level <a href="https://docs.digitalocean.com/products/app-platform/concepts/"><em>components</em></a>—abstractions like <a href="https://docs.digitalocean.com/products/app-platform/concepts/static-site/">static site</a>, <a href="https://docs.digitalocean.com/products/app-platform/concepts/service/">service</a>, and <a href="https://docs.digitalocean.com/products/app-platform/concepts/database/">database</a>—it's pretty much purpose-built for an application like this one, and DigitalOcean customizes the deployment of each component based according to its type. Static websites are distributed and cached on DigitalOcean's CDN, services are packaged and delivered as containers (with its <a href="https://www.digitalocean.com/products/kubernetes">Kubernetes</a> platform), and databases are deployed as configurable managed services. All of this means you're not only able to stay focused on the application itself, but you're able to scale each one of these components up or down however you like, and even delegate your front-end and back-end build processes to DigitalOcean to be handled in response to commits on one or more external Git repositories.</p>

<p>App Platform apps can be configured in one of two ways: manually, by configuring their components individually in the DigitalOcean web console, or programmatically, in the form of an App Platform <a href="https://docs.digitalocean.com/products/app-platform/concepts/app-spec/"><em>spec</em></a>, a JSON document submitted over DigitalOcean's <a href="https://docs.digitalocean.com/reference/api/api-reference/">REST API</a>. In our case, we'll indirectly go the latter route, using Pulumi with the <a href="https://www.pulumi.com/registry/packages/digitalocean">DigitalOcean provider package</a> to define an app spec comprised of three components:</p>

<ul>
<li>A <code>staticSite</code> component mapped to the <code>frontend</code> folder</li>
<li>A <code>service</code> component mapped to the <code>backend</code> folder</li>
<li>A <code>database</code> component mapped to a managed MongoDB cluster (which we'll also configure to be accessible only by the <code>service</code> component)</li>
</ul>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--UA5oCCa4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/mapped-tiers.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--UA5oCCa4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/mapped-tiers.png" alt="Front end, back end, and database tiers mapped to their corresponding App Platform components" loading="lazy" width="880" height="490"></a></p>

<p>And once deployed, it'll all be available at a single DigitalOcean-provided URL.</p>

<p>Let's begin by creating new Pulumi project.</p>

<h2>
  <a name="creating-the-project" href="#creating-the-project">
  </a>
  Creating the project
</h2>

<p>In the root of the repository, make a new folder called <code>infra</code>, change to it, then run <code>pulumi new</code> using the <code>digitalocean</code> <a href="https://github.com/pulumi/templates">project template</a>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">mkdir </span>infra <span class="o">&&</span> <span class="nb">cd </span>infra
<span class="nv">$ </span>pulumi new digitalocean-typescript
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>At the prompts, use the following values:</p>

<ul>
<li>For project name, use <code>grocery-list</code>
</li>
<li>For description, use <code>Deploying a MERN-stack app on DigitalOcean</code>
</li>
<li>For stack name, use <code>dev</code>, the default</li>
</ul>

<p>When the command completes, you'll have a new <a href="https://www.pulumi.com/docs/intro/concepts/stack">Pulumi stack</a>, but you'll still have a few things to configure. For one, the Pulumi DigitalOcean provider needs to be <a href="https://www.pulumi.com/registry/packages/digitalocean/installation-configuration">configured</a> to communicate with DigitalOcean on your behalf (to provision your app and its various resources). For this, you can use the access token you obtained <a href="#first-steps-setting-up">earlier</a> from the DigitalOcean console, and you can apply it by setting a single environment variable:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">DIGITALOCEAN_TOKEN</span><span class="o">=</span><span class="s2">"your-access-token"</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Also, since one of our goals is to have App Platform deploy automatically on every GitHub commit, you'll need to tell DigitalOcean where to find the source code for your front- and back-end components. You <em>could</em> bake these settings right into the Pulumi program itself, but it'd be better to apply them as stack-specific configuration settings, as that'd let you deploy to different stacks later (say, in CI) based on the branch of the commit. Everyone does this a little differently, so for now, let's configure the currently selected stack (which should be <code>dev</code>) to use the default branch of your GitHub repository:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>pulumi config <span class="nb">set </span>repo <span class="s2">"your-github-org/your-github-repo"</span> <span class="c"># e.g., cnunciato/fullstack-pulumi-mern-digitalocean</span>
<span class="nv">$ </span>pulumi config <span class="nb">set </span>branch <span class="s2">"your-main-branch"</span>               <span class="c"># e.g., main</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With these values in place, you're ready to start writing the program.</p>

<blockquote>
<p>App Platform also supports GitLab and other Git-based repositories as well. See the <a href="https://docs.digitalocean.com/products/app-platform/references/app-specification-reference/">App Specification docs</a> for details.</p>
</blockquote>

<h2>
  <a name="writing-the-program" href="#writing-the-program">
  </a>
  Writing the program
</h2>

<p>In your IDE of choice, open <code>index.ts</code> and replace the sample code with the following lines to import the Pulumi and DigitalOcean SDKs and the configuration values you just set, and add a line to specify the <a href="https://docs.digitalocean.com/products/platform/availability-matrix/">DigitalOcean region</a> to deploy into:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">pulumi</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@pulumi/pulumi</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">digitalocean</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@pulumi/digitalocean</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Our stack-specific configuration.</span>
<span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Config</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">repo</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">branch</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">branch</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// The DigitalOcean region to deploy into.</span>
<span class="kd">const</span> <span class="nx">region</span> <span class="o">=</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">Region</span><span class="p">.</span><span class="nx">SFO3</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Next, add a few lines to <a href="https://docs.digitalocean.com/products/databases/mongodb/how-to/create/">declare the managed MongoDB cluster</a>. We'll use just one node for now—additional replica nodes can easily be added later by increasing the <code>nodeCount</code> value—and go with the least expensive <a href="https://www.digitalocean.com/pricing#managed-databases">performance settings</a>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ...</span>

<span class="c1">// Our MongoDB cluster (currently just one node).</span>
<span class="kd">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseCluster</span><span class="p">(</span><span class="dl">"</span><span class="s2">cluster</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">engine</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mongodb</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">version</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">region</span><span class="p">,</span>
    <span class="na">size</span><span class="p">:</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseSlug</span><span class="p">.</span><span class="nx">DB_1VPCU1GB</span><span class="p">,</span>
    <span class="na">nodeCount</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// The database we'll use for our grocery list.</span>
<span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseDb</span><span class="p">(</span><span class="dl">"</span><span class="s2">db</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">grocery-list</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">clusterId</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now for the App Platform spec itself. Notice the <code>digitalocean.App</code> resource takes just one argument, <code>spec</code>, which defines all three of the components of the app: static site, service, and database. Both the static site and the service are configured to use the same GitHub repository (the <code>sourceDir</code> properties indicate their folders within the repository), and both are configured (via the <code>deployOnPush</code> flag) to be rebuilt and redeployed by DigitalOcean on every commit.</p>

<p>The service has a few additional settings that you can use to manage its runtime behavior and deployment topology as well. As in development, we'll configure the service to listen on port 8000 and be available at <code>/api</code>—the entire app will ultimately be proxied transparently by an <a href="https://docs.digitalocean.com/products/app-platform/concepts/load-balancer/">App Platform load balancer</a>—and it'll be powered by just one container instance, again using the least expensive <a href="https://docs.digitalocean.com/products/app-platform/">performance settings</a>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ...</span>

<span class="c1">// The App Platform spec that defines our grocery list.</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">App</span><span class="p">(</span><span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">spec</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">grocery-list</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">region</span><span class="p">:</span> <span class="nx">region</span><span class="p">,</span>

        <span class="c1">// The React front end.</span>
        <span class="na">staticSites</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">frontend</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">github</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nx">repo</span><span class="p">,</span>
                    <span class="nx">branch</span><span class="p">,</span>
                    <span class="na">deployOnPush</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="na">sourceDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/frontend</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">buildCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm install && npm run build</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">outputDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/dist</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">],</span>

        <span class="c1">// The Express back end.</span>
        <span class="na">services</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">backend</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">github</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nx">repo</span><span class="p">,</span>
                    <span class="nx">branch</span><span class="p">,</span>
                    <span class="na">deployOnPush</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="na">sourceDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/backend</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">buildCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm install && npm run build</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">runCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm start</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">httpPort</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>
                <span class="na">routes</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/api</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">preservePathPrefix</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">],</span>
                <span class="na">instanceSizeSlug</span><span class="p">:</span> <span class="dl">"</span><span class="s2">basic-xxs</span><span class="dl">"</span><span class="p">,</span>
                <span class="na">instanceCount</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

                <span class="c1">// To connect to MongoDB, the service needs a DATABASE_URL, which</span>
                <span class="c1">// is conveniently exposed as an environment variable thanks to its</span>
                <span class="c1">// membership in this app spec (below). The CA_CERT value enables</span>
                <span class="c1">// a secure connection between API service and database.</span>
                <span class="na">envs</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="na">key</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DATABASE_URL</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">RUN_AND_BUILD_TIME</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">${db.DATABASE_URL}</span><span class="dl">"</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="na">key</span><span class="p">:</span> <span class="dl">"</span><span class="s2">CA_CERT</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">RUN_AND_BUILD_TIME</span><span class="dl">"</span><span class="p">,</span>
                        <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">${db.CA_CERT}</span><span class="dl">"</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">],</span>
            <span class="p">},</span>
        <span class="p">],</span>

        <span class="c1">// Include the MongoDB cluster as an integrated App Platform component.</span>
        <span class="na">databases</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="c1">// The name `db` defines the prefix of the tokens used (above) to</span>
                <span class="c1">// read the environment variables exposed by the database cluster.</span>
                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">db</span><span class="dl">"</span><span class="p">,</span>

                <span class="c1">// MongoDB clusters are only available in "production" mode.</span>
                <span class="c1">// https://docs.digitalocean.com/products/app-platform/concepts/database/</span>
                <span class="na">production</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>

                <span class="c1">// A reference to the `DatabaseCluster` we declared above.</span>
                <span class="na">clusterName</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>

                <span class="c1">// The engine value must be uppercase, so we transform it with JS.</span>
                <span class="na">engine</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">engine</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">engine</span> <span class="o">=></span> <span class="nx">engine</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()),</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Technically that's all we need to configure the application—but it wouldn't be a bad idea to add one last thing.</p>

<p>By default, managed MongoDB clusters are configured to be publicly accessible—which is great if you need to be able to connect one yourself, but not so great as a strategy for preventing internet miscreants from doing the same. You can fix this easily by adding a <code>DatabaseFirewall</code> resource to declare the app as a <a href="https://docs.digitalocean.com/products/app-platform/how-to/manage-databases/"><em>trusted source</em></a>, thereby rejecting all inbound traffic originating from elsewhere:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ...</span>

<span class="c1">// Adding a database firewall setting grants access solely to our app.</span>
<span class="kd">const</span> <span class="nx">trustedSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseFirewall</span><span class="p">(</span><span class="dl">"</span><span class="s2">trusted-source</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">clusterId</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
    <span class="na">rules</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">value</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And finally, add one last line to export the app URL, to be generated by DigitalOcean, as a Pulumi <a href="https://www.pulumi.com/docs/intro/concepts/inputs-outputs">stack output</a>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ...</span>

<span class="c1">// The DigitalOcean-assigned URL for our app.</span>
<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span> <span class="nx">liveUrl</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">app</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With that, you're ready to deploy.</p>

<h2>
  <a name="deploying" href="#deploying">
  </a>
  Deploying
</h2>

<p>Quickly, to recap, here's what we've done so far:</p>

<ul>
<li>We took a pre-baked MERN app configured to run on <code>localhost</code>.</li>
<li>We mapped the tiers of that app to their corresponding App Platform components.</li>
<li>We wrote a Pulumi program to codify that mapping as an App Platform spec and a managed MongoDB cluster to go along with it.</li>
</ul>

<p>When you deploy this app in a moment with <a href="https://www.pulumi.com/docs/reference/cli/pulumi_up"><code>pulumi up</code></a>, Pulumi will provision a new MongoDB cluster (which usually takes a few minutes), and then once that's available, DigitalOcean will take our spec and use it to fetch the components of the app from GitHub at the specified branch and build them. From that point forward, any commit you make to that branch will trigger DigitalOcean to fetch, rebuild, and redeploy the app automatically.</p>

<p>Make sure you've installed the DigitalOcean GitHub app as described above—you should see it listed at <a href="https://github.com/settings/installations">https://github.com/settings/installations</a>:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--mg41LjNY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/digitalocean-github-app.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--mg41LjNY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/digitalocean-github-app.png" alt="The Applications tab on GitHub, showing the DigitalOcean app installed" loading="lazy" width="880" height="478"></a></p>

<p>Now return to the command line and run <code>pulumi up</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>pulumi up

Previewing update <span class="o">(</span>dev<span class="o">)</span>

View Live: https://app.pulumi.com/cnunciato/grocery-list/dev/previews/605bf32a-95b1-4221-bc35-0e667b30f38a

     Type                                    Name              Plan
 +   pulumi:pulumi:Stack                     grocery-list-dev  create
 +   ├─ digitalocean:index:DatabaseCluster   cluster           create
 +   ├─ digitalocean:index:DatabaseDb        db                create
 +   ├─ digitalocean:index:App               app               create
 +   └─ digitalocean:index:DatabaseFirewall  trusted-source    create

Resources:
    + 5 to create

Do you want to perform this update?
<span class="o">></span> <span class="nb">yes

</span>Updating <span class="o">(</span>dev<span class="o">)</span>

View Live: https://app.pulumi.com/cnunciato/grocery-list/dev/updates/1

     Type                                    Name              Status
     pulumi:pulumi:Stack                     grocery-list-dev
 +   ├─ digitalocean:index:App               app               created
 +   └─ digitalocean:index:DatabaseFirewall  trusted-source    created

Outputs:
  + liveUrl: <span class="s2">"https://grocery-list-fb9bd.ondigitalocean.app"</span>

Resources:
    + 2 created
    3 unchanged

Duration: 2m30s
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Again, it'll probably take a few minutes to get everything spun up for the first time, but when the process completes, you'll have a working app at the URL provided by DigitalOcean, emitted as a Pulumi stack output:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>open <span class="si">$(</span>pulumi stack output liveUrl<span class="si">)</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vEr4C5Ua--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/deployed.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vEr4C5Ua--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/deployed.png" alt="The app now running in the DigitalOcean cloud" loading="lazy" width="880" height="496"></a></p>

<p>You should also be able to explore your shiny new grocery-list app in the DigitalOcean Console, with all three of its components (and their build-time and runtime logs!) now represented:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--iRswh7-O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/in-the-console.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--iRswh7-O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/in-the-console.png" alt="The grocery-list app and its components in the DigitalOcean console" loading="lazy" width="880" height="672"></a></p>

<p>Now try making a commit to your repository (any commit will do, but ideally one to the <code>frontend</code> or <code>backend</code> folder), and watch as the app redeploys automatically:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ExAGUON6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/redeploying.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ExAGUON6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/redeploying.png" alt="App Platform rebuilding the app in response to a GitHub commit" loading="lazy" width="880" height="723"></a></p>

<p>And finally, try scaling the service by bumping the <code>instanceCount</code> from <code>1</code> to <code>2</code> in the code—or better, if you're up for it, making that value configurable by stack:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight diff"><code>  const config = new pulumi.Config();
  const repo = config.require("repo");
  const branch = config.require("branch");
<span class="gi">+ const serviceInstanceCount = config.requireNumber("service_instance_count");
</span>  ...
        services: [
            digitalocean.AppSpecServiceArgs(
                ...
<span class="gi">+               instanceCount: serviceInstanceCount,
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>





<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>pulumi config <span class="nb">set </span>service_instance_count 2

<span class="nv">$ </span>pulumi up

Updating <span class="o">(</span>dev<span class="o">)</span>

     Type                       Name              Status      Info
     pulumi:pulumi:Stack        grocery-list-dev
 ~   └─ digitalocean:index:App  app               updated     <span class="o">[</span>diff: ~spec]

Outputs:
    liveUrl: <span class="s2">"https://grocery-list-fb9bd.ondigitalocean.app"</span>

Resources:
    ~ 1 updated
    4 unchanged

Duration: 1m27s
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And when you're finished experimenting, you can tear everything down in just a few seconds with a <a href="https://www.pulumi.com/docs/reference/cli/pulumi_destroy">}}"><code>pulumi destroy</code></a>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nv">$ </span>pulumi destroy

Destroying <span class="o">(</span>dev<span class="o">)</span>

     Type                                    Name              Status
 -   pulumi:pulumi:Stack                     grocery-list-dev  deleted
 -   ├─ digitalocean:index:DatabaseFirewall  trusted-source    deleted
 -   ├─ digitalocean:index:DatabaseDb        db                deleted
 -   ├─ digitalocean:index:App               app               deleted
 -   └─ digitalocean:index:DatabaseCluster   cluster           deleted

Resources:
    - 5 deleted

Duration: 19s
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="wrapping-up-and-next-steps" href="#wrapping-up-and-next-steps">
  </a>
  Wrapping up, and next steps
</h2>

<p>Hopefully this gives you a sense of the kinds of things you can do with Pulumi and DigitalOcean—and I definitely encourage you to spend a little time with the <a href="https://docs.digitalocean.com/products/app-platform/">App Platform docs</a> to dig a bit deeper into some of these concepts and explore a few others we weren't able to cover. You'll find the <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">full source for this walkthrough on GitHub</a>, of course, with <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/tree/finished"><code>finished</code> branch</a> containing the completed Pulumi program for reference.</p>

<p>From here, you might think about:</p>

<ul>
<li><p>Adding a <a href="https://www.pulumi.com/registry/packages/digitalocean/api-docs/dnsrecord"><code>digitalocean.DnsRecord</code></a> to give your app a <a href="https://docs.digitalocean.com/products/networking/dns/">custom domain name</a>.</p></li>
<li><p>Creating a second stack with <a href="https://www.pulumi.com/docs/reference/cli/pulumi_stack_init"><code>pulumi stack init</code></a> and adjusting the program to make the source <code>branch</code> configurable—a <code>production</code> stack, say, designed to deploy in response to commits to a <code>release</code> branch.</p></li>
<li><p>Using Pulumi's <a href="https://www.pulumi.com/docs/guides/continuous-delivery/github-actions">GitHub Action</a> to run previews and updates as part of a pull-request based workflow.</p></li>
</ul>

<p>Happy coding!</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/cnunciato/fullstack-pulumi-deploying-the-mern-stack-on-digitalocean-40mk" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(a,n,e,s,t){return t.type_of="article",t.id=1022599,t.title="Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean",t.description="As a developer, I get lots of ideas for web apps—little things, mostly: nifty ways to keep track of...",t.readable_publish_date="Mar 14",t.slug="fullstack-pulumi-deploying-the-mern-stack-on-digitalocean-40mk",t.path="/pulumi/fullstack-pulumi-deploying-the-mern-stack-on-digitalocean-40mk",t.url="https://dev.to/pulumi/fullstack-pulumi-deploying-the-mern-stack-on-digitalocean-40mk",t.comments_count=0,t.public_reactions_count=9,t.collection_id=a,t.published_timestamp=n,t.positive_reactions_count=9,t.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--4o8GYKcN--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/qu9erqi66s6uw9c7h1hl.png",t.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--s2yxSh1N--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/qu9erqi66s6uw9c7h1hl.png",t.canonical_url="https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/",t.created_at=n,t.edited_at="2022-03-14T19:14:59Z",t.crossposted_at=a,t.published_at=n,t.last_comment_at=n,t.reading_time_minutes=15,t.tag_list="pulumi, fullstack, mern, digitalocean",t.tags=[e,"fullstack","mern","digitalocean"],t.body_html='<p>As a developer, I get lots of ideas for web apps—little things, mostly: nifty ways to keep track of my kids\' allowances, habit trackers, shopping lists. Most of them, however, never see the light of day, and not just because I\'m lazy; I also tend to get hung up trying to decide what to use for the technology stack.</p>\n\n<p>And as a JavaScript developer, I certainly have options—too many, in fact, and that\'s part of the problem. Having roughly a hundred and fifty million libraries and frameworks to choose from is definitely better than having none, but at the same time, all that choice can make the actual choosing rather difficult. Which is why, when I just want to get something done, I\'ll often reach for a combination of tools known as <a href="https://www.mongodb.com/mern-stack">the MERN stack</a>.</p>\n\n<p>MERN-stack apps are three-tier web apps built with <a href="https://www.mongodb.com/">MongoDB</a>, <a href="https://expressjs.com/">Express</a>, <a href="https://reactjs.org/">React</a>, and <a href="https://nodejs.org/">Node.js</a>. You can read all about them <a href="https://www.mongodb.com/mern-stack">in the MongoDB docs</a>, but the gist is that they allow you use one language—JavaScript (or TypeScript, if you like)—to manage all three layers of the application stack: the front end as a single-page app built statically with React, the back end as a REST API managed with Express, and the database as a collection of JSON-like documents with MongoDB. MERN might not <em>always</em> the right tool for the job, but for the kinds of apps I tend to find myself building, it generally works out pretty well.</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8nlc5TzF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/tiers.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8nlc5TzF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/tiers.png" alt="The tiers of a typical web application: front end, back end, and database" loading="lazy" width="880" height="592"></a></p>\n\n<p>Still, once I\'m <em>finished</em> building my app, I\'m often faced with a whole other problem: figuring out how to get the app off of my laptop and onto the web.</p>\n\n<p>The cloud hasn\'t made this an easy task for developers. Choosing a cloud provider, deciding which resources to use (and how to use them), setting up networking, debugging permissions, navigating billing, and all the rest, can be overwhelming—and that\'s before you\'ve given a single thought to anything having to do with automation or infrastructure as code. What we want, I think, is to be able to focus on our apps, and we\'re ready to ship, push our code to a repository and wait patiently for a URL to emerge that we can paste into a browser and have everything <em>just work</em>.</p>\n\n<p>Which is why I was so delighted when I discovered <a href="https://www.digitalocean.com/products/app-platform">DigitalOcean\'s App Platform</a>.</p>\n\n<p>If you\'ve used DigitalOcean before, you know it\'s all about making infrastructure more accessible to developers. What you may not know, though, or at least I didn\'t myself until recently, is that you can do a lot more with DigitalOcean than just <a href="https://www.digitalocean.com/products/droplets">virtual machines</a>. A <a href="https://www.digitalocean.com/blog/introducing-digitalocean-app-platform-reimagining-paas-to-make-it-simpler-for-you-to-build-deploy-and-scale-apps">fairly new</a>, fully-managed platform service (think <a href="https://heroku.com">Heroku</a>), App Platform gives you a set of high-level abstractions built to align with the tiers of a typical web application, which means you can focus on what you care about most—your app—and leave the infrastructure and its management to someone else. It\'s a compelling option for anyone looking to deploy and manage any web application (MERN or otherwise), and as you\'ll see, with Pulumi and a little bit of code, you can easily do so without ever having to leave the comfort of your IDE.</p>\n\n<p>So let\'s build ourselves a MERN app and deploy it on DigitalOcean with Pulumi. Given the goal is to focus primarily on the infrastructure and how to code it, we\'ll start with a pre-baked web application (a simple grocery list), and we\'ll map its tiers to App Platform constructs and wire everything up with Pulumi.</p>\n\n<h2>\n  <a name="first-steps-setting-up" href="#first-steps-setting-up">\n  </a>\n  First steps: setting up\n</h2>\n\n<p>The code for this walkthrough is <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">available as a template repository on GitHub</a>, so if you want to follow along (and you should!), you should <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/generate">grab a copy of your own</a> to work with by forking the repository or creating a new one from the template. Once you\'ve done that, you should also:</p>\n\n<ul>\n<li>\n<a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">Clone the repository</a> to your local machine.</li>\n<li>\n<a href="https://www.pulumi.com/docs/get-started/install">Install Pulumi</a> and <a href="https://nodejs.org/">Node.js</a>.</li>\n<li>\n<a href="//cloud.digitalocean.com/">Sign into DigitalOcean</a> and obtain a <a href="https://cloud.digitalocean.com/account/api/tokens">personal access token</a> with read-write permissions.</li>\n<li>Grant DigitalOcean access to your GitHub repository by <a href="https://cloud.digitalocean.com/apps">visiting the Apps page</a>, choosing Create App, and following the steps to install DigitalOcean\'s GitHub app.</li>\n<li>Optionally, if you\'d like to develop the application locally as well, <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/">install and configure MongoDB Community Edition</a>.</li>\n</ul>\n\n<p>One thing to note: Since we\'ll be provisioning real DigitalOcean resources, there\'s a chance you could incur a slight cost for what you use. However, as we\'ll be using the least expensive plan settings available, and tearing everything down when we\'re through, that cost shouldn\'t amount to more than a few pennies or so.</p>\n\n<p>Let\'s get started.</p>\n\n<h2>\n  <a name="cloning-and-inspecting-the-repository" href="#cloning-and-inspecting-the-repository">\n  </a>\n  Cloning and inspecting the repository\n</h2>\n\n<p>Once you\'ve cloned your copy of the template repository and navigated to the root, you\'ll see a couple of files and folders that look something like this:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code>├── frontend\n├── backend\n└── package.json\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The <code>frontend</code> folder contains the React application, and its job is to render the list of groceries and give you something to interact with (to add items, check them off, delete them, and so on). The scaffolding for the app was generated with a tool called <a href="https://vitejs.dev/">Vite</a>, and all of its logic—form fields, click handlers, API calls, etc.—is contained in <code>src/App.tsx</code>.</p>\n\n<p>The <code>backend</code> folder contains the Express application that defines the REST API. It sets up four API <a href="https://expressjs.com/en/guide/routing.html">routes</a> to handle the <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations you\'d expect in an app like this one:</p>\n\n<ul>\n<li>\n<code>GET /api/items</code> fetches all items from the database and returns them as a JSON array.</li>\n<li>\n<code>POST /api/items</code> accepts a new item and writes it to the database.</li>\n<li>\n<code>PUT /api/items/:id</code> updates an existing item (to toggle its checked/unchecked status).</li>\n<li>\n<code>DELETE /api/items/:id</code> deletes an item from the database.</li>\n</ul>\n\n<p>The back end supports three configurable properties as well, all of which are exposed as optional environment variables:</p>\n\n<ul>\n<li>\n<code>BACKEND_SERVICE_PORT</code>, which defaults to <code>8000</code>\n</li>\n<li>\n<code>BACKEND_ROUTE_PREFIX</code>, which defaults to <code>/api</code>\n</li>\n<li>\n<code>DATABASE_URL</code>, which defaults to <code>mongodb://127.0.0.1</code> for local development</li>\n</ul>\n\n<h2>\n  <a name="running-the-application-locally-optional" href="#running-the-application-locally-optional">\n  </a>\n  Running the application locally (optional)\n</h2>\n\n<p>You don\'t have to do this, but if you\'d like to, here\'s how. After <a href="https://docs.mongodb.com/manual/administration/install-community/">installing MongoDB and starting the service</a> (which should be listening by default on port <code>27107</code>), you can install all front-end and back-end dependencies and start the development server:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>npm <span class="nb">install</span>\n<span class="nv">$ </span>npm start\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With the development server running, you can browse to <a href="http://localhost:3000">http://localhost:3000</a> and see the app:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--aCCe24hD--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--aCCe24hD--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost.png" alt="The application running in a browser on localhost" loading="lazy" width="880" height="516"></a></p>\n\n<p>The front-end and back-end dev servers are set up to compile your TypeScript to JavaScript automatically, and the front-end server is configured to proxy the back-end service (which runs at <code>http://localhost:8000</code>) at a root-relative path of <code>/api</code>. Proxying the API in this way lets you avoid having to wrestle with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>-related issues, and as you\'ll see when we deploy to DigitalOcean later, App Platform conveniently supports the same configuration out of the box.</p>\n\n<p>Try adding a few items and marking them off, just to make sure everything\'s working as expected. If you\'ve got a MongoDB client installed as well—I generally use <a href="https://www.mongodb.com/products/compass">MongoDB Compass</a>—you should be able to find the <code>grocery-list</code> database and see the <code>items</code> collection filling up with delicious foods:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vHPcX1G3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost-db.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vHPcX1G3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost-db.png" alt="MongoDB Compass, showing the grocery-list database and the items collection" loading="lazy" width="880" height="536"></a></p>\n\n<p>Now let\'s have a look at how to go about deploying this stuff.</p>\n\n<h2>\n  <a name="charting-a-course" href="#charting-a-course">\n  </a>\n  Charting a course\n</h2>\n\n<p>Earlier I mentioned that every cloud provider handles application deployment a little differently, sometimes in multiple ways, and that\'s true for DigitalOcean as well. You <em>could</em> deploy the front end as a <a href="https://www.digitalocean.com/products/spaces">DigitalOcean Space</a>, or both the front end and back end (and even the database) as a <a href="https://www.digitalocean.com/products/droplets">DigitalOcean Droplet</a>. But given the shape of this application, the best fit is really is <a href="https://docs.digitalocean.com/products/app-platform/concepts/">App Platform</a>, for several reasons.</p>\n\n<p>One is that because App Platform apps are comprised these high-level <a href="https://docs.digitalocean.com/products/app-platform/concepts/"><em>components</em></a>—abstractions like <a href="https://docs.digitalocean.com/products/app-platform/concepts/static-site/">static site</a>, <a href="https://docs.digitalocean.com/products/app-platform/concepts/service/">service</a>, and <a href="https://docs.digitalocean.com/products/app-platform/concepts/database/">database</a>—it\'s pretty much purpose-built for an application like this one, and DigitalOcean customizes the deployment of each component based according to its type. Static websites are distributed and cached on DigitalOcean\'s CDN, services are packaged and delivered as containers (with its <a href="https://www.digitalocean.com/products/kubernetes">Kubernetes</a> platform), and databases are deployed as configurable managed services. All of this means you\'re not only able to stay focused on the application itself, but you\'re able to scale each one of these components up or down however you like, and even delegate your front-end and back-end build processes to DigitalOcean to be handled in response to commits on one or more external Git repositories.</p>\n\n<p>App Platform apps can be configured in one of two ways: manually, by configuring their components individually in the DigitalOcean web console, or programmatically, in the form of an App Platform <a href="https://docs.digitalocean.com/products/app-platform/concepts/app-spec/"><em>spec</em></a>, a JSON document submitted over DigitalOcean\'s <a href="https://docs.digitalocean.com/reference/api/api-reference/">REST API</a>. In our case, we\'ll indirectly go the latter route, using Pulumi with the <a href="https://www.pulumi.com/registry/packages/digitalocean">DigitalOcean provider package</a> to define an app spec comprised of three components:</p>\n\n<ul>\n<li>A <code>staticSite</code> component mapped to the <code>frontend</code> folder</li>\n<li>A <code>service</code> component mapped to the <code>backend</code> folder</li>\n<li>A <code>database</code> component mapped to a managed MongoDB cluster (which we\'ll also configure to be accessible only by the <code>service</code> component)</li>\n</ul>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--UA5oCCa4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/mapped-tiers.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--UA5oCCa4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/mapped-tiers.png" alt="Front end, back end, and database tiers mapped to their corresponding App Platform components" loading="lazy" width="880" height="490"></a></p>\n\n<p>And once deployed, it\'ll all be available at a single DigitalOcean-provided URL.</p>\n\n<p>Let\'s begin by creating new Pulumi project.</p>\n\n<h2>\n  <a name="creating-the-project" href="#creating-the-project">\n  </a>\n  Creating the project\n</h2>\n\n<p>In the root of the repository, make a new folder called <code>infra</code>, change to it, then run <code>pulumi new</code> using the <code>digitalocean</code> <a href="https://github.com/pulumi/templates">project template</a>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">mkdir </span>infra <span class="o">&amp;&amp;</span> <span class="nb">cd </span>infra\n<span class="nv">$ </span>pulumi new digitalocean-typescript\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>At the prompts, use the following values:</p>\n\n<ul>\n<li>For project name, use <code>grocery-list</code>\n</li>\n<li>For description, use <code>Deploying a MERN-stack app on DigitalOcean</code>\n</li>\n<li>For stack name, use <code>dev</code>, the default</li>\n</ul>\n\n<p>When the command completes, you\'ll have a new <a href="https://www.pulumi.com/docs/intro/concepts/stack">Pulumi stack</a>, but you\'ll still have a few things to configure. For one, the Pulumi DigitalOcean provider needs to be <a href="https://www.pulumi.com/registry/packages/digitalocean/installation-configuration">configured</a> to communicate with DigitalOcean on your behalf (to provision your app and its various resources). For this, you can use the access token you obtained <a href="#first-steps-setting-up">earlier</a> from the DigitalOcean console, and you can apply it by setting a single environment variable:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">DIGITALOCEAN_TOKEN</span><span class="o">=</span><span class="s2">"your-access-token"</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Also, since one of our goals is to have App Platform deploy automatically on every GitHub commit, you\'ll need to tell DigitalOcean where to find the source code for your front- and back-end components. You <em>could</em> bake these settings right into the Pulumi program itself, but it\'d be better to apply them as stack-specific configuration settings, as that\'d let you deploy to different stacks later (say, in CI) based on the branch of the commit. Everyone does this a little differently, so for now, let\'s configure the currently selected stack (which should be <code>dev</code>) to use the default branch of your GitHub repository:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>pulumi config <span class="nb">set </span>repo <span class="s2">"your-github-org/your-github-repo"</span> <span class="c"># e.g., cnunciato/fullstack-pulumi-mern-digitalocean</span>\n<span class="nv">$ </span>pulumi config <span class="nb">set </span>branch <span class="s2">"your-main-branch"</span>               <span class="c"># e.g., main</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With these values in place, you\'re ready to start writing the program.</p>\n\n<blockquote>\n<p>App Platform also supports GitLab and other Git-based repositories as well. See the <a href="https://docs.digitalocean.com/products/app-platform/references/app-specification-reference/">App Specification docs</a> for details.</p>\n</blockquote>\n\n<h2>\n  <a name="writing-the-program" href="#writing-the-program">\n  </a>\n  Writing the program\n</h2>\n\n<p>In your IDE of choice, open <code>index.ts</code> and replace the sample code with the following lines to import the Pulumi and DigitalOcean SDKs and the configuration values you just set, and add a line to specify the <a href="https://docs.digitalocean.com/products/platform/availability-matrix/">DigitalOcean region</a> to deploy into:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">pulumi</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@pulumi/pulumi</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">digitalocean</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@pulumi/digitalocean</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="c1">// Our stack-specific configuration.</span>\n<span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pulumi</span><span class="p">.</span><span class="nx">Config</span><span class="p">();</span>\n<span class="kd">const</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">repo</span><span class="dl">"</span><span class="p">);</span>\n<span class="kd">const</span> <span class="nx">branch</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">branch</span><span class="dl">"</span><span class="p">);</span>\n\n<span class="c1">// The DigitalOcean region to deploy into.</span>\n<span class="kd">const</span> <span class="nx">region</span> <span class="o">=</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">Region</span><span class="p">.</span><span class="nx">SFO3</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Next, add a few lines to <a href="https://docs.digitalocean.com/products/databases/mongodb/how-to/create/">declare the managed MongoDB cluster</a>. We\'ll use just one node for now—additional replica nodes can easily be added later by increasing the <code>nodeCount</code> value—and go with the least expensive <a href="https://www.digitalocean.com/pricing#managed-databases">performance settings</a>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ...</span>\n\n<span class="c1">// Our MongoDB cluster (currently just one node).</span>\n<span class="kd">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseCluster</span><span class="p">(</span><span class="dl">"</span><span class="s2">cluster</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>\n    <span class="na">engine</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mongodb</span><span class="dl">"</span><span class="p">,</span>\n    <span class="na">version</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">,</span>\n    <span class="nx">region</span><span class="p">,</span>\n    <span class="na">size</span><span class="p">:</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseSlug</span><span class="p">.</span><span class="nx">DB_1VPCU1GB</span><span class="p">,</span>\n    <span class="na">nodeCount</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>\n<span class="p">});</span>\n\n<span class="c1">// The database we\'ll use for our grocery list.</span>\n<span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseDb</span><span class="p">(</span><span class="dl">"</span><span class="s2">db</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>\n    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">grocery-list</span><span class="dl">"</span><span class="p">,</span>\n    <span class="na">clusterId</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now for the App Platform spec itself. Notice the <code>digitalocean.App</code> resource takes just one argument, <code>spec</code>, which defines all three of the components of the app: static site, service, and database. Both the static site and the service are configured to use the same GitHub repository (the <code>sourceDir</code> properties indicate their folders within the repository), and both are configured (via the <code>deployOnPush</code> flag) to be rebuilt and redeployed by DigitalOcean on every commit.</p>\n\n<p>The service has a few additional settings that you can use to manage its runtime behavior and deployment topology as well. As in development, we\'ll configure the service to listen on port 8000 and be available at <code>/api</code>—the entire app will ultimately be proxied transparently by an <a href="https://docs.digitalocean.com/products/app-platform/concepts/load-balancer/">App Platform load balancer</a>—and it\'ll be powered by just one container instance, again using the least expensive <a href="https://docs.digitalocean.com/products/app-platform/">performance settings</a>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ...</span>\n\n<span class="c1">// The App Platform spec that defines our grocery list.</span>\n<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">App</span><span class="p">(</span><span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>\n    <span class="na">spec</span><span class="p">:</span> <span class="p">{</span>\n        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">grocery-list</span><span class="dl">"</span><span class="p">,</span>\n        <span class="na">region</span><span class="p">:</span> <span class="nx">region</span><span class="p">,</span>\n\n        <span class="c1">// The React front end.</span>\n        <span class="na">staticSites</span><span class="p">:</span> <span class="p">[</span>\n            <span class="p">{</span>\n                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">frontend</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">github</span><span class="p">:</span> <span class="p">{</span>\n                    <span class="nx">repo</span><span class="p">,</span>\n                    <span class="nx">branch</span><span class="p">,</span>\n                    <span class="na">deployOnPush</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n                <span class="p">},</span>\n                <span class="na">sourceDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/frontend</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">buildCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm install &amp;&amp; npm run build</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">outputDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/dist</span><span class="dl">"</span><span class="p">,</span>\n            <span class="p">}</span>\n        <span class="p">],</span>\n\n        <span class="c1">// The Express back end.</span>\n        <span class="na">services</span><span class="p">:</span> <span class="p">[</span>\n            <span class="p">{</span>\n                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">backend</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">github</span><span class="p">:</span> <span class="p">{</span>\n                    <span class="nx">repo</span><span class="p">,</span>\n                    <span class="nx">branch</span><span class="p">,</span>\n                    <span class="na">deployOnPush</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n                <span class="p">},</span>\n                <span class="na">sourceDir</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/backend</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">buildCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm install &amp;&amp; npm run build</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">runCommand</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm start</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">httpPort</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>\n                <span class="na">routes</span><span class="p">:</span> <span class="p">[</span>\n                    <span class="p">{</span>\n                        <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/api</span><span class="dl">"</span><span class="p">,</span>\n                        <span class="na">preservePathPrefix</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n                    <span class="p">},</span>\n                <span class="p">],</span>\n                <span class="na">instanceSizeSlug</span><span class="p">:</span> <span class="dl">"</span><span class="s2">basic-xxs</span><span class="dl">"</span><span class="p">,</span>\n                <span class="na">instanceCount</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>\n\n                <span class="c1">// To connect to MongoDB, the service needs a DATABASE_URL, which</span>\n                <span class="c1">// is conveniently exposed as an environment variable thanks to its</span>\n                <span class="c1">// membership in this app spec (below). The CA_CERT value enables</span>\n                <span class="c1">// a secure connection between API service and database.</span>\n                <span class="na">envs</span><span class="p">:</span> <span class="p">[</span>\n                    <span class="p">{</span>\n                        <span class="na">key</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DATABASE_URL</span><span class="dl">"</span><span class="p">,</span>\n                        <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">RUN_AND_BUILD_TIME</span><span class="dl">"</span><span class="p">,</span>\n                        <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">${db.DATABASE_URL}</span><span class="dl">"</span><span class="p">,</span>\n                    <span class="p">},</span>\n                    <span class="p">{</span>\n                        <span class="na">key</span><span class="p">:</span> <span class="dl">"</span><span class="s2">CA_CERT</span><span class="dl">"</span><span class="p">,</span>\n                        <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">RUN_AND_BUILD_TIME</span><span class="dl">"</span><span class="p">,</span>\n                        <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">${db.CA_CERT}</span><span class="dl">"</span><span class="p">,</span>\n                    <span class="p">},</span>\n                <span class="p">],</span>\n            <span class="p">},</span>\n        <span class="p">],</span>\n\n        <span class="c1">// Include the MongoDB cluster as an integrated App Platform component.</span>\n        <span class="na">databases</span><span class="p">:</span> <span class="p">[</span>\n            <span class="p">{</span>\n                <span class="c1">// The name `db` defines the prefix of the tokens used (above) to</span>\n                <span class="c1">// read the environment variables exposed by the database cluster.</span>\n                <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">db</span><span class="dl">"</span><span class="p">,</span>\n\n                <span class="c1">// MongoDB clusters are only available in "production" mode.</span>\n                <span class="c1">// https://docs.digitalocean.com/products/app-platform/concepts/database/</span>\n                <span class="na">production</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n\n                <span class="c1">// A reference to the `DatabaseCluster` we declared above.</span>\n                <span class="na">clusterName</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>\n\n                <span class="c1">// The engine value must be uppercase, so we transform it with JS.</span>\n                <span class="na">engine</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">engine</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">engine</span> <span class="o">=&gt;</span> <span class="nx">engine</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()),</span>\n            <span class="p">}</span>\n        <span class="p">]</span>\n    <span class="p">},</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Technically that\'s all we need to configure the application—but it wouldn\'t be a bad idea to add one last thing.</p>\n\n<p>By default, managed MongoDB clusters are configured to be publicly accessible—which is great if you need to be able to connect one yourself, but not so great as a strategy for preventing internet miscreants from doing the same. You can fix this easily by adding a <code>DatabaseFirewall</code> resource to declare the app as a <a href="https://docs.digitalocean.com/products/app-platform/how-to/manage-databases/"><em>trusted source</em></a>, thereby rejecting all inbound traffic originating from elsewhere:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ...</span>\n\n<span class="c1">// Adding a database firewall setting grants access solely to our app.</span>\n<span class="kd">const</span> <span class="nx">trustedSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">digitalocean</span><span class="p">.</span><span class="nx">DatabaseFirewall</span><span class="p">(</span><span class="dl">"</span><span class="s2">trusted-source</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>\n    <span class="na">clusterId</span><span class="p">:</span> <span class="nx">cluster</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>\n    <span class="na">rules</span><span class="p">:</span> <span class="p">[</span>\n        <span class="p">{</span>\n            <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span>\n            <span class="na">value</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>\n        <span class="p">},</span>\n    <span class="p">],</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And finally, add one last line to export the app URL, to be generated by DigitalOcean, as a Pulumi <a href="https://www.pulumi.com/docs/intro/concepts/inputs-outputs">stack output</a>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ...</span>\n\n<span class="c1">// The DigitalOcean-assigned URL for our app.</span>\n<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span> <span class="nx">liveUrl</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">app</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With that, you\'re ready to deploy.</p>\n\n<h2>\n  <a name="deploying" href="#deploying">\n  </a>\n  Deploying\n</h2>\n\n<p>Quickly, to recap, here\'s what we\'ve done so far:</p>\n\n<ul>\n<li>We took a pre-baked MERN app configured to run on <code>localhost</code>.</li>\n<li>We mapped the tiers of that app to their corresponding App Platform components.</li>\n<li>We wrote a Pulumi program to codify that mapping as an App Platform spec and a managed MongoDB cluster to go along with it.</li>\n</ul>\n\n<p>When you deploy this app in a moment with <a href="https://www.pulumi.com/docs/reference/cli/pulumi_up"><code>pulumi up</code></a>, Pulumi will provision a new MongoDB cluster (which usually takes a few minutes), and then once that\'s available, DigitalOcean will take our spec and use it to fetch the components of the app from GitHub at the specified branch and build them. From that point forward, any commit you make to that branch will trigger DigitalOcean to fetch, rebuild, and redeploy the app automatically.</p>\n\n<p>Make sure you\'ve installed the DigitalOcean GitHub app as described above—you should see it listed at <a href="https://github.com/settings/installations">https://github.com/settings/installations</a>:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--mg41LjNY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/digitalocean-github-app.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--mg41LjNY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/digitalocean-github-app.png" alt="The Applications tab on GitHub, showing the DigitalOcean app installed" loading="lazy" width="880" height="478"></a></p>\n\n<p>Now return to the command line and run <code>pulumi up</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>pulumi up\n\nPreviewing update <span class="o">(</span>dev<span class="o">)</span>\n\nView Live: https://app.pulumi.com/cnunciato/grocery-list/dev/previews/605bf32a-95b1-4221-bc35-0e667b30f38a\n\n     Type                                    Name              Plan\n +   pulumi:pulumi:Stack                     grocery-list-dev  create\n +   ├─ digitalocean:index:DatabaseCluster   cluster           create\n +   ├─ digitalocean:index:DatabaseDb        db                create\n +   ├─ digitalocean:index:App               app               create\n +   └─ digitalocean:index:DatabaseFirewall  trusted-source    create\n\nResources:\n    + 5 to create\n\nDo you want to perform this update?\n<span class="o">&gt;</span> <span class="nb">yes\n\n</span>Updating <span class="o">(</span>dev<span class="o">)</span>\n\nView Live: https://app.pulumi.com/cnunciato/grocery-list/dev/updates/1\n\n     Type                                    Name              Status\n     pulumi:pulumi:Stack                     grocery-list-dev\n +   ├─ digitalocean:index:App               app               created\n +   └─ digitalocean:index:DatabaseFirewall  trusted-source    created\n\nOutputs:\n  + liveUrl: <span class="s2">"https://grocery-list-fb9bd.ondigitalocean.app"</span>\n\nResources:\n    + 2 created\n    3 unchanged\n\nDuration: 2m30s\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Again, it\'ll probably take a few minutes to get everything spun up for the first time, but when the process completes, you\'ll have a working app at the URL provided by DigitalOcean, emitted as a Pulumi stack output:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>open <span class="si">$(</span>pulumi stack output liveUrl<span class="si">)</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vEr4C5Ua--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/deployed.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vEr4C5Ua--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/deployed.png" alt="The app now running in the DigitalOcean cloud" loading="lazy" width="880" height="496"></a></p>\n\n<p>You should also be able to explore your shiny new grocery-list app in the DigitalOcean Console, with all three of its components (and their build-time and runtime logs!) now represented:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--iRswh7-O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/in-the-console.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--iRswh7-O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/in-the-console.png" alt="The grocery-list app and its components in the DigitalOcean console" loading="lazy" width="880" height="672"></a></p>\n\n<p>Now try making a commit to your repository (any commit will do, but ideally one to the <code>frontend</code> or <code>backend</code> folder), and watch as the app redeploys automatically:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ExAGUON6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/redeploying.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ExAGUON6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/redeploying.png" alt="App Platform rebuilding the app in response to a GitHub commit" loading="lazy" width="880" height="723"></a></p>\n\n<p>And finally, try scaling the service by bumping the <code>instanceCount</code> from <code>1</code> to <code>2</code> in the code—or better, if you\'re up for it, making that value configurable by stack:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight diff"><code>  const config = new pulumi.Config();\n  const repo = config.require("repo");\n  const branch = config.require("branch");\n<span class="gi">+ const serviceInstanceCount = config.requireNumber("service_instance_count");\n</span>  ...\n        services: [\n            digitalocean.AppSpecServiceArgs(\n                ...\n<span class="gi">+               instanceCount: serviceInstanceCount,\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>pulumi config <span class="nb">set </span>service_instance_count 2\n\n<span class="nv">$ </span>pulumi up\n\nUpdating <span class="o">(</span>dev<span class="o">)</span>\n\n     Type                       Name              Status      Info\n     pulumi:pulumi:Stack        grocery-list-dev\n ~   └─ digitalocean:index:App  app               updated     <span class="o">[</span>diff: ~spec]\n\nOutputs:\n    liveUrl: <span class="s2">"https://grocery-list-fb9bd.ondigitalocean.app"</span>\n\nResources:\n    ~ 1 updated\n    4 unchanged\n\nDuration: 1m27s\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And when you\'re finished experimenting, you can tear everything down in just a few seconds with a <a href="https://www.pulumi.com/docs/reference/cli/pulumi_destroy">}}"&gt;<code>pulumi destroy</code></a>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nv">$ </span>pulumi destroy\n\nDestroying <span class="o">(</span>dev<span class="o">)</span>\n\n     Type                                    Name              Status\n -   pulumi:pulumi:Stack                     grocery-list-dev  deleted\n -   ├─ digitalocean:index:DatabaseFirewall  trusted-source    deleted\n -   ├─ digitalocean:index:DatabaseDb        db                deleted\n -   ├─ digitalocean:index:App               app               deleted\n -   └─ digitalocean:index:DatabaseCluster   cluster           deleted\n\nResources:\n    - 5 deleted\n\nDuration: 19s\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="wrapping-up-and-next-steps" href="#wrapping-up-and-next-steps">\n  </a>\n  Wrapping up, and next steps\n</h2>\n\n<p>Hopefully this gives you a sense of the kinds of things you can do with Pulumi and DigitalOcean—and I definitely encourage you to spend a little time with the <a href="https://docs.digitalocean.com/products/app-platform/">App Platform docs</a> to dig a bit deeper into some of these concepts and explore a few others we weren\'t able to cover. You\'ll find the <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean">full source for this walkthrough on GitHub</a>, of course, with <a href="https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/tree/finished"><code>finished</code> branch</a> containing the completed Pulumi program for reference.</p>\n\n<p>From here, you might think about:</p>\n\n<ul>\n<li><p>Adding a <a href="https://www.pulumi.com/registry/packages/digitalocean/api-docs/dnsrecord"><code>digitalocean.DnsRecord</code></a> to give your app a <a href="https://docs.digitalocean.com/products/networking/dns/">custom domain name</a>.</p></li>\n<li><p>Creating a second stack with <a href="https://www.pulumi.com/docs/reference/cli/pulumi_stack_init"><code>pulumi stack init</code></a> and adjusting the program to make the source <code>branch</code> configurable—a <code>production</code> stack, say, designed to deploy in response to commits to a <code>release</code> branch.</p></li>\n<li><p>Using Pulumi\'s <a href="https://www.pulumi.com/docs/guides/continuous-delivery/github-actions">GitHub Action</a> to run previews and updates as part of a pull-request based workflow.</p></li>\n</ul>\n\n<p>Happy coding!</p>\n\n',t.body_markdown='As a developer, I get lots of ideas for web apps&mdash;little things, mostly: nifty ways to keep track of my kids\' allowances, habit trackers, shopping lists. Most of them, however, never see the light of day, and not just because I\'m lazy; I also tend to get hung up trying to decide what to use for the technology stack.\n\nAnd as a JavaScript developer, I certainly have options&mdash;too many, in fact, and that\'s part of the problem. Having roughly a hundred and fifty million libraries and frameworks to choose from is definitely better than having none, but at the same time, all that choice can make the actual choosing rather difficult. Which is why, when I just want to get something done, I\'ll often reach for a combination of tools known as [the MERN stack](https://www.mongodb.com/mern-stack).\n\nMERN-stack apps are three-tier web apps built with [MongoDB](https://www.mongodb.com/), [Express](https://expressjs.com/), [React](https://reactjs.org/), and [Node.js](https://nodejs.org/). You can read all about them [in the MongoDB docs](https://www.mongodb.com/mern-stack), but the gist is that they allow you use one language&mdash;JavaScript (or TypeScript, if you like)&mdash;to manage all three layers of the application stack: the front end as a single-page app built statically with React, the back end as a REST API managed with Express, and the database as a collection of JSON-like documents with MongoDB. MERN might not _always_ the right tool for the job, but for the kinds of apps I tend to find myself building, it generally works out pretty well.\n\n![The tiers of a typical web application: front end, back end, and database](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/tiers.png)\n\nStill, once I\'m _finished_ building my app, I\'m often faced with a whole other problem: figuring out how to get the app off of my laptop and onto the web.\n\nThe cloud hasn\'t made this an easy task for developers. Choosing a cloud provider, deciding which resources to use (and how to use them), setting up networking, debugging permissions, navigating billing, and all the rest, can be overwhelming&mdash;and that\'s before you\'ve given a single thought to anything having to do with automation or infrastructure as code. What we want, I think, is to be able to focus on our apps, and we\'re ready to ship, push our code to a repository and wait patiently for a URL to emerge that we can paste into a browser and have everything _just work_.\n\nWhich is why I was so delighted when I discovered [DigitalOcean\'s App Platform](https://www.digitalocean.com/products/app-platform).\n\nIf you\'ve used DigitalOcean before, you know it\'s all about making infrastructure more accessible to developers. What you may not know, though, or at least I didn\'t myself until recently, is that you can do a lot more with DigitalOcean than just [virtual machines](https://www.digitalocean.com/products/droplets). A [fairly new](https://www.digitalocean.com/blog/introducing-digitalocean-app-platform-reimagining-paas-to-make-it-simpler-for-you-to-build-deploy-and-scale-apps), fully-managed platform service (think [Heroku](https://heroku.com)), App Platform gives you a set of high-level abstractions built to align with the tiers of a typical web application, which means you can focus on what you care about most&mdash;your app&mdash;and leave the infrastructure and its management to someone else. It\'s a compelling option for anyone looking to deploy and manage any web application (MERN or otherwise), and as you\'ll see, with Pulumi and a little bit of code, you can easily do so without ever having to leave the comfort of your IDE.\n\nSo let\'s build ourselves a MERN app and deploy it on DigitalOcean with Pulumi. Given the goal is to focus primarily on the infrastructure and how to code it, we\'ll start with a pre-baked web application (a simple grocery list), and we\'ll map its tiers to App Platform constructs and wire everything up with Pulumi.\n\n## First steps: setting up\n\nThe code for this walkthrough is [available as a template repository on GitHub](https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean), so if you want to follow along (and you should!), you should [grab a copy of your own](https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/generate) to work with by forking the repository or creating a new one from the template. Once you\'ve done that, you should also:\n\n* [Clone the repository](https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean) to your local machine.\n* [Install Pulumi](https://www.pulumi.com/docs/get-started/install) and [Node.js](https://nodejs.org/).\n* [Sign into DigitalOcean](cloud.digitalocean.com/) and obtain a [personal access token](https://cloud.digitalocean.com/account/api/tokens) with read-write permissions.\n* Grant DigitalOcean access to your GitHub repository by [visiting the Apps page](https://cloud.digitalocean.com/apps), choosing Create App, and following the steps to install DigitalOcean\'s GitHub app.\n* Optionally, if you\'d like to develop the application locally as well, [install and configure MongoDB Community Edition](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/).\n\nOne thing to note: Since we\'ll be provisioning real DigitalOcean resources, there\'s a chance you could incur a slight cost for what you use. However, as we\'ll be using the least expensive plan settings available, and tearing everything down when we\'re through, that cost shouldn\'t amount to more than a few pennies or so.\n\nLet\'s get started.\n\n## Cloning and inspecting the repository\n\nOnce you\'ve cloned your copy of the template repository and navigated to the root, you\'ll see a couple of files and folders that look something like this:\n\n```bash\n├── frontend\n├── backend\n└── package.json\n```\n\nThe `frontend` folder contains the React application, and its job is to render the list of groceries and give you something to interact with (to add items, check them off, delete them, and so on). The scaffolding for the app was generated with a tool called [Vite](https://vitejs.dev/), and all of its logic&mdash;form fields, click handlers, API calls, etc.&mdash;is contained in `src/App.tsx`.\n\nThe `backend` folder contains the Express application that defines the REST API. It sets up four API [routes](https://expressjs.com/en/guide/routing.html) to handle the [CRUD](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete) operations you\'d expect in an app like this one:\n\n* `GET /api/items` fetches all items from the database and returns them as a JSON array.\n* `POST /api/items` accepts a new item and writes it to the database.\n* `PUT /api/items/:id` updates an existing item (to toggle its checked/unchecked status).\n* `DELETE /api/items/:id` deletes an item from the database.\n\nThe back end supports three configurable properties as well, all of which are exposed as optional environment variables:\n\n* `BACKEND_SERVICE_PORT`, which defaults to `8000`\n* `BACKEND_ROUTE_PREFIX`, which defaults to `/api`\n* `DATABASE_URL`, which defaults to `mongodb://127.0.0.1` for local development\n\n## Running the application locally (optional)\n\nYou don\'t have to do this, but if you\'d like to, here\'s how. After [installing MongoDB and starting the service](https://docs.mongodb.com/manual/administration/install-community/) (which should be listening by default on port `27107`), you can install all front-end and back-end dependencies and start the development server:\n\n```bash\n$ npm install\n$ npm start\n```\n\nWith the development server running, you can browse to <http://localhost:3000> and see the app:\n\n![The application running in a browser on localhost](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost.png)\n\nThe front-end and back-end dev servers are set up to compile your TypeScript to JavaScript automatically, and the front-end server is configured to proxy the back-end service (which runs at `http://localhost:8000`) at a root-relative path of `/api`. Proxying the API in this way lets you avoid having to wrestle with [CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)-related issues, and as you\'ll see when we deploy to DigitalOcean later, App Platform conveniently supports the same configuration out of the box.\n\nTry adding a few items and marking them off, just to make sure everything\'s working as expected. If you\'ve got a MongoDB client installed as well&mdash;I generally use [MongoDB Compass](https://www.mongodb.com/products/compass)&mdash;you should be able to find the `grocery-list` database and see the `items` collection filling up with delicious foods:\n\n![MongoDB Compass, showing the grocery-list database and the items collection](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/localhost-db.png)\n\nNow let\'s have a look at how to go about deploying this stuff.\n\n## Charting a course\n\nEarlier I mentioned that every cloud provider handles application deployment a little differently, sometimes in multiple ways, and that\'s true for DigitalOcean as well. You _could_ deploy the front end as a [DigitalOcean Space](https://www.digitalocean.com/products/spaces), or both the front end and back end (and even the database) as a [DigitalOcean Droplet](https://www.digitalocean.com/products/droplets). But given the shape of this application, the best fit is really is [App Platform](https://docs.digitalocean.com/products/app-platform/concepts/), for several reasons.\n\nOne is that because App Platform apps are comprised these high-level [_components_](https://docs.digitalocean.com/products/app-platform/concepts/)&mdash;abstractions like [static site](https://docs.digitalocean.com/products/app-platform/concepts/static-site/), [service](https://docs.digitalocean.com/products/app-platform/concepts/service/), and [database](https://docs.digitalocean.com/products/app-platform/concepts/database/)&mdash;it\'s pretty much purpose-built for an application like this one, and DigitalOcean customizes the deployment of each component based according to its type. Static websites are distributed and cached on DigitalOcean\'s CDN, services are packaged and delivered as containers (with its [Kubernetes](https://www.digitalocean.com/products/kubernetes) platform), and databases are deployed as configurable managed services. All of this means you\'re not only able to stay focused on the application itself, but you\'re able to scale each one of these components up or down however you like, and even delegate your front-end and back-end build processes to DigitalOcean to be handled in response to commits on one or more external Git repositories.\n\nApp Platform apps can be configured in one of two ways: manually, by configuring their components individually in the DigitalOcean web console, or programmatically, in the form of an App Platform [_spec_](https://docs.digitalocean.com/products/app-platform/concepts/app-spec/), a JSON document submitted over DigitalOcean\'s [REST API](https://docs.digitalocean.com/reference/api/api-reference/). In our case, we\'ll indirectly go the latter route, using Pulumi with the [DigitalOcean provider package](https://www.pulumi.com/registry/packages/digitalocean) to define an app spec comprised of three components:\n\n* A `staticSite` component mapped to the `frontend` folder\n* A `service` component mapped to the `backend` folder\n* A `database` component mapped to a managed MongoDB cluster (which we\'ll also configure to be accessible only by the `service` component)\n\n![Front end, back end, and database tiers mapped to their corresponding App Platform components](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/mapped-tiers.png)\n\nAnd once deployed, it\'ll all be available at a single DigitalOcean-provided URL.\n\nLet\'s begin by creating new Pulumi project.\n\n## Creating the project\n\nIn the root of the repository, make a new folder called `infra`, change to it, then run `pulumi new` using the `digitalocean` [project template](https://github.com/pulumi/templates):\n\n```bash\n$ mkdir infra && cd infra\n$ pulumi new digitalocean-typescript\n```\n\nAt the prompts, use the following values:\n\n* For project name, use `grocery-list`\n* For description, use `Deploying a MERN-stack app on DigitalOcean`\n* For stack name, use `dev`, the default\n\nWhen the command completes, you\'ll have a new [Pulumi stack](https://www.pulumi.com/docs/intro/concepts/stack), but you\'ll still have a few things to configure. For one, the Pulumi DigitalOcean provider needs to be [configured](https://www.pulumi.com/registry/packages/digitalocean/installation-configuration) to communicate with DigitalOcean on your behalf (to provision your app and its various resources). For this, you can use the access token you obtained [earlier](#first-steps-setting-up) from the DigitalOcean console, and you can apply it by setting a single environment variable:\n\n```bash\n$ export DIGITALOCEAN_TOKEN="your-access-token"\n```\n\nAlso, since one of our goals is to have App Platform deploy automatically on every GitHub commit, you\'ll need to tell DigitalOcean where to find the source code for your front- and back-end components. You _could_ bake these settings right into the Pulumi program itself, but it\'d be better to apply them as stack-specific configuration settings, as that\'d let you deploy to different stacks later (say, in CI) based on the branch of the commit. Everyone does this a little differently, so for now, let\'s configure the currently selected stack (which should be `dev`) to use the default branch of your GitHub repository:\n\n```bash\n$ pulumi config set repo "your-github-org/your-github-repo" # e.g., cnunciato/fullstack-pulumi-mern-digitalocean\n$ pulumi config set branch "your-main-branch"               # e.g., main\n```\n\nWith these values in place, you\'re ready to start writing the program.\n\n> App Platform also supports GitLab and other Git-based repositories as well. See the [App Specification docs](https://docs.digitalocean.com/products/app-platform/references/app-specification-reference/) for details.\n\n## Writing the program\n\nIn your IDE of choice, open `index.ts` and replace the sample code with the following lines to import the Pulumi and DigitalOcean SDKs and the configuration values you just set, and add a line to specify the [DigitalOcean region](https://docs.digitalocean.com/products/platform/availability-matrix/) to deploy into:\n\n```typescript\nimport * as pulumi from "@pulumi/pulumi";\nimport * as digitalocean from "@pulumi/digitalocean";\n\n// Our stack-specific configuration.\nconst config = new pulumi.Config();\nconst repo = config.require("repo");\nconst branch = config.require("branch");\n\n// The DigitalOcean region to deploy into.\nconst region = digitalocean.Region.SFO3;\n```\n\nNext, add a few lines to [declare the managed MongoDB cluster](https://docs.digitalocean.com/products/databases/mongodb/how-to/create/). We\'ll use just one node for now&mdash;additional replica nodes can easily be added later by increasing the `nodeCount` value&mdash;and go with the least expensive [performance settings](https://www.digitalocean.com/pricing#managed-databases):\n\n```typescript\n// ...\n\n// Our MongoDB cluster (currently just one node).\nconst cluster = new digitalocean.DatabaseCluster("cluster", {\n    engine: "mongodb",\n    version: "4",\n    region,\n    size: digitalocean.DatabaseSlug.DB_1VPCU1GB,\n    nodeCount: 1,\n});\n\n// The database we\'ll use for our grocery list.\nconst db = new digitalocean.DatabaseDb("db", {\n    name: "grocery-list",\n    clusterId: cluster.id,\n});\n```\n\nNow for the App Platform spec itself. Notice the `digitalocean.App` resource takes just one argument, `spec`, which defines all three of the components of the app: static site, service, and database. Both the static site and the service are configured to use the same GitHub repository (the `sourceDir` properties indicate their folders within the repository), and both are configured (via the `deployOnPush` flag) to be rebuilt and redeployed by DigitalOcean on every commit.\n\nThe service has a few additional settings that you can use to manage its runtime behavior and deployment topology as well. As in development, we\'ll configure the service to listen on port 8000 and be available at `/api`&mdash;the entire app will ultimately be proxied transparently by an [App Platform load balancer](https://docs.digitalocean.com/products/app-platform/concepts/load-balancer/)&mdash;and it\'ll be powered by just one container instance, again using the least expensive [performance settings](https://docs.digitalocean.com/products/app-platform/):\n\n```typescript\n// ...\n\n// The App Platform spec that defines our grocery list.\nconst app = new digitalocean.App("app", {\n    spec: {\n        name: "grocery-list",\n        region: region,\n\n        // The React front end.\n        staticSites: [\n            {\n                name: "frontend",\n                github: {\n                    repo,\n                    branch,\n                    deployOnPush: true,\n                },\n                sourceDir: "/frontend",\n                buildCommand: "npm install && npm run build",\n                outputDir: "/dist",\n            }\n        ],\n\n        // The Express back end.\n        services: [\n            {\n                name: "backend",\n                github: {\n                    repo,\n                    branch,\n                    deployOnPush: true,\n                },\n                sourceDir: "/backend",\n                buildCommand: "npm install && npm run build",\n                runCommand: "npm start",\n                httpPort: 8000,\n                routes: [\n                    {\n                        path: "/api",\n                        preservePathPrefix: true,\n                    },\n                ],\n                instanceSizeSlug: "basic-xxs",\n                instanceCount: 1,\n\n                // To connect to MongoDB, the service needs a DATABASE_URL, which\n                // is conveniently exposed as an environment variable thanks to its\n                // membership in this app spec (below). The CA_CERT value enables\n                // a secure connection between API service and database.\n                envs: [\n                    {\n                        key: "DATABASE_URL",\n                        scope: "RUN_AND_BUILD_TIME",\n                        value: "${db.DATABASE_URL}",\n                    },\n                    {\n                        key: "CA_CERT",\n                        scope: "RUN_AND_BUILD_TIME",\n                        value: "${db.CA_CERT}",\n                    },\n                ],\n            },\n        ],\n\n        // Include the MongoDB cluster as an integrated App Platform component.\n        databases: [\n            {\n                // The name `db` defines the prefix of the tokens used (above) to\n                // read the environment variables exposed by the database cluster.\n                name: "db",\n\n                // MongoDB clusters are only available in "production" mode.\n                // https://docs.digitalocean.com/products/app-platform/concepts/database/\n                production: true,\n\n                // A reference to the `DatabaseCluster` we declared above.\n                clusterName: cluster.name,\n\n                // The engine value must be uppercase, so we transform it with JS.\n                engine: cluster.engine.apply(engine => engine.toUpperCase()),\n            }\n        ]\n    },\n});\n```\n\nTechnically that\'s all we need to configure the application&mdash;but it wouldn\'t be a bad idea to add one last thing.\n\nBy default, managed MongoDB clusters are configured to be publicly accessible&mdash;which is great if you need to be able to connect one yourself, but not so great as a strategy for preventing internet miscreants from doing the same. You can fix this easily by adding a `DatabaseFirewall` resource to declare the app as a [_trusted source_](https://docs.digitalocean.com/products/app-platform/how-to/manage-databases/), thereby rejecting all inbound traffic originating from elsewhere:\n\n```typescript\n// ...\n\n// Adding a database firewall setting grants access solely to our app.\nconst trustedSource = new digitalocean.DatabaseFirewall("trusted-source", {\n    clusterId: cluster.id,\n    rules: [\n        {\n            type: "app",\n            value: app.id,\n        },\n    ],\n});\n```\n\nAnd finally, add one last line to export the app URL, to be generated by DigitalOcean, as a Pulumi [stack output](https://www.pulumi.com/docs/intro/concepts/inputs-outputs):\n\n```typescript\n// ...\n\n// The DigitalOcean-assigned URL for our app.\nexport const { liveUrl } = app;\n```\n\nWith that, you\'re ready to deploy.\n\n## Deploying\n\nQuickly, to recap, here\'s what we\'ve done so far:\n\n* We took a pre-baked MERN app configured to run on `localhost`.\n* We mapped the tiers of that app to their corresponding App Platform components.\n* We wrote a Pulumi program to codify that mapping as an App Platform spec and a managed MongoDB cluster to go along with it.\n\nWhen you deploy this app in a moment with [`pulumi up`](https://www.pulumi.com/docs/reference/cli/pulumi_up), Pulumi will provision a new MongoDB cluster (which usually takes a few minutes), and then once that\'s available, DigitalOcean will take our spec and use it to fetch the components of the app from GitHub at the specified branch and build them. From that point forward, any commit you make to that branch will trigger DigitalOcean to fetch, rebuild, and redeploy the app automatically.\n\nMake sure you\'ve installed the DigitalOcean GitHub app as described above&mdash;you should see it listed at <https://github.com/settings/installations>:\n\n![The Applications tab on GitHub, showing the DigitalOcean app installed](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/digitalocean-github-app.png)\n\nNow return to the command line and run `pulumi up`:\n\n```bash\n$ pulumi up\n\nPreviewing update (dev)\n\nView Live: https://app.pulumi.com/cnunciato/grocery-list/dev/previews/605bf32a-95b1-4221-bc35-0e667b30f38a\n\n     Type                                    Name              Plan\n +   pulumi:pulumi:Stack                     grocery-list-dev  create\n +   ├─ digitalocean:index:DatabaseCluster   cluster           create\n +   ├─ digitalocean:index:DatabaseDb        db                create\n +   ├─ digitalocean:index:App               app               create\n +   └─ digitalocean:index:DatabaseFirewall  trusted-source    create\n\nResources:\n    + 5 to create\n\nDo you want to perform this update?\n> yes\n\nUpdating (dev)\n\nView Live: https://app.pulumi.com/cnunciato/grocery-list/dev/updates/1\n\n     Type                                    Name              Status\n     pulumi:pulumi:Stack                     grocery-list-dev\n +   ├─ digitalocean:index:App               app               created\n +   └─ digitalocean:index:DatabaseFirewall  trusted-source    created\n\nOutputs:\n  + liveUrl: "https://grocery-list-fb9bd.ondigitalocean.app"\n\nResources:\n    + 2 created\n    3 unchanged\n\nDuration: 2m30s\n```\n\nAgain, it\'ll probably take a few minutes to get everything spun up for the first time, but when the process completes, you\'ll have a working app at the URL provided by DigitalOcean, emitted as a Pulumi stack output:\n\n\n```bash\n$ open $(pulumi stack output liveUrl)\n```\n\n![The app now running in the DigitalOcean cloud](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/deployed.png)\n\nYou should also be able to explore your shiny new grocery-list app in the DigitalOcean Console, with all three of its components (and their build-time and runtime logs!) now represented:\n\n![The grocery-list app and its components in the DigitalOcean console](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/in-the-console.png)\n\nNow try making a commit to your repository (any commit will do, but ideally one to the `frontend` or `backend` folder), and watch as the app redeploys automatically:\n\n![App Platform rebuilding the app in response to a GitHub commit](https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/redeploying.png)\n\nAnd finally, try scaling the service by bumping the `instanceCount` from `1` to `2` in the code&mdash;or better, if you\'re up for it, making that value configurable by stack:\n\n\n```diff\n  const config = new pulumi.Config();\n  const repo = config.require("repo");\n  const branch = config.require("branch");\n+ const serviceInstanceCount = config.requireNumber("service_instance_count");\n  ...\n        services: [\n            digitalocean.AppSpecServiceArgs(\n                ...\n+               instanceCount: serviceInstanceCount,\n```\n\n\n```bash\n$ pulumi config set service_instance_count 2\n\n$ pulumi up\n\nUpdating (dev)\n\n     Type                       Name              Status      Info\n     pulumi:pulumi:Stack        grocery-list-dev\n ~   └─ digitalocean:index:App  app               updated     [diff: ~spec]\n\nOutputs:\n    liveUrl: "https://grocery-list-fb9bd.ondigitalocean.app"\n\nResources:\n    ~ 1 updated\n    4 unchanged\n\nDuration: 1m27s\n```\n\nAnd when you\'re finished experimenting, you can tear everything down in just a few seconds with a [`pulumi destroy`](https://www.pulumi.com/docs/reference/cli/pulumi_destroy">}}):\n\n```bash\n$ pulumi destroy\n\nDestroying (dev)\n\n     Type                                    Name              Status\n -   pulumi:pulumi:Stack                     grocery-list-dev  deleted\n -   ├─ digitalocean:index:DatabaseFirewall  trusted-source    deleted\n -   ├─ digitalocean:index:DatabaseDb        db                deleted\n -   ├─ digitalocean:index:App               app               deleted\n -   └─ digitalocean:index:DatabaseCluster   cluster           deleted\n\nResources:\n    - 5 deleted\n\nDuration: 19s\n```\n\n## Wrapping up, and next steps\n\nHopefully this gives you a sense of the kinds of things you can do with Pulumi and DigitalOcean&mdash;and I definitely encourage you to spend a little time with the [App Platform docs](https://docs.digitalocean.com/products/app-platform/) to dig a bit deeper into some of these concepts and explore a few others we weren\'t able to cover. You\'ll find the [full source for this walkthrough on GitHub](https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean), of course, with [`finished` branch](https://github.com/cnunciato/fullstack-pulumi-mern-digitalocean/tree/finished) containing the completed Pulumi program for reference.\n\nFrom here, you might think about:\n\n* Adding a [`digitalocean.DnsRecord`](https://www.pulumi.com/registry/packages/digitalocean/api-docs/dnsrecord) to give your app a [custom domain name](https://docs.digitalocean.com/products/networking/dns/).\n\n* Creating a second stack with [`pulumi stack init`](https://www.pulumi.com/docs/reference/cli/pulumi_stack_init) and adjusting the program to make the source `branch` configurable&mdash;a `production` stack, say, designed to deploy in response to commits to a `release` branch.\n\n* Using Pulumi\'s [GitHub Action](https://www.pulumi.com/docs/guides/continuous-delivery/github-actions) to run previews and updates as part of a pull-request based workflow.\n\nHappy coding!\n',t.user={name:"Christian Nunciato",username:s,twitter_username:s,github_username:s,website_url:"https://chris.nunciato.org",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--uhPcr6xP--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/552729/55955a5b-72aa-4bd0-bdfe-de43d84afb27.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--Sd6_9WMD--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/552729/55955a5b-72aa-4bd0-bdfe-de43d84afb27.jpeg"},t.organization={name:"Pulumi",username:e,slug:e,profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--Wri8WZVx--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/3657/e0121125-e32c-40f8-bc47-45d56fc62b0a.png",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--RpnbcrQc--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/3657/e0121125-e32c-40f8-bc47-45d56fc62b0a.png"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:t}},error:a,state:{currentArticle:t},serverRendered:!0,routePath:"/cnunciato/1022599",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:a}}}}(null,"2022-03-14T17:33:32Z","pulumi","cnunciato",{})</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
