<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Writing a Serverless Android app (ft. Huawei's AppGallery Connect) - Part 1 - Auth</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>Writing a Serverless Android app (ft. Huawei's AppGallery Connect) - Part 1 - Auth</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/android" class="tag" data-v-70afb46a>
          #android
        </a><a href="/nuxtstop/t/serverless" class="tag" data-v-70afb46a>
          #serverless
        </a><a href="/nuxtstop/t/java" class="tag" data-v-70afb46a>
          #java
        </a><a href="/nuxtstop/t/appgallery" class="tag" data-v-70afb46a>
          #appgallery
        </a></div> <!----> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            3
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Jul 7 '21</time></div></header> <div class="content" data-v-70afb46a><p>Not read part 0? Read it first! </p>
<div class="ltag__link">
  <a href="/devwithzachary" class="ltag__link__link">
    <div class="ltag__link__pic">
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--xlTyxq6s--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/practicaldev/image/fetch/s--5l_Wky2H--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/506918/52a7bac6-9f92-4cbd-a577-35d950db17cc.jpeg" alt="devwithzachary" loading="lazy">
    </div>
  </a>
  <a href="/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-0-3hmj" class="ltag__link__link">
    <div class="ltag__link__content">
      <h2>Writing a Serverless Android app (ft. Huawei's AppGallery Connect) - Part 0</h2>
      <h3>Zachary Powell ・ Jun 28 '21 ・ 3 min read</h3>
      <div class="ltag__link__taglist">
        <span class="ltag__link__tag">#android</span>
        <span class="ltag__link__tag">#serverless</span>
        <span class="ltag__link__tag">#java</span>
        <span class="ltag__link__tag">#appgallery</span>
      </div>
    </div>
  </a>
</div>


<p>Over the next couple of months I will be releasing a complete end to end guide to creating an Android app using serverless functionality to completely remove the need for any backend server/hosting etc.</p>

<p>This weeks Video is below</p>

<p><iframe width="710" height="399" src="https://www.youtube.com/embed/OMX7xXBQ6Yg" allowfullscreen loading="lazy">
</iframe>
</p>

<p>And at the bottom of this post you will find my twitch channel where we live stream every Thursday at 2pm BST and the github repo for this project!.</p>

<p>But for those that would rather a written guide, lets get into it!</p>

<h1>
  <a name="project-setup" href="#project-setup">
  </a>
  Project Setup
</h1>

<p>Starting with a brand new project (or one that has never used Huawei services) we will need to start by setting up a new app. (If you haven't setup your developer account yet <a href="https://developer.huawei.com/consumer/en/">sign up!</a>) </p>

<p>If you would like the complete step by step guide on how to get setup check out the <a href="https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-get-started-android-0000001058210705">Official Documentation</a>, but below is a summery.</p>

<p>Navigate to the the <a href="https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/">AppGallery Connect</a> area of the developer portal, here you need to create a <a href="https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/addProject">new project</a>.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--uJPOjrMO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g07gsy6ch6bocg9zdnad.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--uJPOjrMO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g07gsy6ch6bocg9zdnad.png" alt="image" loading="lazy" width="880" height="330"></a></p>

<p>Follow the new project guide, giving that project a name. Once completed on the left hand menu find the Auth service under the build menu.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8ZeXTf4N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksranpl51ul2hk6ntp4b.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8ZeXTf4N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksranpl51ul2hk6ntp4b.png" alt="image" loading="lazy" width="880" height="212"></a><br>
Click the enable now button in the top right corner to enable this service for your project. Set a default data processing location, depending on your physical location will most likely help decide which to use. For us we have selected Germany as this is the closest location and within the EU.</p>

<p>From here you are presented with the list of authentication modes, Huawei supports a wide range of services from Facebook login to AppleID. However today we are focusing on the email auth method. Click the enable button next to this.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Ub4WT7q2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ayls0pm8aipkmw8filq9.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Ub4WT7q2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ayls0pm8aipkmw8filq9.png" alt="image" loading="lazy" width="880" height="266"></a></p>

<p>Now that everything is setup in the project, its time to setup the app! At this point I will assume you have created a new blank project in Android Studio and given it a package name etc.<br>
From the project settings top screen, select the Add app button to setup a new app under this project.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--upnvyihS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hhftxijc5fx19qmaqkoa.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--upnvyihS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hhftxijc5fx19qmaqkoa.png" alt="image" loading="lazy" width="838" height="282"></a><br>
Fill in the add app form, setting the platform, app name, package etc so that it can be added to the created project. Its worth noting at this point, that while we are focusing on Android today many of these services can be used across multiple platforms including iOS and web.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ZXbXHHOM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0ieevkpi5t3bdyenubgo.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ZXbXHHOM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0ieevkpi5t3bdyenubgo.png" alt="image" loading="lazy" width="880" height="509"></a><br>
Once completed you will be told to download the agconnect-services.json file and presented with a code to get the core services setup. As we are already focusing on a specific service for today the setup at this point is a little different.<br>
Start by placing your nearly downloaded <code>agconnect-services.json</code> file into the app directory of your project.<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--MmA2EeIM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m1hmuam07yih8wecej9a.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--MmA2EeIM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m1hmuam07yih8wecej9a.png" alt="image" loading="lazy" width="384" height="427"></a></p>

<p>Next we will get gradle configured correctly. In your top level gradle build file add the below to your repositories both under buildscript and allprojects<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight gradle"><code><span class="n">maven</span> <span class="o">{</span>
    <span class="n">url</span> <span class="s1">'https://developer.huawei.com/repo/'</span>
<span class="o">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>And to your dependencies add <code>classpath 'com.huawei.agconnect:agcp:1.4.1.300'</code></p>

<p>Your file should now look a little like<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight gradle"><code><span class="c1">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span>
<span class="k">buildscript</span> <span class="o">{</span>
    <span class="k">repositories</span> <span class="o">{</span>
        <span class="n">google</span><span class="o">()</span>
        <span class="n">mavenCentral</span><span class="o">()</span>
        <span class="n">maven</span> <span class="o">{</span>
            <span class="n">url</span> <span class="s1">'https://developer.huawei.com/repo/'</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">dependencies</span> <span class="o">{</span>
        <span class="n">classpath</span> <span class="s2">"com.android.tools.build:gradle:4.2.2"</span>
        <span class="n">classpath</span> <span class="s1">'com.huawei.agconnect:agcp:1.4.1.300'</span>
        <span class="c1">// NOTE: Do not place your application dependencies here; they belong</span>
        <span class="c1">// in the individual module build.gradle files</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">allprojects</span> <span class="o">{</span>
    <span class="k">repositories</span> <span class="o">{</span>
        <span class="n">google</span><span class="o">()</span>
        <span class="n">mavenCentral</span><span class="o">()</span>
        <span class="n">jcenter</span><span class="o">()</span> <span class="c1">// Warning: this repository is going to shut down soon</span>
        <span class="n">maven</span> <span class="o">{</span>
            <span class="n">url</span> <span class="s1">'https://developer.huawei.com/repo/'</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">task</span> <span class="nf">clean</span><span class="o">(</span><span class="nl">type:</span> <span class="n">Delete</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">delete</span> <span class="n">rootProject</span><span class="o">.</span><span class="na">buildDir</span>
<span class="o">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Next open your app build.gradle file</p>

<p>Start by adding the agconnect plugin into your plugins list<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight gradle"><code><span class="n">plugins</span> <span class="o">{</span>
    <span class="n">id</span> <span class="s1">'com.android.application'</span>
    <span class="n">id</span> <span class="s1">'com.huawei.agconnect'</span>
<span class="o">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Make sure to set your midSdkVersion to at least <code>17</code> (this is required for any Huawei AppGallery Connect services.</p>

<p>And then in dependencies we are going to add the core and auth services<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight gradle"><code>    <span class="n">implementation</span> <span class="s1">'com.huawei.agconnect:agconnect-core:1.4.1.300'</span>
    <span class="n">implementation</span> <span class="s1">'com.huawei.agconnect:agconnect-auth:1.4.1.300'</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>So your file should now look something like<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight gradle"><code><span class="n">plugins</span> <span class="o">{</span>
    <span class="n">id</span> <span class="s1">'com.android.application'</span>
    <span class="n">id</span> <span class="s1">'com.huawei.agconnect'</span>
<span class="o">}</span>

<span class="n">android</span> <span class="o">{</span>
    <span class="n">compileSdkVersion</span> <span class="mi">30</span>
    <span class="n">buildToolsVersion</span> <span class="s2">"30.0.3"</span>

    <span class="n">defaultConfig</span> <span class="o">{</span>
        <span class="n">applicationId</span> <span class="s2">"site.zpweb.barker"</span>
        <span class="n">minSdkVersion</span> <span class="mi">17</span>
        <span class="n">targetSdkVersion</span> <span class="mi">30</span>
        <span class="n">versionCode</span> <span class="mi">1</span>
        <span class="n">versionName</span> <span class="s2">"1.0"</span>

        <span class="n">testInstrumentationRunner</span> <span class="s2">"androidx.test.runner.AndroidJUnitRunner"</span>
    <span class="o">}</span>

    <span class="n">buildTypes</span> <span class="o">{</span>
        <span class="n">release</span> <span class="o">{</span>
            <span class="n">minifyEnabled</span> <span class="kc">false</span>
            <span class="n">proguardFiles</span> <span class="nf">getDefaultProguardFile</span><span class="o">(</span><span class="s1">'proguard-android-optimize.txt'</span><span class="o">),</span> <span class="s1">'proguard-rules.pro'</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">compileOptions</span> <span class="o">{</span>
        <span class="n">sourceCompatibility</span> <span class="n">JavaVersion</span><span class="o">.</span><span class="na">VERSION_1_8</span>
        <span class="n">targetCompatibility</span> <span class="n">JavaVersion</span><span class="o">.</span><span class="na">VERSION_1_8</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">'com.huawei.agconnect:agconnect-core:1.4.1.300'</span>
    <span class="n">implementation</span> <span class="s1">'com.huawei.agconnect:agconnect-auth:1.4.1.300'</span>
    <span class="n">implementation</span> <span class="s1">'androidx.appcompat:appcompat:1.3.0'</span>
    <span class="n">implementation</span> <span class="s1">'com.google.android.material:material:1.3.0'</span>
    <span class="n">implementation</span> <span class="s1">'androidx.constraintlayout:constraintlayout:2.0.4'</span>
    <span class="n">testImplementation</span> <span class="s1">'junit:junit:4.13.2'</span>
    <span class="n">androidTestImplementation</span> <span class="s1">'androidx.test.ext:junit:1.1.3'</span>
    <span class="n">androidTestImplementation</span> <span class="s1">'androidx.test.espresso:espresso-core:3.4.0'</span>
<span class="o">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>And thats it! let gradle sync up and we are all good to go!</p>
<h1>
  <a name="registration" href="#registration">
  </a>
  Registration
</h1>

<p>As I mentioned before there are a wide range of ways a user can authenticate using the Auth service, but here we are looking at the email service. Email authenticate the user by sending them a code via (your guessed it) Email. The user then inputs this code back into the app to confirm that they are who the say they are, and that they have access to that contact method. We will assume you have setup some kind of register view that will capture a users email.</p>

<p>We start by requesting an authentication code be set to the user, the code to do this looks like<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code><span class="nc">VerifyCodeSettings</span> <span class="n">settings</span> <span class="o">=</span> <span class="nc">VerifyCodeSettings</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">action</span><span class="o">(</span><span class="nc">VerifyCodeSettings</span><span class="o">.</span><span class="na">ACTION_REGISTER_LOGIN</span><span class="o">)</span>
                <span class="o">.</span><span class="na">sendInterval</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span>
                <span class="o">.</span><span class="na">locale</span><span class="o">(</span><span class="nc">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="nc">Task</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">></span> <span class="n">task</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">requestVerifyCode</span><span class="o">(</span><span class="n">emailString</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>
            <span class="n">task</span><span class="o">.</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="nc">TaskExecutors</span><span class="o">.</span><span class="na">uiThread</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">>()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">VerifyCodeResult</span> <span class="n">verifyCodeResult</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">authCodeDialog</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}).</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="nc">TaskExecutors</span><span class="o">.</span><span class="na">uiThread</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>
                            <span class="s">"Error, code sending failed: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span>
                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Lets break this down, we start by defining a <code>VerifyCodeSettings</code> object, this holds all the settings relating to the sending of the code. Here we define what locale should be used for the message text that is sent, what kind of code it is and the send interval.</p>

<p>Next we create a task to be run<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code><span class="nc">Task</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">></span> <span class="n">task</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">requestVerifyCode</span><span class="o">(</span><span class="n">emailString</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Using the EmailAuthProvider, where <code>emailString</code> is the email address the user has entered, as a string and the settings object is the VerifyCodeSettings object we just created.</p>

<p>Next we setup an OnSucessListener which will be called if the code was successfully sent to the user. In this example we are calling the method <code>authCodeDialog();</code> to display a dialog to enter the code, which will see in a moment.<br>
We also setup an OnFailureListener which simply create a toast on screen to display what ever error is sent back.</p>

<p>Now that we have sent the user a code we should display some view for them to enter that code, in my instance I have the method below, but of course this could be what ever view you wanted.<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">authCodeDialog</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">AlertDialog</span><span class="o">.</span><span class="na">Builder</span> <span class="n">alert</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AlertDialog</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="kd">final</span> <span class="nc">EditText</span> <span class="n">authCodeField</span> <span class="o">=</span>  <span class="k">new</span> <span class="nc">EditText</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">alert</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Enter your auth code below"</span><span class="o">);</span>
        <span class="n">alert</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"Authentication Code"</span><span class="o">);</span>

        <span class="n">alert</span><span class="o">.</span><span class="na">setView</span><span class="o">(</span><span class="n">authCodeField</span><span class="o">);</span>

        <span class="n">alert</span><span class="o">.</span><span class="na">setPositiveButton</span><span class="o">(</span><span class="s">"Register"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">authCode</span> <span class="o">=</span> <span class="n">authCodeField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                <span class="n">register</span><span class="o">(</span><span class="n">authCode</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">alert</span><span class="o">.</span><span class="na">setNegativeButton</span><span class="o">(</span><span class="s">"Cancel"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>
                        <span class="s">"Registration Cancelled"</span><span class="o">,</span>
                        <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">alert</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Finally once the user has inputted the code we can register them as you can see above we have a register method that is called, this has the below code:<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code><span class="nc">EmailUser</span> <span class="n">emailUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmailUser</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">emailString</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setVerifyCode</span><span class="o">(</span><span class="n">authCode</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

            <span class="nc">AGConnectAuth</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">createUser</span><span class="o">(</span><span class="n">emailUser</span><span class="o">).</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">SignInResult</span><span class="o">>()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">SignInResult</span> <span class="n">signInResult</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>
                            <span class="s">"Register Successful: "</span> <span class="o">+</span> <span class="n">signInResult</span><span class="o">.</span><span class="na">getUser</span><span class="o">().</span><span class="na">getUid</span><span class="o">(),</span>
                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}).</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>
                            <span class="s">"Registering failed "</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span>
                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>So we start by creating an <code>EmailUser</code> using the email address we captured earlier and the authCode that the user has entered. Using that <code>EmailUser</code> we then attempt to register. Note that we can also set a password against the <code>EmailUser</code>, if we do this when they go to login they do not need to verify their email address again. They can just enter their email and password.</p>

<p>As you can see we pass the created object into the createUser method, attaching OnSuccess and OnFailure Listeners. If the user is successfully registered, i.e the code they entered matches what was sent we are returned a <code>SignInResult</code> this object containes the user. So in this example we simply print out the registered users UID to confirm it completed successfully.</p>
<h1>
  <a name="login" href="#login">
  </a>
  Login
</h1>

<p>Now that we have covered the sign up process lets look at how we might handle a login process. This would assume that the user has already registered via the above method and is now logging into the app, perhaps after installing it on a new phone.</p>

<p>As I mentioned before if the user signed up without a password then start by sending a verify code, in just the same way as we did during the sign up process. Once we have the code we can generate a <code>AGCOnnectAuthCredential</code> object<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code><span class="nc">AGConnectAuthCredential</span> <span class="n">credential</span> <span class="o">=</span> <span class="n">credential</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">credentialWithVerifyCode</span><span class="o">(</span>
                            <span class="n">email</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">trim</span><span class="o">(),</span>
                            <span class="kc">null</span><span class="o">,</span>
                            <span class="n">authCode</span><span class="o">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>Here we get the email that the user entered (<code>email</code> being an <code>EditText</code> object). We pass null for the password as we haven't used this, and finally the authCode which the user has entered into the app.</p>

<p>Now we can attempt the sign the user in:<br>
</p>
<div class="highlight js-code-highlight">
<pre class="highlight java"><code>  <span class="nc">AGConnectAuth</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">signIn</span><span class="o">(</span><span class="n">credential</span><span class="o">)</span>
                <span class="o">.</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">SignInResult</span><span class="o">>()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">SignInResult</span> <span class="n">signInResult</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"Sign in successful: "</span> <span class="o">+</span>
                                <span class="n">signInResult</span><span class="o">.</span><span class="na">getUser</span><span class="o">().</span><span class="na">getUid</span><span class="o">(),</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">})</span>
                <span class="o">.</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"sign in failed:"</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>We pass the credential object into the signIn method, if the code and email matched and was correct the OnSuccessListener will return the SignInResult object just as it did during the sign up, from here we have access to the users detials.<br>
If for any reason the login fails we will get an Exception in the OnFailureListener. </p>

<p>And thats it! We have setup the application to use Huawei services and configured the app to use email authentication during sign up and log in.</p>

<p>For more information on the Auth service, full documentation can be found here <a href="https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-auth-introduction-0000001053732605">https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-auth-introduction-0000001053732605</a></p>
<h1>
  <a name="twitch-acccount" href="#twitch-acccount">
  </a>
  Twitch Acccount
</h1>

<p><iframe src="https://clips.twitch.tv/embed?clip=devwithzachary&parent=dev.to&autoplay=false" height="399" width="710" allowfullscreen frameborder="0" scrolling="no">
</iframe>
</p>
<h1>
  <a name="github-repo" href="#github-repo">
  </a>
  Github Repo
</h1>


<div class="ltag-github-readme-tag">
  <div class="readme-overview">
    <h2>
      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--566lAguM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev.to/assets/github-logo-5a155e1f9a670af7944dd5e12375bc76ed542ea80224905ecaf878b9157cdefc.svg" alt="GitHub logo" loading="lazy">
      <a href="https://github.com/devwithzachary">
        devwithzachary
      </a> / <a style="font-weight:600" href="https://github.com/devwithzachary/Barker">
        Barker
      </a>
    </h2>
    <h3>
      Project init
    </h3>
  </div>
  <div class="ltag-github-body">
    
<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto">
Barker - A Serverless Twitter Clone</h1>
<p dir="auto">Barker is a simple twitter style social network written to demostrate the serverless services provided by Huawei's AppGallery Connect platform.</p>
<p dir="auto">This app is written during live streams over at <a href="https://www.twitch.tv/devwithzachary" rel="nofollow">https://www.twitch.tv/devwithzachary</a>
The streams are then edited down into videos which you can watch <a href="https://www.youtube.com/channel/UC63PqG8ZnWC4JWYrNJKocMA" rel="nofollow">https://www.youtube.com/channel/UC63PqG8ZnWC4JWYrNJKocMA</a></p>
<p dir="auto">Finally there is also a written copy of the guide found on dev.to <a href="https://dev.to/devwithzachary" rel="nofollow">https://dev.to/devwithzachary</a></p>
<p dir="auto">Each episodes code is commited as a single commit to make it easy to step along with the code, simply checkout the specific commit and follow along!</p>
</article></div>

  </div>
  <div class="gh-btn-container"><a class="gh-btn" href="https://github.com/devwithzachary/Barker">View on GitHub</a></div>
</div>



<p>We will be back with the next part next week!</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-1-auth-4hlc" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,a,n,e,t){return n.type_of="article",n.id=752236,n.title="Writing a Serverless Android app (ft. Huawei's AppGallery Connect) - Part 1 - Auth",n.description="Not read part 0? Read it first!                                        Writing a Serverless Android...",n.readable_publish_date="Jul 7 '21",n.slug="writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-1-auth-4hlc",n.path="/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-1-auth-4hlc",n.url=e,n.comments_count=0,n.public_reactions_count=3,n.collection_id=s,n.published_timestamp=a,n.positive_reactions_count=3,n.cover_image=s,n.social_image="https://dev.to/social_previews/article/752236.png",n.canonical_url=e,n.created_at="2021-07-07T09:17:10Z",n.edited_at="2021-07-07T13:38:29Z",n.crossposted_at=s,n.published_at=a,n.last_comment_at=a,n.reading_time_minutes=8,n.tag_list="android, serverless, java, appgallery",n.tags=["android","serverless","java","appgallery"],n.body_html='<p>Not read part 0? Read it first! </p>\n<div class="ltag__link">\n  <a href="/devwithzachary" class="ltag__link__link">\n    <div class="ltag__link__pic">\n      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--xlTyxq6s--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/practicaldev/image/fetch/s--5l_Wky2H--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/506918/52a7bac6-9f92-4cbd-a577-35d950db17cc.jpeg" alt="devwithzachary" loading="lazy">\n    </div>\n  </a>\n  <a href="/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-0-3hmj" class="ltag__link__link">\n    <div class="ltag__link__content">\n      <h2>Writing a Serverless Android app (ft. Huawei\'s AppGallery Connect) - Part 0</h2>\n      <h3>Zachary Powell ・ Jun 28 \'21 ・ 3 min read</h3>\n      <div class="ltag__link__taglist">\n        <span class="ltag__link__tag">#android</span>\n        <span class="ltag__link__tag">#serverless</span>\n        <span class="ltag__link__tag">#java</span>\n        <span class="ltag__link__tag">#appgallery</span>\n      </div>\n    </div>\n  </a>\n</div>\n\n\n<p>Over the next couple of months I will be releasing a complete end to end guide to creating an Android app using serverless functionality to completely remove the need for any backend server/hosting etc.</p>\n\n<p>This weeks Video is below</p>\n\n<p><iframe width="710" height="399" src="https://www.youtube.com/embed/OMX7xXBQ6Yg" allowfullscreen loading="lazy">\n</iframe>\n</p>\n\n<p>And at the bottom of this post you will find my twitch channel where we live stream every Thursday at 2pm BST and the github repo for this project!.</p>\n\n<p>But for those that would rather a written guide, lets get into it!</p>\n\n<h1>\n  <a name="project-setup" href="#project-setup">\n  </a>\n  Project Setup\n</h1>\n\n<p>Starting with a brand new project (or one that has never used Huawei services) we will need to start by setting up a new app. (If you haven\'t setup your developer account yet <a href="https://developer.huawei.com/consumer/en/">sign up!</a>) </p>\n\n<p>If you would like the complete step by step guide on how to get setup check out the <a href="https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-get-started-android-0000001058210705">Official Documentation</a>, but below is a summery.</p>\n\n<p>Navigate to the the <a href="https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/">AppGallery Connect</a> area of the developer portal, here you need to create a <a href="https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/addProject">new project</a>.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--uJPOjrMO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g07gsy6ch6bocg9zdnad.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--uJPOjrMO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g07gsy6ch6bocg9zdnad.png" alt="image" loading="lazy" width="880" height="330"></a></p>\n\n<p>Follow the new project guide, giving that project a name. Once completed on the left hand menu find the Auth service under the build menu.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8ZeXTf4N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksranpl51ul2hk6ntp4b.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8ZeXTf4N--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksranpl51ul2hk6ntp4b.png" alt="image" loading="lazy" width="880" height="212"></a><br>\nClick the enable now button in the top right corner to enable this service for your project. Set a default data processing location, depending on your physical location will most likely help decide which to use. For us we have selected Germany as this is the closest location and within the EU.</p>\n\n<p>From here you are presented with the list of authentication modes, Huawei supports a wide range of services from Facebook login to AppleID. However today we are focusing on the email auth method. Click the enable button next to this.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Ub4WT7q2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ayls0pm8aipkmw8filq9.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Ub4WT7q2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ayls0pm8aipkmw8filq9.png" alt="image" loading="lazy" width="880" height="266"></a></p>\n\n<p>Now that everything is setup in the project, its time to setup the app! At this point I will assume you have created a new blank project in Android Studio and given it a package name etc.<br>\nFrom the project settings top screen, select the Add app button to setup a new app under this project.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--upnvyihS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hhftxijc5fx19qmaqkoa.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--upnvyihS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hhftxijc5fx19qmaqkoa.png" alt="image" loading="lazy" width="838" height="282"></a><br>\nFill in the add app form, setting the platform, app name, package etc so that it can be added to the created project. Its worth noting at this point, that while we are focusing on Android today many of these services can be used across multiple platforms including iOS and web.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ZXbXHHOM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0ieevkpi5t3bdyenubgo.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ZXbXHHOM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0ieevkpi5t3bdyenubgo.png" alt="image" loading="lazy" width="880" height="509"></a><br>\nOnce completed you will be told to download the agconnect-services.json file and presented with a code to get the core services setup. As we are already focusing on a specific service for today the setup at this point is a little different.<br>\nStart by placing your nearly downloaded <code>agconnect-services.json</code> file into the app directory of your project.<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--MmA2EeIM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m1hmuam07yih8wecej9a.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--MmA2EeIM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m1hmuam07yih8wecej9a.png" alt="image" loading="lazy" width="384" height="427"></a></p>\n\n<p>Next we will get gradle configured correctly. In your top level gradle build file add the below to your repositories both under buildscript and allprojects<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight gradle"><code><span class="n">maven</span> <span class="o">{</span>\n    <span class="n">url</span> <span class="s1">\'https://developer.huawei.com/repo/\'</span>\n<span class="o">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>And to your dependencies add <code>classpath \'com.huawei.agconnect:agcp:1.4.1.300\'</code></p>\n\n<p>Your file should now look a little like<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight gradle"><code><span class="c1">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span>\n<span class="k">buildscript</span> <span class="o">{</span>\n    <span class="k">repositories</span> <span class="o">{</span>\n        <span class="n">google</span><span class="o">()</span>\n        <span class="n">mavenCentral</span><span class="o">()</span>\n        <span class="n">maven</span> <span class="o">{</span>\n            <span class="n">url</span> <span class="s1">\'https://developer.huawei.com/repo/\'</span>\n        <span class="o">}</span>\n    <span class="o">}</span>\n    <span class="k">dependencies</span> <span class="o">{</span>\n        <span class="n">classpath</span> <span class="s2">"com.android.tools.build:gradle:4.2.2"</span>\n        <span class="n">classpath</span> <span class="s1">\'com.huawei.agconnect:agcp:1.4.1.300\'</span>\n        <span class="c1">// NOTE: Do not place your application dependencies here; they belong</span>\n        <span class="c1">// in the individual module build.gradle files</span>\n    <span class="o">}</span>\n<span class="o">}</span>\n\n<span class="k">allprojects</span> <span class="o">{</span>\n    <span class="k">repositories</span> <span class="o">{</span>\n        <span class="n">google</span><span class="o">()</span>\n        <span class="n">mavenCentral</span><span class="o">()</span>\n        <span class="n">jcenter</span><span class="o">()</span> <span class="c1">// Warning: this repository is going to shut down soon</span>\n        <span class="n">maven</span> <span class="o">{</span>\n            <span class="n">url</span> <span class="s1">\'https://developer.huawei.com/repo/\'</span>\n        <span class="o">}</span>\n    <span class="o">}</span>\n<span class="o">}</span>\n\n<span class="n">task</span> <span class="nf">clean</span><span class="o">(</span><span class="nl">type:</span> <span class="n">Delete</span><span class="o">)</span> <span class="o">{</span>\n    <span class="n">delete</span> <span class="n">rootProject</span><span class="o">.</span><span class="na">buildDir</span>\n<span class="o">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Next open your app build.gradle file</p>\n\n<p>Start by adding the agconnect plugin into your plugins list<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight gradle"><code><span class="n">plugins</span> <span class="o">{</span>\n    <span class="n">id</span> <span class="s1">\'com.android.application\'</span>\n    <span class="n">id</span> <span class="s1">\'com.huawei.agconnect\'</span>\n<span class="o">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Make sure to set your midSdkVersion to at least <code>17</code> (this is required for any Huawei AppGallery Connect services.</p>\n\n<p>And then in dependencies we are going to add the core and auth services<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight gradle"><code>    <span class="n">implementation</span> <span class="s1">\'com.huawei.agconnect:agconnect-core:1.4.1.300\'</span>\n    <span class="n">implementation</span> <span class="s1">\'com.huawei.agconnect:agconnect-auth:1.4.1.300\'</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>So your file should now look something like<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight gradle"><code><span class="n">plugins</span> <span class="o">{</span>\n    <span class="n">id</span> <span class="s1">\'com.android.application\'</span>\n    <span class="n">id</span> <span class="s1">\'com.huawei.agconnect\'</span>\n<span class="o">}</span>\n\n<span class="n">android</span> <span class="o">{</span>\n    <span class="n">compileSdkVersion</span> <span class="mi">30</span>\n    <span class="n">buildToolsVersion</span> <span class="s2">"30.0.3"</span>\n\n    <span class="n">defaultConfig</span> <span class="o">{</span>\n        <span class="n">applicationId</span> <span class="s2">"site.zpweb.barker"</span>\n        <span class="n">minSdkVersion</span> <span class="mi">17</span>\n        <span class="n">targetSdkVersion</span> <span class="mi">30</span>\n        <span class="n">versionCode</span> <span class="mi">1</span>\n        <span class="n">versionName</span> <span class="s2">"1.0"</span>\n\n        <span class="n">testInstrumentationRunner</span> <span class="s2">"androidx.test.runner.AndroidJUnitRunner"</span>\n    <span class="o">}</span>\n\n    <span class="n">buildTypes</span> <span class="o">{</span>\n        <span class="n">release</span> <span class="o">{</span>\n            <span class="n">minifyEnabled</span> <span class="kc">false</span>\n            <span class="n">proguardFiles</span> <span class="nf">getDefaultProguardFile</span><span class="o">(</span><span class="s1">\'proguard-android-optimize.txt\'</span><span class="o">),</span> <span class="s1">\'proguard-rules.pro\'</span>\n        <span class="o">}</span>\n    <span class="o">}</span>\n    <span class="n">compileOptions</span> <span class="o">{</span>\n        <span class="n">sourceCompatibility</span> <span class="n">JavaVersion</span><span class="o">.</span><span class="na">VERSION_1_8</span>\n        <span class="n">targetCompatibility</span> <span class="n">JavaVersion</span><span class="o">.</span><span class="na">VERSION_1_8</span>\n    <span class="o">}</span>\n<span class="o">}</span>\n\n<span class="k">dependencies</span> <span class="o">{</span>\n    <span class="n">implementation</span> <span class="s1">\'com.huawei.agconnect:agconnect-core:1.4.1.300\'</span>\n    <span class="n">implementation</span> <span class="s1">\'com.huawei.agconnect:agconnect-auth:1.4.1.300\'</span>\n    <span class="n">implementation</span> <span class="s1">\'androidx.appcompat:appcompat:1.3.0\'</span>\n    <span class="n">implementation</span> <span class="s1">\'com.google.android.material:material:1.3.0\'</span>\n    <span class="n">implementation</span> <span class="s1">\'androidx.constraintlayout:constraintlayout:2.0.4\'</span>\n    <span class="n">testImplementation</span> <span class="s1">\'junit:junit:4.13.2\'</span>\n    <span class="n">androidTestImplementation</span> <span class="s1">\'androidx.test.ext:junit:1.1.3\'</span>\n    <span class="n">androidTestImplementation</span> <span class="s1">\'androidx.test.espresso:espresso-core:3.4.0\'</span>\n<span class="o">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>And thats it! let gradle sync up and we are all good to go!</p>\n<h1>\n  <a name="registration" href="#registration">\n  </a>\n  Registration\n</h1>\n\n<p>As I mentioned before there are a wide range of ways a user can authenticate using the Auth service, but here we are looking at the email service. Email authenticate the user by sending them a code via (your guessed it) Email. The user then inputs this code back into the app to confirm that they are who the say they are, and that they have access to that contact method. We will assume you have setup some kind of register view that will capture a users email.</p>\n\n<p>We start by requesting an authentication code be set to the user, the code to do this looks like<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code><span class="nc">VerifyCodeSettings</span> <span class="n">settings</span> <span class="o">=</span> <span class="nc">VerifyCodeSettings</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">()</span>\n                <span class="o">.</span><span class="na">action</span><span class="o">(</span><span class="nc">VerifyCodeSettings</span><span class="o">.</span><span class="na">ACTION_REGISTER_LOGIN</span><span class="o">)</span>\n                <span class="o">.</span><span class="na">sendInterval</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span>\n                <span class="o">.</span><span class="na">locale</span><span class="o">(</span><span class="nc">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">)</span>\n                <span class="o">.</span><span class="na">build</span><span class="o">();</span>\n<span class="nc">Task</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">&gt;</span> <span class="n">task</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">requestVerifyCode</span><span class="o">(</span><span class="n">emailString</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>\n            <span class="n">task</span><span class="o">.</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="nc">TaskExecutors</span><span class="o">.</span><span class="na">uiThread</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">&gt;()</span> <span class="o">{</span>\n                <span class="nd">@Override</span>\n                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">VerifyCodeResult</span> <span class="n">verifyCodeResult</span><span class="o">)</span> <span class="o">{</span>\n                    <span class="n">authCodeDialog</span><span class="o">();</span>\n                <span class="o">}</span>\n            <span class="o">}).</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="nc">TaskExecutors</span><span class="o">.</span><span class="na">uiThread</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>\n                <span class="nd">@Override</span>\n                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>\n                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>\n                            <span class="s">"Error, code sending failed: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span>\n                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>\n                <span class="o">}</span>\n            <span class="o">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Lets break this down, we start by defining a <code>VerifyCodeSettings</code> object, this holds all the settings relating to the sending of the code. Here we define what locale should be used for the message text that is sent, what kind of code it is and the send interval.</p>\n\n<p>Next we create a task to be run<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code><span class="nc">Task</span><span class="o">&lt;</span><span class="nc">VerifyCodeResult</span><span class="o">&gt;</span> <span class="n">task</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">requestVerifyCode</span><span class="o">(</span><span class="n">emailString</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Using the EmailAuthProvider, where <code>emailString</code> is the email address the user has entered, as a string and the settings object is the VerifyCodeSettings object we just created.</p>\n\n<p>Next we setup an OnSucessListener which will be called if the code was successfully sent to the user. In this example we are calling the method <code>authCodeDialog();</code> to display a dialog to enter the code, which will see in a moment.<br>\nWe also setup an OnFailureListener which simply create a toast on screen to display what ever error is sent back.</p>\n\n<p>Now that we have sent the user a code we should display some view for them to enter that code, in my instance I have the method below, but of course this could be what ever view you wanted.<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">authCodeDialog</span><span class="o">()</span> <span class="o">{</span>\n        <span class="nc">AlertDialog</span><span class="o">.</span><span class="na">Builder</span> <span class="n">alert</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AlertDialog</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>\n        <span class="kd">final</span> <span class="nc">EditText</span> <span class="n">authCodeField</span> <span class="o">=</span>  <span class="k">new</span> <span class="nc">EditText</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>\n        <span class="n">alert</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Enter your auth code below"</span><span class="o">);</span>\n        <span class="n">alert</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"Authentication Code"</span><span class="o">);</span>\n\n        <span class="n">alert</span><span class="o">.</span><span class="na">setView</span><span class="o">(</span><span class="n">authCodeField</span><span class="o">);</span>\n\n        <span class="n">alert</span><span class="o">.</span><span class="na">setPositiveButton</span><span class="o">(</span><span class="s">"Register"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>\n            <span class="nd">@Override</span>\n            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span>\n                <span class="nc">String</span> <span class="n">authCode</span> <span class="o">=</span> <span class="n">authCodeField</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>\n                <span class="n">register</span><span class="o">(</span><span class="n">authCode</span><span class="o">);</span>\n            <span class="o">}</span>\n        <span class="o">});</span>\n\n        <span class="n">alert</span><span class="o">.</span><span class="na">setNegativeButton</span><span class="o">(</span><span class="s">"Cancel"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">DialogInterface</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>\n            <span class="nd">@Override</span>\n            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">DialogInterface</span> <span class="n">dialog</span><span class="o">,</span> <span class="kt">int</span> <span class="n">which</span><span class="o">)</span> <span class="o">{</span>\n                <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>\n                        <span class="s">"Registration Cancelled"</span><span class="o">,</span>\n                        <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>\n            <span class="o">}</span>\n        <span class="o">});</span>\n\n        <span class="n">alert</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>\n    <span class="o">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Finally once the user has inputted the code we can register them as you can see above we have a register method that is called, this has the below code:<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code><span class="nc">EmailUser</span> <span class="n">emailUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmailUser</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>\n                    <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">emailString</span><span class="o">)</span>\n                    <span class="o">.</span><span class="na">setVerifyCode</span><span class="o">(</span><span class="n">authCode</span><span class="o">)</span>\n                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>\n\n            <span class="nc">AGConnectAuth</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">createUser</span><span class="o">(</span><span class="n">emailUser</span><span class="o">).</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">SignInResult</span><span class="o">&gt;()</span> <span class="o">{</span>\n                <span class="nd">@Override</span>\n                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">SignInResult</span> <span class="n">signInResult</span><span class="o">)</span> <span class="o">{</span>\n                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>\n                            <span class="s">"Register Successful: "</span> <span class="o">+</span> <span class="n">signInResult</span><span class="o">.</span><span class="na">getUser</span><span class="o">().</span><span class="na">getUid</span><span class="o">(),</span>\n                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>\n                <span class="o">}</span>\n            <span class="o">}).</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>\n                <span class="nd">@Override</span>\n                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>\n                    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">RegisterActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span>\n                            <span class="s">"Registering failed "</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span>\n                            <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>\n                <span class="o">}</span>\n            <span class="o">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>So we start by creating an <code>EmailUser</code> using the email address we captured earlier and the authCode that the user has entered. Using that <code>EmailUser</code> we then attempt to register. Note that we can also set a password against the <code>EmailUser</code>, if we do this when they go to login they do not need to verify their email address again. They can just enter their email and password.</p>\n\n<p>As you can see we pass the created object into the createUser method, attaching OnSuccess and OnFailure Listeners. If the user is successfully registered, i.e the code they entered matches what was sent we are returned a <code>SignInResult</code> this object containes the user. So in this example we simply print out the registered users UID to confirm it completed successfully.</p>\n<h1>\n  <a name="login" href="#login">\n  </a>\n  Login\n</h1>\n\n<p>Now that we have covered the sign up process lets look at how we might handle a login process. This would assume that the user has already registered via the above method and is now logging into the app, perhaps after installing it on a new phone.</p>\n\n<p>As I mentioned before if the user signed up without a password then start by sending a verify code, in just the same way as we did during the sign up process. Once we have the code we can generate a <code>AGCOnnectAuthCredential</code> object<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code><span class="nc">AGConnectAuthCredential</span> <span class="n">credential</span> <span class="o">=</span> <span class="n">credential</span> <span class="o">=</span> <span class="nc">EmailAuthProvider</span><span class="o">.</span><span class="na">credentialWithVerifyCode</span><span class="o">(</span>\n                            <span class="n">email</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">trim</span><span class="o">(),</span>\n                            <span class="kc">null</span><span class="o">,</span>\n                            <span class="n">authCode</span><span class="o">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>Here we get the email that the user entered (<code>email</code> being an <code>EditText</code> object). We pass null for the password as we haven\'t used this, and finally the authCode which the user has entered into the app.</p>\n\n<p>Now we can attempt the sign the user in:<br>\n</p>\n<div class="highlight js-code-highlight">\n<pre class="highlight java"><code>  <span class="nc">AGConnectAuth</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">signIn</span><span class="o">(</span><span class="n">credential</span><span class="o">)</span>\n                <span class="o">.</span><span class="na">addOnSuccessListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnSuccessListener</span><span class="o">&lt;</span><span class="nc">SignInResult</span><span class="o">&gt;()</span> <span class="o">{</span>\n                    <span class="nd">@Override</span>\n                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="nc">SignInResult</span> <span class="n">signInResult</span><span class="o">)</span> <span class="o">{</span>\n                        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"Sign in successful: "</span> <span class="o">+</span>\n                                <span class="n">signInResult</span><span class="o">.</span><span class="na">getUser</span><span class="o">().</span><span class="na">getUid</span><span class="o">(),</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>\n                    <span class="o">}</span>\n                <span class="o">})</span>\n                <span class="o">.</span><span class="na">addOnFailureListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnFailureListener</span><span class="o">()</span> <span class="o">{</span>\n                    <span class="nd">@Override</span>\n                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>\n                        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"sign in failed:"</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">);</span>\n                    <span class="o">}</span>\n                <span class="o">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>We pass the credential object into the signIn method, if the code and email matched and was correct the OnSuccessListener will return the SignInResult object just as it did during the sign up, from here we have access to the users detials.<br>\nIf for any reason the login fails we will get an Exception in the OnFailureListener. </p>\n\n<p>And thats it! We have setup the application to use Huawei services and configured the app to use email authentication during sign up and log in.</p>\n\n<p>For more information on the Auth service, full documentation can be found here <a href="https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-auth-introduction-0000001053732605">https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-auth-introduction-0000001053732605</a></p>\n<h1>\n  <a name="twitch-acccount" href="#twitch-acccount">\n  </a>\n  Twitch Acccount\n</h1>\n\n<p><iframe src="https://clips.twitch.tv/embed?clip=devwithzachary&amp;parent=dev.to&amp;autoplay=false" height="399" width="710" allowfullscreen="true" frameborder="0" scrolling="no">\n</iframe>\n</p>\n<h1>\n  <a name="github-repo" href="#github-repo">\n  </a>\n  Github Repo\n</h1>\n\n\n<div class="ltag-github-readme-tag">\n  <div class="readme-overview">\n    <h2>\n      <img src="https://res.cloudinary.com/practicaldev/image/fetch/s--566lAguM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev.to/assets/github-logo-5a155e1f9a670af7944dd5e12375bc76ed542ea80224905ecaf878b9157cdefc.svg" alt="GitHub logo" loading="lazy">\n      <a href="https://github.com/devwithzachary">\n        devwithzachary\n      </a> / <a style="font-weight: 600;" href="https://github.com/devwithzachary/Barker">\n        Barker\n      </a>\n    </h2>\n    <h3>\n      Project init\n    </h3>\n  </div>\n  <div class="ltag-github-body">\n    \n<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto">\nBarker - A Serverless Twitter Clone</h1>\n<p dir="auto">Barker is a simple twitter style social network written to demostrate the serverless services provided by Huawei\'s AppGallery Connect platform.</p>\n<p dir="auto">This app is written during live streams over at <a href="https://www.twitch.tv/devwithzachary" rel="nofollow">https://www.twitch.tv/devwithzachary</a>\nThe streams are then edited down into videos which you can watch <a href="https://www.youtube.com/channel/UC63PqG8ZnWC4JWYrNJKocMA" rel="nofollow">https://www.youtube.com/channel/UC63PqG8ZnWC4JWYrNJKocMA</a></p>\n<p dir="auto">Finally there is also a written copy of the guide found on dev.to <a href="https://dev.to/devwithzachary" rel="nofollow">https://dev.to/devwithzachary</a></p>\n<p dir="auto">Each episodes code is commited as a single commit to make it easy to step along with the code, simply checkout the specific commit and follow along!</p>\n</article></div>\n\n  </div>\n  <div class="gh-btn-container"><a class="gh-btn" href="https://github.com/devwithzachary/Barker">View on GitHub</a></div>\n</div>\n\n\n\n<p>We will be back with the next part next week!</p>\n\n',n.body_markdown="Not read part 0? Read it first! {% link https://dev.to/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-0-3hmj %}\n\n\nOver the next couple of months I will be releasing a complete end to end guide to creating an Android app using serverless functionality to completely remove the need for any backend server/hosting etc.\n\nThis weeks Video is below\n\n{% youtube OMX7xXBQ6Yg%}\n\nAnd at the bottom of this post you will find my twitch channel where we live stream every Thursday at 2pm BST and the github repo for this project!.\n\nBut for those that would rather a written guide, lets get into it!\n\n#Project Setup\nStarting with a brand new project (or one that has never used Huawei services) we will need to start by setting up a new app. (If you haven't setup your developer account yet [sign up!](https://developer.huawei.com/consumer/en/)) \n\nIf you would like the complete step by step guide on how to get setup check out the [Official Documentation](https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-get-started-android-0000001058210705), but below is a summery.\n\nNavigate to the the [AppGallery Connect](https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/) area of the developer portal, here you need to create a [new project](https://developer.huawei.com/consumer/en/service/josp/agc/index.html#/addProject).\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g07gsy6ch6bocg9zdnad.png)\n\nFollow the new project guide, giving that project a name. Once completed on the left hand menu find the Auth service under the build menu.\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksranpl51ul2hk6ntp4b.png)\nClick the enable now button in the top right corner to enable this service for your project. Set a default data processing location, depending on your physical location will most likely help decide which to use. For us we have selected Germany as this is the closest location and within the EU.\n\nFrom here you are presented with the list of authentication modes, Huawei supports a wide range of services from Facebook login to AppleID. However today we are focusing on the email auth method. Click the enable button next to this.\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ayls0pm8aipkmw8filq9.png)\n\n  \nNow that everything is setup in the project, its time to setup the app! At this point I will assume you have created a new blank project in Android Studio and given it a package name etc.\nFrom the project settings top screen, select the Add app button to setup a new app under this project.\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hhftxijc5fx19qmaqkoa.png)\nFill in the add app form, setting the platform, app name, package etc so that it can be added to the created project. Its worth noting at this point, that while we are focusing on Android today many of these services can be used across multiple platforms including iOS and web.\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0ieevkpi5t3bdyenubgo.png)\nOnce completed you will be told to download the agconnect-services.json file and presented with a code to get the core services setup. As we are already focusing on a specific service for today the setup at this point is a little different.\nStart by placing your nearly downloaded `agconnect-services.json` file into the app directory of your project.\n![image](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m1hmuam07yih8wecej9a.png)\n\nNext we will get gradle configured correctly. In your top level gradle build file add the below to your repositories both under buildscript and allprojects\n  \n```gradle\nmaven {\n    url 'https://developer.huawei.com/repo/'\n}\n```\n\nAnd to your dependencies add `classpath 'com.huawei.agconnect:agcp:1.4.1.300'`\n\nYour file should now look a little like\n\n```gradle\n// Top-level build file where you can add configuration options common to all sub-projects/modules.\nbuildscript {\n    repositories {\n        google()\n        mavenCentral()\n        maven {\n            url 'https://developer.huawei.com/repo/'\n        }\n    }\n    dependencies {\n        classpath \"com.android.tools.build:gradle:4.2.2\"\n        classpath 'com.huawei.agconnect:agcp:1.4.1.300'\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        mavenCentral()\n        jcenter() // Warning: this repository is going to shut down soon\n        maven {\n            url 'https://developer.huawei.com/repo/'\n        }\n    }\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n```\n\nNext open your app build.gradle file\n\nStart by adding the agconnect plugin into your plugins list\n\n```gradle\nplugins {\n    id 'com.android.application'\n    id 'com.huawei.agconnect'\n}\n```\n\nMake sure to set your midSdkVersion to at least `17` (this is required for any Huawei AppGallery Connect services.\n\nAnd then in dependencies we are going to add the core and auth services\n\n```gradle\n    implementation 'com.huawei.agconnect:agconnect-core:1.4.1.300'\n    implementation 'com.huawei.agconnect:agconnect-auth:1.4.1.300'\n```\n\nSo your file should now look something like\n\n```gradle\nplugins {\n    id 'com.android.application'\n    id 'com.huawei.agconnect'\n}\n\nandroid {\n    compileSdkVersion 30\n    buildToolsVersion \"30.0.3\"\n\n    defaultConfig {\n        applicationId \"site.zpweb.barker\"\n        minSdkVersion 17\n        targetSdkVersion 30\n        versionCode 1\n        versionName \"1.0\"\n\n        testInstrumentationRunner \"androidx.test.runner.AndroidJUnitRunner\"\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n}\n\ndependencies {\n    implementation 'com.huawei.agconnect:agconnect-core:1.4.1.300'\n    implementation 'com.huawei.agconnect:agconnect-auth:1.4.1.300'\n    implementation 'androidx.appcompat:appcompat:1.3.0'\n    implementation 'com.google.android.material:material:1.3.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.0.4'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.3'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.4.0'\n}\n```\n\nAnd thats it! let gradle sync up and we are all good to go!\n\n#Registration\nAs I mentioned before there are a wide range of ways a user can authenticate using the Auth service, but here we are looking at the email service. Email authenticate the user by sending them a code via (your guessed it) Email. The user then inputs this code back into the app to confirm that they are who the say they are, and that they have access to that contact method. We will assume you have setup some kind of register view that will capture a users email.\n\nWe start by requesting an authentication code be set to the user, the code to do this looks like\n\n```java\nVerifyCodeSettings settings = VerifyCodeSettings.newBuilder()\n                .action(VerifyCodeSettings.ACTION_REGISTER_LOGIN)\n                .sendInterval(30)\n                .locale(Locale.ENGLISH)\n                .build();\nTask<VerifyCodeResult> task = EmailAuthProvider.requestVerifyCode(emailString, settings);\n            task.addOnSuccessListener(TaskExecutors.uiThread(), new OnSuccessListener<VerifyCodeResult>() {\n                @Override\n                public void onSuccess(VerifyCodeResult verifyCodeResult) {\n                    authCodeDialog();\n                }\n            }).addOnFailureListener(TaskExecutors.uiThread(), new OnFailureListener() {\n                @Override\n                public void onFailure(Exception e) {\n                    Toast.makeText(RegisterActivity.this,\n                            \"Error, code sending failed: \" + e,\n                            Toast.LENGTH_LONG).show();\n                }\n            });\n```\n\nLets break this down, we start by defining a `VerifyCodeSettings` object, this holds all the settings relating to the sending of the code. Here we define what locale should be used for the message text that is sent, what kind of code it is and the send interval.\n\nNext we create a task to be run\n```java\nTask<VerifyCodeResult> task = EmailAuthProvider.requestVerifyCode(emailString, settings);\n```\n\nUsing the EmailAuthProvider, where `emailString` is the email address the user has entered, as a string and the settings object is the VerifyCodeSettings object we just created.\n\nNext we setup an OnSucessListener which will be called if the code was successfully sent to the user. In this example we are calling the method `authCodeDialog();` to display a dialog to enter the code, which will see in a moment.\nWe also setup an OnFailureListener which simply create a toast on screen to display what ever error is sent back.\n\nNow that we have sent the user a code we should display some view for them to enter that code, in my instance I have the method below, but of course this could be what ever view you wanted.\n\n```java\nprivate void authCodeDialog() {\n        AlertDialog.Builder alert = new AlertDialog.Builder(this);\n        final EditText authCodeField =  new EditText(this);\n        alert.setMessage(\"Enter your auth code below\");\n        alert.setTitle(\"Authentication Code\");\n\n        alert.setView(authCodeField);\n\n        alert.setPositiveButton(\"Register\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                String authCode = authCodeField.getText().toString();\n                register(authCode);\n            }\n        });\n\n        alert.setNegativeButton(\"Cancel\", new DialogInterface.OnClickListener() {\n            @Override\n            public void onClick(DialogInterface dialog, int which) {\n                Toast.makeText(RegisterActivity.this,\n                        \"Registration Cancelled\",\n                        Toast.LENGTH_LONG).show();\n            }\n        });\n\n        alert.show();\n    }\n```\n\nFinally once the user has inputted the code we can register them as you can see above we have a register method that is called, this has the below code:\n\n```java\nEmailUser emailUser = new EmailUser.Builder()\n                    .setEmail(emailString)\n                    .setVerifyCode(authCode)\n                    .build();\n\n            AGConnectAuth.getInstance().createUser(emailUser).addOnSuccessListener(new OnSuccessListener<SignInResult>() {\n                @Override\n                public void onSuccess(SignInResult signInResult) {\n                    Toast.makeText(RegisterActivity.this,\n                            \"Register Successful: \" + signInResult.getUser().getUid(),\n                            Toast.LENGTH_LONG);\n                }\n            }).addOnFailureListener(new OnFailureListener() {\n                @Override\n                public void onFailure(Exception e) {\n                    Toast.makeText(RegisterActivity.this,\n                            \"Registering failed \" + e,\n                            Toast.LENGTH_LONG);\n                }\n            });\n```\n\nSo we start by creating an `EmailUser` using the email address we captured earlier and the authCode that the user has entered. Using that `EmailUser` we then attempt to register. Note that we can also set a password against the `EmailUser`, if we do this when they go to login they do not need to verify their email address again. They can just enter their email and password.\n\nAs you can see we pass the created object into the createUser method, attaching OnSuccess and OnFailure Listeners. If the user is successfully registered, i.e the code they entered matches what was sent we are returned a `SignInResult` this object containes the user. So in this example we simply print out the registered users UID to confirm it completed successfully.\n\n#Login\n\nNow that we have covered the sign up process lets look at how we might handle a login process. This would assume that the user has already registered via the above method and is now logging into the app, perhaps after installing it on a new phone.\n\nAs I mentioned before if the user signed up without a password then start by sending a verify code, in just the same way as we did during the sign up process. Once we have the code we can generate a `AGCOnnectAuthCredential` object\n\n```java\nAGConnectAuthCredential credential = credential = EmailAuthProvider.credentialWithVerifyCode(\n                            email.getText().toString().trim(),\n                            null,\n                            authCode);\n```\n\nHere we get the email that the user entered (`email` being an `EditText` object). We pass null for the password as we haven't used this, and finally the authCode which the user has entered into the app.\n\nNow we can attempt the sign the user in:\n\n```java\n  AGConnectAuth.getInstance().signIn(credential)\n                .addOnSuccessListener(new OnSuccessListener<SignInResult>() {\n                    @Override\n                    public void onSuccess(SignInResult signInResult) {\n                        Toast.makeText(MainActivity.this, \"Sign in successful: \" +\n                                signInResult.getUser().getUid(), Toast.LENGTH_LONG);\n                    }\n                })\n                .addOnFailureListener(new OnFailureListener() {\n                    @Override\n                    public void onFailure(Exception e) {\n                        Toast.makeText(MainActivity.this, \"sign in failed:\" + e, Toast.LENGTH_LONG);\n                    }\n                });\n```\n\nWe pass the credential object into the signIn method, if the code and email matched and was correct the OnSuccessListener will return the SignInResult object just as it did during the sign up, from here we have access to the users detials.\nIf for any reason the login fails we will get an Exception in the OnFailureListener. \n\nAnd thats it! We have setup the application to use Huawei services and configured the app to use email authentication during sign up and log in.\n\n\nFor more information on the Auth service, full documentation can be found here https://developer.huawei.com/consumer/en/doc/development/AppGallery-connect-Guides/agc-auth-introduction-0000001053732605\n\n#Twitch Acccount\n\n{% twitch devwithzachary%}\n\n#Github Repo\n\n{% github devwithzachary/Barker%}\n\nWe will be back with the next part next week!\n",n.user={name:"Zachary Powell",username:t,twitter_username:"AppgalleryC",github_username:t,website_url:"https://www.youtube.com/channel/UC63PqG8ZnWC4JWYrNJKocMA/",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--SaE0d5J8--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/506918/52a7bac6-9f92-4cbd-a577-35d950db17cc.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--BLRiP1sn--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/506918/52a7bac6-9f92-4cbd-a577-35d950db17cc.jpeg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:n}},error:s,state:{currentArticle:n},serverRendered:!0,routePath:"/devwithzachary/752236",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:s}}}}(null,"2021-07-07T11:45:35Z",{},"https://dev.to/devwithzachary/writing-a-serverless-android-app-ft-huawei-s-appgallery-connect-part-1-auth-4hlc","devwithzachary")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
