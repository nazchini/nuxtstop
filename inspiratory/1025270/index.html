<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>A Practical Introduction to Developing Web3 Apps Using Solidity and React - Part 1</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>A Practical Introduction to Developing Web3 Apps Using Solidity and React - Part 1</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/blockchain" class="tag" data-v-70afb46a>
          #blockchain
        </a><a href="/nuxtstop/t/web3" class="tag" data-v-70afb46a>
          #web3
        </a><a href="/nuxtstop/t/solidity" class="tag" data-v-70afb46a>
          #solidity
        </a><a href="/nuxtstop/t/smartcontract" class="tag" data-v-70afb46a>
          #smartcontract
        </a></div> <!----> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            10
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            1
          </span></div> <time data-v-70afb46a>Mar 16</time></div></header> <div class="content" data-v-70afb46a><h2>
  <a name="developing-a-smart-contract" href="#developing-a-smart-contract">
  </a>
  Developing a Smart Contract
</h2>

<p>Imagine building a project with someone. You are planning on monetizing this project by accepting payments in cryptocurrency. You would want to distribute the earnings fairly in between yourselves. <a href="https://www.partnerly.co/">Partnerly.co</a> helps you do this. It is an app that helps you create a smart contract on the blockchain that can distribute the collected payments between two (or more) parties in a predetermined split ratio.</p>

<p>I will show you how I built <strong>Partnerly</strong> from scratch. In this part of this walkthrough, you will learn how to create the smart contract that can be deployed on the <strong>Ethereum blockchain</strong> using <strong>Solidity</strong>.</p>

<p>The code for the smart contract and the front end application is available at <a href="https://github.com/hibernationTheory/partnerly">https://github.com/hibernationTheory/partnerly</a>.</p>

<h2>
  <a name="disclaimer" href="#disclaimer">
  </a>
  Disclaimer
</h2>

<p>I am not a Blockchain developer. In fact, I am just learning this stuff myself. However, I am a software developer and an educator who taught programming from scratch to thousands of students. I can't claim that you will become a Blockchain development expert by just following this walkthrough, but I am pretty confident that you will learn practical skills that will make this a valuable stepping stone in your journey.</p>

<p>Let's get started!</p>

<h2>
  <a name="getting-started" href="#getting-started">
  </a>
  Getting Started
</h2>

<p>This walkthrough assumes you have a working knowledge of <strong>JavaScript</strong>, <strong>Node.js</strong> and <strong>React</strong>. We will be using the <strong>Solidity</strong> language to develop the smart contract, which is relatively similar to <strong>JavaScript</strong>. The user interface we will be building for this contract will use <strong>React</strong>, <strong>Next.js</strong> and <strong>Tailwind</strong> libraries.</p>

<p>I use Visual Studio Code (VS Code) for coding. VS Code has an extension that makes working with Solidity (<code>sol</code>) files easy, so I recommend you <a href="https://marketplace.visualstudio.com/items?itemName=JuanBlanco.solidity">download</a> that for a better development experience.</p>

<p>If you are yet to install Node.js, make sure to install it using <a href="https://github.com/nvm-sh/nvm">nvm</a>. <strong>nvm</strong> makes it easy to manage multiple Node versions on the same system.</p>

<p>We will first need to install a library called <a href="https://hardhat.org/">Hardhat</a>. <strong>Hardhat</strong> is a local development tool that makes developing, testing and deploying smart contracts easy.</p>

<p>Let's create a folder for our smart contract and initialize <strong>npm</strong> to install packages from the node registry.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code><span class="nb">mkdir </span>partnerly-contract
<span class="nb">cd </span>partnerly-contract
npm init <span class="nt">-y</span>
npm <span class="nb">install</span> <span class="nt">--save-dev</span> hardhat
npx hardhat
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>When you run <code>npx hardhat</code> you will be presented with some options. Select <code>> Create a basic sample project</code> and say <code>yes</code> to all the questions. This will set up a sample project with Hardhat, further dependencies will get installed.</p>

<h2>
  <a name="initializing-the-contract" href="#initializing-the-contract">
  </a>
  Initializing the Contract
</h2>

<p>We will be developing our contract inside the <code>contracts</code> folder. Let's delete the sample contract in there and create a new file called <code>Partnership.sol</code>. Below is what the skeleton of our contract looks like. I will explain every line that is in there.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.4;

import "hardhat/console.sol";

contract Partnership {
    constructor() {
        console.log("Contract is deployed");
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The first line inside the contract is a comment that defines the licence for this contract. We will just leave it to be <strong>unlicensed</strong>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The second line is for the Solidity version you want for this contract. We will be using version <code>0.8.4</code>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code>pragma solidity ^0.8.4<span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Hardhat created a config file called <code>hardhat.config.js</code> when we initiated this sample project. You should set the version declaration in there to match the contract version.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">solidity</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.8.4</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Next, we are importing another contract into our contract called <code>hardhat/console.sol</code>. This is similar to how you would import libraries when coding in Node.js to enhance the functionality of your programs. <code>console.sol</code> gives our contract the ability to call the <code>console.log</code> function, which will make debugging the contract easier as we are developing it. We will remove this function before deploying the contract to a live network since it costs some <strong>gas</strong> to execute the <code>console.log</code> statements on the Ethereum network. You can think of <strong>gas</strong> as the price you need to pay for things to get executed on the Ethereum blockchain.</p>

<p>Next, we define a contract called <code>Partnership</code> that console.log's the message <code>Contract is deployed</code> when it is deployed.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>contract Partnership {
    constructor() {
        console.log("Contract is deployed");
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Notice the definition of a contract is pretty similar to the definition of a <strong>class</strong> in JavaScript. Just like a class, a contract has a <strong>constructor</strong> function that gets executed when the contract is initialized (<strong>deployed</strong> in our case). It potentially can have other attributes and methods that will help us define the contract's data and behaviour. But for now, let's just <code>console.log</code> a string to indicate that the contract is deployed.</p>

<h2>
  <a name="running-the-contract" href="#running-the-contract">
  </a>
  Running the Contract
</h2>

<p>Using Hardhat, we can define a script that will simulate the deployment of a contract. Let's create a script called <code>run.js</code> inside the <code>scripts</code> folder.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>

  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=></span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We can execute this script by running this statement inside the terminal:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code> npx hardhat run scripts/run.js
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We should now see our <code>console.log</code> message get executed. The contract gets deployed successfully.</p>

<p>This <code>run.js</code> file has a bunch of boilerplate that we will skim over. You won't need to adjust some of the statements in there.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>const hre = require("hardhat");
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The above statement imports the <code>hardhat</code> library into the <code>run</code> script. You might see some other examples where this line is omitted. That is because this dependency gets automatically injected when you call this script using <code>npx hardhat</code>.</p>

<p>It is the same with the first statement inside the <code>main</code> function. You might see it getting omitted in some examples. I have included in my examples for the sake of completeness.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>async function main() {
  await hre.run("compiler");
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The following statement executes the async <code>main</code> function and exits from the script once the execution is completed. It additionally logs errors if there are any.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
  });
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>What we need to care about are these three lines of code.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>// We get the contract to deploy
const Contract = await hre.ethers.getContractFactory("Partnership");
const contract = await Contract.deploy();

await contract.deployed();
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We first compile the smart contract with the given name and then deploy the contract using the <code>deploy</code> method. Then, we ensure that the contract is deployed using the <code>deployed</code> method. Note that all these operations are <strong>asynchronous</strong>, so we use the <strong>async-await</strong> pattern.</p>

<p>We can continue developing the contract now that we have a script to execute it.</p>

<h2>
  <a name="terms-of-the-contract" href="#terms-of-the-contract">
  </a>
  Terms of the Contract
</h2>

<p>Let's think of what we would like to do with this contract.</p>

<ul>
<li>We want to create a contract that requires two or more <strong>wallet addresses</strong> that can accept payments.</li>
<li>The contract will also require split ratios to be defined for each given address. 1 to 1 split ratio means an equal split. 2 to 1 split means that the first address will get double the amount of the second one.</li>
<li>The contract will store these given addresses and split ratios.</li>
<li>The contract should be able to receive and store payments.</li>
<li>When a withdrawal is requested, the stored amount should be transferred to the contract's parties in the designated split ratio.</li>
</ul>

<p>At this point, I should mention that I am not a lawyer. In fact, I am just a simple programmer, and as a programmer, I write bugs all the time. This poses some problems when it comes to developing smart contracts. It is impossible to ensure that a contract (or a program, for that matter) doesn't have a bug, and once a contract is deployed, you can't change it. The implication is that it is possible to deploy a buggy program that you can't alter after the fact.</p>

<p>The code for the smart contract is available on the blockchain for anyone to see. This transparency is great since you can verify that the contract is working as intended by reading the code. However, it also means that any actor could be dissecting the contract to take advantage of its vulnerabilities.</p>

<p>Have a look at the above terms. Does it look airtight? When I started to code this, it looked pretty good to me until I realized the users could pass a split ratio equivalent to <code>0</code>, which would cause the contract to fail (You can't divide a number with <code>0</code>). This is only a single oversight I could catch, and I can't guarantee there aren't others!</p>

<p>So let's ensure we update our requirements to include that the split ratios should be bigger than 0.</p>

<ul>
<li>The contract will also need split ratios to be defined for each given address. Each split ratio should be bigger than 0.</li>
</ul>

<h2>
  <a name="passing-and-storing-values-inside-the-smart-contract" href="#passing-and-storing-values-inside-the-smart-contract">
  </a>
  Passing and Storing Values inside the Smart Contract
</h2>

<p>You can store data (state) inside the contract by defining variables inside the contract body. Any value passed into these variables will be stored inside the contract <strong>permanently</strong>.</p>

<p>Let's define a contract that has some state variables.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.4;

import "hardhat/console.sol";

contract Partnership {
    string private deploymentMessage = "Contract is deployed";
    uint256 private partnerAmount = 2;
    address[] public addresses;

    constructor(address[] memory _addresses) {
        require(
            _addresses.length == partnerAmount,
            "You can't have more than 2 partners"
        );

        addresses = _addresses;

        console.log(deploymentMessage);
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Solidity is a <strong>typed</strong> language meaning that we need to define our variable types.</p>

<p>We can also define the <strong>visibility</strong> and <strong>accessibility</strong> of these variables by using the keywords <code>public</code> and <code>private</code>. A <strong>private</strong> variable is meant to be accessible only inside the contract. In contrast, Solidity creates a <strong>getter</strong> function for a <strong>public</strong> variable, meaning that you could read the value of this variable by calling an automagically generated method of the same name (<code>partnerAmount()</code> and <code>addresses()</code> in this case).</p>

<p>We have defined three variables at the top of this contract. A private <code>string</code> variable called <code>deploymentMessage</code>, a public <code>uint256</code> (an unsigned 256 bit integer) variable called <code>partnerAmount</code>, and a public array of <code>address</code> type called <code>addresses</code>. The <code>addresses</code> variable doesn't have a value yet. It is going to be populated by the caller of this contract.</p>

<p>We have updated the <code>constructor</code> function to accept <code>_addresses</code> as an argument. It is conventional to prefix function arguments with an underscore (<code>_</code>) to differentiate them from the state variables.</p>

<p>We use a keyword called <code>memory</code> before the <code>_addresses</code> argument. The <code>memory</code> keyword instructs Solidity that this data doesn't need to be part of the permanent storage. The function arguments are always declared with the <code>memory</code> keyword.</p>

<p>Constructor function makes use of a built-in function called <code>require</code> that checks to see if the given conditional is <code>true</code>. If not, it reverts the operation (an operation is called <code>transaction</code> in Blockchain terms) with the given message.</p>

<p>In our case, we require the given address amount to be equal to the defined <code>partnerAmount</code>. If that is not the case, the transaction will not go through. If there aren't any errors, our contract will deploy, and the passed arguments will permanently get stored inside this smart contract.</p>

<p>If we tried running the <code>run</code> script as is, we would get an error since our script now expects an array of two addresses to be passed in. Let's update our <code>run</code> script to pass addresses inside this contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">partnerAmount</span><span class="p">());</span>
  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">addresses</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=></span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We use the <code>hre.ethers.getSigners</code> function to get objects representing Ethereum accounts. We create an array of addresses by using the addresses of these accounts by using their <code>address</code> property.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>const [owner, person1] = await hre.ethers.getSigners();
const addresses = [owner.address, person1.address];
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We then pass these addresses into our contract during the initialization. Our contract successfully deploys when provided with two addresses.</p>

<p>Another way of ensuring that our contract would only accept two addresses would have been to define the array to have a fixed size. That way, we wouldn't need the <code>require</code> statement since the condition would be enforced at a data type level.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>address[2] public addresses;
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are also logging the <code>partnerAmount</code> and the first address inside the <code>addresses</code> array by using the getter functions that Solidity exposes since these are defined as <strong>public</strong> variables.</p>

<p>While the <code>run</code> script is helpful to us in understanding the runtime behaviour of our contract, it is not a reliable way to ensure that our contract behaves correctly for our use cases. To develop confidence in our contract, we should write some <strong>tests</strong> that cover its behaviour.</p>

<p>Create a file called <code>Partnership.js</code> inside the test folder. This is what it will look like:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be deployed by providing two addresses on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

    <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

    <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">);</span>
    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We will call this file using <code>npx hardhat test test/Partnership.js</code>. You should see a nicely formatted terminal output that tells us that 1 test has passed. As you can see, this file is super similar to our <strong>run</strong> script. The only difference is that it includes a <strong>test suite</strong> that gets executed whenever this script is called. The <code>describe</code> function describes what this test suite is for. The test block that starts with the function name <code>it</code> defines a test block that tests one aspect of our contract. In this case, it just tests to see if the contract is deploying successfully.</p>

<p>Let's write a test to see if our contract is failing as expected when no addresses are provided. First, we will need to import an <code>expect</code> method to help us make <strong>assertations</strong>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">expect</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">chai</span><span class="dl">"</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And then, we will add this test block right after the previous one.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when NOT providing addresses on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">error</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>
    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">error</span> <span class="o">=</span> <span class="nx">_error</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>You would get an error thrown when a contract that expects arguments is deployed without being provided with those arguments. Here we start by initializing an empty <code>error</code> variable.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">error</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And then, we use the <strong>try-catch</strong> block to see if the error is populated or not. The error gets populated because the deployment fails when addresses are not provided. We check for the error to exist (to be truthy) inside the <code>finally</code> block:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Tests are a super important part of any software development process. They not only help you ascertain the behaviour of a program (or a smart contract), but they can also give you confidence that the existing behaviour of the contract doesn't break when you modify it. You can ensure this by running the test suite whenever you update the contract.</p>

<p>Tests are an essential part of the software development process. There is a software development paradigm called <strong>Test-Driven Development (TDD)</strong>, where we first write a failing test for each feature. We then implement the bare minimum code that will make this test pass. This methodology forces us to be iterative with our development process. We will try to follow this methodology while developing our smart contract.</p>

<h2>
  <a name="smart-contract-continued" href="#smart-contract-continued">
  </a>
  Smart Contract Continued
</h2>

<p>In the previous section, we wrote a contract that takes two addresses. But we would like our eventual contract to work with two or more addresses and equivalent amounts of split ratios.</p>

<p>Let's change our tests to encode this expectation. We will be deleting the tests from before and writing new ones. Here is the first test block we will have. It simply tests if the contract deploys without errors when provided with the required amount of addresses and split ratios.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be deployed by providing at least two addresses and equal amounts of split ratios on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Our second test will check to see if our contract fails as expected when the address amount and the split ratio amount are different. In this test, we will have two addresses but three split ratios.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when the split ratios are not equivalent to the address amount</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">The address amount and the split ratio amount should be equal</span><span class="dl">"</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We use a new method on the <code>expect</code> function called <code>revertedWith</code> that checks to see if the transactions are reverted with the expected message.</p>

<p>We will add one more test block to ensure that the contract fails to deploy when it is called with less than two addresses.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when the the address amount is less than two</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">];</span>

  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">More than one address should be provided to establish a partnership</span><span class="dl">"</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>All these tests will currently fail when called. Let's update our contract to make them pass. Our new contract will look like this.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.4;

import "hardhat/console.sol";

contract Partnership {
    address[] public addresses;
    uint256[] public splitRatios;

    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {
        require(
            _addresses.length > 1,
            "More than one address should be provided to establish a partnership"
        );

        require(
            _splitRatios.length == _addresses.length,
            "The address amount and the split ratio amount should be equal"
        );
        addresses = _addresses;
        splitRatios = _splitRatios;
        console.log("Contract is Deployed");
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We now have two <code>require</code> statements. The first one is to ensure that more than one address is passed into the contract, and the second is to ensure that an equal amount of split ratios is provided. We get the <code>_addresses</code> and <code>_splitRatios</code> and store them inside the contract.</p>

<p>If we want to update our <code>run</code> script, we can do so by including <code>splitRatios</code> as an argument.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">addresses</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">splitRatios</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=></span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are now defining and passing split ratios to the contract as well inside the <code>run</code> script.</p>

<h2>
  <a name="requiring-valid-arguments" href="#requiring-valid-arguments">
  </a>
  Requiring Valid Arguments
</h2>

<p>We also need to ensure that there are no split ratios that are less than or equal to 0. We should iterate through every split ratio to see if they are all above one. The test for this functionality would look like this.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when any of the split ratios is less than one</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>

  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">Split ratio can not be 0 or less</span><span class="dl">"</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>As mentioned previously, this test will initially fail. Let's implement the code that would make it pass.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.4;

import "hardhat/console.sol";

contract Partnership {
    address[] public addresses;
    uint256[] public splitRatios;
    uint256 private splitRatiosTotal;

    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {
        require(
            _addresses.length > 1,
            "More than one address should be provided to establish a partnership"
        );

        require(
            _splitRatios.length == _addresses.length,
            "The address amount and the split ratio amount should be equal"
        );
        addresses = _addresses;
        splitRatios = _splitRatios;
        splitRatiosTotal = getSplitRatiosTotal(splitRatios);

        console.log("Contract is Deployed");
    }

    function getSplitRatiosTotal(uint256[] memory _splitRatios)
        private
        pure
        returns (uint256)
    {
        uint256 total = 0;

        for (uint256 i = 0; i &lt; _splitRatios.length; i++) {
            require(_splitRatios[i] > 0, "Split ratio can not be 0 or less");
            total += _splitRatios[i];
        }

        return total;
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We now added a new variable called <code>splitRatiosTotal</code> that is <code>private</code>. This means that it won't be accessible from outside of the contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>uint256 private splitRatiosTotal;
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We have defined a new function called <code>getSplitRatiosTotal</code> that goes through every item in a given <code>uint256[]</code> and checks to see if they are bigger than <code>0</code>. It also calculates the sum of those items and stores it inside a state variable <code>splitRatiosTotal</code>. We will use this variable when we want to distribute the funds to the contract addresses.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">getSplitRatiosTotal</span><span class="p">(</span><span class="nx">uint256</span><span class="p">[]</span> <span class="nx">memory</span> <span class="nx">_splitRatios</span><span class="p">)</span>
    <span class="kr">private</span>
    <span class="nx">pure</span>
    <span class="nx">returns</span> <span class="p">(</span><span class="nx">uint256</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">uint256</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">uint256</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">_splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">require</span><span class="p">(</span><span class="nx">_splitRatios</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">></span> <span class="mi">0</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Split ratio can not be 0 or less</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">total</span> <span class="o">+=</span> <span class="nx">_splitRatios</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">total</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We have defined this function as <code>private</code> and <code>pure</code>. A <strong>pure</strong> function means that the operation inside the function doesn't rely on any external state. It would return the same output for the same inputs on every execution. Pure functions are highly desirable in programming since their behaviour is very predictable.</p>

<p>Having a pure function in Solidity is also great since they don't cost any gas when executed. As mentioned previously, <strong>gas</strong> is the computational and monetary cost of doing operations on the Ethereum blockchain.</p>

<h2>
  <a name="receiving-payments" href="#receiving-payments">
  </a>
  Receiving Payments
</h2>

<p>We can now store addresses and split ratios inside the smart contract. Let's update our contract so that it can also receive payments. Let's start by writing a failing test for this.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can receive transactions in Ether</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="c1">// send ether to contract</span>
  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">),</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are using the following function call to send Ether to the contract from the <code>owner</code> account.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// send ether to contract</span>
<span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">),</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Our test currently fails because the contract can't receive funds. Making it to receive funds is super easy to do so. We just need to add a single line of code into our contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>receive() external payable {}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Run the test again. It should pass. The contract can now receive funds!</p>

<p>We will also add a function called <code>getBalance</code> that will get the current balance of the contract. We can test this function by checking if the balance increased by the expected amount after receiving a transaction.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">has a balance that increases after receiving a transaction</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">,</span> <span class="nx">person2</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">);</span>

  <span class="c1">// send ether to contract</span>
  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
    <span class="nx">value</span><span class="p">,</span>
  <span class="p">});</span>

  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We first check to see if the contract balance is <code>0</code> to begin with.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We then use the <code>parseEther</code> method to convert a single Ether's value to its <strong>Wei</strong> equivalent.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>A <strong>Wei</strong> is the smallest unit of Ether. Think of it as what a penny is to a dollar. The similarity ends there, though, since a dollar is only 100 times more valuable than a penny, whereas an Ether is 10^18 times more valuable than a <strong>Wei</strong>!</p>

<p>We then execute a transaction with this Wei value and check to see if the balance has increased.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Let's implement the <code>getBalance</code> method inside our contract so that the test would pass. This is again straightforward to do so.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">getBalance</span><span class="p">()</span> <span class="kr">public</span> <span class="nx">view</span> <span class="nx">returns</span> <span class="p">(</span><span class="nx">uint256</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">address</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">balance</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Note the usage of the <code>view</code> keyword in the function definition. A <strong>view</strong> function is a function that doesn't alter the state but merely reads it.</p>

<p>Our tests should start passing with the implementation of this function.</p>

<h2>
  <a name="sending-payments" href="#sending-payments">
  </a>
  Sending Payments
</h2>

<p>We will be implementing a function called <code>withdraw</code>. When called, this function will initiate the transfer of the funds to the recorded addresses according to the provided split ratio.</p>

<p>We can create a new <code>describe</code> block called <code>withdraw</code> inside the existing one. Using <code>describe</code> function allows us to categorize related tests together. We will include any withdrawal-related test inside this new block.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">"</span><span class="s2">withdraw</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be called if the contract balance is more than 0</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

    <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

    <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

    <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

    <span class="c1">// send ether to contract</span>
    <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
      <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5.0</span><span class="dl">"</span><span class="p">),</span>
    <span class="p">});</span>

    <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">not</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We check to see if the contract balance is non-zero after the transfer.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">not</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then we call the <code>withdraw</code> function. The test fails because the withdraw function doesn't exist. Let's fix that. We will add a <code>withdraw</code> function inside the contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>function withdraw() public {
    uint256 addressesLength = addresses.length;

    for (uint256 i = 0; i &lt; addressesLength; i++) {
        addresses[i].transfer(
            (balance / splitRatiosTotal) * splitRatios[i]
        );
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This function doesn't quite work yet. The reason for that is that we should define the addresses as <code>payable</code> for us to invoke the <code>transfer</code> method on them. We need to update the state variable for addresses and the argument inside the constructor with the <code>payable</code> keyword.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>address payable[] public addresses;
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And inside the <code>constructor</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>constructor(
    address payable[] memory _addresses,
    uint256[] memory _splitRatios
) {
    // constructor body
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With this change, the <code>withdraw</code> function should start working!</p>

<p>We would like to have the <code>withdraw</code> function fail if the balance is less than 0. Let's write the test for that.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be called if the contract balance is less than or equal to 0</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">Insufficient balance</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We first ensure that the balance of the contract is <code>0</code>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then we try to call the <code>withdraw</code> function. We should make it fail with the <code>"Insufficient balance"</code> error.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">Insufficient balance</span><span class="dl">"</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>To implement this inside the contract, we should get the contract balance inside the <code>withdraw</code> function and ensure it is bigger than 0.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>function withdraw() public {
    uint256 balance = getBalance();
    uint256 addressesLength = addresses.length;

    require(balance > 0, "Insufficient balance");

    for (uint256 i = 0; i &lt; addressesLength; i++) {
        addresses[i].transfer(
            (balance / splitRatiosTotal) * splitRatios[i]
        );
    }
}
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="ensuring-that-split-ratio-total-is-smaller-than-the-balance" href="#ensuring-that-split-ratio-total-is-smaller-than-the-balance">
  </a>
  Ensuring that Split Ratio Total is Smaller Than the Balance
</h2>

<p>We should ensure that the total split ratio is smaller than the balance. This way, we won't get any numerical errors when dividing the balance with the split ratio. Here is the test for that looks like.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be called when the total split ratio is greater than the contract balance</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">];</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="c1">// send ether to contract</span>
  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">0.00000000000000001</span><span class="dl">"</span><span class="p">),</span>
  <span class="p">});</span>

  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">Balance should be greater than the total split ratios</span><span class="dl">"</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are sending 10 Wei to the contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// send ether to contract</span>
<span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">0.00000000000000001</span><span class="dl">"</span><span class="p">),</span>
<span class="p">});</span>

<span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The total of the split ratios in this test is greater than 10 (it is 20). This causes the contract to fail with the <code>"Balance should be greater than the total split ratios"</code> message. We can implement this inside the contract by adding a simple <code>require</code> statement.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>require(balance >=
  splitRatiosTotal, "Balance should be greater than the total split ratios");
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="finalizing-the-run-script" href="#finalizing-the-run-script">
  </a>
  Finalizing the Run Script
</h2>

<p>Now that we have finished the contract logic, let's update the <code>run</code> script to simulate how someone would interact with this contract.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">,</span> <span class="nx">person2</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">provider</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="kd">let</span> <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person1 is: </span><span class="p">${</span><span class="nx">balance1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">balance2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person2 is: </span><span class="p">${</span><span class="nx">balance2</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">contractBalance</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance in the contract is: </span><span class="p">${</span><span class="nx">contractBalance</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5.0</span><span class="dl">"</span><span class="p">),</span>
  <span class="p">});</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`The balance in the contract after receiving funds is: </span><span class="p">${</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()}</span><span class="s2">`</span>
  <span class="p">);</span>

  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`The balance in the contract after withdrawal is: </span><span class="p">${</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()}</span><span class="s2">`</span>
  <span class="p">);</span>

  <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The new balance for the person1 is:</span><span class="p">${</span><span class="nx">balance1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

  <span class="nx">balance2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person2 is: </span><span class="p">${</span><span class="nx">balance2</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=></span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here, we simulate the contract deployment with two addresses and a 4 to 1 split ratio. We need to define a <code>provider</code> to get the balance from the Ethereum accounts.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">provider</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We can then call the <code>getBalance</code> method on the provider to see the contract balance.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Hardhat initializes these accounts with a balance of 10000 ETH.</p>

<p>After the deployment, we get another user to send 5000 ETH into the contract. The balance of the contract changes accordingly.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>
  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5000.0</span><span class="dl">"</span><span class="p">),</span>
<span class="p">});</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We then call the <code>withdraw</code> function on the contract. This distributes the funds inside the contract in between the addresses. We then check to ensure the balance of the accounts has changed accordingly.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>It seems like things are working as expected!</p>

<p>Believe it or not, this is it! We now have a program that can permanently store data, securely receive transactions, store funds and transfer those funds to specified accounts (wallet addresses). And it took less than 100 lines to write it! Building something like this makes you truly appreciate the power of blockchains and smart contract platforms like Ethereum. The amount of code and complexity to achieve something similar using centralized solutions would have been substantial.</p>

<p>How can other people make use of this smart contract? We could upload the contract to a public repository like Github and have other people clone it from there. They would need to change the run script to handle the deployment of the contract on the Ethereum blockchain themselves. Obviously, this is not an ideal or feasible solution for those who don't have any familiarity with working with smart contracts.</p>

<p>We could do so much better than this! If you enjoyed this walkthrough, check out my <a href="https://leanpub.com/develop-web3-apps-using-solidity-and-react/">ebook</a> for learning how to build the front end application for this contract using React, Next.js, and React.</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/inspiratory/a-practical-introduction-to-developing-web3-apps-using-solidity-and-react-part-1-cc1" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,n,a,t){return n.type_of="article",n.id=1025270,n.title="A Practical Introduction to Developing Web3 Apps Using Solidity and React - Part 1",n.description="Learn how to create the smart contract that can be deployed on the Ethereum blockchain using Solidity and following a TDD methodology. ",n.readable_publish_date="Mar 16",n.slug="a-practical-introduction-to-developing-web3-apps-using-solidity-and-react-part-1-cc1",n.path="/inspiratory/a-practical-introduction-to-developing-web3-apps-using-solidity-and-react-part-1-cc1",n.url="https://dev.to/inspiratory/a-practical-introduction-to-developing-web3-apps-using-solidity-and-react-part-1-cc1",n.comments_count=1,n.public_reactions_count=10,n.collection_id=s,n.published_timestamp=a,n.positive_reactions_count=10,n.cover_image=s,n.social_image="https://dev.to/social_previews/article/1025270.png",n.canonical_url="https://www.partnerly.co/learn",n.created_at="2022-03-16T21:31:14Z",n.edited_at=s,n.crossposted_at=s,n.published_at=a,n.last_comment_at="2022-06-03T23:14:26Z",n.reading_time_minutes=20,n.tag_list="blockchain, web3, solidity, smartcontract",n.tags=["blockchain","web3","solidity","smartcontract"],n.body_html='<h2>\n  <a name="developing-a-smart-contract" href="#developing-a-smart-contract">\n  </a>\n  Developing a Smart Contract\n</h2>\n\n<p>Imagine building a project with someone. You are planning on monetizing this project by accepting payments in cryptocurrency. You would want to distribute the earnings fairly in between yourselves. <a href="https://www.partnerly.co/">Partnerly.co</a> helps you do this. It is an app that helps you create a smart contract on the blockchain that can distribute the collected payments between two (or more) parties in a predetermined split ratio.</p>\n\n<p>I will show you how I built <strong>Partnerly</strong> from scratch. In this part of this walkthrough, you will learn how to create the smart contract that can be deployed on the <strong>Ethereum blockchain</strong> using <strong>Solidity</strong>.</p>\n\n<p>The code for the smart contract and the front end application is available at <a href="https://github.com/hibernationTheory/partnerly">https://github.com/hibernationTheory/partnerly</a>.</p>\n\n<h2>\n  <a name="disclaimer" href="#disclaimer">\n  </a>\n  Disclaimer\n</h2>\n\n<p>I am not a Blockchain developer. In fact, I am just learning this stuff myself. However, I am a software developer and an educator who taught programming from scratch to thousands of students. I can\'t claim that you will become a Blockchain development expert by just following this walkthrough, but I am pretty confident that you will learn practical skills that will make this a valuable stepping stone in your journey.</p>\n\n<p>Let\'s get started!</p>\n\n<h2>\n  <a name="getting-started" href="#getting-started">\n  </a>\n  Getting Started\n</h2>\n\n<p>This walkthrough assumes you have a working knowledge of <strong>JavaScript</strong>, <strong>Node.js</strong> and <strong>React</strong>. We will be using the <strong>Solidity</strong> language to develop the smart contract, which is relatively similar to <strong>JavaScript</strong>. The user interface we will be building for this contract will use <strong>React</strong>, <strong>Next.js</strong> and <strong>Tailwind</strong> libraries.</p>\n\n<p>I use Visual Studio Code (VS Code) for coding. VS Code has an extension that makes working with Solidity (<code>sol</code>) files easy, so I recommend you <a href="https://marketplace.visualstudio.com/items?itemName=JuanBlanco.solidity">download</a> that for a better development experience.</p>\n\n<p>If you are yet to install Node.js, make sure to install it using <a href="https://github.com/nvm-sh/nvm">nvm</a>. <strong>nvm</strong> makes it easy to manage multiple Node versions on the same system.</p>\n\n<p>We will first need to install a library called <a href="https://hardhat.org/">Hardhat</a>. <strong>Hardhat</strong> is a local development tool that makes developing, testing and deploying smart contracts easy.</p>\n\n<p>Let\'s create a folder for our smart contract and initialize <strong>npm</strong> to install packages from the node registry.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code><span class="nb">mkdir </span>partnerly-contract\n<span class="nb">cd </span>partnerly-contract\nnpm init <span class="nt">-y</span>\nnpm <span class="nb">install</span> <span class="nt">--save-dev</span> hardhat\nnpx hardhat\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>When you run <code>npx hardhat</code> you will be presented with some options. Select <code>&gt; Create a basic sample project</code> and say <code>yes</code> to all the questions. This will set up a sample project with Hardhat, further dependencies will get installed.</p>\n\n<h2>\n  <a name="initializing-the-contract" href="#initializing-the-contract">\n  </a>\n  Initializing the Contract\n</h2>\n\n<p>We will be developing our contract inside the <code>contracts</code> folder. Let\'s delete the sample contract in there and create a new file called <code>Partnership.sol</code>. Below is what the skeleton of our contract looks like. I will explain every line that is in there.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    constructor() {\n        console.log("Contract is deployed");\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The first line inside the contract is a comment that defines the licence for this contract. We will just leave it to be <strong>unlicensed</strong>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The second line is for the Solidity version you want for this contract. We will be using version <code>0.8.4</code>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code>pragma solidity ^0.8.4<span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Hardhat created a config file called <code>hardhat.config.js</code> when we initiated this sample project. You should set the version declaration in there to match the contract version.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">solidity</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.8.4</span><span class="dl">"</span><span class="p">,</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Next, we are importing another contract into our contract called <code>hardhat/console.sol</code>. This is similar to how you would import libraries when coding in Node.js to enhance the functionality of your programs. <code>console.sol</code> gives our contract the ability to call the <code>console.log</code> function, which will make debugging the contract easier as we are developing it. We will remove this function before deploying the contract to a live network since it costs some <strong>gas</strong> to execute the <code>console.log</code> statements on the Ethereum network. You can think of <strong>gas</strong> as the price you need to pay for things to get executed on the Ethereum blockchain.</p>\n\n<p>Next, we define a contract called <code>Partnership</code> that console.log\'s the message <code>Contract is deployed</code> when it is deployed.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>contract Partnership {\n    constructor() {\n        console.log("Contract is deployed");\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Notice the definition of a contract is pretty similar to the definition of a <strong>class</strong> in JavaScript. Just like a class, a contract has a <strong>constructor</strong> function that gets executed when the contract is initialized (<strong>deployed</strong> in our case). It potentially can have other attributes and methods that will help us define the contract\'s data and behaviour. But for now, let\'s just <code>console.log</code> a string to indicate that the contract is deployed.</p>\n\n<h2>\n  <a name="running-the-contract" href="#running-the-contract">\n  </a>\n  Running the Contract\n</h2>\n\n<p>Using Hardhat, we can define a script that will simulate the deployment of a contract. Let\'s create a script called <code>run.js</code> inside the <code>scripts</code> folder.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>\n\n<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>\n  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>\n\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n<span class="p">}</span>\n\n<span class="nx">main</span><span class="p">()</span>\n  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>\n  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>\n    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>\n  <span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We can execute this script by running this statement inside the terminal:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code> npx hardhat run scripts/run.js\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We should now see our <code>console.log</code> message get executed. The contract gets deployed successfully.</p>\n\n<p>This <code>run.js</code> file has a bunch of boilerplate that we will skim over. You won\'t need to adjust some of the statements in there.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>const hre = require("hardhat");\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The above statement imports the <code>hardhat</code> library into the <code>run</code> script. You might see some other examples where this line is omitted. That is because this dependency gets automatically injected when you call this script using <code>npx hardhat</code>.</p>\n\n<p>It is the same with the first statement inside the <code>main</code> function. You might see it getting omitted in some examples. I have included in my examples for the sake of completeness.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>async function main() {\n  await hre.run("compiler");\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The following statement executes the async <code>main</code> function and exits from the script once the execution is completed. It additionally logs errors if there are any.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>main()\n  .then(() =&gt; process.exit(0))\n  .catch((error) =&gt; {\n    console.error(error);\n    process.exit(1);\n  });\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>What we need to care about are these three lines of code.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>// We get the contract to deploy\nconst Contract = await hre.ethers.getContractFactory("Partnership");\nconst contract = await Contract.deploy();\n\nawait contract.deployed();\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We first compile the smart contract with the given name and then deploy the contract using the <code>deploy</code> method. Then, we ensure that the contract is deployed using the <code>deployed</code> method. Note that all these operations are <strong>asynchronous</strong>, so we use the <strong>async-await</strong> pattern.</p>\n\n<p>We can continue developing the contract now that we have a script to execute it.</p>\n\n<h2>\n  <a name="terms-of-the-contract" href="#terms-of-the-contract">\n  </a>\n  Terms of the Contract\n</h2>\n\n<p>Let\'s think of what we would like to do with this contract.</p>\n\n<ul>\n<li>We want to create a contract that requires two or more <strong>wallet addresses</strong> that can accept payments.</li>\n<li>The contract will also require split ratios to be defined for each given address. 1 to 1 split ratio means an equal split. 2 to 1 split means that the first address will get double the amount of the second one.</li>\n<li>The contract will store these given addresses and split ratios.</li>\n<li>The contract should be able to receive and store payments.</li>\n<li>When a withdrawal is requested, the stored amount should be transferred to the contract\'s parties in the designated split ratio.</li>\n</ul>\n\n<p>At this point, I should mention that I am not a lawyer. In fact, I am just a simple programmer, and as a programmer, I write bugs all the time. This poses some problems when it comes to developing smart contracts. It is impossible to ensure that a contract (or a program, for that matter) doesn\'t have a bug, and once a contract is deployed, you can\'t change it. The implication is that it is possible to deploy a buggy program that you can\'t alter after the fact.</p>\n\n<p>The code for the smart contract is available on the blockchain for anyone to see. This transparency is great since you can verify that the contract is working as intended by reading the code. However, it also means that any actor could be dissecting the contract to take advantage of its vulnerabilities.</p>\n\n<p>Have a look at the above terms. Does it look airtight? When I started to code this, it looked pretty good to me until I realized the users could pass a split ratio equivalent to <code>0</code>, which would cause the contract to fail (You can\'t divide a number with <code>0</code>). This is only a single oversight I could catch, and I can\'t guarantee there aren\'t others!</p>\n\n<p>So let\'s ensure we update our requirements to include that the split ratios should be bigger than 0.</p>\n\n<ul>\n<li>The contract will also need split ratios to be defined for each given address. Each split ratio should be bigger than 0.</li>\n</ul>\n\n<h2>\n  <a name="passing-and-storing-values-inside-the-smart-contract" href="#passing-and-storing-values-inside-the-smart-contract">\n  </a>\n  Passing and Storing Values inside the Smart Contract\n</h2>\n\n<p>You can store data (state) inside the contract by defining variables inside the contract body. Any value passed into these variables will be stored inside the contract <strong>permanently</strong>.</p>\n\n<p>Let\'s define a contract that has some state variables.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    string private deploymentMessage = "Contract is deployed";\n    uint256 private partnerAmount = 2;\n    address[] public addresses;\n\n    constructor(address[] memory _addresses) {\n        require(\n            _addresses.length == partnerAmount,\n            "You can\'t have more than 2 partners"\n        );\n\n        addresses = _addresses;\n\n        console.log(deploymentMessage);\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Solidity is a <strong>typed</strong> language meaning that we need to define our variable types.</p>\n\n<p>We can also define the <strong>visibility</strong> and <strong>accessibility</strong> of these variables by using the keywords <code>public</code> and <code>private</code>. A <strong>private</strong> variable is meant to be accessible only inside the contract. In contrast, Solidity creates a <strong>getter</strong> function for a <strong>public</strong> variable, meaning that you could read the value of this variable by calling an automagically generated method of the same name (<code>partnerAmount()</code> and <code>addresses()</code> in this case).</p>\n\n<p>We have defined three variables at the top of this contract. A private <code>string</code> variable called <code>deploymentMessage</code>, a public <code>uint256</code> (an unsigned 256 bit integer) variable called <code>partnerAmount</code>, and a public array of <code>address</code> type called <code>addresses</code>. The <code>addresses</code> variable doesn\'t have a value yet. It is going to be populated by the caller of this contract.</p>\n\n<p>We have updated the <code>constructor</code> function to accept <code>_addresses</code> as an argument. It is conventional to prefix function arguments with an underscore (<code>_</code>) to differentiate them from the state variables.</p>\n\n<p>We use a keyword called <code>memory</code> before the <code>_addresses</code> argument. The <code>memory</code> keyword instructs Solidity that this data doesn\'t need to be part of the permanent storage. The function arguments are always declared with the <code>memory</code> keyword.</p>\n\n<p>Constructor function makes use of a built-in function called <code>require</code> that checks to see if the given conditional is <code>true</code>. If not, it reverts the operation (an operation is called <code>transaction</code> in Blockchain terms) with the given message.</p>\n\n<p>In our case, we require the given address amount to be equal to the defined <code>partnerAmount</code>. If that is not the case, the transaction will not go through. If there aren\'t any errors, our contract will deploy, and the passed arguments will permanently get stored inside this smart contract.</p>\n\n<p>If we tried running the <code>run</code> script as is, we would get an error since our script now expects an array of two addresses to be passed in. Let\'s update our <code>run</code> script to pass addresses inside this contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>\n\n<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>\n  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">partnerAmount</span><span class="p">());</span>\n  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">addresses</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>\n<span class="p">}</span>\n\n<span class="nx">main</span><span class="p">()</span>\n  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>\n  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>\n    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>\n  <span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We use the <code>hre.ethers.getSigners</code> function to get objects representing Ethereum accounts. We create an array of addresses by using the addresses of these accounts by using their <code>address</code> property.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>const [owner, person1] = await hre.ethers.getSigners();\nconst addresses = [owner.address, person1.address];\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We then pass these addresses into our contract during the initialization. Our contract successfully deploys when provided with two addresses.</p>\n\n<p>Another way of ensuring that our contract would only accept two addresses would have been to define the array to have a fixed size. That way, we wouldn\'t need the <code>require</code> statement since the condition would be enforced at a data type level.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>address[2] public addresses;\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are also logging the <code>partnerAmount</code> and the first address inside the <code>addresses</code> array by using the getter functions that Solidity exposes since these are defined as <strong>public</strong> variables.</p>\n\n<p>While the <code>run</code> script is helpful to us in understanding the runtime behaviour of our contract, it is not a reliable way to ensure that our contract behaves correctly for our use cases. To develop confidence in our contract, we should write some <strong>tests</strong> that cover its behaviour.</p>\n\n<p>Create a file called <code>Partnership.js</code> inside the test folder. This is what it will look like:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be deployed by providing two addresses on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n    <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n    <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">);</span>\n    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n  <span class="p">});</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We will call this file using <code>npx hardhat test test/Partnership.js</code>. You should see a nicely formatted terminal output that tells us that 1 test has passed. As you can see, this file is super similar to our <strong>run</strong> script. The only difference is that it includes a <strong>test suite</strong> that gets executed whenever this script is called. The <code>describe</code> function describes what this test suite is for. The test block that starts with the function name <code>it</code> defines a test block that tests one aspect of our contract. In this case, it just tests to see if the contract is deploying successfully.</p>\n\n<p>Let\'s write a test to see if our contract is failing as expected when no addresses are provided. First, we will need to import an <code>expect</code> method to help us make <strong>assertations</strong>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">expect</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">chai</span><span class="dl">"</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And then, we will add this test block right after the previous one.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when NOT providing addresses on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">let</span> <span class="nx">error</span><span class="p">;</span>\n  <span class="k">try</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>\n    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_error</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">error</span> <span class="o">=</span> <span class="nx">_error</span><span class="p">;</span>\n  <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>\n    <span class="nx">expect</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span><span class="p">;</span>\n  <span class="p">}</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>You would get an error thrown when a contract that expects arguments is deployed without being provided with those arguments. Here we start by initializing an empty <code>error</code> variable.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">error</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And then, we use the <strong>try-catch</strong> block to see if the error is populated or not. The error gets populated because the deployment fails when addresses are not provided. We check for the error to exist (to be truthy) inside the <code>finally</code> block:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="nx">error</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Tests are a super important part of any software development process. They not only help you ascertain the behaviour of a program (or a smart contract), but they can also give you confidence that the existing behaviour of the contract doesn\'t break when you modify it. You can ensure this by running the test suite whenever you update the contract.</p>\n\n<p>Tests are an essential part of the software development process. There is a software development paradigm called <strong>Test-Driven Development (TDD)</strong>, where we first write a failing test for each feature. We then implement the bare minimum code that will make this test pass. This methodology forces us to be iterative with our development process. We will try to follow this methodology while developing our smart contract.</p>\n\n<h2>\n  <a name="smart-contract-continued" href="#smart-contract-continued">\n  </a>\n  Smart Contract Continued\n</h2>\n\n<p>In the previous section, we wrote a contract that takes two addresses. But we would like our eventual contract to work with two or more addresses and equivalent amounts of split ratios.</p>\n\n<p>Let\'s change our tests to encode this expectation. We will be deleting the tests from before and writing new ones. Here is the first test block we will have. It simply tests if the contract deploys without errors when provided with the required amount of addresses and split ratios.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be deployed by providing at least two addresses and equal amounts of split ratios on initialization</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Our second test will check to see if our contract fails as expected when the address amount and the split ratio amount are different. In this test, we will have two addresses but three split ratios.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when the split ratios are not equivalent to the address amount</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>\n    <span class="dl">"</span><span class="s2">The address amount and the split ratio amount should be equal</span><span class="dl">"</span>\n  <span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We use a new method on the <code>expect</code> function called <code>revertedWith</code> that checks to see if the transactions are reverted with the expected message.</p>\n\n<p>We will add one more test block to ensure that the contract fails to deploy when it is called with less than two addresses.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when the the address amount is less than two</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">];</span>\n\n  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>\n    <span class="dl">"</span><span class="s2">More than one address should be provided to establish a partnership</span><span class="dl">"</span>\n  <span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>All these tests will currently fail when called. Let\'s update our contract to make them pass. Our new contract will look like this.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    address[] public addresses;\n    uint256[] public splitRatios;\n\n    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {\n        require(\n            _addresses.length &gt; 1,\n            "More than one address should be provided to establish a partnership"\n        );\n\n        require(\n            _splitRatios.length == _addresses.length,\n            "The address amount and the split ratio amount should be equal"\n        );\n        addresses = _addresses;\n        splitRatios = _splitRatios;\n        console.log("Contract is Deployed");\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We now have two <code>require</code> statements. The first one is to ensure that more than one address is passed into the contract, and the second is to ensure that an equal amount of split ratios is provided. We get the <code>_addresses</code> and <code>_splitRatios</code> and store them inside the contract.</p>\n\n<p>If we want to update our <code>run</code> script, we can do so by including <code>splitRatios</code> as an argument.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>\n\n<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>\n  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">addresses</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>\n  <span class="k">await</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">splitRatios</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>\n<span class="p">}</span>\n\n<span class="nx">main</span><span class="p">()</span>\n  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>\n  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>\n    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>\n  <span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are now defining and passing split ratios to the contract as well inside the <code>run</code> script.</p>\n\n<h2>\n  <a name="requiring-valid-arguments" href="#requiring-valid-arguments">\n  </a>\n  Requiring Valid Arguments\n</h2>\n\n<p>We also need to ensure that there are no split ratios that are less than or equal to 0. We should iterate through every split ratio to see if they are all above one. The test for this functionality would look like this.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be deployed when any of the split ratios is less than one</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>\n\n  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>\n    <span class="dl">"</span><span class="s2">Split ratio can not be 0 or less</span><span class="dl">"</span>\n  <span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>As mentioned previously, this test will initially fail. Let\'s implement the code that would make it pass.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    address[] public addresses;\n    uint256[] public splitRatios;\n    uint256 private splitRatiosTotal;\n\n    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {\n        require(\n            _addresses.length &gt; 1,\n            "More than one address should be provided to establish a partnership"\n        );\n\n        require(\n            _splitRatios.length == _addresses.length,\n            "The address amount and the split ratio amount should be equal"\n        );\n        addresses = _addresses;\n        splitRatios = _splitRatios;\n        splitRatiosTotal = getSplitRatiosTotal(splitRatios);\n\n        console.log("Contract is Deployed");\n    }\n\n    function getSplitRatiosTotal(uint256[] memory _splitRatios)\n        private\n        pure\n        returns (uint256)\n    {\n        uint256 total = 0;\n\n        for (uint256 i = 0; i &lt; _splitRatios.length; i++) {\n            require(_splitRatios[i] &gt; 0, "Split ratio can not be 0 or less");\n            total += _splitRatios[i];\n        }\n\n        return total;\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We now added a new variable called <code>splitRatiosTotal</code> that is <code>private</code>. This means that it won\'t be accessible from outside of the contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>uint256 private splitRatiosTotal;\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We have defined a new function called <code>getSplitRatiosTotal</code> that goes through every item in a given <code>uint256[]</code> and checks to see if they are bigger than <code>0</code>. It also calculates the sum of those items and stores it inside a state variable <code>splitRatiosTotal</code>. We will use this variable when we want to distribute the funds to the contract addresses.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">getSplitRatiosTotal</span><span class="p">(</span><span class="nx">uint256</span><span class="p">[]</span> <span class="nx">memory</span> <span class="nx">_splitRatios</span><span class="p">)</span>\n    <span class="kr">private</span>\n    <span class="nx">pure</span>\n    <span class="nx">returns</span> <span class="p">(</span><span class="nx">uint256</span><span class="p">)</span>\n<span class="p">{</span>\n    <span class="nx">uint256</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>\n\n    <span class="k">for</span> <span class="p">(</span><span class="nx">uint256</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">_splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>\n        <span class="nx">require</span><span class="p">(</span><span class="nx">_splitRatios</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Split ratio can not be 0 or less</span><span class="dl">"</span><span class="p">);</span>\n        <span class="nx">total</span> <span class="o">+=</span> <span class="nx">_splitRatios</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>\n    <span class="p">}</span>\n\n    <span class="k">return</span> <span class="nx">total</span><span class="p">;</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We have defined this function as <code>private</code> and <code>pure</code>. A <strong>pure</strong> function means that the operation inside the function doesn\'t rely on any external state. It would return the same output for the same inputs on every execution. Pure functions are highly desirable in programming since their behaviour is very predictable.</p>\n\n<p>Having a pure function in Solidity is also great since they don\'t cost any gas when executed. As mentioned previously, <strong>gas</strong> is the computational and monetary cost of doing operations on the Ethereum blockchain.</p>\n\n<h2>\n  <a name="receiving-payments" href="#receiving-payments">\n  </a>\n  Receiving Payments\n</h2>\n\n<p>We can now store addresses and split ratios inside the smart contract. Let\'s update our contract so that it can also receive payments. Let\'s start by writing a failing test for this.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can receive transactions in Ether</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="c1">// send ether to contract</span>\n  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">),</span>\n  <span class="p">});</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are using the following function call to send Ether to the contract from the <code>owner</code> account.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// send ether to contract</span>\n<span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">),</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Our test currently fails because the contract can\'t receive funds. Making it to receive funds is super easy to do so. We just need to add a single line of code into our contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>receive() external payable {}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Run the test again. It should pass. The contract can now receive funds!</p>\n\n<p>We will also add a function called <code>getBalance</code> that will get the current balance of the contract. We can test this function by checking if the balance increased by the expected amount after receiving a transaction.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">has a balance that increases after receiving a transaction</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">,</span> <span class="nx">person2</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="c1">// send ether to contract</span>\n  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n    <span class="nx">value</span><span class="p">,</span>\n  <span class="p">});</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We first check to see if the contract balance is <code>0</code> to begin with.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We then use the <code>parseEther</code> method to convert a single Ether\'s value to its <strong>Wei</strong> equivalent.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">1.0</span><span class="dl">"</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>A <strong>Wei</strong> is the smallest unit of Ether. Think of it as what a penny is to a dollar. The similarity ends there, though, since a dollar is only 100 times more valuable than a penny, whereas an Ether is 10^18 times more valuable than a <strong>Wei</strong>!</p>\n\n<p>We then execute a transaction with this Wei value and check to see if the balance has increased.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Let\'s implement the <code>getBalance</code> method inside our contract so that the test would pass. This is again straightforward to do so.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">getBalance</span><span class="p">()</span> <span class="kr">public</span> <span class="nx">view</span> <span class="nx">returns</span> <span class="p">(</span><span class="nx">uint256</span><span class="p">)</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="nx">address</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">balance</span><span class="p">;</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Note the usage of the <code>view</code> keyword in the function definition. A <strong>view</strong> function is a function that doesn\'t alter the state but merely reads it.</p>\n\n<p>Our tests should start passing with the implementation of this function.</p>\n\n<h2>\n  <a name="sending-payments" href="#sending-payments">\n  </a>\n  Sending Payments\n</h2>\n\n<p>We will be implementing a function called <code>withdraw</code>. When called, this function will initiate the transfer of the funds to the recorded addresses according to the provided split ratio.</p>\n\n<p>We can create a new <code>describe</code> block called <code>withdraw</code> inside the existing one. Using <code>describe</code> function allows us to categorize related tests together. We will include any withdrawal-related test inside this new block.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">"</span><span class="s2">withdraw</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can be called if the contract balance is more than 0</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n    <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n    <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n    <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n    <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>\n\n    <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n    <span class="c1">// send ether to contract</span>\n    <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n      <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n      <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5.0</span><span class="dl">"</span><span class="p">),</span>\n    <span class="p">});</span>\n\n    <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">not</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n\n    <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>\n  <span class="p">});</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We check to see if the contract balance is non-zero after the transfer.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">not</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then we call the <code>withdraw</code> function. The test fails because the withdraw function doesn\'t exist. Let\'s fix that. We will add a <code>withdraw</code> function inside the contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>function withdraw() public {\n    uint256 addressesLength = addresses.length;\n\n    for (uint256 i = 0; i &lt; addressesLength; i++) {\n        addresses[i].transfer(\n            (balance / splitRatiosTotal) * splitRatios[i]\n        );\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>This function doesn\'t quite work yet. The reason for that is that we should define the addresses as <code>payable</code> for us to invoke the <code>transfer</code> method on them. We need to update the state variable for addresses and the argument inside the constructor with the <code>payable</code> keyword.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>address payable[] public addresses;\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And inside the <code>constructor</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>constructor(\n    address payable[] memory _addresses,\n    uint256[] memory _splitRatios\n) {\n    // constructor body\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With this change, the <code>withdraw</code> function should start working!</p>\n\n<p>We would like to have the <code>withdraw</code> function fail if the balance is less than 0. Let\'s write the test for that.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be called if the contract balance is less than or equal to 0</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">Insufficient balance</span><span class="dl">"</span><span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We first ensure that the balance of the contract is <code>0</code>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then we try to call the <code>withdraw</code> function. We should make it fail with the <code>"Insufficient balance"</code> error.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">Insufficient balance</span><span class="dl">"</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>To implement this inside the contract, we should get the contract balance inside the <code>withdraw</code> function and ensure it is bigger than 0.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>function withdraw() public {\n    uint256 balance = getBalance();\n    uint256 addressesLength = addresses.length;\n\n    require(balance &gt; 0, "Insufficient balance");\n\n    for (uint256 i = 0; i &lt; addressesLength; i++) {\n        addresses[i].transfer(\n            (balance / splitRatiosTotal) * splitRatios[i]\n        );\n    }\n}\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="ensuring-that-split-ratio-total-is-smaller-than-the-balance" href="#ensuring-that-split-ratio-total-is-smaller-than-the-balance">\n  </a>\n  Ensuring that Split Ratio Total is Smaller Than the Balance\n</h2>\n\n<p>We should ensure that the total split ratio is smaller than the balance. This way, we won\'t get any numerical errors when dividing the balance with the split ratio. Here is the test for that looks like.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">can NOT be called when the total split ratio is greater than the contract balance</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">owner</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">];</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="nx">addresses</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">splitRatios</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>\n\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>\n\n  <span class="c1">// send ether to contract</span>\n  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">0.00000000000000001</span><span class="dl">"</span><span class="p">),</span>\n  <span class="p">});</span>\n\n  <span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">expect</span><span class="p">(</span><span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">revertedWith</span><span class="p">(</span>\n    <span class="dl">"</span><span class="s2">Balance should be greater than the total split ratios</span><span class="dl">"</span>\n  <span class="p">);</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are sending 10 Wei to the contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// send ether to contract</span>\n<span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">0.00000000000000001</span><span class="dl">"</span><span class="p">),</span>\n<span class="p">});</span>\n\n<span class="nx">expect</span><span class="p">(</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The total of the split ratios in this test is greater than 10 (it is 20). This causes the contract to fail with the <code>"Balance should be greater than the total split ratios"</code> message. We can implement this inside the contract by adding a simple <code>require</code> statement.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>require(balance &gt;=\n  splitRatiosTotal, "Balance should be greater than the total split ratios");\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="finalizing-the-run-script" href="#finalizing-the-run-script">\n  </a>\n  Finalizing the Run Script\n</h2>\n\n<p>Now that we have finished the contract logic, let\'s update the <code>run</code> script to simulate how someone would interact with this contract.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">hre</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">hardhat</span><span class="dl">"</span><span class="p">);</span>\n\n<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>\n  <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">person1</span><span class="p">,</span> <span class="nx">person2</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>\n  <span class="kd">const</span> <span class="nx">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span> <span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">];</span>\n  <span class="kd">const</span> <span class="nx">splitRatios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>\n\n  <span class="kd">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="dl">"</span><span class="s2">Partnership</span><span class="dl">"</span><span class="p">);</span>\n  <span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">provider</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">addresses</span><span class="p">,</span> <span class="nx">splitRatios</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>\n\n  <span class="kd">let</span> <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person1 is: </span><span class="p">${</span><span class="nx">balance1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>\n\n  <span class="kd">let</span> <span class="nx">balance2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person2 is: </span><span class="p">${</span><span class="nx">balance2</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>\n\n  <span class="kd">let</span> <span class="nx">contractBalance</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">();</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance in the contract is: </span><span class="p">${</span><span class="nx">contractBalance</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n    <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n    <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5.0</span><span class="dl">"</span><span class="p">),</span>\n  <span class="p">});</span>\n\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>\n    <span class="s2">`The balance in the contract after receiving funds is: </span><span class="p">${</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()}</span><span class="s2">`</span>\n  <span class="p">);</span>\n\n  <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>\n\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>\n    <span class="s2">`The balance in the contract after withdrawal is: </span><span class="p">${</span><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()}</span><span class="s2">`</span>\n  <span class="p">);</span>\n\n  <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The new balance for the person1 is:</span><span class="p">${</span><span class="nx">balance1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>\n\n  <span class="nx">balance2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person2</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`The balance for the person2 is: </span><span class="p">${</span><span class="nx">balance2</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>\n<span class="p">}</span>\n\n<span class="nx">main</span><span class="p">()</span>\n  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>\n  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>\n    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>\n  <span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here, we simulate the contract deployment with two addresses and a 4 to 1 split ratio. We need to define a <code>provider</code> to get the balance from the Ethereum accounts.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">provider</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We can then call the <code>getBalance</code> method on the provider to see the contract balance.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">balance1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">person1</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Hardhat initializes these accounts with a balance of 10000 ETH.</p>\n\n<p>After the deployment, we get another user to send 5000 ETH into the contract. The balance of the contract changes accordingly.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">({</span>\n  <span class="na">to</span><span class="p">:</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>\n  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="dl">"</span><span class="s2">5000.0</span><span class="dl">"</span><span class="p">),</span>\n<span class="p">});</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We then call the <code>withdraw</code> function on the contract. This distributes the funds inside the contract in between the addresses. We then check to ensure the balance of the accounts has changed accordingly.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">();</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>It seems like things are working as expected!</p>\n\n<p>Believe it or not, this is it! We now have a program that can permanently store data, securely receive transactions, store funds and transfer those funds to specified accounts (wallet addresses). And it took less than 100 lines to write it! Building something like this makes you truly appreciate the power of blockchains and smart contract platforms like Ethereum. The amount of code and complexity to achieve something similar using centralized solutions would have been substantial.</p>\n\n<p>How can other people make use of this smart contract? We could upload the contract to a public repository like Github and have other people clone it from there. They would need to change the run script to handle the deployment of the contract on the Ethereum blockchain themselves. Obviously, this is not an ideal or feasible solution for those who don\'t have any familiarity with working with smart contracts.</p>\n\n<p>We could do so much better than this! If you enjoyed this walkthrough, check out my <a href="https://leanpub.com/develop-web3-apps-using-solidity-and-react/">ebook</a> for learning how to build the front end application for this contract using React, Next.js, and React.</p>\n\n',n.body_markdown='---\ntitle: A Practical Introduction to Developing Web3 Apps Using Solidity and React - Part 1\npublished: true\ndescription: Learn how to create the smart contract that can be deployed on the Ethereum blockchain using Solidity and following a TDD methodology. \ntags: blockchain, web3, solidity, smartcontract\ncanonical_url: https://www.partnerly.co/learn\n//cover_image: https://direct_url_to_image.jpg\n---\n\n## Developing a Smart Contract\n\nImagine building a project with someone. You are planning on monetizing this project by accepting payments in cryptocurrency. You would want to distribute the earnings fairly in between yourselves. [Partnerly.co](https://www.partnerly.co/) helps you do this. It is an app that helps you create a smart contract on the blockchain that can distribute the collected payments between two (or more) parties in a predetermined split ratio.\n\nI will show you how I built **Partnerly** from scratch. In this part of this walkthrough, you will learn how to create the smart contract that can be deployed on the **Ethereum blockchain** using **Solidity**.\n\nThe code for the smart contract and the front end application is available at [https://github.com/hibernationTheory/partnerly](https://github.com/hibernationTheory/partnerly).\n\n## Disclaimer\n\nI am not a Blockchain developer. In fact, I am just learning this stuff myself. However, I am a software developer and an educator who taught programming from scratch to thousands of students. I can\'t claim that you will become a Blockchain development expert by just following this walkthrough, but I am pretty confident that you will learn practical skills that will make this a valuable stepping stone in your journey.\n\nLet\'s get started!\n\n## Getting Started\n\nThis walkthrough assumes you have a working knowledge of **JavaScript**, **Node.js** and **React**. We will be using the **Solidity** language to develop the smart contract, which is relatively similar to **JavaScript**. The user interface we will be building for this contract will use **React**, **Next.js** and **Tailwind** libraries.\n\nI use Visual Studio Code (VS Code) for coding. VS Code has an extension that makes working with Solidity (`sol`) files easy, so I recommend you [download](https://marketplace.visualstudio.com/items?itemName=JuanBlanco.solidity) that for a better development experience.\n\nIf you are yet to install Node.js, make sure to install it using [nvm](https://github.com/nvm-sh/nvm). **nvm** makes it easy to manage multiple Node versions on the same system.\n\nWe will first need to install a library called [Hardhat](https://hardhat.org/). **Hardhat** is a local development tool that makes developing, testing and deploying smart contracts easy.\n\nLet\'s create a folder for our smart contract and initialize **npm** to install packages from the node registry.\n\n```bash\nmkdir partnerly-contract\ncd partnerly-contract\nnpm init -y\nnpm install --save-dev hardhat\nnpx hardhat\n```\n\nWhen you run `npx hardhat` you will be presented with some options. Select `> Create a basic sample project` and say `yes` to all the questions. This will set up a sample project with Hardhat, further dependencies will get installed.\n\n## Initializing the Contract\n\nWe will be developing our contract inside the `contracts` folder. Let\'s delete the sample contract in there and create a new file called `Partnership.sol`. Below is what the skeleton of our contract looks like. I will explain every line that is in there.\n\n```sol\n//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    constructor() {\n        console.log("Contract is deployed");\n    }\n}\n```\n\nThe first line inside the contract is a comment that defines the licence for this contract. We will just leave it to be **unlicensed**.\n\n```sol\n//SPDX-License-Identifier: Unlicense\n```\n\nThe second line is for the Solidity version you want for this contract. We will be using version `0.8.4`.\n\n```bash\npragma solidity ^0.8.4;\n```\n\nHardhat created a config file called `hardhat.config.js` when we initiated this sample project. You should set the version declaration in there to match the contract version.\n\n```js\nmodule.exports = {\n  solidity: "0.8.4",\n};\n```\n\nNext, we are importing another contract into our contract called `hardhat/console.sol`. This is similar to how you would import libraries when coding in Node.js to enhance the functionality of your programs. `console.sol` gives our contract the ability to call the `console.log` function, which will make debugging the contract easier as we are developing it. We will remove this function before deploying the contract to a live network since it costs some **gas** to execute the `console.log` statements on the Ethereum network. You can think of **gas** as the price you need to pay for things to get executed on the Ethereum blockchain.\n\nNext, we define a contract called `Partnership` that console.log\'s the message `Contract is deployed` when it is deployed.\n\n```sol\ncontract Partnership {\n    constructor() {\n        console.log("Contract is deployed");\n    }\n}\n```\n\nNotice the definition of a contract is pretty similar to the definition of a **class** in JavaScript. Just like a class, a contract has a **constructor** function that gets executed when the contract is initialized (**deployed** in our case). It potentially can have other attributes and methods that will help us define the contract\'s data and behaviour. But for now, let\'s just `console.log` a string to indicate that the contract is deployed.\n\n## Running the Contract\n\nUsing Hardhat, we can define a script that will simulate the deployment of a contract. Let\'s create a script called `run.js` inside the `scripts` folder.\n\n```js\nconst hre = require("hardhat");\n\nasync function main() {\n  await hre.run("compile");\n\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n  const contract = await Contract.deploy();\n\n  await contract.deployed();\n}\n\nmain()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n```\n\nWe can execute this script by running this statement inside the terminal:\n\n```bash\n npx hardhat run scripts/run.js\n```\n\nWe should now see our `console.log` message get executed. The contract gets deployed successfully.\n\nThis `run.js` file has a bunch of boilerplate that we will skim over. You won\'t need to adjust some of the statements in there.\n\n```sol\nconst hre = require("hardhat");\n```\n\nThe above statement imports the `hardhat` library into the `run` script. You might see some other examples where this line is omitted. That is because this dependency gets automatically injected when you call this script using `npx hardhat`.\n\nIt is the same with the first statement inside the `main` function. You might see it getting omitted in some examples. I have included in my examples for the sake of completeness.\n\n```sol\nasync function main() {\n  await hre.run("compiler");\n}\n```\n\nThe following statement executes the async `main` function and exits from the script once the execution is completed. It additionally logs errors if there are any.\n\n```sol\nmain()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n```\n\nWhat we need to care about are these three lines of code.\n\n```sol\n// We get the contract to deploy\nconst Contract = await hre.ethers.getContractFactory("Partnership");\nconst contract = await Contract.deploy();\n\nawait contract.deployed();\n```\n\nWe first compile the smart contract with the given name and then deploy the contract using the `deploy` method. Then, we ensure that the contract is deployed using the `deployed` method. Note that all these operations are **asynchronous**, so we use the **async-await** pattern.\n\nWe can continue developing the contract now that we have a script to execute it.\n\n## Terms of the Contract\n\nLet\'s think of what we would like to do with this contract.\n\n- We want to create a contract that requires two or more **wallet addresses** that can accept payments.\n- The contract will also require split ratios to be defined for each given address. 1 to 1 split ratio means an equal split. 2 to 1 split means that the first address will get double the amount of the second one.\n- The contract will store these given addresses and split ratios.\n- The contract should be able to receive and store payments.\n- When a withdrawal is requested, the stored amount should be transferred to the contract\'s parties in the designated split ratio.\n\nAt this point, I should mention that I am not a lawyer. In fact, I am just a simple programmer, and as a programmer, I write bugs all the time. This poses some problems when it comes to developing smart contracts. It is impossible to ensure that a contract (or a program, for that matter) doesn\'t have a bug, and once a contract is deployed, you can\'t change it. The implication is that it is possible to deploy a buggy program that you can\'t alter after the fact.\n\nThe code for the smart contract is available on the blockchain for anyone to see. This transparency is great since you can verify that the contract is working as intended by reading the code. However, it also means that any actor could be dissecting the contract to take advantage of its vulnerabilities.\n\nHave a look at the above terms. Does it look airtight? When I started to code this, it looked pretty good to me until I realized the users could pass a split ratio equivalent to `0`, which would cause the contract to fail (You can\'t divide a number with `0`). This is only a single oversight I could catch, and I can\'t guarantee there aren\'t others!\n\nSo let\'s ensure we update our requirements to include that the split ratios should be bigger than 0.\n\n- The contract will also need split ratios to be defined for each given address. Each split ratio should be bigger than 0.\n\n## Passing and Storing Values inside the Smart Contract\n\nYou can store data (state) inside the contract by defining variables inside the contract body. Any value passed into these variables will be stored inside the contract **permanently**.\n\nLet\'s define a contract that has some state variables.\n\n```sol\n//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    string private deploymentMessage = "Contract is deployed";\n    uint256 private partnerAmount = 2;\n    address[] public addresses;\n\n    constructor(address[] memory _addresses) {\n        require(\n            _addresses.length == partnerAmount,\n            "You can\'t have more than 2 partners"\n        );\n\n        addresses = _addresses;\n\n        console.log(deploymentMessage);\n    }\n}\n```\n\nSolidity is a **typed** language meaning that we need to define our variable types.\n\nWe can also define the **visibility** and **accessibility** of these variables by using the keywords `public` and `private`. A **private** variable is meant to be accessible only inside the contract. In contrast, Solidity creates a **getter** function for a **public** variable, meaning that you could read the value of this variable by calling an automagically generated method of the same name (`partnerAmount()` and `addresses()` in this case).\n\nWe have defined three variables at the top of this contract. A private `string` variable called `deploymentMessage`, a public `uint256` (an unsigned 256 bit integer) variable called `partnerAmount`, and a public array of `address` type called `addresses`. The `addresses` variable doesn\'t have a value yet. It is going to be populated by the caller of this contract.\n\nWe have updated the `constructor` function to accept `_addresses` as an argument. It is conventional to prefix function arguments with an underscore (`_`) to differentiate them from the state variables.\n\nWe use a keyword called `memory` before the `_addresses` argument. The `memory` keyword instructs Solidity that this data doesn\'t need to be part of the permanent storage. The function arguments are always declared with the `memory` keyword.\n\nConstructor function makes use of a built-in function called `require` that checks to see if the given conditional is `true`. If not, it reverts the operation (an operation is called `transaction` in Blockchain terms) with the given message.\n\nIn our case, we require the given address amount to be equal to the defined `partnerAmount`. If that is not the case, the transaction will not go through. If there aren\'t any errors, our contract will deploy, and the passed arguments will permanently get stored inside this smart contract.\n\nIf we tried running the `run` script as is, we would get an error since our script now expects an array of two addresses to be passed in. Let\'s update our `run` script to pass addresses inside this contract.\n\n```js\nconst hre = require("hardhat");\n\nasync function main() {\n  await hre.run("compile");\n  const [owner, person1] = await hre.ethers.getSigners();\n  const addresses = [owner.address, person1.address];\n\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n  const contract = await Contract.deploy(addresses);\n\n  await contract.deployed();\n\n  await console.log(await contract.partnerAmount());\n  await console.log(await contract.addresses(0));\n}\n\nmain()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n```\n\nWe use the `hre.ethers.getSigners` function to get objects representing Ethereum accounts. We create an array of addresses by using the addresses of these accounts by using their `address` property.\n\n```sol\nconst [owner, person1] = await hre.ethers.getSigners();\nconst addresses = [owner.address, person1.address];\n```\n\nWe then pass these addresses into our contract during the initialization. Our contract successfully deploys when provided with two addresses.\n\nAnother way of ensuring that our contract would only accept two addresses would have been to define the array to have a fixed size. That way, we wouldn\'t need the `require` statement since the condition would be enforced at a data type level.\n\n```sol\naddress[2] public addresses;\n```\n\nWe are also logging the `partnerAmount` and the first address inside the `addresses` array by using the getter functions that Solidity exposes since these are defined as **public** variables.\n\nWhile the `run` script is helpful to us in understanding the runtime behaviour of our contract, it is not a reliable way to ensure that our contract behaves correctly for our use cases. To develop confidence in our contract, we should write some **tests** that cover its behaviour.\n\nCreate a file called `Partnership.js` inside the test folder. This is what it will look like:\n\n```js\ndescribe("Partnership", () => {\n  it("can be deployed by providing two addresses on initialization", async () => {\n    const Contract = await hre.ethers.getContractFactory("Partnership");\n\n    const [owner, person1] = await hre.ethers.getSigners();\n\n    const addresses = [owner.address, person1.address];\n\n    const contract = await Contract.deploy(addresses);\n    await contract.deployed();\n  });\n});\n```\n\nWe will call this file using `npx hardhat test test/Partnership.js`. You should see a nicely formatted terminal output that tells us that 1 test has passed. As you can see, this file is super similar to our **run** script. The only difference is that it includes a **test suite** that gets executed whenever this script is called. The `describe` function describes what this test suite is for. The test block that starts with the function name `it` defines a test block that tests one aspect of our contract. In this case, it just tests to see if the contract is deploying successfully.\n\nLet\'s write a test to see if our contract is failing as expected when no addresses are provided. First, we will need to import an `expect` method to help us make **assertations**.\n\n```js\nconst { expect } = require("chai");\n```\n\nAnd then, we will add this test block right after the previous one.\n\n```js\nit("can NOT be deployed when NOT providing addresses on initialization", async () => {\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n\n  let error;\n  try {\n    const contract = await Contract.deploy();\n    await contract.deployed();\n  } catch (_error) {\n    error = _error;\n  } finally {\n    expect(error).to.be.ok;\n  }\n});\n```\n\nYou would get an error thrown when a contract that expects arguments is deployed without being provided with those arguments. Here we start by initializing an empty `error` variable.\n\n```js\nlet error;\n```\n\nAnd then, we use the **try-catch** block to see if the error is populated or not. The error gets populated because the deployment fails when addresses are not provided. We check for the error to exist (to be truthy) inside the `finally` block:\n\n```js\nexpect(error).to.be.ok;\n```\n\nTests are a super important part of any software development process. They not only help you ascertain the behaviour of a program (or a smart contract), but they can also give you confidence that the existing behaviour of the contract doesn\'t break when you modify it. You can ensure this by running the test suite whenever you update the contract.\n\nTests are an essential part of the software development process. There is a software development paradigm called **Test-Driven Development (TDD)**, where we first write a failing test for each feature. We then implement the bare minimum code that will make this test pass. This methodology forces us to be iterative with our development process. We will try to follow this methodology while developing our smart contract.\n\n## Smart Contract Continued\n\nIn the previous section, we wrote a contract that takes two addresses. But we would like our eventual contract to work with two or more addresses and equivalent amounts of split ratios.\n\nLet\'s change our tests to encode this expectation. We will be deleting the tests from before and writing new ones. Here is the first test block we will have. It simply tests if the contract deploys without errors when provided with the required amount of addresses and split ratios.\n\n```js\nit("can be deployed by providing at least two addresses and equal amounts of split ratios on initialization", async () => {\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n  const addresses = [owner.address, person1.address];\n\n  const splitRatios = [1, 1];\n\n  const contract = await Contract.deploy(addresses, splitRatios);\n  await contract.deployed();\n});\n```\n\nOur second test will check to see if our contract fails as expected when the address amount and the split ratio amount are different. In this test, we will have two addresses but three split ratios.\n\n```js\nit("can NOT be deployed when the split ratios are not equivalent to the address amount", async () => {\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n  const addresses = [owner.address, person1.address];\n\n  const splitRatios = [1, 1, 1];\n\n  await expect(Contract.deploy(addresses, splitRatios)).to.be.revertedWith(\n    "The address amount and the split ratio amount should be equal"\n  );\n});\n```\n\nWe use a new method on the `expect` function called `revertedWith` that checks to see if the transactions are reverted with the expected message.\n\nWe will add one more test block to ensure that the contract fails to deploy when it is called with less than two addresses.\n\n```js\nit("can NOT be deployed when the the address amount is less than two", async () => {\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n\n  const [owner] = await hre.ethers.getSigners();\n  const addresses = [owner.address];\n\n  const splitRatios = [1];\n\n  await expect(Contract.deploy(addresses, splitRatios)).to.be.revertedWith(\n    "More than one address should be provided to establish a partnership"\n  );\n});\n```\n\nAll these tests will currently fail when called. Let\'s update our contract to make them pass. Our new contract will look like this.\n\n```sol\n//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    address[] public addresses;\n    uint256[] public splitRatios;\n\n    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {\n        require(\n            _addresses.length > 1,\n            "More than one address should be provided to establish a partnership"\n        );\n\n        require(\n            _splitRatios.length == _addresses.length,\n            "The address amount and the split ratio amount should be equal"\n        );\n        addresses = _addresses;\n        splitRatios = _splitRatios;\n        console.log("Contract is Deployed");\n    }\n}\n```\n\nWe now have two `require` statements. The first one is to ensure that more than one address is passed into the contract, and the second is to ensure that an equal amount of split ratios is provided. We get the `_addresses` and `_splitRatios` and store them inside the contract.\n\nIf we want to update our `run` script, we can do so by including `splitRatios` as an argument.\n\n```js\nconst hre = require("hardhat");\n\nasync function main() {\n  await hre.run("compile");\n  const [owner, person1] = await hre.ethers.getSigners();\n  const addresses = [owner.address, person1.address];\n  const splitRatios = [1, 1];\n\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n  const contract = await Contract.deploy(addresses, splitRatios);\n\n  await contract.deployed();\n\n  await console.log(await contract.addresses(0));\n  await console.log(await contract.splitRatios(0));\n}\n\nmain()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n```\n\nWe are now defining and passing split ratios to the contract as well inside the `run` script.\n\n## Requiring Valid Arguments\n\nWe also need to ensure that there are no split ratios that are less than or equal to 0. We should iterate through every split ratio to see if they are all above one. The test for this functionality would look like this.\n\n```js\nit("can NOT be deployed when any of the split ratios is less than one", async () => {\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n  const addresses = [owner.address, person1.address];\n\n  const splitRatios = [1, 0];\n\n  await expect(Contract.deploy(addresses, splitRatios)).to.be.revertedWith(\n    "Split ratio can not be 0 or less"\n  );\n});\n```\n\nAs mentioned previously, this test will initially fail. Let\'s implement the code that would make it pass.\n\n```sol\n//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.4;\n\nimport "hardhat/console.sol";\n\ncontract Partnership {\n    address[] public addresses;\n    uint256[] public splitRatios;\n    uint256 private splitRatiosTotal;\n\n    constructor(address[] memory _addresses, uint256[] memory _splitRatios) {\n        require(\n            _addresses.length > 1,\n            "More than one address should be provided to establish a partnership"\n        );\n\n        require(\n            _splitRatios.length == _addresses.length,\n            "The address amount and the split ratio amount should be equal"\n        );\n        addresses = _addresses;\n        splitRatios = _splitRatios;\n        splitRatiosTotal = getSplitRatiosTotal(splitRatios);\n\n        console.log("Contract is Deployed");\n    }\n\n    function getSplitRatiosTotal(uint256[] memory _splitRatios)\n        private\n        pure\n        returns (uint256)\n    {\n        uint256 total = 0;\n\n        for (uint256 i = 0; i < _splitRatios.length; i++) {\n            require(_splitRatios[i] > 0, "Split ratio can not be 0 or less");\n            total += _splitRatios[i];\n        }\n\n        return total;\n    }\n}\n```\n\nWe now added a new variable called `splitRatiosTotal` that is `private`. This means that it won\'t be accessible from outside of the contract.\n\n```sol\nuint256 private splitRatiosTotal;\n```\n\nWe have defined a new function called `getSplitRatiosTotal` that goes through every item in a given `uint256[]` and checks to see if they are bigger than `0`. It also calculates the sum of those items and stores it inside a state variable `splitRatiosTotal`. We will use this variable when we want to distribute the funds to the contract addresses.\n\n```js\nfunction getSplitRatiosTotal(uint256[] memory _splitRatios)\n    private\n    pure\n    returns (uint256)\n{\n    uint256 total = 0;\n\n    for (uint256 i = 0; i < _splitRatios.length; i++) {\n        require(_splitRatios[i] > 0, "Split ratio can not be 0 or less");\n        total += _splitRatios[i];\n    }\n\n    return total;\n}\n```\n\nWe have defined this function as `private` and `pure`. A **pure** function means that the operation inside the function doesn\'t rely on any external state. It would return the same output for the same inputs on every execution. Pure functions are highly desirable in programming since their behaviour is very predictable.\n\nHaving a pure function in Solidity is also great since they don\'t cost any gas when executed. As mentioned previously, **gas** is the computational and monetary cost of doing operations on the Ethereum blockchain.\n\n## Receiving Payments\n\nWe can now store addresses and split ratios inside the smart contract. Let\'s update our contract so that it can also receive payments. Let\'s start by writing a failing test for this.\n\n```js\nit("can receive transactions in Ether", async () => {\n  const Contract = await ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n\n  const addresses = [owner.address, person1.address];\n  const splitRatios = [1, 1];\n\n  const contract = await Contract.deploy(addresses, splitRatios);\n  await contract.deployed();\n\n  // send ether to contract\n  await owner.sendTransaction({\n    to: contract.address,\n    value: ethers.utils.parseEther("1.0"),\n  });\n});\n```\n\nWe are using the following function call to send Ether to the contract from the `owner` account.\n\n```js\n// send ether to contract\nawait owner.sendTransaction({\n  to: contract.address,\n  value: ethers.utils.parseEther("1.0"),\n});\n```\n\nOur test currently fails because the contract can\'t receive funds. Making it to receive funds is super easy to do so. We just need to add a single line of code into our contract.\n\n```sol\nreceive() external payable {}\n```\n\nRun the test again. It should pass. The contract can now receive funds!\n\nWe will also add a function called `getBalance` that will get the current balance of the contract. We can test this function by checking if the balance increased by the expected amount after receiving a transaction.\n\n```js\nit("has a balance that increases after receiving a transaction", async () => {\n  const Contract = await ethers.getContractFactory("Partnership");\n\n  const [owner, person1, person2] = await hre.ethers.getSigners();\n\n  const addresses = [person1.address, person2.address];\n  const splitRatios = [1, 1];\n\n  const contract = await Contract.deploy(addresses, splitRatios);\n  await contract.deployed();\n\n  expect(await contract.getBalance()).to.equal(0);\n\n  const value = ethers.utils.parseEther("1.0");\n\n  // send ether to contract\n  await owner.sendTransaction({\n    to: contract.address,\n    value,\n  });\n\n  expect(await contract.getBalance()).to.equal(value);\n});\n```\n\nWe first check to see if the contract balance is `0` to begin with.\n\n```js\nexpect(await contract.getBalance()).to.equal(0);\n```\n\nWe then use the `parseEther` method to convert a single Ether\'s value to its **Wei** equivalent.\n\n```js\nconst value = ethers.utils.parseEther("1.0");\n```\n\nA **Wei** is the smallest unit of Ether. Think of it as what a penny is to a dollar. The similarity ends there, though, since a dollar is only 100 times more valuable than a penny, whereas an Ether is 10^18 times more valuable than a **Wei**!\n\nWe then execute a transaction with this Wei value and check to see if the balance has increased.\n\n```js\nexpect(await contract.getBalance()).to.equal(value);\n```\n\nLet\'s implement the `getBalance` method inside our contract so that the test would pass. This is again straightforward to do so.\n\n```js\nfunction getBalance() public view returns (uint256) {\n    return address(this).balance;\n}\n```\n\nNote the usage of the `view` keyword in the function definition. A **view** function is a function that doesn\'t alter the state but merely reads it.\n\nOur tests should start passing with the implementation of this function.\n\n## Sending Payments\n\nWe will be implementing a function called `withdraw`. When called, this function will initiate the transfer of the funds to the recorded addresses according to the provided split ratio.\n\nWe can create a new `describe` block called `withdraw` inside the existing one. Using `describe` function allows us to categorize related tests together. We will include any withdrawal-related test inside this new block.\n\n```js\ndescribe("withdraw", () => {\n  it("can be called if the contract balance is more than 0", async () => {\n    const Contract = await ethers.getContractFactory("Partnership");\n\n    const [owner, person1] = await hre.ethers.getSigners();\n\n    const addresses = [owner.address, person1.address];\n    const splitRatios = [1, 1];\n\n    expect(addresses.length).to.equal(splitRatios.length);\n\n    const contract = await Contract.deploy(addresses, splitRatios);\n    await contract.deployed();\n\n    // send ether to contract\n    await owner.sendTransaction({\n      to: contract.address,\n      value: ethers.utils.parseEther("5.0"),\n    });\n\n    expect(await contract.getBalance()).to.not.equal(0);\n\n    await contract.withdraw();\n  });\n});\n```\n\nWe check to see if the contract balance is non-zero after the transfer.\n\n```js\nexpect(await contract.getBalance()).to.not.equal(0);\n```\n\nThen we call the `withdraw` function. The test fails because the withdraw function doesn\'t exist. Let\'s fix that. We will add a `withdraw` function inside the contract.\n\n```sol\nfunction withdraw() public {\n    uint256 addressesLength = addresses.length;\n\n    for (uint256 i = 0; i < addressesLength; i++) {\n        addresses[i].transfer(\n            (balance / splitRatiosTotal) * splitRatios[i]\n        );\n    }\n}\n```\n\nThis function doesn\'t quite work yet. The reason for that is that we should define the addresses as `payable` for us to invoke the `transfer` method on them. We need to update the state variable for addresses and the argument inside the constructor with the `payable` keyword.\n\n```sol\naddress payable[] public addresses;\n```\n\nAnd inside the `constructor`:\n\n```sol\nconstructor(\n    address payable[] memory _addresses,\n    uint256[] memory _splitRatios\n) {\n    // constructor body\n}\n```\n\nWith this change, the `withdraw` function should start working!\n\nWe would like to have the `withdraw` function fail if the balance is less than 0. Let\'s write the test for that.\n\n```js\nit("can NOT be called if the contract balance is less than or equal to 0", async () => {\n  const Contract = await ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n\n  const addresses = [owner.address, person1.address];\n  const splitRatios = [1, 1];\n\n  expect(addresses.length).to.equal(splitRatios.length);\n\n  const contract = await Contract.deploy(addresses, splitRatios);\n  await contract.deployed();\n\n  expect(await contract.getBalance()).to.equal(0);\n\n  await expect(contract.withdraw()).to.be.revertedWith("Insufficient balance");\n});\n```\n\nWe first ensure that the balance of the contract is `0`.\n\n```js\nexpect(await contract.getBalance()).to.equal(0);\n```\n\nThen we try to call the `withdraw` function. We should make it fail with the `"Insufficient balance"` error.\n\n```js\nawait expect(contract.withdraw()).to.be.revertedWith("Insufficient balance");\n```\n\nTo implement this inside the contract, we should get the contract balance inside the `withdraw` function and ensure it is bigger than 0.\n\n```sol\nfunction withdraw() public {\n    uint256 balance = getBalance();\n    uint256 addressesLength = addresses.length;\n\n    require(balance > 0, "Insufficient balance");\n\n    for (uint256 i = 0; i < addressesLength; i++) {\n        addresses[i].transfer(\n            (balance / splitRatiosTotal) * splitRatios[i]\n        );\n    }\n}\n```\n\n## Ensuring that Split Ratio Total is Smaller Than the Balance\n\nWe should ensure that the total split ratio is smaller than the balance. This way, we won\'t get any numerical errors when dividing the balance with the split ratio. Here is the test for that looks like.\n\n```js\nit("can NOT be called when the total split ratio is greater than the contract balance", async () => {\n  const Contract = await ethers.getContractFactory("Partnership");\n\n  const [owner, person1] = await hre.ethers.getSigners();\n\n  const addresses = [owner.address, person1.address];\n  const splitRatios = [10, 10];\n\n  expect(addresses.length).to.equal(splitRatios.length);\n\n  const contract = await Contract.deploy(addresses, splitRatios);\n  await contract.deployed();\n\n  expect(await contract.getBalance()).to.equal(0);\n\n  // send ether to contract\n  await owner.sendTransaction({\n    to: contract.address,\n    value: ethers.utils.parseEther("0.00000000000000001"),\n  });\n\n  expect(await contract.getBalance()).to.equal(10);\n\n  await expect(contract.withdraw()).to.be.revertedWith(\n    "Balance should be greater than the total split ratios"\n  );\n});\n```\n\nWe are sending 10 Wei to the contract.\n\n```js\n// send ether to contract\nawait owner.sendTransaction({\n  to: contract.address,\n  value: ethers.utils.parseEther("0.00000000000000001"),\n});\n\nexpect(await contract.getBalance()).to.equal(10);\n```\n\nThe total of the split ratios in this test is greater than 10 (it is 20). This causes the contract to fail with the `"Balance should be greater than the total split ratios"` message. We can implement this inside the contract by adding a simple `require` statement.\n\n```sol\nrequire(balance >=\n  splitRatiosTotal, "Balance should be greater than the total split ratios");\n```\n\n## Finalizing the Run Script\n\nNow that we have finished the contract logic, let\'s update the `run` script to simulate how someone would interact with this contract.\n\n```js\nconst hre = require("hardhat");\n\nasync function main() {\n  await hre.run("compile");\n  const [owner, person1, person2] = await hre.ethers.getSigners();\n  const addresses = [person1.address, person2.address];\n  const splitRatios = [4, 1];\n\n  const Contract = await hre.ethers.getContractFactory("Partnership");\n  const provider = hre.ethers.provider;\n  const contract = await Contract.deploy(addresses, splitRatios);\n\n  await contract.deployed();\n\n  let balance1 = await provider.getBalance(person1.address);\n  console.log(`The balance for the person1 is: ${balance1}`);\n\n  let balance2 = await provider.getBalance(person2.address);\n  console.log(`The balance for the person2 is: ${balance2}`);\n\n  let contractBalance = await contract.getBalance();\n  console.log(`The balance in the contract is: ${contractBalance}`);\n\n  await owner.sendTransaction({\n    to: contract.address,\n    value: ethers.utils.parseEther("5.0"),\n  });\n\n  console.log(\n    `The balance in the contract after receiving funds is: ${await contract.getBalance()}`\n  );\n\n  await contract.withdraw();\n\n  console.log(\n    `The balance in the contract after withdrawal is: ${await contract.getBalance()}`\n  );\n\n  balance1 = await provider.getBalance(person1.address);\n  console.log(`The new balance for the person1 is:${balance1}`);\n\n  balance2 = await provider.getBalance(person2.address);\n  console.log(`The balance for the person2 is: ${balance2}`);\n}\n\nmain()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n```\n\nHere, we simulate the contract deployment with two addresses and a 4 to 1 split ratio. We need to define a `provider` to get the balance from the Ethereum accounts.\n\n```js\nconst provider = hre.ethers.provider;\n```\n\nWe can then call the `getBalance` method on the provider to see the contract balance.\n\n```js\nlet balance1 = await provider.getBalance(person1.address);\n```\n\nHardhat initializes these accounts with a balance of 10000 ETH.\n\nAfter the deployment, we get another user to send 5000 ETH into the contract. The balance of the contract changes accordingly.\n\n```js\nawait owner.sendTransaction({\n  to: contract.address,\n  value: ethers.utils.parseEther("5000.0"),\n});\n```\n\nWe then call the `withdraw` function on the contract. This distributes the funds inside the contract in between the addresses. We then check to ensure the balance of the accounts has changed accordingly.\n\n```js\nawait contract.withdraw();\n```\n\nIt seems like things are working as expected!\n\nBelieve it or not, this is it! We now have a program that can permanently store data, securely receive transactions, store funds and transfer those funds to specified accounts (wallet addresses). And it took less than 100 lines to write it! Building something like this makes you truly appreciate the power of blockchains and smart contract platforms like Ethereum. The amount of code and complexity to achieve something similar using centralized solutions would have been substantial.\n\nHow can other people make use of this smart contract? We could upload the contract to a public repository like Github and have other people clone it from there. They would need to change the run script to handle the deployment of the contract on the Ethereum blockchain themselves. Obviously, this is not an ideal or feasible solution for those who don\'t have any familiarity with working with smart contracts.\n\nWe could do so much better than this! If you enjoyed this walkthrough, check out my [ebook](https://leanpub.com/develop-web3-apps-using-solidity-and-react/) for learning how to build the front end application for this contract using React, Next.js, and React.\n\n',n.user={name:"Engin Arslan",username:t,twitter_username:t,github_username:"hibernationTheory",website_url:"http://www.enginarslan.com",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--aYt4FmKd--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/10588/0fb648e7-7368-4392-bd3b-2f90e800e3e7.jpg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--EFye281k--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/10588/0fb648e7-7368-4392-bd3b-2f90e800e3e7.jpg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:n}},error:s,state:{currentArticle:n},serverRendered:!0,routePath:"/inspiratory/1025270",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:s}}}}(null,{},"2022-03-16T21:34:47Z","inspiratory")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
