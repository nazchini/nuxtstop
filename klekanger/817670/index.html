<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Part 2: A new web page for our condo. Setting up Gatsby and Contentful.</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>Part 2: A new web page for our condo. Setting up Gatsby and Contentful.</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/gatsby" class="tag" data-v-70afb46a>
          #gatsby
        </a><a href="/nuxtstop/t/react" class="tag" data-v-70afb46a>
          #react
        </a><a href="/nuxtstop/t/contentful" class="tag" data-v-70afb46a>
          #contentful
        </a><a href="/nuxtstop/t/auth0" class="tag" data-v-70afb46a>
          #auth0
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--5QlmkYRa--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/p27hjy5qossofwql6qjs.jpg" alt="Part 2: A new web page for our condo. Setting up Gatsby and Contentful." data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            4
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Sep 12 '21</time></div></header> <div class="content" data-v-70afb46a><p>In part 1 of this mini-series I wrote about the technology choices I made when I started building new web pages for my local condominium. If you haven´t done it already, read about <a href="https://dev.to/klekanger/part-1-how-i-built-our-condos-s-new-web-pages-with-gatsby-and-chakra-ui-4jd5">why I chose React/Gatsby and Chakra UI on the frontend, Contentful as a headless CMS and Netlify for hosting everything</a>. I also needed an authentication solution for those parts of the web site that should only be accessible for logged in residents only.</p>

<h2>
  <a name="building-the-foundation" href="#building-the-foundation">
  </a>
  Building the foundation
</h2>

<p>Starting a Gatsby project is as simple as typing <code>npm init gatsby</code> on the command line and answering a few simple questions (or <code>gatsby new</code> if you have <a href="https://www.gatsbyjs.com/docs/reference/gatsby-cli/">Gatsby-CLI</a> installed). Gatsby will then set up a starter project for you, which you can then modify.</p>

<p>You will be asked which CMS you want to use for storing the content, and can choose between Wordpress, Contentful, Sanity, DatoCMS, Shopify or Netlify CMS. You can use almost anything else with Gatsby as well - but Gatsby can set up a number of things for you automatically if you choose one of the predefined options. You will also be asked if you want to have a specific styling system pre-installed, such as Sass, Styled components, Emiton, PostCSS or Theme UI.</p>

<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--0qGWaQQH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/werqlkugjmzm57lltvtm.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--0qGWaQQH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/werqlkugjmzm57lltvtm.png" alt="Command line screenshot, setting up Gatsby" loading="lazy"></a></p>
<figcaption>Gatsby can prepare a number of things for you in advance.</figcaption></figure>



<p>However, I chose to start from scratch, and installed the various dependencies I needed as I went along with the project. I needed <a href="https://www.gatsbyjs.com/plugins/gatsby-source-contentful">gatsby-source-contentful</a> to get content from my Contentful headless CMS. And I wanted to make life a little easier for myself by creating the user interface with <a href="https://chakra-ui.com/">Chakra UI</a>. I also needed some other packages, like <a href="https://github.com/motdotla/dotenv#readme">dotenv</a> to handle environmental variables (such as access tokens for Contentful, and other things I didn't want to include in the source code on Github).</p>

<p>When everything is set up, you will get a page that looks something like this when entering <code>gatsby develop</code> on the command line and visiting <code>http://localhost:8000</code>:</p>

<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--LmQwb0jA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gshzjq3rxcweb5pobn3e.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--LmQwb0jA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gshzjq3rxcweb5pobn3e.png" alt="Screenshot of a new Gatsby site" loading="lazy"></a></p>
<figcaption>The Gatsby documentation is awesome, and the start page created by the gatsby new command links to a lot of useful information.</figcaption></figure>



<p>The first thing you should do, is of course to remove this dummy page.</p>

<p>In Gatsby, routing is as simple as creating a React component in the <code>/src/pages</code> folder and exporting it. For example, if you export a component from the <code>/src/pages/test.js</code> file, you will have a route on <code>/test</code> (ie you can type <code>localhost:8000/test</code> in the browser to reach it). The main page - ie the front page of the website - is <code>/src/pages/index.js</code>. This is how my index.js file looks like on my finished website:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./src/pages/index.js</span>

<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">SEO</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/seo</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">CookieConsent</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/cookieConsent</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">HeroWide</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/sections/hero-wide</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ArticleGrid</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/sections/articleGrid</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">IndexPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;></span>
      <span class="o">&lt;</span><span class="nx">SEO</span> <span class="o">/></span>
      <span class="o">&lt;</span><span class="nx">CookieConsent</span> <span class="o">/></span>
      <span class="o">&lt;</span><span class="nx">HeroWide</span> <span class="o">/></span>
      <span class="o">&lt;</span><span class="nx">ArticleGrid</span> <span class="o">/></span>
    <span class="o">&lt;</span><span class="sr">/</span><span class="err">>
</span>  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">IndexPage</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Normally I would include a Layout component here, for consistent layout with header, footer, etc. across all pages. But since I use Chakra UI, I have put the Layout component elsewhere where the Layout component is wrapped by <code>&lt;ChakraProvider></code> which is necessary for it all to work. This also enables theme based styling using Chakra UI. I created the file <code>./src/chakra-wrapper.js</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./src/chakra-wrapper.js</span>

<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ChakraProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@chakra-ui/react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Layout</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./components/layouts/layout</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">theme</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./theme/</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">wrapPageElement</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">element</span> <span class="p">})</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ChakraProvider</span> <span class="nx">resetCSS</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">></span>
      <span class="o">&lt;</span><span class="nx">Layout</span><span class="o">></span><span class="p">{</span><span class="nx">element</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="sr">/ChakraProvider</span><span class="err">>
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And then, in <code>./gatsby-browser.js</code> and <code>./gatsby-ssr.js</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">wrapPageElement</span> <span class="k">as</span> <span class="nx">wrap</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./src/chakra-wrapper</span><span class="dl">'</span><span class="p">;</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">wrapPageElement</span> <span class="o">=</span> <span class="nx">wrap</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This means that the entire page is wrapped in ChakraProvider, and then the Layout component which wraps everything else and includes a header and a footer. In the <code>&lt;ChakraProvider></code> component in the top code snippet, I also pass in the theme I have defined for the page as a prop.</p>

<p>I ended up with the folder structure below, where I have put all reusable React components in <code>/src/components</code>, pages under <code>/src/pages</code>, page templates under <code>/src/templates</code> and Chakra UI themes under <code>/src/theme</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>src
├── components
│   ├── article.tsx
│   ├── layouts
│   │   └── layout.tsx
│   ├── private-components
│   └── sections
│       ├── articleGrid.tsx
│       ├── footer.tsx
│       ├── header.tsx
│       └── hero-wide.tsx
├── pages
│   ├── 404.tsx
│   ├── index.tsx
│   ├── informasjon.tsx
│   └── min-side.tsx
├── templates
│   ├── blog-archive-template.tsx
│   ├── blog-template.tsx
│   └── page-template.tsx
├── theme
│   ├── colors.js
│   ├── components
│   │   ├── button.js
│   │   ├── heading.js
│   │   └── text.js
│   ├── index.js
│   ├── renderRichTextOptions.js
│   ├── styles.js
│   └── textStyles.js
└── utils
    └── privateRoute.tsx
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>As you can see, I chose to rename the .js files for the React components to .tsx, in order to use TypeScript in my components - and to reduce the risk of bugs when I pass data as props between components.</p>

<h2>
  <a name="fetch-content-from-contentful" href="#fetch-content-from-contentful">
  </a>
  Fetch content from Contentful
</h2>

<p>As mentioned, I wanted to use <a href="https://www.contentful.com/developers/">Contentful</a> for my content. Contentful is a <a href="https://en.wikipedia.org/wiki/Headless_content_management_system">headless CMS</a> system, which means that the content is decoupled or separated from the front end. This makes it relatively easy if I later on wants to switch to another frontend or backend, or fetch content from the same source to another web page or maybe a mobile app. When using Gatsby, you can fetch content from virtually any source by making GraphQL queries in your code. There are a lot of ready-made plugins that make this very easy, whether you want to fetch data from markdown files, a headless CMS like Contentful or Sanity, or from an online shopping solution like Shopify. I used Gatsby's official Contentful plugin, <a href="https://www.gatsbyjs.com/plugins/gatsby-source-contentful/">gatsby-source-contentful</a>.</p>

<p>When you have installed and configured the plugin, you can visit <code>localhost:8000/__graphiql</code> to create the GraphQL queries. In the left column of the GraphiQL interface you get a view of all available data (including content from Contentful). The middle column is for creating the queries - and the column on the right shows the result of a query after you press the Run button. GraphiQL makes it very easy and straightforward to test different queries and check that you get back the data you expect, before copying the query into your code.</p>

<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s---Y1HqNVI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkhaul1ccar60tp1p96a.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s---Y1HqNVI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkhaul1ccar60tp1p96a.png" alt="Alt Text" loading="lazy"></a></p>
<figcaption>GraphiQL is a user-friendly interface for creating GraphQL queries.</figcaption></figure>



<p>But before I could see my data in GraphiQL, I had to set up everything in Contentful. I first had to define a Content model, which is a description of the different types of content - and what fields should be available for each content type. For example, I have a content type called <em>Blog Post</em>, which contains fields such as <em>Title</em>, <em>Summary</em>, <em>Top Image</em>, <em>Body Text</em> and <em>Author</em>. For each of the fields you must define the type of the content - such as text, numbers, boolean values, media (images, video, etc). You can also create references between different types of content, for example links between a blog post and one or more authors (where Author is a content type as well).</p>

<p>I defined separate content types for front page text and pages (for example information pages and contact pages). In addition, I created a content type called Service menu, which is used to change a menu with information for the residents of the condominium - including links for downloading meeting minutes, a list of all the residents and other useful information. All content in the Service menu will require login. </p>

<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--HrfLDHjF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/knlq8sumrkpwh8h6qfjh.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--HrfLDHjF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/knlq8sumrkpwh8h6qfjh.png" alt="Screenshot: editing the content model in Contentful" loading="lazy"></a></p>
<figcaption>Contentful: Start by making a content model with all the different types of content you want. Then define which fields each content type should include.</figcaption></figure>



<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--90mgzJ6e--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3w1ok8acxb7v6gmx5kjw.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--90mgzJ6e--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3w1ok8acxb7v6gmx5kjw.png" alt="Field definitions in Contentful." loading="lazy"></a></p>
<figcaption>Field definitions in Contentful.</figcaption></figure>



<h2>
  <a name="generation-of-static-web-pages" href="#generation-of-static-web-pages">
  </a>
  Generation of static web pages
</h2>

<p>One of the things that makes websites created in Gatsby extremely fast is that Gatsby generates static web pages. This means that when you run <code>gatsby build</code>, Gatsby will retrieve content from Contentful (or other sources) and build every HTML page for you. Thus, 100/100 in Lighthouse should be within reach:</p>

<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--AGCjmuFc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3m5qkx4azpmsplzmk8ch.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--AGCjmuFc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3m5qkx4azpmsplzmk8ch.png" alt="Screenshot: 100 of 100 in Lighthouse." loading="lazy"></a></p>
<figcaption>100 of 100 in Lighthouse. You can do it!</figcaption></figure>



<p>As I have mentioned, all components exported from the <code>/src/pages</code> folder will automatically be converted to static HTML pages. But to be able to programmatically create my own pages for each blog post and other content, I used one of Gatsby's built-in APIs, <a href="https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createPages">createPages</a>. To explain:</p>

<p>When you build a Gatsby page, code in the <code>gatsby-node.js</code> file will run once before the page is built. The <code>createPages</code> (plural) API allows you to run a GraphQL query to retrieve content (such as blog posts) - in our case from Contentful. Then you can run a so-called <em>action</em> called <code>createPage</code> (singular) on each blog post. <code>createPage</code> receives as a parameter the React component you want to use as a page template, along with context data that the page template will receive as props. Context data in my case is the ID of the article in Contentful. Inside the page template you run a new GraphQL query where you only retrieve the blog post that has the correct ID, and then you retrieve everything you need to display the content - such as title, introduction, body text, images, etc. The page template is like any normal React component.</p>

<p>My gatsby-node.js looks like this (abbreviated - there are also several GraphQL queries and actions to create other types of pages. See <a href="https://github.com/klekanger">my Github</a> for full source code):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./gatsby-node.js</span>

<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">`path`</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">createPages</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">graphql</span><span class="p">,</span> <span class="nx">actions</span> <span class="p">})</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">createPage</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actions</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">blogPostTemplate</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`src/templates/blog-template.tsx`</span><span class="p">);</span>

<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
  <span class="k">return</span> <span class="nx">graphql</span><span class="p">(</span><span class="s2">`
    {
      publicPosts: allContentfulBlogPost(
        filter: { privatePost: { eq: false } }
      ) {
        nodes {
          contentful_id
          slug
        }
      }
    }
  `</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">blogNodes</span> <span class="o">=</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">publicPosts</span> <span class="o">||</span> <span class="p">{}).</span><span class="nx">nodes</span> <span class="o">||</span> <span class="p">[];</span>

  <span class="c1">// Create public blog post pages.</span>
  <span class="c1">// Skip private pages (in graphQl query)</span>
  <span class="nx">blogNodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">node</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">contentful_id</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">slug</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">slug</span><span class="p">;</span>
    <span class="nx">createPage</span><span class="p">({</span>
      <span class="c1">// Path for this page — required</span>
      <span class="na">path</span><span class="p">:</span> <span class="s2">`/blog/</span><span class="p">${</span><span class="nx">slug</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="na">component</span><span class="p">:</span> <span class="nx">blogPostTemplate</span><span class="p">,</span>
      <span class="na">context</span><span class="p">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">},</span>
    <span class="p">});</span>
  <span class="p">});</span>

<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>In the file <code>blog-template.tsx</code> I fetch the blogposts one-by-one from Contentful using the GraphQL query below. Note the variable <code>$id</code> in the GraphQL query. This ID comes from the context parameter sent from <code>createPage</code> in <code>gatsby-node.js</code> and gives us the content for the correct blog post, and nothing morge.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./src/templates/blog-template.tsx</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query BlogPostQuery($id: String!) {
    contentfulBlogPost(contentful_id: { eq: $id }) {
      title
      createdAt(formatString: "DD.MM.YYYY")
      updatedAt(formatString: "DD.MM.YYYY")
      author {
        firstName
        lastName
      }
      excerpt {
        excerpt
      }
      bodyText {
        raw
        references {
          ... on ContentfulAsset {
            contentful_id
            __typename
            title
            description
            gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)
          }
        }
      }

      featuredImage {
        gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)
        file {
          url
        }
        title
        description
      }
    }
  }
`</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then I destructure the data I want from the query and use the data in the page template component:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./src/templates/blog-template.tsx</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="kd">const</span> <span class="p">{</span>
    <span class="nx">title</span><span class="p">,</span>
    <span class="nx">author</span><span class="p">,</span>
    <span class="nx">createdAt</span><span class="p">,</span>
    <span class="nx">updatedAt</span><span class="p">,</span>
    <span class="nx">bodyText</span><span class="p">,</span>
    <span class="nx">excerpt</span><span class="p">,</span>
    <span class="nx">featuredImage</span><span class="p">,</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">contentfulBlogPost</span><span class="p">;</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;></span>
      <span class="o">&lt;</span><span class="nx">SEO</span>
        <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span>
        <span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">featuredImage</span><span class="p">?.</span><span class="nx">file</span><span class="p">?.</span><span class="nx">url</span> <span class="o">||</span> <span class="kc">null</span><span class="p">}</span>
        <span class="nx">description</span><span class="o">=</span><span class="p">{</span><span class="nx">excerpt</span><span class="p">?.</span><span class="nx">excerpt</span> <span class="o">||</span> <span class="kc">null</span><span class="p">}</span>
      <span class="sr">/</span><span class="err">>
</span>      <span class="o">&lt;</span><span class="nx">Article</span>
        <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span>
        <span class="nx">bodyText</span><span class="o">=</span><span class="p">{</span><span class="nx">bodyText</span><span class="p">}</span>
        <span class="nx">createdAt</span><span class="o">=</span><span class="p">{</span><span class="nx">createdAt</span><span class="p">}</span>
        <span class="nx">updatedAt</span><span class="o">=</span><span class="p">{</span><span class="nx">updatedAt</span><span class="p">}</span>
        <span class="nx">mainImage</span><span class="o">=</span><span class="p">{</span><span class="nx">featuredImage</span><span class="p">}</span>
        <span class="nx">author</span><span class="o">=</span><span class="p">{</span><span class="nx">author</span><span class="p">}</span>
        <span class="nx">buttonLink</span><span class="o">=</span><span class="dl">'</span><span class="s1">/blog</span><span class="dl">'</span>
      <span class="o">/></span>
    <span class="o">&lt;</span><span class="sr">/</span><span class="err">>
</span>  <span class="p">);</span>
<span class="p">}</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Since I often need to present content in article format, with a featured image, title, introduction, author, etc., I created an <code>&lt;Article></code> component for this, and pass data to it via props.</p>

<p>One challenge I encountered was how to render content that was defined as Rich Text in Contentful. Content in Rich Text fields are based on blocks, and when you do a GraphQL query, you're getting back JSON containing nodes with all the content in. There are a lot of different ways to render this content, and Contentful has a little <a href="https://github.com/contentful/rich-text">more info here</a>. I used <code>import {renderRichText} from 'gatsby-source-contentful/rich-text'</code> and then I could use <code>{renderRichText (bodyText, renderRichTextOptions)}</code> in my Article component to render the contents of bodyText. <code>renderRichTextOptions</code> is a component I import at the beginning of the <code>&lt;Article></code> component, and inside <code>renderRichTextOptions</code> I can then define how for example a <code>&lt;H1></code> title or image should be rendered (<code>&lt;Text></code> and <code>&lt;Heading></code> in the code below are Chakra UI components):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="c1">// ./src/theme/renderTichTextOptions.js</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="kd">const</span> <span class="nx">renderRichTextOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">renderMark</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">BOLD</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=></span> <span class="o">&lt;</span><span class="nx">strong</span><span class="o">></span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/strong></span><span class="err">,
</span>    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">UNDERLINE</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=></span> <span class="o">&lt;</span><span class="nx">u</span><span class="o">></span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/u></span><span class="err">,
</span>    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">ITALIC</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=></span> <span class="o">&lt;</span><span class="nx">em</span><span class="o">></span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/em></span><span class="err">,
</span>  <span class="p">},</span>
  <span class="na">renderNode</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">BLOCKS</span><span class="p">.</span><span class="nx">PARAGRAPH</span><span class="p">]:</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">children</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Text</span>
        <span class="nx">textAlign</span><span class="o">=</span><span class="dl">'</span><span class="s1">left</span><span class="dl">'</span>
        <span class="nx">my</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span>
        <span class="nx">fontSize</span><span class="o">=</span><span class="p">{{</span> <span class="na">base</span><span class="p">:</span> <span class="dl">'</span><span class="s1">sm</span><span class="dl">'</span><span class="p">,</span> <span class="na">sm</span><span class="p">:</span> <span class="dl">'</span><span class="s1">md</span><span class="dl">'</span><span class="p">,</span> <span class="na">md</span><span class="p">:</span> <span class="dl">'</span><span class="s1">lg</span><span class="dl">'</span> <span class="p">}}</span>
      <span class="o">></span>
        <span class="p">{</span><span class="nx">children</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/Text</span><span class="err">>
</span>    <span class="p">),</span>
    <span class="p">[</span><span class="nx">BLOCKS</span><span class="p">.</span><span class="nx">HEADING_1</span><span class="p">]:</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">children</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Heading</span> <span class="k">as</span><span class="o">=</span><span class="dl">'</span><span class="s1">h1</span><span class="dl">'</span> <span class="nx">textAlign</span><span class="o">=</span><span class="dl">'</span><span class="s1">left</span><span class="dl">'</span> <span class="nx">size</span><span class="o">=</span><span class="dl">'</span><span class="s1">4xl</span><span class="dl">'</span><span class="o">></span>
        <span class="p">{</span><span class="nx">children</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/Heading</span><span class="err">>
</span>    <span class="p">),</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>It's also possible to use another library, <a href="https://github.com/contentful/rich-text/tree/master/packages/rich-text-react-renderer">rich-text-react-renderer</a>, but the way I did it worked very well and gave me the flexibility I needed.</p>

<h2>
  <a name="styling" href="#styling">
  </a>
  Styling
</h2>

<p>Chakra UI have components for everything you need to create beautiful web pages, using components like <code>&lt;Badge></code>, <code>&lt;Alert></code>, <code>&lt;Text></code>, <code>&lt;Heading></code>, <code>&lt;Menu></code>, <code>&lt;Image></code>, and so on.</p>

<p>As Chakra UI is a theme based component library, you dont't have to write a single line of CSS. Instead, you just <a href="https://chakra-ui.com/docs/theming/customize-theme">customize the standard theme</a> if you want a different look-and-feel. </p>

<p>With Chakra UI you get <a href="https://chakra-ui.com/docs/features/responsive-styles">responsive design right out of the box</a>, with pre-defined breakpoints (which you can change if you want). You do not need to manually create media queries, but can do as I have done in the example below in your JSX code (<a href="https://chakra-ui.com/docs/typography/heading"></a> is a Chakra UI component intended for titles and renders by default an <code>&lt;H2></code>- tag, but in the example I have chosen to render it as <code>&lt;H1></code>):<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Heading</span>
   <span class="k">as</span><span class="o">=</span><span class="dl">'</span><span class="s1">h1</span><span class="dl">'</span>
   <span class="nx">fontSize</span><span class="o">=</span><span class="p">{[</span><span class="dl">'</span><span class="s1">4xl</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">6xl</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">6xl</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">7xl</span><span class="dl">'</span><span class="p">]}</span>
   <span class="nx">textAlign</span><span class="o">=</span><span class="p">{[</span><span class="dl">'</span><span class="s1">center</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span><span class="p">]}</span>
   <span class="nx">pb</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span>
<span class="o">></span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here we define font size and text alignment for four different screen sizes. That's actually all you need to do to get perfect responsive design with Chakra UI.</p>

<p>Or you could do like this to use Chakra UI's CSS Grid component and define that you want 1 column on small and medium screen sizes, and 2 columns on larger screens:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Grid</span>
    <span class="nx">templateColumns</span><span class="o">=</span><span class="p">{{</span>
      <span class="na">sm</span><span class="p">:</span> <span class="dl">'</span><span class="s1">repeat(1, 1fr)</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">md</span><span class="p">:</span> <span class="dl">'</span><span class="s1">repeat(1, 1fr)</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">lg</span><span class="p">:</span> <span class="dl">'</span><span class="s1">repeat(2, 1fr)</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">xl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">repeat(2, 1fr)</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">}}</span>
    <span class="nx">pt</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>
    <span class="nx">gap</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>
    <span class="nx">mb</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>
    <span class="nx">mt</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span>
    <span class="nx">maxWidth</span><span class="o">=</span><span class="dl">'</span><span class="s1">95vw</span><span class="dl">'</span>
    <span class="nx">minHeight</span><span class="o">=</span><span class="dl">'</span><span class="s1">45vh</span><span class="dl">'</span>
  <span class="o">></span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>With Chakra UI you also get a web site with excellent accessibility, without you needing to think about aria-tags or other things.</p>

<p>Have a look at <a href="https://chakra-ui.com">https://chakra-ui.com</a> for more info and more examples. </p>

<h2>
  <a name="next-step-authentication-and-protected-routes" href="#next-step-authentication-and-protected-routes">
  </a>
  Next step: <a href="https://dev.to/klekanger/part-3-authentication-and-private-routes-in-gatsby-46jc">Authentication and protected routes</a>
</h2>

<p>Feel free to take a look at the finished website here: <a href="https://gartnerihagen-askim.no">https://gartnerihagen-askim.no</a></p>

<p>The project is open source, you can find the source code <a href="https://github.com/klekanger/gartnerihagen">at my Github</a>.</p>

<p><em>This is a translation, the original article in Norwegian is here: <a href="https://www.lekanger.no/project/del-2-slik-bygget-jeg-sameiets-nye-nettsider-grunnmuren-er-pa-plass">Del 2: Slik bygget jeg sameiets nye nettsider. Grunnmuren er på plass</a></em></p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/klekanger/part-2-a-new-web-page-for-our-condo-setting-up-gatsby-and-contentful-2k0j" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,n,a,e,t){return a.type_of="article",a.id=817670,a.title="Part 2: A new web page for our condo. Setting up Gatsby and Contentful.",a.description="In part 1 of this mini-series I wrote about the technology choices I made when I started building new...",a.readable_publish_date="Sep 12 '21",a.slug="part-2-a-new-web-page-for-our-condo-setting-up-gatsby-and-contentful-2k0j",a.path="/klekanger/part-2-a-new-web-page-for-our-condo-setting-up-gatsby-and-contentful-2k0j",a.url=e,a.comments_count=0,a.public_reactions_count=4,a.collection_id=14578,a.published_timestamp=s,a.positive_reactions_count=4,a.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--5QlmkYRa--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/p27hjy5qossofwql6qjs.jpg",a.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--Ao5zFI85--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/p27hjy5qossofwql6qjs.jpg",a.canonical_url=e,a.created_at="2021-09-08T17:04:57Z",a.edited_at="2021-09-12T17:03:25Z",a.crossposted_at=n,a.published_at=s,a.last_comment_at=s,a.reading_time_minutes=10,a.tag_list="gatsby, react, contentful, auth0",a.tags=["gatsby","react","contentful","auth0"],a.body_html='<p>In part 1 of this mini-series I wrote about the technology choices I made when I started building new web pages for my local condominium. If you haven´t done it already, read about <a href="https://dev.to/klekanger/part-1-how-i-built-our-condos-s-new-web-pages-with-gatsby-and-chakra-ui-4jd5">why I chose React/Gatsby and Chakra UI on the frontend, Contentful as a headless CMS and Netlify for hosting everything</a>. I also needed an authentication solution for those parts of the web site that should only be accessible for logged in residents only.</p>\n\n<h2>\n  <a name="building-the-foundation" href="#building-the-foundation">\n  </a>\n  Building the foundation\n</h2>\n\n<p>Starting a Gatsby project is as simple as typing <code>npm init gatsby</code> on the command line and answering a few simple questions (or <code>gatsby new</code> if you have <a href="https://www.gatsbyjs.com/docs/reference/gatsby-cli/">Gatsby-CLI</a> installed). Gatsby will then set up a starter project for you, which you can then modify.</p>\n\n<p>You will be asked which CMS you want to use for storing the content, and can choose between Wordpress, Contentful, Sanity, DatoCMS, Shopify or Netlify CMS. You can use almost anything else with Gatsby as well - but Gatsby can set up a number of things for you automatically if you choose one of the predefined options. You will also be asked if you want to have a specific styling system pre-installed, such as Sass, Styled components, Emiton, PostCSS or Theme UI.</p>\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--0qGWaQQH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/werqlkugjmzm57lltvtm.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--0qGWaQQH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/werqlkugjmzm57lltvtm.png" alt="Command line screenshot, setting up Gatsby" loading="lazy"></a></p>\n<figcaption>Gatsby can prepare a number of things for you in advance.</figcaption></figure>\n\n\n\n<p>However, I chose to start from scratch, and installed the various dependencies I needed as I went along with the project. I needed <a href="https://www.gatsbyjs.com/plugins/gatsby-source-contentful">gatsby-source-contentful</a> to get content from my Contentful headless CMS. And I wanted to make life a little easier for myself by creating the user interface with <a href="https://chakra-ui.com/">Chakra UI</a>. I also needed some other packages, like <a href="https://github.com/motdotla/dotenv#readme">dotenv</a> to handle environmental variables (such as access tokens for Contentful, and other things I didn\'t want to include in the source code on Github).</p>\n\n<p>When everything is set up, you will get a page that looks something like this when entering <code>gatsby develop</code> on the command line and visiting <code>http://localhost:8000</code>:</p>\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--LmQwb0jA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gshzjq3rxcweb5pobn3e.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--LmQwb0jA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gshzjq3rxcweb5pobn3e.png" alt="Screenshot of a new Gatsby site" loading="lazy"></a></p>\n<figcaption>The Gatsby documentation is awesome, and the start page created by the gatsby new command links to a lot of useful information.</figcaption></figure>\n\n\n\n<p>The first thing you should do, is of course to remove this dummy page.</p>\n\n<p>In Gatsby, routing is as simple as creating a React component in the <code>/src/pages</code> folder and exporting it. For example, if you export a component from the <code>/src/pages/test.js</code> file, you will have a route on <code>/test</code> (ie you can type <code>localhost:8000/test</code> in the browser to reach it). The main page - ie the front page of the website - is <code>/src/pages/index.js</code>. This is how my index.js file looks like on my finished website:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./src/pages/index.js</span>\n\n<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">react</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">SEO</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">../components/seo</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">CookieConsent</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">../components/cookieConsent</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">HeroWide</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">../components/sections/hero-wide</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">ArticleGrid</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">../components/sections/articleGrid</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="kd">const</span> <span class="nx">IndexPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="o">&lt;&gt;</span>\n      <span class="o">&lt;</span><span class="nx">SEO</span> <span class="o">/&gt;</span>\n      <span class="o">&lt;</span><span class="nx">CookieConsent</span> <span class="o">/&gt;</span>\n      <span class="o">&lt;</span><span class="nx">HeroWide</span> <span class="o">/&gt;</span>\n      <span class="o">&lt;</span><span class="nx">ArticleGrid</span> <span class="o">/&gt;</span>\n    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;\n</span>  <span class="p">);</span>\n<span class="p">};</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">IndexPage</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Normally I would include a Layout component here, for consistent layout with header, footer, etc. across all pages. But since I use Chakra UI, I have put the Layout component elsewhere where the Layout component is wrapped by <code>&lt;ChakraProvider&gt;</code> which is necessary for it all to work. This also enables theme based styling using Chakra UI. I created the file <code>./src/chakra-wrapper.js</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./src/chakra-wrapper.js</span>\n\n<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">react</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ChakraProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@chakra-ui/react</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">Layout</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./components/layouts/layout</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">theme</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./theme/</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">wrapPageElement</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">element</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="o">&lt;</span><span class="nx">ChakraProvider</span> <span class="nx">resetCSS</span> <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span><span class="o">&gt;</span>\n      <span class="o">&lt;</span><span class="nx">Layout</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">element</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Layout</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="sr">/ChakraProvider</span><span class="err">&gt;\n</span>  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And then, in <code>./gatsby-browser.js</code> and <code>./gatsby-ssr.js</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">react</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">wrapPageElement</span> <span class="k">as</span> <span class="nx">wrap</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./src/chakra-wrapper</span><span class="dl">\'</span><span class="p">;</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">wrapPageElement</span> <span class="o">=</span> <span class="nx">wrap</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>This means that the entire page is wrapped in ChakraProvider, and then the Layout component which wraps everything else and includes a header and a footer. In the <code>&lt;ChakraProvider&gt;</code> component in the top code snippet, I also pass in the theme I have defined for the page as a prop.</p>\n\n<p>I ended up with the folder structure below, where I have put all reusable React components in <code>/src/components</code>, pages under <code>/src/pages</code>, page templates under <code>/src/templates</code> and Chakra UI themes under <code>/src/theme</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>src\n├── components\n│   ├── article.tsx\n│   ├── layouts\n│   │   └── layout.tsx\n│   ├── private-components\n│   └── sections\n│       ├── articleGrid.tsx\n│       ├── footer.tsx\n│       ├── header.tsx\n│       └── hero-wide.tsx\n├── pages\n│   ├── 404.tsx\n│   ├── index.tsx\n│   ├── informasjon.tsx\n│   └── min-side.tsx\n├── templates\n│   ├── blog-archive-template.tsx\n│   ├── blog-template.tsx\n│   └── page-template.tsx\n├── theme\n│   ├── colors.js\n│   ├── components\n│   │   ├── button.js\n│   │   ├── heading.js\n│   │   └── text.js\n│   ├── index.js\n│   ├── renderRichTextOptions.js\n│   ├── styles.js\n│   └── textStyles.js\n└── utils\n    └── privateRoute.tsx\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>As you can see, I chose to rename the .js files for the React components to .tsx, in order to use TypeScript in my components - and to reduce the risk of bugs when I pass data as props between components.</p>\n\n<h2>\n  <a name="fetch-content-from-contentful" href="#fetch-content-from-contentful">\n  </a>\n  Fetch content from Contentful\n</h2>\n\n<p>As mentioned, I wanted to use <a href="https://www.contentful.com/developers/">Contentful</a> for my content. Contentful is a <a href="https://en.wikipedia.org/wiki/Headless_content_management_system">headless CMS</a> system, which means that the content is decoupled or separated from the front end. This makes it relatively easy if I later on wants to switch to another frontend or backend, or fetch content from the same source to another web page or maybe a mobile app. When using Gatsby, you can fetch content from virtually any source by making GraphQL queries in your code. There are a lot of ready-made plugins that make this very easy, whether you want to fetch data from markdown files, a headless CMS like Contentful or Sanity, or from an online shopping solution like Shopify. I used Gatsby\'s official Contentful plugin, <a href="https://www.gatsbyjs.com/plugins/gatsby-source-contentful/">gatsby-source-contentful</a>.</p>\n\n<p>When you have installed and configured the plugin, you can visit <code>localhost:8000/__graphiql</code> to create the GraphQL queries. In the left column of the GraphiQL interface you get a view of all available data (including content from Contentful). The middle column is for creating the queries - and the column on the right shows the result of a query after you press the Run button. GraphiQL makes it very easy and straightforward to test different queries and check that you get back the data you expect, before copying the query into your code.</p>\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s---Y1HqNVI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkhaul1ccar60tp1p96a.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s---Y1HqNVI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkhaul1ccar60tp1p96a.png" alt="Alt Text" loading="lazy"></a></p>\n<figcaption>GraphiQL is a user-friendly interface for creating GraphQL queries.</figcaption></figure>\n\n\n\n<p>But before I could see my data in GraphiQL, I had to set up everything in Contentful. I first had to define a Content model, which is a description of the different types of content - and what fields should be available for each content type. For example, I have a content type called <em>Blog Post</em>, which contains fields such as <em>Title</em>, <em>Summary</em>, <em>Top Image</em>, <em>Body Text</em> and <em>Author</em>. For each of the fields you must define the type of the content - such as text, numbers, boolean values, media (images, video, etc). You can also create references between different types of content, for example links between a blog post and one or more authors (where Author is a content type as well).</p>\n\n<p>I defined separate content types for front page text and pages (for example information pages and contact pages). In addition, I created a content type called Service menu, which is used to change a menu with information for the residents of the condominium - including links for downloading meeting minutes, a list of all the residents and other useful information. All content in the Service menu will require login. </p>\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--HrfLDHjF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/knlq8sumrkpwh8h6qfjh.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--HrfLDHjF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/knlq8sumrkpwh8h6qfjh.png" alt="Screenshot: editing the content model in Contentful" loading="lazy"></a></p>\n<figcaption>Contentful: Start by making a content model with all the different types of content you want. Then define which fields each content type should include.</figcaption></figure>\n\n\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--90mgzJ6e--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3w1ok8acxb7v6gmx5kjw.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--90mgzJ6e--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3w1ok8acxb7v6gmx5kjw.png" alt="Field definitions in Contentful." loading="lazy"></a></p>\n<figcaption>Field definitions in Contentful.</figcaption></figure>\n\n\n\n<h2>\n  <a name="generation-of-static-web-pages" href="#generation-of-static-web-pages">\n  </a>\n  Generation of static web pages\n</h2>\n\n<p>One of the things that makes websites created in Gatsby extremely fast is that Gatsby generates static web pages. This means that when you run <code>gatsby build</code>, Gatsby will retrieve content from Contentful (or other sources) and build every HTML page for you. Thus, 100/100 in Lighthouse should be within reach:</p>\n\n<figure><p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--AGCjmuFc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3m5qkx4azpmsplzmk8ch.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--AGCjmuFc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3m5qkx4azpmsplzmk8ch.png" alt="Screenshot: 100 of 100 in Lighthouse." loading="lazy"></a></p>\n<figcaption>100 of 100 in Lighthouse. You can do it!</figcaption></figure>\n\n\n\n<p>As I have mentioned, all components exported from the <code>/src/pages</code> folder will automatically be converted to static HTML pages. But to be able to programmatically create my own pages for each blog post and other content, I used one of Gatsby\'s built-in APIs, <a href="https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createPages">createPages</a>. To explain:</p>\n\n<p>When you build a Gatsby page, code in the <code>gatsby-node.js</code> file will run once before the page is built. The <code>createPages</code> (plural) API allows you to run a GraphQL query to retrieve content (such as blog posts) - in our case from Contentful. Then you can run a so-called <em>action</em> called <code>createPage</code> (singular) on each blog post. <code>createPage</code> receives as a parameter the React component you want to use as a page template, along with context data that the page template will receive as props. Context data in my case is the ID of the article in Contentful. Inside the page template you run a new GraphQL query where you only retrieve the blog post that has the correct ID, and then you retrieve everything you need to display the content - such as title, introduction, body text, images, etc. The page template is like any normal React component.</p>\n\n<p>My gatsby-node.js looks like this (abbreviated - there are also several GraphQL queries and actions to create other types of pages. See <a href="https://github.com/klekanger">my Github</a> for full source code):<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./gatsby-node.js</span>\n\n<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">`path`</span><span class="p">);</span>\n\n<span class="nx">exports</span><span class="p">.</span><span class="nx">createPages</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">graphql</span><span class="p">,</span> <span class="nx">actions</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">createPage</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actions</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="nx">blogPostTemplate</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`src/templates/blog-template.tsx`</span><span class="p">);</span>\n\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n  <span class="k">return</span> <span class="nx">graphql</span><span class="p">(</span><span class="s2">`\n    {\n      publicPosts: allContentfulBlogPost(\n        filter: { privatePost: { eq: false } }\n      ) {\n        nodes {\n          contentful_id\n          slug\n        }\n      }\n    }\n  `</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">)</span> <span class="p">{</span>\n      <span class="k">throw</span> <span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>\n    <span class="p">}</span>\n\n  <span class="kd">const</span> <span class="nx">blogNodes</span> <span class="o">=</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">publicPosts</span> <span class="o">||</span> <span class="p">{}).</span><span class="nx">nodes</span> <span class="o">||</span> <span class="p">[];</span>\n\n  <span class="c1">// Create public blog post pages.</span>\n  <span class="c1">// Skip private pages (in graphQl query)</span>\n  <span class="nx">blogNodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">node</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">contentful_id</span><span class="p">;</span>\n    <span class="kd">const</span> <span class="nx">slug</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">slug</span><span class="p">;</span>\n    <span class="nx">createPage</span><span class="p">({</span>\n      <span class="c1">// Path for this page — required</span>\n      <span class="na">path</span><span class="p">:</span> <span class="s2">`/blog/</span><span class="p">${</span><span class="nx">slug</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>\n      <span class="na">component</span><span class="p">:</span> <span class="nx">blogPostTemplate</span><span class="p">,</span>\n      <span class="na">context</span><span class="p">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">},</span>\n    <span class="p">});</span>\n  <span class="p">});</span>\n\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>In the file <code>blog-template.tsx</code> I fetch the blogposts one-by-one from Contentful using the GraphQL query below. Note the variable <code>$id</code> in the GraphQL query. This ID comes from the context parameter sent from <code>createPage</code> in <code>gatsby-node.js</code> and gives us the content for the correct blog post, and nothing morge.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./src/templates/blog-template.tsx</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`\n  query BlogPostQuery($id: String!) {\n    contentfulBlogPost(contentful_id: { eq: $id }) {\n      title\n      createdAt(formatString: "DD.MM.YYYY")\n      updatedAt(formatString: "DD.MM.YYYY")\n      author {\n        firstName\n        lastName\n      }\n      excerpt {\n        excerpt\n      }\n      bodyText {\n        raw\n        references {\n          ... on ContentfulAsset {\n            contentful_id\n            __typename\n            title\n            description\n            gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)\n          }\n        }\n      }\n\n      featuredImage {\n        gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)\n        file {\n          url\n        }\n        title\n        description\n      }\n    }\n  }\n`</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then I destructure the data I want from the query and use the data in the page template component:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./src/templates/blog-template.tsx</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="kd">const</span> <span class="p">{</span>\n    <span class="nx">title</span><span class="p">,</span>\n    <span class="nx">author</span><span class="p">,</span>\n    <span class="nx">createdAt</span><span class="p">,</span>\n    <span class="nx">updatedAt</span><span class="p">,</span>\n    <span class="nx">bodyText</span><span class="p">,</span>\n    <span class="nx">excerpt</span><span class="p">,</span>\n    <span class="nx">featuredImage</span><span class="p">,</span>\n  <span class="p">}</span> <span class="o">=</span> <span class="nx">contentfulBlogPost</span><span class="p">;</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="o">&lt;&gt;</span>\n      <span class="o">&lt;</span><span class="nx">SEO</span>\n        <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span>\n        <span class="nx">image</span><span class="o">=</span><span class="p">{</span><span class="nx">featuredImage</span><span class="p">?.</span><span class="nx">file</span><span class="p">?.</span><span class="nx">url</span> <span class="o">||</span> <span class="kc">null</span><span class="p">}</span>\n        <span class="nx">description</span><span class="o">=</span><span class="p">{</span><span class="nx">excerpt</span><span class="p">?.</span><span class="nx">excerpt</span> <span class="o">||</span> <span class="kc">null</span><span class="p">}</span>\n      <span class="sr">/</span><span class="err">&gt;\n</span>      <span class="o">&lt;</span><span class="nx">Article</span>\n        <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span>\n        <span class="nx">bodyText</span><span class="o">=</span><span class="p">{</span><span class="nx">bodyText</span><span class="p">}</span>\n        <span class="nx">createdAt</span><span class="o">=</span><span class="p">{</span><span class="nx">createdAt</span><span class="p">}</span>\n        <span class="nx">updatedAt</span><span class="o">=</span><span class="p">{</span><span class="nx">updatedAt</span><span class="p">}</span>\n        <span class="nx">mainImage</span><span class="o">=</span><span class="p">{</span><span class="nx">featuredImage</span><span class="p">}</span>\n        <span class="nx">author</span><span class="o">=</span><span class="p">{</span><span class="nx">author</span><span class="p">}</span>\n        <span class="nx">buttonLink</span><span class="o">=</span><span class="dl">\'</span><span class="s1">/blog</span><span class="dl">\'</span>\n      <span class="o">/&gt;</span>\n    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;\n</span>  <span class="p">);</span>\n<span class="p">}</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Since I often need to present content in article format, with a featured image, title, introduction, author, etc., I created an <code>&lt;Article&gt;</code> component for this, and pass data to it via props.</p>\n\n<p>One challenge I encountered was how to render content that was defined as Rich Text in Contentful. Content in Rich Text fields are based on blocks, and when you do a GraphQL query, you\'re getting back JSON containing nodes with all the content in. There are a lot of different ways to render this content, and Contentful has a little <a href="https://github.com/contentful/rich-text">more info here</a>. I used <code>import {renderRichText} from \'gatsby-source-contentful/rich-text\'</code> and then I could use <code>{renderRichText (bodyText, renderRichTextOptions)}</code> in my Article component to render the contents of bodyText. <code>renderRichTextOptions</code> is a component I import at the beginning of the <code>&lt;Article&gt;</code> component, and inside <code>renderRichTextOptions</code> I can then define how for example a <code>&lt;H1&gt;</code> title or image should be rendered (<code>&lt;Text&gt;</code> and <code>&lt;Heading&gt;</code> in the code below are Chakra UI components):<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="c1">// ./src/theme/renderTichTextOptions.js</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="kd">const</span> <span class="nx">renderRichTextOptions</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">renderMark</span><span class="p">:</span> <span class="p">{</span>\n    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">BOLD</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/strong&gt;</span><span class="err">,\n</span>    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">UNDERLINE</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">u</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/u&gt;</span><span class="err">,\n</span>    <span class="p">[</span><span class="nx">MARKS</span><span class="p">.</span><span class="nx">ITALIC</span><span class="p">]:</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/em&gt;</span><span class="err">,\n</span>  <span class="p">},</span>\n  <span class="na">renderNode</span><span class="p">:</span> <span class="p">{</span>\n    <span class="p">[</span><span class="nx">BLOCKS</span><span class="p">.</span><span class="nx">PARAGRAPH</span><span class="p">]:</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">children</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n      <span class="o">&lt;</span><span class="nx">Text</span>\n        <span class="nx">textAlign</span><span class="o">=</span><span class="dl">\'</span><span class="s1">left</span><span class="dl">\'</span>\n        <span class="nx">my</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span>\n        <span class="nx">fontSize</span><span class="o">=</span><span class="p">{{</span> <span class="na">base</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">sm</span><span class="dl">\'</span><span class="p">,</span> <span class="na">sm</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">md</span><span class="dl">\'</span><span class="p">,</span> <span class="na">md</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">lg</span><span class="dl">\'</span> <span class="p">}}</span>\n      <span class="o">&gt;</span>\n        <span class="p">{</span><span class="nx">children</span><span class="p">}</span>\n      <span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;\n</span>    <span class="p">),</span>\n    <span class="p">[</span><span class="nx">BLOCKS</span><span class="p">.</span><span class="nx">HEADING_1</span><span class="p">]:</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">children</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n      <span class="o">&lt;</span><span class="nx">Heading</span> <span class="k">as</span><span class="o">=</span><span class="dl">\'</span><span class="s1">h1</span><span class="dl">\'</span> <span class="nx">textAlign</span><span class="o">=</span><span class="dl">\'</span><span class="s1">left</span><span class="dl">\'</span> <span class="nx">size</span><span class="o">=</span><span class="dl">\'</span><span class="s1">4xl</span><span class="dl">\'</span><span class="o">&gt;</span>\n        <span class="p">{</span><span class="nx">children</span><span class="p">}</span>\n      <span class="o">&lt;</span><span class="sr">/Heading</span><span class="err">&gt;\n</span>    <span class="p">),</span>\n<span class="p">.</span>\n<span class="p">.</span>\n<span class="p">.</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>It\'s also possible to use another library, <a href="https://github.com/contentful/rich-text/tree/master/packages/rich-text-react-renderer">rich-text-react-renderer</a>, but the way I did it worked very well and gave me the flexibility I needed.</p>\n\n<h2>\n  <a name="styling" href="#styling">\n  </a>\n  Styling\n</h2>\n\n<p>Chakra UI have components for everything you need to create beautiful web pages, using components like <code>&lt;Badge&gt;</code>, <code>&lt;Alert&gt;</code>, <code>&lt;Text&gt;</code>, <code>&lt;Heading&gt;</code>, <code>&lt;Menu&gt;</code>, <code>&lt;Image&gt;</code>, and so on.</p>\n\n<p>As Chakra UI is a theme based component library, you dont\'t have to write a single line of CSS. Instead, you just <a href="https://chakra-ui.com/docs/theming/customize-theme">customize the standard theme</a> if you want a different look-and-feel. </p>\n\n<p>With Chakra UI you get <a href="https://chakra-ui.com/docs/features/responsive-styles">responsive design right out of the box</a>, with pre-defined breakpoints (which you can change if you want). You do not need to manually create media queries, but can do as I have done in the example below in your JSX code (<a href="https://chakra-ui.com/docs/typography/heading"></a> is a Chakra UI component intended for titles and renders by default an <code>&lt;H2&gt;</code>- tag, but in the example I have chosen to render it as <code>&lt;H1&gt;</code>):<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Heading</span>\n   <span class="k">as</span><span class="o">=</span><span class="dl">\'</span><span class="s1">h1</span><span class="dl">\'</span>\n   <span class="nx">fontSize</span><span class="o">=</span><span class="p">{[</span><span class="dl">\'</span><span class="s1">4xl</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">6xl</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">6xl</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">7xl</span><span class="dl">\'</span><span class="p">]}</span>\n   <span class="nx">textAlign</span><span class="o">=</span><span class="p">{[</span><span class="dl">\'</span><span class="s1">center</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">left</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">left</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">left</span><span class="dl">\'</span><span class="p">]}</span>\n   <span class="nx">pb</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span>\n<span class="o">&gt;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here we define font size and text alignment for four different screen sizes. That\'s actually all you need to do to get perfect responsive design with Chakra UI.</p>\n\n<p>Or you could do like this to use Chakra UI\'s CSS Grid component and define that you want 1 column on small and medium screen sizes, and 2 columns on larger screens:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="o">&lt;</span><span class="nx">Grid</span>\n    <span class="nx">templateColumns</span><span class="o">=</span><span class="p">{{</span>\n      <span class="na">sm</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">repeat(1, 1fr)</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="na">md</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">repeat(1, 1fr)</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="na">lg</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">repeat(2, 1fr)</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="na">xl</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">repeat(2, 1fr)</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="p">}}</span>\n    <span class="nx">pt</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>\n    <span class="nx">gap</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>\n    <span class="nx">mb</span><span class="o">=</span><span class="p">{</span><span class="mi">16</span><span class="p">}</span>\n    <span class="nx">mt</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span>\n    <span class="nx">maxWidth</span><span class="o">=</span><span class="dl">\'</span><span class="s1">95vw</span><span class="dl">\'</span>\n    <span class="nx">minHeight</span><span class="o">=</span><span class="dl">\'</span><span class="s1">45vh</span><span class="dl">\'</span>\n  <span class="o">&gt;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>With Chakra UI you also get a web site with excellent accessibility, without you needing to think about aria-tags or other things.</p>\n\n<p>Have a look at <a href="https://chakra-ui.com">https://chakra-ui.com</a> for more info and more examples. </p>\n\n<h2>\n  <a name="next-step-authentication-and-protected-routes" href="#next-step-authentication-and-protected-routes">\n  </a>\n  Next step: <a href="https://dev.to/klekanger/part-3-authentication-and-private-routes-in-gatsby-46jc">Authentication and protected routes</a>\n</h2>\n\n<p>Feel free to take a look at the finished website here: <a href="https://gartnerihagen-askim.no">https://gartnerihagen-askim.no</a></p>\n\n<p>The project is open source, you can find the source code <a href="https://github.com/klekanger/gartnerihagen">at my Github</a>.</p>\n\n<p><em>This is a translation, the original article in Norwegian is here: <a href="https://www.lekanger.no/project/del-2-slik-bygget-jeg-sameiets-nye-nettsider-grunnmuren-er-pa-plass">Del 2: Slik bygget jeg sameiets nye nettsider. Grunnmuren er på plass</a></em></p>\n\n',a.body_markdown="In part 1 of this mini-series I wrote about the technology choices I made when I started building new web pages for my local condominium. If you haven´t done it already, read about [why I chose React/Gatsby and Chakra UI on the frontend, Contentful as a headless CMS and Netlify for hosting everything](https://dev.to/klekanger/part-1-how-i-built-our-condos-s-new-web-pages-with-gatsby-and-chakra-ui-4jd5). I also needed an authentication solution for those parts of the web site that should only be accessible for logged in residents only.\n\n## Building the foundation\nStarting a Gatsby project is as simple as typing `npm init gatsby` on the command line and answering a few simple questions (or `gatsby new` if you have [Gatsby-CLI](https://www.gatsbyjs.com/docs/reference/gatsby-cli/) installed). Gatsby will then set up a starter project for you, which you can then modify.\n\nYou will be asked which CMS you want to use for storing the content, and can choose between Wordpress, Contentful, Sanity, DatoCMS, Shopify or Netlify CMS. You can use almost anything else with Gatsby as well - but Gatsby can set up a number of things for you automatically if you choose one of the predefined options. You will also be asked if you want to have a specific styling system pre-installed, such as Sass, Styled components, Emiton, PostCSS or Theme UI.\n\n![Command line screenshot, setting up Gatsby](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/werqlkugjmzm57lltvtm.png)\n<figcaption>Gatsby can prepare a number of things for you in advance.</figcaption>\n\n\nHowever, I chose to start from scratch, and installed the various dependencies I needed as I went along with the project. I needed [gatsby-source-contentful](https://www.gatsbyjs.com/plugins/gatsby-source-contentful) to get content from my Contentful headless CMS. And I wanted to make life a little easier for myself by creating the user interface with [Chakra UI](https://chakra-ui.com/). I also needed some other packages, like [dotenv](https://github.com/motdotla/dotenv#readme) to handle environmental variables (such as access tokens for Contentful, and other things I didn't want to include in the source code on Github).\n\nWhen everything is set up, you will get a page that looks something like this when entering `gatsby develop` on the command line and visiting `http://localhost:8000`:\n\n![Screenshot of a new Gatsby site](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gshzjq3rxcweb5pobn3e.png)\n<figcaption>The Gatsby documentation is awesome, and the start page created by the gatsby new command links to a lot of useful information.</figcaption>\n\nThe first thing you should do, is of course to remove this dummy page.\n\nIn Gatsby, routing is as simple as creating a React component in the `/src/pages` folder and exporting it. For example, if you export a component from the `/src/pages/test.js` file, you will have a route on `/test` (ie you can type `localhost:8000/test` in the browser to reach it). The main page - ie the front page of the website - is `/src/pages/index.js`. This is how my index.js file looks like on my finished website:\n```TypeScript\n// ./src/pages/index.js\n\nimport * as React from 'react';\nimport SEO from '../components/seo';\nimport CookieConsent from '../components/cookieConsent';\nimport HeroWide from '../components/sections/hero-wide';\nimport ArticleGrid from '../components/sections/articleGrid';\n\nconst IndexPage = () => {\n  return (\n    <>\n      <SEO />\n      <CookieConsent />\n      <HeroWide />\n      <ArticleGrid />\n    </>\n  );\n};\n\nexport default IndexPage;\n```\n\nNormally I would include a Layout component here, for consistent layout with header, footer, etc. across all pages. But since I use Chakra UI, I have put the Layout component elsewhere where the Layout component is wrapped by `<ChakraProvider>` which is necessary for it all to work. This also enables theme based styling using Chakra UI. I created the file `./src/chakra-wrapper.js`:\n\n```TypeScript\n// ./src/chakra-wrapper.js\n\nimport * as React from 'react';\nimport { ChakraProvider } from '@chakra-ui/react';\nimport Layout from './components/layouts/layout';\nimport theme from './theme/';\n\nexport const wrapPageElement = ({ element }) => {\n  return (\n    <ChakraProvider resetCSS theme={theme}>\n      <Layout>{element}</Layout>\n    </ChakraProvider>\n  );\n};\n```\n\nAnd then, in `./gatsby-browser.js` and `./gatsby-ssr.js`:\n\n```TypeScript\nimport * as React from 'react';\nimport { wrapPageElement as wrap } from './src/chakra-wrapper';\n.\n.\n.\nexport const wrapPageElement = wrap;\n```\n\nThis means that the entire page is wrapped in ChakraProvider, and then the Layout component which wraps everything else and includes a header and a footer. In the `<ChakraProvider>` component in the top code snippet, I also pass in the theme I have defined for the page as a prop.\n\nI ended up with the folder structure below, where I have put all reusable React components in `/src/components`, pages under `/src/pages`, page templates under `/src/templates` and Chakra UI themes under `/src/theme`:\n\n```\nsrc\n├── components\n│   ├── article.tsx\n│   ├── layouts\n│   │   └── layout.tsx\n│   ├── private-components\n│   └── sections\n│       ├── articleGrid.tsx\n│       ├── footer.tsx\n│       ├── header.tsx\n│       └── hero-wide.tsx\n├── pages\n│   ├── 404.tsx\n│   ├── index.tsx\n│   ├── informasjon.tsx\n│   └── min-side.tsx\n├── templates\n│   ├── blog-archive-template.tsx\n│   ├── blog-template.tsx\n│   └── page-template.tsx\n├── theme\n│   ├── colors.js\n│   ├── components\n│   │   ├── button.js\n│   │   ├── heading.js\n│   │   └── text.js\n│   ├── index.js\n│   ├── renderRichTextOptions.js\n│   ├── styles.js\n│   └── textStyles.js\n└── utils\n    └── privateRoute.tsx\n```\n\nAs you can see, I chose to rename the .js files for the React components to .tsx, in order to use TypeScript in my components - and to reduce the risk of bugs when I pass data as props between components.\n\n## Fetch content from Contentful\nAs mentioned, I wanted to use [Contentful](https://www.contentful.com/developers/) for my content. Contentful is a [headless CMS](https://en.wikipedia.org/wiki/Headless_content_management_system) system, which means that the content is decoupled or separated from the front end. This makes it relatively easy if I later on wants to switch to another frontend or backend, or fetch content from the same source to another web page or maybe a mobile app. When using Gatsby, you can fetch content from virtually any source by making GraphQL queries in your code. There are a lot of ready-made plugins that make this very easy, whether you want to fetch data from markdown files, a headless CMS like Contentful or Sanity, or from an online shopping solution like Shopify. I used Gatsby's official Contentful plugin, [gatsby-source-contentful](https://www.gatsbyjs.com/plugins/gatsby-source-contentful/).\n\nWhen you have installed and configured the plugin, you can visit `localhost:8000/__graphiql` to create the GraphQL queries. In the left column of the GraphiQL interface you get a view of all available data (including content from Contentful). The middle column is for creating the queries - and the column on the right shows the result of a query after you press the Run button. GraphiQL makes it very easy and straightforward to test different queries and check that you get back the data you expect, before copying the query into your code.\n\n![Alt Text](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkhaul1ccar60tp1p96a.png)\n<figcaption>GraphiQL is a user-friendly interface for creating GraphQL queries.</figcaption>\n\nBut before I could see my data in GraphiQL, I had to set up everything in Contentful. I first had to define a Content model, which is a description of the different types of content - and what fields should be available for each content type. For example, I have a content type called *Blog Post*, which contains fields such as *Title*, *Summary*, *Top Image*, *Body Text* and *Author*. For each of the fields you must define the type of the content - such as text, numbers, boolean values, media (images, video, etc). You can also create references between different types of content, for example links between a blog post and one or more authors (where Author is a content type as well).\n\nI defined separate content types for front page text and pages (for example information pages and contact pages). In addition, I created a content type called Service menu, which is used to change a menu with information for the residents of the condominium - including links for downloading meeting minutes, a list of all the residents and other useful information. All content in the Service menu will require login. \n\n![Screenshot: editing the content model in Contentful](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/knlq8sumrkpwh8h6qfjh.png)\n<figcaption>Contentful: Start by making a content model with all the different types of content you want. Then define which fields each content type should include.</figcaption>\n\n![Field definitions in Contentful.](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3w1ok8acxb7v6gmx5kjw.png)\n<figcaption>Field definitions in Contentful.</figcaption>\n\n## Generation of static web pages\nOne of the things that makes websites created in Gatsby extremely fast is that Gatsby generates static web pages. This means that when you run `gatsby build`, Gatsby will retrieve content from Contentful (or other sources) and build every HTML page for you. Thus, 100/100 in Lighthouse should be within reach:\n\n![Screenshot: 100 of 100 in Lighthouse.](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3m5qkx4azpmsplzmk8ch.png)\n<figcaption>100 of 100 in Lighthouse. You can do it!</figcaption>\n\nAs I have mentioned, all components exported from the `/src/pages` folder will automatically be converted to static HTML pages. But to be able to programmatically create my own pages for each blog post and other content, I used one of Gatsby's built-in APIs, [createPages](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createPages). To explain:\n\nWhen you build a Gatsby page, code in the `gatsby-node.js` file will run once before the page is built. The `createPages` (plural) API allows you to run a GraphQL query to retrieve content (such as blog posts) - in our case from Contentful. Then you can run a so-called *action* called `createPage` (singular) on each blog post. `createPage` receives as a parameter the React component you want to use as a page template, along with context data that the page template will receive as props. Context data in my case is the ID of the article in Contentful. Inside the page template you run a new GraphQL query where you only retrieve the blog post that has the correct ID, and then you retrieve everything you need to display the content - such as title, introduction, body text, images, etc. The page template is like any normal React component.\n\nMy gatsby-node.js looks like this (abbreviated - there are also several GraphQL queries and actions to create other types of pages. See [my Github](https://github.com/klekanger) for full source code):\n\n```TypeScript\n// ./gatsby-node.js\n\nconst path = require(`path`);\n\nexports.createPages = ({ graphql, actions }) => {\n  const { createPage } = actions;\n  const blogPostTemplate = path.resolve(`src/templates/blog-template.tsx`);\n\n.\n.\n.\n  return graphql(`\n    {\n      publicPosts: allContentfulBlogPost(\n        filter: { privatePost: { eq: false } }\n      ) {\n        nodes {\n          contentful_id\n          slug\n        }\n      }\n    }\n  `).then((result) => {\n    if (result.errors) {\n      throw result.errors;\n    }\n\n  const blogNodes = (result.data.publicPosts || {}).nodes || [];\n  \n  // Create public blog post pages.\n  // Skip private pages (in graphQl query)\n  blogNodes.forEach((node) => {\n    const id = node.contentful_id;\n    const slug = node.slug;\n    createPage({\n      // Path for this page — required\n      path: `/blog/${slug}`,\n      component: blogPostTemplate,\n      context: { id },\n    });\n  });\n\n.\n.\n.\n}\n```\n\nIn the file `blog-template.tsx` I fetch the blogposts one-by-one from Contentful using the GraphQL query below. Note the variable `$id` in the GraphQL query. This ID comes from the context parameter sent from `createPage` in `gatsby-node.js` and gives us the content for the correct blog post, and nothing morge. \n\n```TypeScript\n// ./src/templates/blog-template.tsx\n\nexport const query = graphql`\n  query BlogPostQuery($id: String!) {\n    contentfulBlogPost(contentful_id: { eq: $id }) {\n      title\n      createdAt(formatString: \"DD.MM.YYYY\")\n      updatedAt(formatString: \"DD.MM.YYYY\")\n      author {\n        firstName\n        lastName\n      }\n      excerpt {\n        excerpt\n      }\n      bodyText {\n        raw\n        references {\n          ... on ContentfulAsset {\n            contentful_id\n            __typename\n            title\n            description\n            gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)\n          }\n        }\n      }\n\n      featuredImage {\n        gatsbyImageData(layout: CONSTRAINED, aspectRatio: 1.6)\n        file {\n          url\n        }\n        title\n        description\n      }\n    }\n  }\n`;\n```\n\nThen I destructure the data I want from the query and use the data in the page template component:\n\n```TypeScript\n// ./src/templates/blog-template.tsx\n.\n.\n.\nconst {\n    title,\n    author,\n    createdAt,\n    updatedAt,\n    bodyText,\n    excerpt,\n    featuredImage,\n  } = contentfulBlogPost;\n\n  return (\n    <>\n      <SEO\n        title={title}\n        image={featuredImage?.file?.url || null}\n        description={excerpt?.excerpt || null}\n      />\n      <Article\n        title={title}\n        bodyText={bodyText}\n        createdAt={createdAt}\n        updatedAt={updatedAt}\n        mainImage={featuredImage}\n        author={author}\n        buttonLink='/blog'\n      />\n    </>\n  );\n}\n.\n.\n.\n```\n\nSince I often need to present content in article format, with a featured image, title, introduction, author, etc., I created an `<Article>` component for this, and pass data to it via props.\n\nOne challenge I encountered was how to render content that was defined as Rich Text in Contentful. Content in Rich Text fields are based on blocks, and when you do a GraphQL query, you're getting back JSON containing nodes with all the content in. There are a lot of different ways to render this content, and Contentful has a little [more info here](https://github.com/contentful/rich-text). I used `import {renderRichText} from 'gatsby-source-contentful/rich-text'` and then I could use `{renderRichText (bodyText, renderRichTextOptions)}` in my Article component to render the contents of bodyText. `renderRichTextOptions` is a component I import at the beginning of the `<Article>` component, and inside `renderRichTextOptions` I can then define how for example a `<H1>` title or image should be rendered (`<Text>` and `<Heading>` in the code below are Chakra UI components):\n\n```TypeScript\n// ./src/theme/renderTichTextOptions.js\n.\n.\n.\nconst renderRichTextOptions = {\n  renderMark: {\n    [MARKS.BOLD]: (text) => <strong>{text}</strong>,\n    [MARKS.UNDERLINE]: (text) => <u>{text}</u>,\n    [MARKS.ITALIC]: (text) => <em>{text}</em>,\n  },\n  renderNode: {\n    [BLOCKS.PARAGRAPH]: (node, children) => (\n      <Text\n        textAlign='left'\n        my={4}\n        fontSize={{ base: 'sm', sm: 'md', md: 'lg' }}\n      >\n        {children}\n      </Text>\n    ),\n    [BLOCKS.HEADING_1]: (node, children) => (\n      <Heading as='h1' textAlign='left' size='4xl'>\n        {children}\n      </Heading>\n    ),\n.\n.\n.\n```\n\nIt's also possible to use another library, [rich-text-react-renderer](https://github.com/contentful/rich-text/tree/master/packages/rich-text-react-renderer), but the way I did it worked very well and gave me the flexibility I needed.\n\n## Styling\nChakra UI have components for everything you need to create beautiful web pages, using components like `<Badge>`, `<Alert>`, `<Text>`, `<Heading>`, `<Menu>`, `<Image>`, and so on.\n\nAs Chakra UI is a theme based component library, you dont't have to write a single line of CSS. Instead, you just [customize the standard theme](https://chakra-ui.com/docs/theming/customize-theme) if you want a different look-and-feel. \n\nWith Chakra UI you get [responsive design right out of the box](https://chakra-ui.com/docs/features/responsive-styles), with pre-defined breakpoints (which you can change if you want). You do not need to manually create media queries, but can do as I have done in the example below in your JSX code ([<Heading>](https://chakra-ui.com/docs/typography/heading) is a Chakra UI component intended for titles and renders by default an `<H2>`- tag, but in the example I have chosen to render it as `<H1>`):\n\n```TypeScript\n<Heading\n   as='h1'\n   fontSize={['4xl', '6xl', '6xl', '7xl']}\n   textAlign={['center', 'left', 'left', 'left']}\n   pb={4}\n>\n```\n\nHere we define font size and text alignment for four different screen sizes. That's actually all you need to do to get perfect responsive design with Chakra UI.\n\nOr you could do like this to use Chakra UI's CSS Grid component and define that you want 1 column on small and medium screen sizes, and 2 columns on larger screens:\n\n```TypeScript\n<Grid\n    templateColumns={{\n      sm: 'repeat(1, 1fr)',\n      md: 'repeat(1, 1fr)',\n      lg: 'repeat(2, 1fr)',\n      xl: 'repeat(2, 1fr)',\n    }}\n    pt={16}\n    gap={16}\n    mb={16}\n    mt={0}\n    maxWidth='95vw'\n    minHeight='45vh'\n  >\n```\n\nWith Chakra UI you also get a web site with excellent accessibility, without you needing to think about aria-tags or other things.\n\nHave a look at [https://chakra-ui.com](https://chakra-ui.com) for more info and more examples. \n\n## Next step: [Authentication and protected routes](https://dev.to/klekanger/part-3-authentication-and-private-routes-in-gatsby-46jc)\n\nFeel free to take a look at the finished website here: [https://gartnerihagen-askim.no](https://gartnerihagen-askim.no)\n\nThe project is open source, you can find the source code [at my Github](https://github.com/klekanger/gartnerihagen).\n\n*This is a translation, the original article in Norwegian is here: [Del 2: Slik bygget jeg sameiets nye nettsider. Grunnmuren er på plass](https://www.lekanger.no/project/del-2-slik-bygget-jeg-sameiets-nye-nettsider-grunnmuren-er-pa-plass)*",a.user={name:"Kurt Lekanger",username:t,twitter_username:"lekanger",github_username:t,website_url:"https://www.lekanger.no/",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--xHuw8nfr--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/328029/98d735a6-e6d3-4787-bcfb-686eecc28fb0.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--2s9f366o--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/328029/98d735a6-e6d3-4787-bcfb-686eecc28fb0.jpeg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:a}},error:n,state:{currentArticle:a},serverRendered:!0,routePath:"/klekanger/817670",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:n}}}}("2021-09-12T13:34:54Z",null,{},"https://dev.to/klekanger/part-2-a-new-web-page-for-our-condo-setting-up-gatsby-and-contentful-2k0j","klekanger")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
