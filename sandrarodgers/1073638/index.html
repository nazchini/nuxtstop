<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Project Upgrade: Voice Controlled To-Do List App with Deepgram and Vue 3</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>Project Upgrade: Voice Controlled To-Do List App with Deepgram and Vue 3</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/vue" class="tag" data-v-70afb46a>
          #vue
        </a><a href="/nuxtstop/t/tutorial" class="tag" data-v-70afb46a>
          #tutorial
        </a><a href="/nuxtstop/t/regex" class="tag" data-v-70afb46a>
          #regex
        </a><a href="/nuxtstop/t/deeplearning" class="tag" data-v-70afb46a>
          #deeplearning
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--HV3yLjmE--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/x04hct3152t0cpxpzo67.jpg" alt="Project Upgrade: Voice Controlled To-Do List App with Deepgram and Vue 3" data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            20
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>May 2</time></div></header> <div class="content" data-v-70afb46a><p>Recently I wrote about a project I did to help me learn Pinia, Vue 3's new official state management system. I built a basic to-do list app:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Byx6P3uA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2urt6znxf9vkvq9qrf5g.jpg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Byx6P3uA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2urt6znxf9vkvq9qrf5g.jpg" alt="Example to-do list app" loading="lazy" width="880" height="462"></a></p>

<p>It dawned on me that a fun way to jazz up this project would be to use Deepgram to make the app <strong>voice-powered</strong> so that a user can <strong>speak</strong> commands to add, delete, or check-off items on the list.</p>

<p>I'm inspired by my colleague Bekah's series about <a href="https://developers.deepgram.com/blog/2022/03/freecodecamp-quote-generator-upgrade/">updating portfolio projects</a>. A voice-based to-do list app would be a lot more interesting than a regular to-do list app!</p>

<h2>
  <a name="project-overview" href="#project-overview">
  </a>
  Project Overview
</h2>

<p>The project I originally did can be found in this <a href="https://github.com/deepgram-devs/todo-pinia">repo</a>, and the accompanying blog post is <a href="https://developers.deepgram.com/blog/2022/04/build-a-todo-list-with-pinia-and-vue-3/">here</a>. Check it out to build the standard to-do list project with Vue 3 and Pinia.</p>

<p>In this iteration of the project, I'll continue to use <a href="https://pinia.vuejs.org/">Pinia</a> to manage global state, but I'll add Deepgram so I can use Deepgram's speech-to-text API to help me power the voice-control feature. If you want to build this voice-control feature along with me, I've created a starting branch <a href="https://github.com/deepgram-devs/todo-pinia-deepgram/tree/starter-branch">here</a>.</p>

<h3>
  <a name="deepgram-live-streaming-logic" href="#deepgram-live-streaming-logic">
  </a>
  Deepgram Live Streaming Logic
</h3>

<p>There are several articles on Deepgram Docs about how to use Deepgram in Javascript to convert an audio stream of speech into text, including one I wrote about how to use it with Vue 3. I won't go over in detail here how I built Vue composables to integrate Deepgram's speech-to-text API. Use these resources or take a look at my repo (in the <a href="https://github.com/deepgram-devs/todo-pinia-deepgram/tree/main/src/composables">composables folder</a>) to learn how I did this using Vue 3 and the Deepgram Node SDK:</p>

<h3>
  <a name="additional-resources" href="#additional-resources">
  </a>
  Additional Resources
</h3>

<ul>
<li>
<a href="https://developers.deepgram.com/blog/2022/03/asynchronous-logic-to-write-a-vue-3-and-deepgram-captions-component/">Asynchronous Logic to Write a Vue 3 and Deepgram Captions Component</a> by <a href="https://developers.deepgram.com/blog/authors/sandrarodgers/">Sandra Rodgers</a>
</li>
<li>
<a href="https://developers.deepgram.com/blog/2021/11/live-transcription-mic-browser/">Get Live Speech Transcriptions In Your Browser</a> by <a href="https://developers.deepgram.com/blog/authors/kevinlewis/">Kevin Lewis</a>
</li>
<li>
<a href="https://developers.deepgram.com/blog/2022/01/protecting-api-key/">Browser Live Transcription - Protecting Your API Key</a> by <a href="https://developers.deepgram.com/blog/authors/kevinlewis/">Kevin Lewis</a>
</li>
</ul>

<h3>
  <a name="focus-voicecontrol-feature" href="#focus-voicecontrol-feature">
  </a>
  Focus: Voice-Control Feature
</h3>

<p>For today's project, I will focus on dealing with the transcript of text that I get back from Deepgram, analyzing it for speech commands to add, delete, and check off items in the to-do list. This logic will all be part of a voice-control feature.</p>

<h2>
  <a name="create-the-component-and-connect-deepgram" href="#create-the-component-and-connect-deepgram">
  </a>
  Create the Component and Connect Deepgram
</h2>

<p>The voice-control feature that I build today will be one component with two main elements:</p>

<ol>
<li>a <code>button</code> that, when clicked, <strong>turns on or off voice-control mode</strong> (i.e., toggles the connection to Deepgram)</li>
<li>a <code>div</code> that contains text which identifies the status of whether Deepgram is <strong>connected and listening</strong>, if it <strong>misheard what was said</strong>, or if it is <strong>not connected</strong>.</li>
</ol>

<p>Here's a minimally styled version of this project that highlights the component I'll be building today:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8FG3tdCC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/v2cntq4anyyakx0x3zg5.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8FG3tdCC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/v2cntq4anyyakx0x3zg5.png" alt="To-do list app highlighting component" loading="lazy" width="880" height="598"></a></p>

<p>In the components folder with the other Todo components, I'll create a component called <code>TodoSpeech.vue</code>. It will be a child component of <code>TodoApp.vue</code>.</p>

<p>In <code>TodoSpeech.vue</code>, I'll start by adding the button element and status div to the template. I'll use a speech bubble emoji on the button, and I'll create an event listener that I plan to program to toggle the Deepgram connection when the button is clicked.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight html"><code><span class="c">&lt;!-- in template: --></span>
<span class="nt">&lt;button</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleListen()"</span><span class="nt">></span>ðŸ’¬<span class="nt">&lt;/button></span>
<span class="nt">&lt;div></span>{{ deepgramStatus }}<span class="nt">&lt;/div></span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I'll also create a <code>deepgramStatus</code> ref, which I'll program to update when Deepgram is connected and ready to receive audio data. The initial value will report that Deepgram is not connected:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// in script:</span>
<span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">'</span><span class="s1">Deepgram Not Connected</span><span class="dl">'</span><span class="p">)</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I'll connect to Deepgram using the composable <code>useDeepgramSocket</code> (already built in a previous post), which I import in the script. I also run the composable in the setup function so that it runs at the beginning of the component lifecycle. I destructure four properties off of the composable: <code>DG_socket</code>, <code>DG_transcript</code>, <code>openStream</code>, <code>closeStream</code>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">></span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useDeepgramSocket</span><span class="p">();</span>
    <span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">Deepgram Not Connected</span><span class="dl">"</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">deepgramStatus</span> <span class="p">};</span>
  <span class="p">},</span>
<span class="p">};</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">>
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The <code>openStream</code> and <code>closeStream</code> methods that I destructured off of the <code>useDeepgramSocket</code> composable will toggle on and off when the button is clicked and <code>toggleListen</code> runs. Notice that I created the <code>isListening</code> ref to update the toggle status:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">isListening</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">toggleListen</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">openStream</span><span class="p">()</span>
    <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">closeStream</span><span class="p">()</span>
    <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I'll use a watcher to watch the Deepgram socket's status in the composable. That way, the <code>div</code> in the template will update when I click the button and Deepgram is connecting, connected, or not connected:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">DG_socket</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">Connecting</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Connecting</span><span class="dl">'</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">Not Connected</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Voice Controls Off</span><span class="dl">'</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">Closing connection...</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Closing connection...</span><span class="dl">'</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Listening</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here is the entire component now. I should be able to click the button and see the status change to show the status of the Deepgram connection:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">></span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">></span>
    <span class="o">&lt;</span><span class="nx">button</span> <span class="p">@</span><span class="nd">click</span><span class="o">=</span><span class="dl">"</span><span class="s2">toggleListen()</span><span class="dl">"</span><span class="o">></span><span class="err">ðŸ’¬</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">>
</span>    <span class="o">&lt;</span><span class="nx">div</span><span class="o">></span><span class="p">{{</span> <span class="nx">deepgramStatus</span> <span class="p">}}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">>
</span>  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">>
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">>
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">></span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">watch</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>
      <span class="nx">useDeepgramSocket</span><span class="p">();</span>

    <span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">Deepgram Not Connected</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">isListening</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">toggleListen</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">openStream</span><span class="p">();</span>
        <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">closeStream</span><span class="p">();</span>
        <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">watch</span><span class="p">(</span><span class="nx">DG_socket</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Connecting</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Connecting</span><span class="dl">"</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Not Connected</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Voice Controls Off</span><span class="dl">"</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Closing connection...</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Closing connection...</span><span class="dl">"</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Listening</span><span class="dl">"</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">deepgramStatus</span><span class="p">,</span> <span class="nx">toggleListen</span> <span class="p">};</span>
  <span class="p">},</span>
<span class="p">};</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">>
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="analyze-deepgram-response-for-voice-commands" href="#analyze-deepgram-response-for-voice-commands">
  </a>
  Analyze Deepgram Response for Voice Commands
</h2>

<p>The logic to add, delete, or check-off an item from the list will be based on what the speaker says. I need to program this application to listen for commands such as "add!" or "delete!".</p>

<p>To do that, I will need to understand the form of the text transcript I'll be getting back from Deepgram.</p>

<h3>
  <a name="deepgram-audio-stream-to-text" href="#deepgram-audio-stream-to-text">
  </a>
  Deepgram Audio Stream to Text
</h3>

<p>When I started using Deepgram to transcribe audio streams, I was surprised that Deepgram was able to send back the text almost immediately, after each phrase or sentence rather than waiting until the socket closes and sending back the entire transcription.</p>

<p>How is it able to send a response back continuously, as the audio is streaming, and how is it able to send meaningful chunks, such as at the end of a sentence or a pause in speech? This is thanks to two of its features: <strong>Endpointing</strong> and <strong>Interim Results</strong>.</p>

<p>To put it very simply, <strong>Endpointing</strong> is how Deepgram uses pauses in speech to process that speech into meaningful text chunks. It can hear longer silences in speech and use them to identify finished thoughts, i.e., phrases or sentences.</p>

<p><strong>Interim results</strong> is Deepgram analyzing speech as accurately and as quickly as possible with the little bits of info it gets on the fly; then, after it gets more data to work with, it corrects the transcription. That is why as one or two words come back, one might be wrong, but then when the sentence comes back, the whole thing is more accurate.</p>

<p>In my case, I'm using the <strong>Interim Results</strong> property <code>is_final</code> to identify a complete voice command. When <code>is_final</code> is <code>true</code>, it means I'm dealing with a full statement or a complete command such as "Add walk the dog to the list!" The <code>is_final</code> property breaks the transcript up at the end of a fully-processed statement:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// in useDeepgramSocket.js:</span>
<span class="kd">const</span> <span class="nx">transcript</span> <span class="o">=</span> <span class="nx">received</span><span class="p">.</span><span class="nx">channel</span><span class="p">.</span><span class="nx">alternatives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">transcript</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">transcript</span> <span class="o">&&</span> <span class="nx">received</span><span class="p">.</span><span class="nx">is_final</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">DG_transcript</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">transcript</span> <span class="o">+</span> <span class="dl">''</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>This is a pretty cool feature because it means that a user can speak a command, such as "Add walk the dog to the list", and Deepgram can identify that it is the end of the command based on the flow of the speech. It will send me that sentence back to deal with in text form, and then I can use logic to dig in and find the specific command word, such as <em>add</em> or <em>delete</em>. Nice!</p>



<ul>
<li><a href="https://developers.deepgram.com/documentation/guides/understand-endpointing-interim-results/">Understanding Endpointing and Interim Results When Transcribing Live Streaming Audio</a></li>
<li><a href="https://developers.deepgram.com/documentation/features/interim-results/">Interim Results</a></li>
<li><a href="https://developers.deepgram.com/documentation/features/endpointing/">Endpointing</a></li>
</ul>



<h2>
  <a name="add-todo-item-with-voicecontrol" href="#add-todo-item-with-voicecontrol">
  </a>
  Add To-Do Item With Voice-Control
</h2>

<p>Now I'll write logic to analyze a voice command for the words "add to do", and if the command has those words (such as in the command "ADD TO DO walk the dog!"), the item will be added to the <code>todoList</code> array in the Pinia store.</p>

<p>I also want to keep track of the number of commands given, so if Deepgram doesn't transcribe the command correctly due to problems interpreting the speech, I can check that count value against the number of items in the store <code>todoList</code> array, and report back to the user that the command was misunderstood and didn't make it in.</p>

<p>Here is pseudo-code for what I need to write:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Create array of Regular Expression words to identify in the text string, such as [/^add to do/, /^ad to do/]</span>
  <span class="c1">// Loop through regex values using .find()</span>
  <span class="c1">// Turn the command into a standardized string - lower case, no final punctuation, trim whitespace</span>
  <span class="c1">// Check if the command string contains the regex value using .test</span>
  <span class="c1">// If so, remove the command phrase ADD TO DO to create new string that is just the todo item</span>
  <span class="c1">// add todo to the Pinia store todo-list</span>
  <span class="c1">// reset the count of uttered commands to match the length of the todo list array in the store</span>
<span class="p">}</span>
<span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="c1">// watch for a command and if there is one, add it to the list</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>PHEW! That is a lot of logic to get through. Best to take it one step at a time.</p>

<h3>
  <a name="create-a-set-of-regular-expressions" href="#create-a-set-of-regular-expressions">
  </a>
  Create a Set of Regular Expressions
</h3>

<p>I want to analyze the command string such as "Add to do walk the dog" for the three words "add to do". I will:</p>

<ul>
<li>Create a regular expression by enclosing it within slashes <code>/-/</code>
</li>
<li>Use the character <code>^</code> before the command phrase to identify that the phrase should be at the beginning of the string</li>
</ul>

<p>So the regular expression for "add to do" that I will use is <code>/^add to do/</code>.</p>

<p>However, since there is the possibility that Deepgram could transcribe this with 'ad' instead of 'add' (seems unlikely, but I want to be prepared), I'll also use <code>/^ad to do/</code>. In fact, I'll match to anything that could be a homophone.</p>

<p>I need an array to create a set of all the options. (The reason I don't include something like <code>/^add two do/</code> is because it's not grammatically correct, and Deepgram is smart enough to know not to transcribe things as ungrammatical.)<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h3>
  <a name="use-the-array-method-find" href="#use-the-array-method-find">
  </a>
  Use the Array Method .find()
</h3>

<p>I'll use the array method <code>.find</code> to loop through the array of regular expressions. It will search for the first item in the array that matches. If it finds one, there's no need to continue looping through since all we need is one match:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>
  <span class="c1">// loop through array to find first match:</span>
  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{})</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h3>
  <a name="write-a-method-to-standardize-the-command-string" href="#write-a-method-to-standardize-the-command-string">
  </a>
  Write a Method to Standardize the Command String
</h3>

<p>I want the command to be lowercase, to not include periods, commas, question marks, or quotation marks, and to not have extra whitespace at the end. (I could entirely turn off punctuation in Deepgram, but I like the transcript to include apostrophes in words such as "she's.")</p>

<p>I'll create a function to take the command string and standardize it:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">punctuation</span> <span class="o">=</span> <span class="sr">/</span><span class="se">[</span><span class="sr">.,?"</span><span class="se">]</span><span class="sr">+/g</span>
  <span class="kd">const</span> <span class="nx">change</span> <span class="o">=</span> <span class="nx">command</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="nx">punctuation</span><span class="p">,</span> <span class="dl">''</span><span class="p">).</span><span class="nx">trim</span><span class="p">()</span>
  <span class="k">return</span> <span class="nx">change</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Notice that I used another regular expression, <code>/[.,?"]+/g</code>. This paired with the <code>replace</code> method will search for any of those punctuation marks throughout the entire string and replace them with<code>""</code> (which is nothing).</p>

<p>Then I use this <code>standardizeUtterance</code> function inside the <code>addTodo</code> function. I'll add it before the loop so that it doesn't run for every loop:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>
  <span class="c1">// clean up utterance</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>
  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="c1">// use item for more logic</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h3>
  <a name="test-that-the-item-matches-the-regular-expression" href="#test-that-the-item-matches-the-regular-expression">
  </a>
  Test that the Item Matches the Regular Expression
</h3>

<p>I'll write an <code>if</code> statement to say that if the string starts with the regular expression command such as <code>/^add to do/</code>, then do something else (the something else will involve adding it to the to-do list).</p>

<p>I use the method <code>.test</code>, which is a javascript method used to match a regular expression with a string, returning <code>true</code> or <code>false</code> depending on if there is a match or not.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>
<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h3>
  <a name="remove-the-command-phrase-from-the-string" href="#remove-the-command-phrase-from-the-string">
  </a>
  Remove the Command Phrase from the String
</h3>

<p>If there is a match, I will want to add the string to the to-do list. But right now the whole string also contains the command phrase "add to do" as in the sentence "Add to do walk the dog." I do not want "add to do" to be part of the string that goes into the to-do list array in the store.</p>

<p>I'll write a function that takes the string and removes the phrase. I'll need to give it both the full command, and the regular expression (which is the command phrase). The method <code>replace</code> will search for the phrase and replace it with <code>""</code>, i.e., nothing.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">change</span> <span class="o">=</span> <span class="nx">command</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">reg</span><span class="p">,</span> <span class="dl">''</span><span class="p">).</span><span class="nx">trim</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">change</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then I add it to <code>addTodo</code>:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>

<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// remove command phrase ADD TO DO</span>
    <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h3>
  <a name="add-the-todo-item-to-the-todo-list-array" href="#add-the-todo-item-to-the-todo-list-array">
  </a>
  Add the To-Do Item to the To-Do List Array
</h3>

<p>I'm almost done! This is the most important step. I can add the to-do item to the list in the store.</p>

<p>I have to go back up to the start of the <code>script</code> and import the store. I also need to run the store function and set it to a variable that I can use (I'll set it to <code>store</code>)<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">></span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">watch</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>
<span class="c1">// import store:</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useTodoListStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/useTodoListStore</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>
      <span class="nx">useDeepgramSocket</span><span class="p">();</span>
     <span class="c1">// run function and set to variable:</span>
    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useTodoListStore</span><span class="p">();</span>
    <span class="p">...</span>
    <span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Then inside <code>addTodo</code> I will use the <code>store.addTodo</code> function that is already in the store as an action (I created it in the first post in this series.)<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>

<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// remove command phrase ADD TO DO</span>
    <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>

    <span class="c1">// add to store</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">addTodo</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now the logic is there to add the item to the to-do list. I just need to do one more thing to make it show up on the screen.</p>

<h3>
  <a name="watch-for-a-command-add-it-to-the-list" href="#watch-for-a-command-add-it-to-the-list">
  </a>
  Watch For a Command, Add it To The List
</h3>

<p>Right now, the <code>addTodo</code> function with all the logic to add an item to the list never runs. I need to make it run somehow.</p>

<p>Originally, I set up Deepgram to turn on when the button is clicked. When the logic runs to create the WebSocket connection to Deepgram, I also get a value from it that I defined as <code>DG_transcript</code>. This value holds the transcript string that comes back after a user says something such as "Add to do walk the dog".</p>

<p>I want to trigger <code>addTodo</code> to run <strong>every time a new command is said</strong>. And I know I'll be using that transcript for logic to keep track of how many times a command has been said (I'll go over that in the next section). So I'm going to create a ref in this <code>TodoSpeech.vue</code> component called <code>utterance</code>, which will stay in sync with the <code>DG_transcript</code> from the <code>useDeepgramSocket.js</code> composable.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="c1">// inside setup() function in TodoSpeech.vue</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>
  <span class="nx">useDeepgramSocket</span><span class="p">()</span>
<span class="c1">// create ref</span>
<span class="kd">let</span> <span class="nx">utterance</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="nx">DG_transcript</span><span class="p">)</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now the <code>utterance</code> ref is in sync with the transcript that comes from Deepgram. I can watch that <code>utterance</code> ref for changes, and if there is a change, the <code>addTodo</code> function will run.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now when I use the voice-control feature to add an item to the list, I see it show up on the screen. Woo-hoo!</p>

<h2>
  <a name="dealing-with-misunderstood-commands" href="#dealing-with-misunderstood-commands">
  </a>
  Dealing with Misunderstood Commands
</h2>

<p>Automatic Speech Recognition technology has gotten really good, but there can still be mistakes. People might mumble or slur some of the words, or the garbage truck could be making a lot of noise in the background. Deepgram's ASR technology can handle a lot, but I have to expect that sometimes it will mishear something.</p>

<p>What if I say "Add to do walk the dog", but Deepgram mishears it as "And to do walk the dog"? I want to be ready for that and for any other situation. What if the user forgets to add the command and just says "Walk the dog!"</p>

<p>I'm going to program my app to show a message to the user when this happens. It will display "I didn't catch that" when it doesn't hear a match to the command phrase.</p>

<p>The logic for this will depend on <strong>counting how many times a command has been spoken</strong>. If the speaker says one thing, and it gets added to the list, then the count should be one. But if the speaker says another thing after that, and it doesn't get added to the list, then the count is at two, but the list is at one. So there was a misunderstanding.</p>

<p>Here is the logic that will run:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>
    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">alertMisunderstood</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>If a command is given, the count is increased by one. Then the<code>addTodo</code> function runs.</p>

<p>Inside <code>addTodo</code>, I check for a match. If there is a match, it means that an item is added to the list. After it is added to the list, I will reset the count to match the number of items in the list:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>
  <span class="c1">// clean up utterance</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>
  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// remove command phrase ADD TO DO</span>
      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>
      <span class="c1">// add to store</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">addTodo</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span>
      <span class="c1">// reset count</span>
      <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>However, in the <code>if</code> statement above, I test for a match. If it does NOT find a match, none of that logic inside of it runs. So that would result in the count having increased, but the number of items in the to-do list not having increased.</p>

<p>In that case, I need to write logic to notice that discrepancy and alert the user:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">alertMisunderstood</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// if count doesn't equal todo list length, the command was misunderstood</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I didn't catch that</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>I don't want the phrase "I didn't catch that" to remain on the screen forever. I'll have it disappear after a second and return to "Listening":<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">alertMisunderstood</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// if count doesn't equal todo list length, the command was misunderstood</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I didn't catch that</span><span class="dl">"</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
      <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Listening</span><span class="dl">'</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Now, everything in the watcher is set up to make sure that when a user gives a command, it is either added to the to-do list, or reported back with a message to the user that the command was misunderstood.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>
    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">alertMisunderstood</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="delete-todo-item-with-voicecontrol" href="#delete-todo-item-with-voicecontrol">
  </a>
  Delete To-Do Item With Voice-Control
</h2>

<p>The hard part of this is done. I walked through the step-by-step logic to analyze voice-control command strings. Now that I want to delete an item, I can use the same logic.</p>

<p>I'll write out the pseudo-code and supply my logic. I won't go through it step-by-step again since the only thing that will be different is writing the step <strong>to remove an item from the store to-do list</strong> instead of add an item.</p>

<p>Anyone following along with this post and building the voice-control feature could now take some time to write a <code>deleteTodo</code> function. I recommend copying the pseudo-code below (the commented-out steps) and then writing each step of the logic.</p>

<h3>
  <a name="pseudocode" href="#pseudocode">
  </a>
  Pseudo-Code:
</h3>



<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Create an array of Regular Expression words to identify in the text, such as [/^delete/];</span>
  <span class="c1">// Loop through regex values using .find</span>
  <span class="c1">// Turn the command into a standardized string - lower case, no final punctuation, trim whitespace</span>
  <span class="c1">// Check if the command string contains the regex value using .test()</span>
  <span class="c1">// If so, remove the command phrase DELETE to create new string that is just the todo item</span>
  <span class="c1">// Loop through store to-do list and for each item, check if that item matches the new string that is just the todo item</span>
  <span class="c1">// if item in store todo list matches, delete from store to-do list</span>
  <span class="c1">// reset the count of uttered commands to match the length of the todo list array in the store</span>
<span class="p">}</span>

<span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="c1">// watch for a command to run delete logic</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here is the code I wrote for this voice-controlled delete logic:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">deleteRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^delete/</span><span class="p">]</span>
  <span class="c1">// clean up utterance</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>
  <span class="nx">deleteRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// remove command phrase DELETE</span>
      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">storeTodo</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
        <span class="c1">// if item in store todo list matches this utterance,</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">item</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// delete from store</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
          <span class="c1">// reset count</span>
          <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And in the watcher:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>
    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">alertMisunderstood</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="checkoff-todo-item-with-voicecontrol" href="#checkoff-todo-item-with-voicecontrol">
  </a>
  Check-Off To-Do Item With Voice-Control
</h2>

<p>The logic to check off an item on the list is exactly the same as the logic to delete an item, except instead of calling <code>store.deleteTodo(storeTodo.id)</code>, I will call <code>store.toggleCompleted(storeTodo.id)</code>.</p>

<p>Here is the logic to check-off an item with voice-control:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">checkOffTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">checkOffRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^check off/</span><span class="p">]</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>
  <span class="nx">checkOffRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">storeTodo</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">item</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// toggle completed in store:</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">toggleCompleted</span><span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
          <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>And the watcher:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>
    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">checkOffTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">alertMisunderstood</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<h2>
  <a name="conclusion" href="#conclusion">
  </a>
  Conclusion
</h2>

<p>That concludes this post on how to add voice-control to a Vue 3 to-do list app. It was well worth the trouble to turn a classic to-do list project into a more exciting voice-based app that uses Deepgram's speech-to-text API.</p>

<p>Feel free to reach out with questions on <a href="https://twitter.com/sandra_rodgers_">Twitter</a>. Happy coding!</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/sandrarodgers/project-upgrade-voice-controlled-to-do-list-app-with-deepgram-and-vue-3-5eeh" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,n,a,e,t){return a.type_of="article",a.id=1073638,a.title="Project Upgrade: Voice Controlled To-Do List App with Deepgram and Vue 3",a.description="Using Vue 3 & Deepgram's Speech-to-Text API, update the classic to-do list project by adding voice controls!",a.readable_publish_date="May 2",a.slug="project-upgrade-voice-controlled-to-do-list-app-with-deepgram-and-vue-3-5eeh",a.path="/deepgram/project-upgrade-voice-controlled-to-do-list-app-with-deepgram-and-vue-3-5eeh",a.url="https://dev.to/deepgram/project-upgrade-voice-controlled-to-do-list-app-with-deepgram-and-vue-3-5eeh",a.comments_count=0,a.public_reactions_count=20,a.collection_id=17968,a.published_timestamp=n,a.positive_reactions_count=20,a.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--HV3yLjmE--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/x04hct3152t0cpxpzo67.jpg",a.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--vrXQW3U8--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/x04hct3152t0cpxpzo67.jpg",a.canonical_url="https://developers.deepgram.com/blog/2022/05/build-a-voice-controlled-to-do-list-app-with-deepgram-and-vue-3/",a.created_at="2022-05-02T20:14:53Z",a.edited_at=s,a.crossposted_at=s,a.published_at=n,a.last_comment_at=n,a.reading_time_minutes=15,a.tag_list="vue, tutorial, regex, deeplearning",a.tags=["vue","tutorial","regex","deeplearning"],a.body_html='<p>Recently I wrote about a project I did to help me learn Pinia, Vue 3\'s new official state management system. I built a basic to-do list app:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Byx6P3uA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2urt6znxf9vkvq9qrf5g.jpg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Byx6P3uA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2urt6znxf9vkvq9qrf5g.jpg" alt="Example to-do list app" loading="lazy" width="880" height="462"></a></p>\n\n<p>It dawned on me that a fun way to jazz up this project would be to use Deepgram to make the app <strong>voice-powered</strong> so that a user can <strong>speak</strong> commands to add, delete, or check-off items on the list.</p>\n\n<p>I\'m inspired by my colleague Bekah\'s series about <a href="https://developers.deepgram.com/blog/2022/03/freecodecamp-quote-generator-upgrade/">updating portfolio projects</a>. A voice-based to-do list app would be a lot more interesting than a regular to-do list app!</p>\n\n<h2>\n  <a name="project-overview" href="#project-overview">\n  </a>\n  Project Overview\n</h2>\n\n<p>The project I originally did can be found in this <a href="https://github.com/deepgram-devs/todo-pinia">repo</a>, and the accompanying blog post is <a href="https://developers.deepgram.com/blog/2022/04/build-a-todo-list-with-pinia-and-vue-3/">here</a>. Check it out to build the standard to-do list project with Vue 3 and Pinia.</p>\n\n<p>In this iteration of the project, I\'ll continue to use <a href="https://pinia.vuejs.org/">Pinia</a> to manage global state, but I\'ll add Deepgram so I can use Deepgram\'s speech-to-text API to help me power the voice-control feature. If you want to build this voice-control feature along with me, I\'ve created a starting branch <a href="https://github.com/deepgram-devs/todo-pinia-deepgram/tree/starter-branch">here</a>.</p>\n\n<h3>\n  <a name="deepgram-live-streaming-logic" href="#deepgram-live-streaming-logic">\n  </a>\n  Deepgram Live Streaming Logic\n</h3>\n\n<p>There are several articles on Deepgram Docs about how to use Deepgram in Javascript to convert an audio stream of speech into text, including one I wrote about how to use it with Vue 3. I won\'t go over in detail here how I built Vue composables to integrate Deepgram\'s speech-to-text API. Use these resources or take a look at my repo (in the <a href="https://github.com/deepgram-devs/todo-pinia-deepgram/tree/main/src/composables">composables folder</a>) to learn how I did this using Vue 3 and the Deepgram Node SDK:</p>\n\n<h3>\n  <a name="additional-resources" href="#additional-resources">\n  </a>\n  Additional Resources\n</h3>\n\n<ul>\n<li>\n<a href="https://developers.deepgram.com/blog/2022/03/asynchronous-logic-to-write-a-vue-3-and-deepgram-captions-component/">Asynchronous Logic to Write a Vue 3 and Deepgram Captions Component</a> by <a href="https://developers.deepgram.com/blog/authors/sandrarodgers/">Sandra Rodgers</a>\n</li>\n<li>\n<a href="https://developers.deepgram.com/blog/2021/11/live-transcription-mic-browser/">Get Live Speech Transcriptions In Your Browser</a> by <a href="https://developers.deepgram.com/blog/authors/kevinlewis/">Kevin Lewis</a>\n</li>\n<li>\n<a href="https://developers.deepgram.com/blog/2022/01/protecting-api-key/">Browser Live Transcription - Protecting Your API Key</a> by <a href="https://developers.deepgram.com/blog/authors/kevinlewis/">Kevin Lewis</a>\n</li>\n</ul>\n\n<h3>\n  <a name="focus-voicecontrol-feature" href="#focus-voicecontrol-feature">\n  </a>\n  Focus: Voice-Control Feature\n</h3>\n\n<p>For today\'s project, I will focus on dealing with the transcript of text that I get back from Deepgram, analyzing it for speech commands to add, delete, and check off items in the to-do list. This logic will all be part of a voice-control feature.</p>\n\n<h2>\n  <a name="create-the-component-and-connect-deepgram" href="#create-the-component-and-connect-deepgram">\n  </a>\n  Create the Component and Connect Deepgram\n</h2>\n\n<p>The voice-control feature that I build today will be one component with two main elements:</p>\n\n<ol>\n<li>a <code>button</code> that, when clicked, <strong>turns on or off voice-control mode</strong> (i.e., toggles the connection to Deepgram)</li>\n<li>a <code>div</code> that contains text which identifies the status of whether Deepgram is <strong>connected and listening</strong>, if it <strong>misheard what was said</strong>, or if it is <strong>not connected</strong>.</li>\n</ol>\n\n<p>Here\'s a minimally styled version of this project that highlights the component I\'ll be building today:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--8FG3tdCC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/v2cntq4anyyakx0x3zg5.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--8FG3tdCC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/v2cntq4anyyakx0x3zg5.png" alt="To-do list app highlighting component" loading="lazy" width="880" height="598"></a></p>\n\n<p>In the components folder with the other Todo components, I\'ll create a component called <code>TodoSpeech.vue</code>. It will be a child component of <code>TodoApp.vue</code>.</p>\n\n<p>In <code>TodoSpeech.vue</code>, I\'ll start by adding the button element and status div to the template. I\'ll use a speech bubble emoji on the button, and I\'ll create an event listener that I plan to program to toggle the Deepgram connection when the button is clicked.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight html"><code><span class="c">&lt;!-- in template: --&gt;</span>\n<span class="nt">&lt;button</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleListen()"</span><span class="nt">&gt;</span>ðŸ’¬<span class="nt">&lt;/button&gt;</span>\n<span class="nt">&lt;div&gt;</span>{{ deepgramStatus }}<span class="nt">&lt;/div&gt;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>I\'ll also create a <code>deepgramStatus</code> ref, which I\'ll program to update when Deepgram is connected and ready to receive audio data. The initial value will report that Deepgram is not connected:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// in script:</span>\n<span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">\'</span><span class="s1">Deepgram Not Connected</span><span class="dl">\'</span><span class="p">)</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>I\'ll connect to Deepgram using the composable <code>useDeepgramSocket</code> (already built in a previous post), which I import in the script. I also run the composable in the setup function so that it runs at the beginning of the component lifecycle. I destructure four properties off of the composable: <code>DG_socket</code>, <code>DG_transcript</code>, <code>openStream</code>, <code>closeStream</code>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useDeepgramSocket</span><span class="p">();</span>\n    <span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">Deepgram Not Connected</span><span class="dl">"</span><span class="p">);</span>\n\n    <span class="k">return</span> <span class="p">{</span> <span class="nx">deepgramStatus</span> <span class="p">};</span>\n  <span class="p">},</span>\n<span class="p">};</span>\n<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The <code>openStream</code> and <code>closeStream</code> methods that I destructured off of the <code>useDeepgramSocket</code> composable will toggle on and off when the button is clicked and <code>toggleListen</code> runs. Notice that I created the <code>isListening</code> ref to update the toggle status:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">let</span> <span class="nx">isListening</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>\n\n<span class="kd">function</span> <span class="nx">toggleListen</span><span class="p">()</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">openStream</span><span class="p">()</span>\n    <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">true</span>\n  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>\n    <span class="nx">closeStream</span><span class="p">()</span>\n    <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>I\'ll use a watcher to watch the Deepgram socket\'s status in the composable. That way, the <code>div</code> in the template will update when I click the button and Deepgram is connecting, connected, or not connected:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">DG_socket</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">\'</span><span class="s1">Connecting</span><span class="dl">\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">Connecting</span><span class="dl">\'</span>\n  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">\'</span><span class="s1">Not Connected</span><span class="dl">\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">Voice Controls Off</span><span class="dl">\'</span>\n  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">\'</span><span class="s1">Closing connection...</span><span class="dl">\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">Closing connection...</span><span class="dl">\'</span>\n  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">Listening</span><span class="dl">\'</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here is the entire component now. I should be able to click the button and see the status change to show the status of the Deepgram connection:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>\n  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>\n    <span class="o">&lt;</span><span class="nx">button</span> <span class="p">@</span><span class="nd">click</span><span class="o">=</span><span class="dl">"</span><span class="s2">toggleListen()</span><span class="dl">"</span><span class="o">&gt;</span><span class="err">ðŸ’¬</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;\n</span>    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{{</span> <span class="nx">deepgramStatus</span> <span class="p">}}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;\n</span>  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;\n</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;\n</span>\n<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">watch</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>\n      <span class="nx">useDeepgramSocket</span><span class="p">();</span>\n\n    <span class="kd">let</span> <span class="nx">deepgramStatus</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="dl">"</span><span class="s2">Deepgram Not Connected</span><span class="dl">"</span><span class="p">);</span>\n    <span class="kd">let</span> <span class="nx">isListening</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>\n\n    <span class="kd">function</span> <span class="nx">toggleListen</span><span class="p">()</span> <span class="p">{</span>\n      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>\n        <span class="nx">openStream</span><span class="p">();</span>\n        <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>\n      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>\n        <span class="nx">closeStream</span><span class="p">();</span>\n        <span class="nx">isListening</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>\n      <span class="p">}</span>\n    <span class="p">}</span>\n\n    <span class="nx">watch</span><span class="p">(</span><span class="nx">DG_socket</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n      <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Connecting</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>\n        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Connecting</span><span class="dl">"</span><span class="p">;</span>\n      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Not Connected</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>\n        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Voice Controls Off</span><span class="dl">"</span><span class="p">;</span>\n      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">DG_socket</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">Closing connection...</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>\n        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Closing connection...</span><span class="dl">"</span><span class="p">;</span>\n      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>\n        <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Listening</span><span class="dl">"</span><span class="p">;</span>\n      <span class="p">}</span>\n    <span class="p">});</span>\n\n    <span class="k">return</span> <span class="p">{</span> <span class="nx">deepgramStatus</span><span class="p">,</span> <span class="nx">toggleListen</span> <span class="p">};</span>\n  <span class="p">},</span>\n<span class="p">};</span>\n<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="analyze-deepgram-response-for-voice-commands" href="#analyze-deepgram-response-for-voice-commands">\n  </a>\n  Analyze Deepgram Response for Voice Commands\n</h2>\n\n<p>The logic to add, delete, or check-off an item from the list will be based on what the speaker says. I need to program this application to listen for commands such as "add!" or "delete!".</p>\n\n<p>To do that, I will need to understand the form of the text transcript I\'ll be getting back from Deepgram.</p>\n\n<h3>\n  <a name="deepgram-audio-stream-to-text" href="#deepgram-audio-stream-to-text">\n  </a>\n  Deepgram Audio Stream to Text\n</h3>\n\n<p>When I started using Deepgram to transcribe audio streams, I was surprised that Deepgram was able to send back the text almost immediately, after each phrase or sentence rather than waiting until the socket closes and sending back the entire transcription.</p>\n\n<p>How is it able to send a response back continuously, as the audio is streaming, and how is it able to send meaningful chunks, such as at the end of a sentence or a pause in speech? This is thanks to two of its features: <strong>Endpointing</strong> and <strong>Interim Results</strong>.</p>\n\n<p>To put it very simply, <strong>Endpointing</strong> is how Deepgram uses pauses in speech to process that speech into meaningful text chunks. It can hear longer silences in speech and use them to identify finished thoughts, i.e., phrases or sentences.</p>\n\n<p><strong>Interim results</strong> is Deepgram analyzing speech as accurately and as quickly as possible with the little bits of info it gets on the fly; then, after it gets more data to work with, it corrects the transcription. That is why as one or two words come back, one might be wrong, but then when the sentence comes back, the whole thing is more accurate.</p>\n\n<p>In my case, I\'m using the <strong>Interim Results</strong> property <code>is_final</code> to identify a complete voice command. When <code>is_final</code> is <code>true</code>, it means I\'m dealing with a full statement or a complete command such as "Add walk the dog to the list!" The <code>is_final</code> property breaks the transcript up at the end of a fully-processed statement:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// in useDeepgramSocket.js:</span>\n<span class="kd">const</span> <span class="nx">transcript</span> <span class="o">=</span> <span class="nx">received</span><span class="p">.</span><span class="nx">channel</span><span class="p">.</span><span class="nx">alternatives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">transcript</span>\n<span class="k">if</span> <span class="p">(</span><span class="nx">transcript</span> <span class="o">&amp;&amp;</span> <span class="nx">received</span><span class="p">.</span><span class="nx">is_final</span><span class="p">)</span> <span class="p">{</span>\n  <span class="nx">DG_transcript</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">transcript</span> <span class="o">+</span> <span class="dl">\'\'</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>This is a pretty cool feature because it means that a user can speak a command, such as "Add walk the dog to the list", and Deepgram can identify that it is the end of the command based on the flow of the speech. It will send me that sentence back to deal with in text form, and then I can use logic to dig in and find the specific command word, such as <em>add</em> or <em>delete</em>. Nice!</p>\n\n\n\n<ul>\n<li><a href="https://developers.deepgram.com/documentation/guides/understand-endpointing-interim-results/">Understanding Endpointing and Interim Results When Transcribing Live Streaming Audio</a></li>\n<li><a href="https://developers.deepgram.com/documentation/features/interim-results/">Interim Results</a></li>\n<li><a href="https://developers.deepgram.com/documentation/features/endpointing/">Endpointing</a></li>\n</ul>\n\n\n\n<h2>\n  <a name="add-todo-item-with-voicecontrol" href="#add-todo-item-with-voicecontrol">\n  </a>\n  Add To-Do Item With Voice-Control\n</h2>\n\n<p>Now I\'ll write logic to analyze a voice command for the words "add to do", and if the command has those words (such as in the command "ADD TO DO walk the dog!"), the item will be added to the <code>todoList</code> array in the Pinia store.</p>\n\n<p>I also want to keep track of the number of commands given, so if Deepgram doesn\'t transcribe the command correctly due to problems interpreting the speech, I can check that count value against the number of items in the store <code>todoList</code> array, and report back to the user that the command was misunderstood and didn\'t make it in.</p>\n\n<p>Here is pseudo-code for what I need to write:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="c1">// Create array of Regular Expression words to identify in the text string, such as [/^add to do/, /^ad to do/]</span>\n  <span class="c1">// Loop through regex values using .find()</span>\n  <span class="c1">// Turn the command into a standardized string - lower case, no final punctuation, trim whitespace</span>\n  <span class="c1">// Check if the command string contains the regex value using .test</span>\n  <span class="c1">// If so, remove the command phrase ADD TO DO to create new string that is just the todo item</span>\n  <span class="c1">// add todo to the Pinia store todo-list</span>\n  <span class="c1">// reset the count of uttered commands to match the length of the todo list array in the store</span>\n<span class="p">}</span>\n<span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="c1">// watch for a command and if there is one, add it to the list</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>PHEW! That is a lot of logic to get through. Best to take it one step at a time.</p>\n\n<h3>\n  <a name="create-a-set-of-regular-expressions" href="#create-a-set-of-regular-expressions">\n  </a>\n  Create a Set of Regular Expressions\n</h3>\n\n<p>I want to analyze the command string such as "Add to do walk the dog" for the three words "add to do". I will:</p>\n\n<ul>\n<li>Create a regular expression by enclosing it within slashes <code>/-/</code>\n</li>\n<li>Use the character <code>^</code> before the command phrase to identify that the phrase should be at the beginning of the string</li>\n</ul>\n\n<p>So the regular expression for "add to do" that I will use is <code>/^add to do/</code>.</p>\n\n<p>However, since there is the possibility that Deepgram could transcribe this with \'ad\' instead of \'add\' (seems unlikely, but I want to be prepared), I\'ll also use <code>/^ad to do/</code>. In fact, I\'ll match to anything that could be a homophone.</p>\n\n<p>I need an array to create a set of all the options. (The reason I don\'t include something like <code>/^add two do/</code> is because it\'s not grammatically correct, and Deepgram is smart enough to know not to transcribe things as ungrammatical.)<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h3>\n  <a name="use-the-array-method-find" href="#use-the-array-method-find">\n  </a>\n  Use the Array Method .find()\n</h3>\n\n<p>I\'ll use the array method <code>.find</code> to loop through the array of regular expressions. It will search for the first item in the array that matches. If it finds one, there\'s no need to continue looping through since all we need is one match:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>\n  <span class="c1">// loop through array to find first match:</span>\n  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{})</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h3>\n  <a name="write-a-method-to-standardize-the-command-string" href="#write-a-method-to-standardize-the-command-string">\n  </a>\n  Write a Method to Standardize the Command String\n</h3>\n\n<p>I want the command to be lowercase, to not include periods, commas, question marks, or quotation marks, and to not have extra whitespace at the end. (I could entirely turn off punctuation in Deepgram, but I like the transcript to include apostrophes in words such as "she\'s.")</p>\n\n<p>I\'ll create a function to take the command string and standardize it:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">punctuation</span> <span class="o">=</span> <span class="sr">/</span><span class="se">[</span><span class="sr">.,?"</span><span class="se">]</span><span class="sr">+/g</span>\n  <span class="kd">const</span> <span class="nx">change</span> <span class="o">=</span> <span class="nx">command</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="nx">punctuation</span><span class="p">,</span> <span class="dl">\'\'</span><span class="p">).</span><span class="nx">trim</span><span class="p">()</span>\n  <span class="k">return</span> <span class="nx">change</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Notice that I used another regular expression, <code>/[.,?"]+/g</code>. This paired with the <code>replace</code> method will search for any of those punctuation marks throughout the entire string and replace them with<code>""</code> (which is nothing).</p>\n\n<p>Then I use this <code>standardizeUtterance</code> function inside the <code>addTodo</code> function. I\'ll add it before the loop so that it doesn\'t run for every loop:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>\n  <span class="c1">// clean up utterance</span>\n  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>\n  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="c1">// use item for more logic</span>\n  <span class="p">})</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h3>\n  <a name="test-that-the-item-matches-the-regular-expression" href="#test-that-the-item-matches-the-regular-expression">\n  </a>\n  Test that the Item Matches the Regular Expression\n</h3>\n\n<p>I\'ll write an <code>if</code> statement to say that if the string starts with the regular expression command such as <code>/^add to do/</code>, then do something else (the something else will involve adding it to the to-do list).</p>\n\n<p>I use the method <code>.test</code>, which is a javascript method used to match a regular expression with a string, returning <code>true</code> or <code>false</code> depending on if there is a match or not.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>\n<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h3>\n  <a name="remove-the-command-phrase-from-the-string" href="#remove-the-command-phrase-from-the-string">\n  </a>\n  Remove the Command Phrase from the String\n</h3>\n\n<p>If there is a match, I will want to add the string to the to-do list. But right now the whole string also contains the command phrase "add to do" as in the sentence "Add to do walk the dog." I do not want "add to do" to be part of the string that goes into the to-do list array in the store.</p>\n\n<p>I\'ll write a function that takes the string and removes the phrase. I\'ll need to give it both the full command, and the regular expression (which is the command phrase). The method <code>replace</code> will search for the phrase and replace it with <code>""</code>, i.e., nothing.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">change</span> <span class="o">=</span> <span class="nx">command</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">reg</span><span class="p">,</span> <span class="dl">\'\'</span><span class="p">).</span><span class="nx">trim</span><span class="p">(</span><span class="dl">\'\'</span><span class="p">)</span>\n  <span class="k">return</span> <span class="nx">change</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then I add it to <code>addTodo</code>:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>\n\n<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n    <span class="c1">// remove command phrase ADD TO DO</span>\n    <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">);</span>\n    <span class="p">}</span>\n  <span class="p">});</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h3>\n  <a name="add-the-todo-item-to-the-todo-list-array" href="#add-the-todo-item-to-the-todo-list-array">\n  </a>\n  Add the To-Do Item to the To-Do List Array\n</h3>\n\n<p>I\'m almost done! This is the most important step. I can add the to-do item to the list in the store.</p>\n\n<p>I have to go back up to the start of the <code>script</code> and import the store. I also need to run the store function and set it to a variable that I can use (I\'ll set it to <code>store</code>)<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">watch</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">useDeepgramSocket</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@/composables/useDeepgramSocket</span><span class="dl">"</span><span class="p">;</span>\n<span class="c1">// import store:</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">useTodoListStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/useTodoListStore</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>\n      <span class="nx">useDeepgramSocket</span><span class="p">();</span>\n     <span class="c1">// run function and set to variable:</span>\n    <span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useTodoListStore</span><span class="p">();</span>\n    <span class="p">...</span>\n    <span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n    <span class="p">...</span>\n    <span class="p">});</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Then inside <code>addTodo</code> I will use the <code>store.addTodo</code> function that is already in the store as an action (I created it in the first post in this series.)<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// inside addTodo method:</span>\n\n<span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n    <span class="c1">// remove command phrase ADD TO DO</span>\n    <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>\n\n    <span class="c1">// add to store</span>\n    <span class="nx">store</span><span class="p">.</span><span class="nx">addTodo</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now the logic is there to add the item to the to-do list. I just need to do one more thing to make it show up on the screen.</p>\n\n<h3>\n  <a name="watch-for-a-command-add-it-to-the-list" href="#watch-for-a-command-add-it-to-the-list">\n  </a>\n  Watch For a Command, Add it To The List\n</h3>\n\n<p>Right now, the <code>addTodo</code> function with all the logic to add an item to the list never runs. I need to make it run somehow.</p>\n\n<p>Originally, I set up Deepgram to turn on when the button is clicked. When the logic runs to create the WebSocket connection to Deepgram, I also get a value from it that I defined as <code>DG_transcript</code>. This value holds the transcript string that comes back after a user says something such as "Add to do walk the dog".</p>\n\n<p>I want to trigger <code>addTodo</code> to run <strong>every time a new command is said</strong>. And I know I\'ll be using that transcript for logic to keep track of how many times a command has been said (I\'ll go over that in the next section). So I\'m going to create a ref in this <code>TodoSpeech.vue</code> component called <code>utterance</code>, which will stay in sync with the <code>DG_transcript</code> from the <code>useDeepgramSocket.js</code> composable.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="c1">// inside setup() function in TodoSpeech.vue</span>\n<span class="kd">const</span> <span class="p">{</span> <span class="nx">DG_socket</span><span class="p">,</span> <span class="nx">DG_transcript</span><span class="p">,</span> <span class="nx">openStream</span><span class="p">,</span> <span class="nx">closeStream</span> <span class="p">}</span> <span class="o">=</span>\n  <span class="nx">useDeepgramSocket</span><span class="p">()</span>\n<span class="c1">// create ref</span>\n<span class="kd">let</span> <span class="nx">utterance</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="nx">DG_transcript</span><span class="p">)</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now the <code>utterance</code> ref is in sync with the transcript that comes from Deepgram. I can watch that <code>utterance</code> ref for changes, and if there is a change, the <code>addTodo</code> function will run.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">\'\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now when I use the voice-control feature to add an item to the list, I see it show up on the screen. Woo-hoo!</p>\n\n<h2>\n  <a name="dealing-with-misunderstood-commands" href="#dealing-with-misunderstood-commands">\n  </a>\n  Dealing with Misunderstood Commands\n</h2>\n\n<p>Automatic Speech Recognition technology has gotten really good, but there can still be mistakes. People might mumble or slur some of the words, or the garbage truck could be making a lot of noise in the background. Deepgram\'s ASR technology can handle a lot, but I have to expect that sometimes it will mishear something.</p>\n\n<p>What if I say "Add to do walk the dog", but Deepgram mishears it as "And to do walk the dog"? I want to be ready for that and for any other situation. What if the user forgets to add the command and just says "Walk the dog!"</p>\n\n<p>I\'m going to program my app to show a message to the user when this happens. It will display "I didn\'t catch that" when it doesn\'t hear a match to the command phrase.</p>\n\n<p>The logic for this will depend on <strong>counting how many times a command has been spoken</strong>. If the speaker says one thing, and it gets added to the list, then the count should be one. But if the speaker says another thing after that, and it doesn\'t get added to the list, then the count is at two, but the list is at one. So there was a misunderstanding.</p>\n\n<p>Here is the logic that will run:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">\'\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>\n    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">alertMisunderstood</span><span class="p">()</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>If a command is given, the count is increased by one. Then the<code>addTodo</code> function runs.</p>\n\n<p>Inside <code>addTodo</code>, I check for a match. If there is a match, it means that an item is added to the list. After it is added to the list, I will reset the count to match the number of items in the list:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">addRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^add to do/</span><span class="p">,</span> <span class="sr">/^ad to do/</span><span class="p">,</span> <span class="sr">/^add to dew/</span><span class="p">]</span>\n  <span class="c1">// clean up utterance</span>\n  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>\n  <span class="nx">addRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n      <span class="c1">// remove command phrase ADD TO DO</span>\n      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>\n      <span class="c1">// add to store</span>\n      <span class="nx">store</span><span class="p">.</span><span class="nx">addTodo</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span>\n      <span class="c1">// reset count</span>\n      <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>\n    <span class="p">}</span>\n  <span class="p">})</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>However, in the <code>if</code> statement above, I test for a match. If it does NOT find a match, none of that logic inside of it runs. So that would result in the count having increased, but the number of items in the to-do list not having increased.</p>\n\n<p>In that case, I need to write logic to notice that discrepancy and alert the user:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">alertMisunderstood</span><span class="p">()</span> <span class="p">{</span>\n  <span class="c1">// if count doesn\'t equal todo list length, the command was misunderstood</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I didn\'t catch that</span><span class="dl">"</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>I don\'t want the phrase "I didn\'t catch that" to remain on the screen forever. I\'ll have it disappear after a second and return to "Listening":<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">alertMisunderstood</span><span class="p">()</span> <span class="p">{</span>\n  <span class="c1">// if count doesn\'t equal todo list length, the command was misunderstood</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I didn\'t catch that</span><span class="dl">"</span>\n    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n      <span class="nx">deepgramStatus</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">Listening</span><span class="dl">\'</span>\n    <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Now, everything in the watcher is set up to make sure that when a user gives a command, it is either added to the to-do list, or reported back with a message to the user that the command was misunderstood.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">\'\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>\n    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">alertMisunderstood</span><span class="p">()</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="delete-todo-item-with-voicecontrol" href="#delete-todo-item-with-voicecontrol">\n  </a>\n  Delete To-Do Item With Voice-Control\n</h2>\n\n<p>The hard part of this is done. I walked through the step-by-step logic to analyze voice-control command strings. Now that I want to delete an item, I can use the same logic.</p>\n\n<p>I\'ll write out the pseudo-code and supply my logic. I won\'t go through it step-by-step again since the only thing that will be different is writing the step <strong>to remove an item from the store to-do list</strong> instead of add an item.</p>\n\n<p>Anyone following along with this post and building the voice-control feature could now take some time to write a <code>deleteTodo</code> function. I recommend copying the pseudo-code below (the commented-out steps) and then writing each step of the logic.</p>\n\n<h3>\n  <a name="pseudocode" href="#pseudocode">\n  </a>\n  Pseudo-Code:\n</h3>\n\n\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="c1">// Create an array of Regular Expression words to identify in the text, such as [/^delete/];</span>\n  <span class="c1">// Loop through regex values using .find</span>\n  <span class="c1">// Turn the command into a standardized string - lower case, no final punctuation, trim whitespace</span>\n  <span class="c1">// Check if the command string contains the regex value using .test()</span>\n  <span class="c1">// If so, remove the command phrase DELETE to create new string that is just the todo item</span>\n  <span class="c1">// Loop through store to-do list and for each item, check if that item matches the new string that is just the todo item</span>\n  <span class="c1">// if item in store todo list matches, delete from store to-do list</span>\n  <span class="c1">// reset the count of uttered commands to match the length of the todo list array in the store</span>\n<span class="p">}</span>\n\n<span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="c1">// watch for a command to run delete logic</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here is the code I wrote for this voice-controlled delete logic:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">deleteRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^delete/</span><span class="p">]</span>\n  <span class="c1">// clean up utterance</span>\n  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>\n  <span class="nx">deleteRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n      <span class="c1">// remove command phrase DELETE</span>\n      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>\n      <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">storeTodo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n        <span class="c1">// if item in store todo list matches this utterance,</span>\n        <span class="k">if</span> <span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">item</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>\n          <span class="c1">// delete from store</span>\n          <span class="nx">store</span><span class="p">.</span><span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>\n          <span class="c1">// reset count</span>\n          <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>\n        <span class="p">}</span>\n      <span class="p">})</span>\n    <span class="p">}</span>\n  <span class="p">})</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And in the watcher:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">\'\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>\n    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">alertMisunderstood</span><span class="p">()</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="checkoff-todo-item-with-voicecontrol" href="#checkoff-todo-item-with-voicecontrol">\n  </a>\n  Check-Off To-Do Item With Voice-Control\n</h2>\n\n<p>The logic to check off an item on the list is exactly the same as the logic to delete an item, except instead of calling <code>store.deleteTodo(storeTodo.id)</code>, I will call <code>store.toggleCompleted(storeTodo.id)</code>.</p>\n\n<p>Here is the logic to check-off an item with voice-control:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">checkOffTodo</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="nx">checkOffRegEx</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/^check off/</span><span class="p">]</span>\n  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">standardizeUtterance</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span>\n  <span class="nx">checkOffRegEx</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">reg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">reg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>\n      <span class="kd">const</span> <span class="nx">todo</span> <span class="o">=</span> <span class="nx">removeCommandPhrase</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">reg</span><span class="p">)</span>\n      <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">storeTodo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n        <span class="k">if</span> <span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">item</span> <span class="o">===</span> <span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>\n          <span class="c1">// toggle completed in store:</span>\n          <span class="nx">store</span><span class="p">.</span><span class="nx">toggleCompleted</span><span class="p">(</span><span class="nx">storeTodo</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>\n          <span class="nx">count</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">length</span>\n        <span class="p">}</span>\n      <span class="p">})</span>\n    <span class="p">}</span>\n  <span class="p">})</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>And the watcher:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight javascript"><code><span class="nx">watch</span><span class="p">(</span><span class="nx">utterance</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span> <span class="o">!==</span> <span class="dl">\'\'</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">count</span><span class="p">.</span><span class="nx">value</span><span class="o">++</span>\n    <span class="nx">addTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">deleteTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">checkOffTodo</span><span class="p">(</span><span class="nx">utterance</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>\n    <span class="nx">alertMisunderstood</span><span class="p">()</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<h2>\n  <a name="conclusion" href="#conclusion">\n  </a>\n  Conclusion\n</h2>\n\n<p>That concludes this post on how to add voice-control to a Vue 3 to-do list app. It was well worth the trouble to turn a classic to-do list project into a more exciting voice-based app that uses Deepgram\'s speech-to-text API.</p>\n\n<p>Feel free to reach out with questions on <a href="https://twitter.com/sandra_rodgers_">Twitter</a>. Happy coding!</p>\n\n',a.body_markdown="---\ndescription: Using Vue 3 & Deepgram's Speech-to-Text API, update the classic to-do list project by adding voice controls!\ncanonical_url: https://developers.deepgram.com/blog/2022/05/build-a-voice-controlled-to-do-list-app-with-deepgram-and-vue-3/\nseries: Build a To-do List App With Vue 3\n---\n\nRecently I wrote about a project I did to help me learn Pinia, Vue 3's new official state management system. I built a basic to-do list app:\n\n![Example to-do list app](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/2urt6znxf9vkvq9qrf5g.jpg)\n\nIt dawned on me that a fun way to jazz up this project would be to use Deepgram to make the app **voice-powered** so that a user can **speak** commands to add, delete, or check-off items on the list.\n\nI'm inspired by my colleague Bekah's series about [updating portfolio projects](https://developers.deepgram.com/blog/2022/03/freecodecamp-quote-generator-upgrade/). A voice-based to-do list app would be a lot more interesting than a regular to-do list app!\n\n## Project Overview\n\nThe project I originally did can be found in this [repo](https://github.com/deepgram-devs/todo-pinia), and the accompanying blog post is [here](https://developers.deepgram.com/blog/2022/04/build-a-todo-list-with-pinia-and-vue-3/). Check it out to build the standard to-do list project with Vue 3 and Pinia.\n\nIn this iteration of the project, I'll continue to use [Pinia](https://pinia.vuejs.org/) to manage global state, but I'll add Deepgram so I can use Deepgram's speech-to-text API to help me power the voice-control feature. If you want to build this voice-control feature along with me, I've created a starting branch [here](https://github.com/deepgram-devs/todo-pinia-deepgram/tree/starter-branch).\n\n### Deepgram Live Streaming Logic\n\nThere are several articles on Deepgram Docs about how to use Deepgram in Javascript to convert an audio stream of speech into text, including one I wrote about how to use it with Vue 3. I won't go over in detail here how I built Vue composables to integrate Deepgram's speech-to-text API. Use these resources or take a look at my repo (in the [composables folder](https://github.com/deepgram-devs/todo-pinia-deepgram/tree/main/src/composables)) to learn how I did this using Vue 3 and the Deepgram Node SDK:\n\n### Additional Resources\n\n- [Asynchronous Logic to Write a Vue 3 and Deepgram Captions Component](https://developers.deepgram.com/blog/2022/03/asynchronous-logic-to-write-a-vue-3-and-deepgram-captions-component/) by [Sandra Rodgers](https://developers.deepgram.com/blog/authors/sandrarodgers/)</li>\n- [Get Live Speech Transcriptions In Your Browser](https://developers.deepgram.com/blog/2021/11/live-transcription-mic-browser/) by [Kevin Lewis](https://developers.deepgram.com/blog/authors/kevinlewis/)\n- [Browser Live Transcription - Protecting Your API Key](https://developers.deepgram.com/blog/2022/01/protecting-api-key/) by [Kevin Lewis](https://developers.deepgram.com/blog/authors/kevinlewis/)\n\n### Focus: Voice-Control Feature\n\nFor today's project, I will focus on dealing with the transcript of text that I get back from Deepgram, analyzing it for speech commands to add, delete, and check off items in the to-do list. This logic will all be part of a voice-control feature.\n\n## Create the Component and Connect Deepgram\n\nThe voice-control feature that I build today will be one component with two main elements:\n\n1. a `button` that, when clicked, **turns on or off voice-control mode** (i.e., toggles the connection to Deepgram)\n2. a `div` that contains text which identifies the status of whether Deepgram is **connected and listening**, if it **misheard what was said**, or if it is **not connected**.\n\nHere's a minimally styled version of this project that highlights the component I'll be building today:\n\n\n![To-do list app highlighting component](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/v2cntq4anyyakx0x3zg5.png)\n\nIn the components folder with the other Todo components, I'll create a component called `TodoSpeech.vue`. It will be a child component of `TodoApp.vue`.\n\nIn `TodoSpeech.vue`, I'll start by adding the button element and status div to the template. I'll use a speech bubble emoji on the button, and I'll create an event listener that I plan to program to toggle the Deepgram connection when the button is clicked.\n\n```html\n\x3c!-- in template: --\x3e\n<button @click=\"toggleListen()\">ðŸ’¬</button>\n<div>{{ deepgramStatus }}</div>\n```\n\nI'll also create a `deepgramStatus` ref, which I'll program to update when Deepgram is connected and ready to receive audio data. The initial value will report that Deepgram is not connected:\n\n```js\n// in script:\nlet deepgramStatus = ref('Deepgram Not Connected')\n```\n\nI'll connect to Deepgram using the composable `useDeepgramSocket` (already built in a previous post), which I import in the script. I also run the composable in the setup function so that it runs at the beginning of the component lifecycle. I destructure four properties off of the composable: `DG_socket`, `DG_transcript`, `openStream`, `closeStream`.\n\n```js\n<script>\nimport { ref } from \"vue\";\nimport useDeepgramSocket from \"@/composables/useDeepgramSocket\";\n\nexport default {\n  setup() {\n    const { DG_socket, DG_transcript, openStream, closeStream } = useDeepgramSocket();\n    let deepgramStatus = ref(\"Deepgram Not Connected\");\n\n    return { deepgramStatus };\n  },\n};\n<\/script>\n```\n\nThe `openStream` and `closeStream` methods that I destructured off of the `useDeepgramSocket` composable will toggle on and off when the button is clicked and `toggleListen` runs. Notice that I created the `isListening` ref to update the toggle status:\n\n```js\nlet isListening = ref(false)\n\nfunction toggleListen() {\n  if (!isListening.value) {\n    openStream()\n    isListening.value = true\n  } else {\n    closeStream()\n    isListening.value = false\n  }\n}\n```\n\nI'll use a watcher to watch the Deepgram socket's status in the composable. That way, the `div` in the template will update when I click the button and Deepgram is connecting, connected, or not connected:\n\n```js\nwatch(DG_socket, () => {\n  if (DG_socket.value === 'Connecting') {\n    deepgramStatus.value = 'Connecting'\n  } else if (DG_socket.value === 'Not Connected') {\n    deepgramStatus.value = 'Voice Controls Off'\n  } else if (DG_socket.value === 'Closing connection...') {\n    deepgramStatus.value = 'Closing connection...'\n  } else {\n    deepgramStatus.value = 'Listening'\n  }\n})\n```\n\nHere is the entire component now. I should be able to click the button and see the status change to show the status of the Deepgram connection:\n\n```js\n<template>\n  <div>\n    <button @click=\"toggleListen()\">ðŸ’¬</button>\n    <div>{{ deepgramStatus }}</div>\n  </div>\n</template>\n\n<script>\nimport { ref, watch } from \"vue\";\nimport useDeepgramSocket from \"@/composables/useDeepgramSocket\";\n\nexport default {\n  setup() {\n    const { DG_socket, DG_transcript, openStream, closeStream } =\n      useDeepgramSocket();\n\n    let deepgramStatus = ref(\"Deepgram Not Connected\");\n    let isListening = ref(false);\n\n    function toggleListen() {\n      if (!isListening.value) {\n        openStream();\n        isListening.value = true;\n      } else {\n        closeStream();\n        isListening.value = false;\n      }\n    }\n\n    watch(DG_socket, () => {\n      if (DG_socket.value === \"Connecting\") {\n        deepgramStatus.value = \"Connecting\";\n      } else if (DG_socket.value === \"Not Connected\") {\n        deepgramStatus.value = \"Voice Controls Off\";\n      } else if (DG_socket.value === \"Closing connection...\") {\n        deepgramStatus.value = \"Closing connection...\";\n      } else {\n        deepgramStatus.value = \"Listening\";\n      }\n    });\n\n    return { deepgramStatus, toggleListen };\n  },\n};\n<\/script>\n```\n\n## Analyze Deepgram Response for Voice Commands\n\nThe logic to add, delete, or check-off an item from the list will be based on what the speaker says. I need to program this application to listen for commands such as \"add!\" or \"delete!\".\n\nTo do that, I will need to understand the form of the text transcript I'll be getting back from Deepgram.\n\n### Deepgram Audio Stream to Text\n\nWhen I started using Deepgram to transcribe audio streams, I was surprised that Deepgram was able to send back the text almost immediately, after each phrase or sentence rather than waiting until the socket closes and sending back the entire transcription.\n\nHow is it able to send a response back continuously, as the audio is streaming, and how is it able to send meaningful chunks, such as at the end of a sentence or a pause in speech? This is thanks to two of its features: **Endpointing** and **Interim Results**.\n\nTo put it very simply, **Endpointing** is how Deepgram uses pauses in speech to process that speech into meaningful text chunks. It can hear longer silences in speech and use them to identify finished thoughts, i.e., phrases or sentences.\n\n**Interim results** is Deepgram analyzing speech as accurately and as quickly as possible with the little bits of info it gets on the fly; then, after it gets more data to work with, it corrects the transcription. That is why as one or two words come back, one might be wrong, but then when the sentence comes back, the whole thing is more accurate.\n\nIn my case, I'm using the **Interim Results** property `is_final` to identify a complete voice command. When `is_final` is `true`, it means I'm dealing with a full statement or a complete command such as \"Add walk the dog to the list!\" The `is_final` property breaks the transcript up at the end of a fully-processed statement:\n\n```js\n// in useDeepgramSocket.js:\nconst transcript = received.channel.alternatives[0].transcript\nif (transcript && received.is_final) {\n  DG_transcript.value = transcript + ''\n}\n```\n\nThis is a pretty cool feature because it means that a user can speak a command, such as \"Add walk the dog to the list\", and Deepgram can identify that it is the end of the command based on the flow of the speech. It will send me that sentence back to deal with in text form, and then I can use logic to dig in and find the specific command word, such as _add_ or _delete_. Nice!\n\n<panel type=\"info\" title=\"Additional Resources\">\n\n- [Understanding Endpointing and Interim Results When Transcribing Live Streaming Audio](https://developers.deepgram.com/documentation/guides/understand-endpointing-interim-results/)</li>\n- [Interim Results](https://developers.deepgram.com/documentation/features/interim-results/)</li>\n- [Endpointing](https://developers.deepgram.com/documentation/features/endpointing/)</li>\n\n</panel>\n\n## Add To-Do Item With Voice-Control\n\nNow I'll write logic to analyze a voice command for the words \"add to do\", and if the command has those words (such as in the command \"ADD TO DO walk the dog!\"), the item will be added to the `todoList` array in the Pinia store.\n\nI also want to keep track of the number of commands given, so if Deepgram doesn't transcribe the command correctly due to problems interpreting the speech, I can check that count value against the number of items in the store `todoList` array, and report back to the user that the command was misunderstood and didn't make it in.\n\nHere is pseudo-code for what I need to write:\n\n```js\nfunction addTodo(command) {\n  // Create array of Regular Expression words to identify in the text string, such as [/^add to do/, /^ad to do/]\n  // Loop through regex values using .find()\n  // Turn the command into a standardized string - lower case, no final punctuation, trim whitespace\n  // Check if the command string contains the regex value using .test\n  // If so, remove the command phrase ADD TO DO to create new string that is just the todo item\n  // add todo to the Pinia store todo-list\n  // reset the count of uttered commands to match the length of the todo list array in the store\n}\nwatch(utterance, () => {\n  // watch for a command and if there is one, add it to the list\n})\n```\n\nPHEW! That is a lot of logic to get through. Best to take it one step at a time.\n\n### Create a Set of Regular Expressions\n\nI want to analyze the command string such as \"Add to do walk the dog\" for the three words \"add to do\". I will:\n\n- Create a regular expression by enclosing it within slashes `/-/`\n- Use the character `^` before the command phrase to identify that the phrase should be at the beginning of the string\n\nSo the regular expression for \"add to do\" that I will use is `/^add to do/`.\n\nHowever, since there is the possibility that Deepgram could transcribe this with 'ad' instead of 'add' (seems unlikely, but I want to be prepared), I'll also use `/^ad to do/`. In fact, I'll match to anything that could be a homophone.\n\nI need an array to create a set of all the options. (The reason I don't include something like `/^add two do/` is because it's not grammatically correct, and Deepgram is smart enough to know not to transcribe things as ungrammatical.)\n\n```js\nconst addRegEx = [/^add to do/, /^ad to do/, /^add to dew/]\n```\n\n### Use the Array Method .find()\n\nI'll use the array method `.find` to loop through the array of regular expressions. It will search for the first item in the array that matches. If it finds one, there's no need to continue looping through since all we need is one match:\n\n```js\nfunction addTodo(command) {\n  const addRegEx = [/^add to do/, /^ad to do/, /^add to dew/]\n  // loop through array to find first match:\n  addRegEx.find((reg) => {})\n}\n```\n\n### Write a Method to Standardize the Command String\n\nI want the command to be lowercase, to not include periods, commas, question marks, or quotation marks, and to not have extra whitespace at the end. (I could entirely turn off punctuation in Deepgram, but I like the transcript to include apostrophes in words such as \"she's.\")\n\nI'll create a function to take the command string and standardize it:\n\n```js\nfunction standardizeUtterance(command) {\n  const punctuation = /[.,?\"]+/g\n  const change = command.toLowerCase().replace(punctuation, '').trim()\n  return change\n}\n```\n\nNotice that I used another regular expression, `/[.,?\"]+/g`. This paired with the `replace` method will search for any of those punctuation marks throughout the entire string and replace them with`\"\"` (which is nothing).\n\nThen I use this `standardizeUtterance` function inside the `addTodo` function. I'll add it before the loop so that it doesn't run for every loop:\n\n```js\nfunction addTodo(command) {\n  const addRegEx = [/^add to do/, /^ad to do/, /^add to dew/]\n  // clean up utterance\n  const item = standardizeUtterance(command)\n  addRegEx.find((reg) => {\n    // use item for more logic\n  })\n}\n```\n\n### Test that the Item Matches the Regular Expression\n\nI'll write an `if` statement to say that if the string starts with the regular expression command such as `/^add to do/`, then do something else (the something else will involve adding it to the to-do list).\n\nI use the method `.test`, which is a javascript method used to match a regular expression with a string, returning `true` or `false` depending on if there is a match or not.\n\n```js\n// inside addTodo method:\naddRegEx.find((reg) => {\n  if (reg.test(item)) {\n  }\n})\n```\n\n### Remove the Command Phrase from the String\n\nIf there is a match, I will want to add the string to the to-do list. But right now the whole string also contains the command phrase \"add to do\" as in the sentence \"Add to do walk the dog.\" I do not want \"add to do\" to be part of the string that goes into the to-do list array in the store.\n\nI'll write a function that takes the string and removes the phrase. I'll need to give it both the full command, and the regular expression (which is the command phrase). The method `replace` will search for the phrase and replace it with `\"\"`, i.e., nothing.\n\n```js\nfunction removeCommandPhrase(command, reg) {\n  const change = command.replace(reg, '').trim('')\n  return change\n}\n```\n\nThen I add it to `addTodo`:\n\n```js\n// inside addTodo method:\n\naddRegEx.find((reg) => {\n  if (reg.test(item)) {\n    // remove command phrase ADD TO DO\n    const todo = removeCommandPhrase(item, reg);\n    }\n  });\n}\n```\n\n### Add the To-Do Item to the To-Do List Array\n\nI'm almost done! This is the most important step. I can add the to-do item to the list in the store.\n\nI have to go back up to the start of the `script` and import the store. I also need to run the store function and set it to a variable that I can use (I'll set it to `store`)\n\n```js\n<script>\nimport { ref, watch } from \"vue\";\nimport useDeepgramSocket from \"@/composables/useDeepgramSocket\";\n// import store:\nimport { useTodoListStore } from \"../store/useTodoListStore\";\n\nexport default {\n  setup() {\n    const { DG_socket, DG_transcript, openStream, closeStream } =\n      useDeepgramSocket();\n     // run function and set to variable:\n    const store = useTodoListStore();\n    ...\n    function addTodo(command) {\n    ...\n    });\n}\n```\n\nThen inside `addTodo` I will use the `store.addTodo` function that is already in the store as an action (I created it in the first post in this series.)\n\n```js\n// inside addTodo method:\n\naddRegEx.find((reg) => {\n  if (reg.test(item)) {\n    // remove command phrase ADD TO DO\n    const todo = removeCommandPhrase(item, reg)\n\n    // add to store\n    store.addTodo(todo)\n  }\n})\n```\n\nNow the logic is there to add the item to the to-do list. I just need to do one more thing to make it show up on the screen.\n\n### Watch For a Command, Add it To The List\n\nRight now, the `addTodo` function with all the logic to add an item to the list never runs. I need to make it run somehow.\n\nOriginally, I set up Deepgram to turn on when the button is clicked. When the logic runs to create the WebSocket connection to Deepgram, I also get a value from it that I defined as `DG_transcript`. This value holds the transcript string that comes back after a user says something such as \"Add to do walk the dog\".\n\nI want to trigger `addTodo` to run **every time a new command is said**. And I know I'll be using that transcript for logic to keep track of how many times a command has been said (I'll go over that in the next section). So I'm going to create a ref in this `TodoSpeech.vue` component called `utterance`, which will stay in sync with the `DG_transcript` from the `useDeepgramSocket.js` composable.\n\n```js\n// inside setup() function in TodoSpeech.vue\nconst { DG_socket, DG_transcript, openStream, closeStream } =\n  useDeepgramSocket()\n// create ref\nlet utterance = ref(DG_transcript)\n```\n\nNow the `utterance` ref is in sync with the transcript that comes from Deepgram. I can watch that `utterance` ref for changes, and if there is a change, the `addTodo` function will run.\n\n```js\nwatch(utterance, () => {\n  if (utterance.value !== '') {\n    addTodo(utterance.value)\n  }\n})\n```\n\nNow when I use the voice-control feature to add an item to the list, I see it show up on the screen. Woo-hoo!\n\n## Dealing with Misunderstood Commands\n\nAutomatic Speech Recognition technology has gotten really good, but there can still be mistakes. People might mumble or slur some of the words, or the garbage truck could be making a lot of noise in the background. Deepgram's ASR technology can handle a lot, but I have to expect that sometimes it will mishear something.\n\nWhat if I say \"Add to do walk the dog\", but Deepgram mishears it as \"And to do walk the dog\"? I want to be ready for that and for any other situation. What if the user forgets to add the command and just says \"Walk the dog!\"\n\nI'm going to program my app to show a message to the user when this happens. It will display \"I didn't catch that\" when it doesn't hear a match to the command phrase.\n\nThe logic for this will depend on **counting how many times a command has been spoken**. If the speaker says one thing, and it gets added to the list, then the count should be one. But if the speaker says another thing after that, and it doesn't get added to the list, then the count is at two, but the list is at one. So there was a misunderstanding.\n\nHere is the logic that will run:\n\n```js\nwatch(utterance, () => {\n  if (utterance.value !== '') {\n    count.value++\n    addTodo(utterance.value)\n    alertMisunderstood()\n  }\n})\n```\n\nIf a command is given, the count is increased by one. Then the`addTodo` function runs.\n\nInside `addTodo`, I check for a match. If there is a match, it means that an item is added to the list. After it is added to the list, I will reset the count to match the number of items in the list:\n\n```js\nfunction addTodo(command) {\n  const addRegEx = [/^add to do/, /^ad to do/, /^add to dew/]\n  // clean up utterance\n  const item = standardizeUtterance(command)\n  addRegEx.find((reg) => {\n    if (reg.test(item)) {\n      // remove command phrase ADD TO DO\n      const todo = removeCommandPhrase(item, reg)\n      // add to store\n      store.addTodo(todo)\n      // reset count\n      count.value = store.todoList.length\n    }\n  })\n}\n```\n\nHowever, in the `if` statement above, I test for a match. If it does NOT find a match, none of that logic inside of it runs. So that would result in the count having increased, but the number of items in the to-do list not having increased.\n\nIn that case, I need to write logic to notice that discrepancy and alert the user:\n\n```js\nfunction alertMisunderstood() {\n  // if count doesn't equal todo list length, the command was misunderstood\n  if (count.value !== store.todoList.length) {\n    deepgramStatus.value = \"I didn't catch that\"\n  }\n}\n```\n\nI don't want the phrase \"I didn't catch that\" to remain on the screen forever. I'll have it disappear after a second and return to \"Listening\":\n\n```js\nfunction alertMisunderstood() {\n  // if count doesn't equal todo list length, the command was misunderstood\n  if (count.value !== store.todoList.length) {\n    deepgramStatus.value = \"I didn't catch that\"\n    setTimeout(() => {\n      deepgramStatus.value = 'Listening'\n    }, 1000)\n  }\n}\n```\n\nNow, everything in the watcher is set up to make sure that when a user gives a command, it is either added to the to-do list, or reported back with a message to the user that the command was misunderstood.\n\n```js\nwatch(utterance, () => {\n  if (utterance.value !== '') {\n    count.value++\n    addTodo(utterance.value)\n    alertMisunderstood()\n  }\n})\n```\n\n## Delete To-Do Item With Voice-Control\n\nThe hard part of this is done. I walked through the step-by-step logic to analyze voice-control command strings. Now that I want to delete an item, I can use the same logic.\n\nI'll write out the pseudo-code and supply my logic. I won't go through it step-by-step again since the only thing that will be different is writing the step **to remove an item from the store to-do list** instead of add an item.\n\nAnyone following along with this post and building the voice-control feature could now take some time to write a `deleteTodo` function. I recommend copying the pseudo-code below (the commented-out steps) and then writing each step of the logic.\n\n### Pseudo-Code:\n\n```js\nfunction deleteTodo(command) {\n  // Create an array of Regular Expression words to identify in the text, such as [/^delete/];\n  // Loop through regex values using .find\n  // Turn the command into a standardized string - lower case, no final punctuation, trim whitespace\n  // Check if the command string contains the regex value using .test()\n  // If so, remove the command phrase DELETE to create new string that is just the todo item\n  // Loop through store to-do list and for each item, check if that item matches the new string that is just the todo item\n  // if item in store todo list matches, delete from store to-do list\n  // reset the count of uttered commands to match the length of the todo list array in the store\n}\n\nwatch(utterance, () => {\n  // watch for a command to run delete logic\n})\n```\n\nHere is the code I wrote for this voice-controlled delete logic:\n\n```js\nfunction deleteTodo(command) {\n  const deleteRegEx = [/^delete/]\n  // clean up utterance\n  const item = standardizeUtterance(command)\n  deleteRegEx.find((reg) => {\n    if (reg.test(item)) {\n      // remove command phrase DELETE\n      const todo = removeCommandPhrase(item, reg)\n      store.todoList.forEach((storeTodo) => {\n        // if item in store todo list matches this utterance,\n        if (storeTodo.item === todo) {\n          // delete from store\n          store.deleteTodo(storeTodo.id)\n          // reset count\n          count.value = store.todoList.length\n        }\n      })\n    }\n  })\n}\n```\n\nAnd in the watcher:\n\n```js\nwatch(utterance, () => {\n  if (utterance.value !== '') {\n    count.value++\n    addTodo(utterance.value)\n    deleteTodo(utterance.value)\n    alertMisunderstood()\n  }\n})\n```\n\n## Check-Off To-Do Item With Voice-Control\n\nThe logic to check off an item on the list is exactly the same as the logic to delete an item, except instead of calling `store.deleteTodo(storeTodo.id)`, I will call `store.toggleCompleted(storeTodo.id)`.\n\nHere is the logic to check-off an item with voice-control:\n\n```js\nfunction checkOffTodo(command) {\n  const checkOffRegEx = [/^check off/]\n  const item = standardizeUtterance(command)\n  checkOffRegEx.find((reg) => {\n    if (reg.test(item)) {\n      const todo = removeCommandPhrase(item, reg)\n      store.todoList.forEach((storeTodo) => {\n        if (storeTodo.item === todo) {\n          // toggle completed in store:\n          store.toggleCompleted(storeTodo.id)\n          count.value = store.todoList.length\n        }\n      })\n    }\n  })\n}\n```\n\nAnd the watcher:\n\n```js\nwatch(utterance, () => {\n  if (utterance.value !== '') {\n    count.value++\n    addTodo(utterance.value)\n    deleteTodo(utterance.value)\n    checkOffTodo(utterance.value)\n    alertMisunderstood()\n  }\n})\n```\n\n## Conclusion\n\nThat concludes this post on how to add voice-control to a Vue 3 to-do list app. It was well worth the trouble to turn a classic to-do list project into a more exciting voice-based app that uses Deepgram's speech-to-text API.\n\nFeel free to reach out with questions on [Twitter](https://twitter.com/sandra_rodgers_). Happy coding!",a.user={name:e,username:"sandrarodgers",twitter_username:"sandra_rodgers_",github_username:e,website_url:s,profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--ehG5HzYG--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/312029/73f50c87-158f-41ee-957e-4f8059a33df5.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--746HOM0a--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/312029/73f50c87-158f-41ee-957e-4f8059a33df5.jpeg"},a.organization={name:"Deepgram",username:t,slug:t,profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--7ZcPZGcP--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/4019/b921b72d-3c60-425e-a223-189a5fce8839.jpg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--PScdE06w--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/organization/profile_image/4019/b921b72d-3c60-425e-a223-189a5fce8839.jpg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:a}},error:s,state:{currentArticle:a},serverRendered:!0,routePath:"/sandrarodgers/1073638",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:s}}}}(null,"2022-05-02T20:25:41Z",{},"SandraRodgers","deepgram")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
