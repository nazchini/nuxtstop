<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Improving email deliverability with DNS records</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>Improving email deliverability with DNS records</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/tutorial" class="tag" data-v-70afb46a>
          #tutorial
        </a><a href="/nuxtstop/t/email" class="tag" data-v-70afb46a>
          #email
        </a><a href="/nuxtstop/t/dns" class="tag" data-v-70afb46a>
          #dns
        </a><a href="/nuxtstop/t/network" class="tag" data-v-70afb46a>
          #network
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--fay2oiYo--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yg8pl2zj6ioozm5jdw22.png" alt="Improving email deliverability with DNS records" data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            4
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Nov 26 '21</time></div></header> <div class="content" data-v-70afb46a><p>As always, every day brings up new challenges, and today I faced one of my greatest fears - dealing with mailing DNS records.</p>

<p>Up until today, I was only familiar with <em>A Record</em>, <em>CNAME Record</em>, and <em>TXT Record</em>. A while ago, I used the <em>MX Record</em> while setting up my mailbox for my domain, but I don't quite remember its purpose, but enough about me.</p>

<p>Mail eXchangers, such as Gmail, Yahoo, Outlook, check the validity of incoming email messages. As part of the validation process, the Mail eXchanger queries the DNS records of the sender and evaluates the sender's reputation.</p>

<p>The sender's reputation affects how the Mail eXchanger classifies the message and whether or not it should be marked as spam before it is delivered to the receiver. In some cases, the message is blocked entirely by the Mail eXchanger, and the receiver is unaware of it.</p>

<h2>
  <a name="the-reputation" href="#the-reputation">
  </a>
  The Reputation
</h2>

<p>There are many algorithms out there for evaluating an email sender's reputation. To put it on a scale, I classified the reputation level into four levels - <em>Very Low</em>, <em>Low</em>, <em>Standard</em>, and <em>Best</em>.</p>

<h3>
  <a name="very-low" href="#very-low">
  </a>
  Very Low
</h3>

<p>Blocked completely without even bothering the receiver, here are two common error messages that may appear in the ESP's logs if the sender's email has sent too many emails in a short period.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>421 4.7.0 [TS01] Messages from &lt;1.2.3.4> temporarily deferred due to user complaints
&lt;1.2.3.4> ;see http://postmaster.yahoo.com/421-ts01.html
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>





<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>553 5.7.1 [BL21] Connections will not be accepted from 1.2.3.4,
    because the ip is in Spamhaus's list; 
see http://postmaster.yahoo.com/550-bl23.html
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p><a href="https://glockapps.com/blog/remove-ip-address-yahoo-blacklist/">Above snippets from - glockapps.com - How To Remove Your IP From Yahoo Blacklist – Yahoo Blacklist Checker<br>
</a></p>

<p>If there's a need to send large volumes of email messages, it is recommended to purchase a <a href="https://docs.sendgrid.com/ui/sending-email/warming-up-an-ip-address">dedicated IP with a warm-up mechanism</a>. The subject is broadly explained in the provided link, though in short, it's another method of identifying yourself as a trusted sender, by saying:</p>

<blockquote>
<p>"I own a unique IP address because I'm confident that Mail eXchangers won't block me. I know that it's easy to block an IP address, so yeah, I'm that confident."</p>
</blockquote>
<h3>
  <a name="low-reputation" href="#low-reputation">
  </a>
  Low Reputation
</h3>

<p>Emails are marked as spam due to the low authenticity of the sender or previous reports of other users. But, most of the time, it's because the content of the message is not specific enough to the receiver.</p>

<p>For example, Willy is a Gmail customer, and he is interested in computer science and surfing. Then, out of the blue, Willy receives an email message about a great body lotion for women. Though Willy may have subscribed to some cosmetics stores websites, if the message isn't specific enough, like "Hi Willy," then it <strong>might</strong> be marked as spam.</p>

<p>Send the relevant content to the appropriate audience to avoid getting here.</p>
<h3>
  <a name="standard-reputation" href="#standard-reputation">
  </a>
  Standard Reputation
</h3>

<p>Email messages are getting to the client's mailbox as they should, though, in some Mail eXchangers such as Gmail, messages could move to the <a href="https://developers.google.com/gmail/promotab/faq#why_do_i_see_my_email_in_a_bundle_and_i_have_not_added_the_annotation">Promotions tab</a>, while it wasn't intended.</p>

<blockquote>
<p>"... Gmail will recommend emails based on previous user engagement, regardless of whether annotations are present."</p>
</blockquote>
<h3>
  <a name="best-reputation" href="#best-reputation">
  </a>
  Best Reputation
</h3>

<p>Email messages are getting to the client's mailbox as the <strong>sender intended</strong>. </p>

<p>Some businesses may want to get on Gmail's <a href="https://developers.google.com/gmail/promotab/overview">Promotions tab on purpose</a>; it all depends on the sender's needs.</p>


<hr>

<p>Are you ready to explore the dark depths of mailing DNS records? Let's go!</p>


<hr>
<h2>
  <a name="baseline" href="#baseline">
  </a>
  Baseline
</h2>

<p>Previously, I mentioned that I'm familiar with a few DNS records, but that doesn't mean that we're on the same page. So line up!</p>

<div class="table-wrapper-paragraph"><table>
<thead><tr>
<th>Record Type</th>
<th>Target</th>
<th>Example Key Pair Values</th>
</tr></thead>
<tbody>
<tr>
<td>A</td>
<td>IP addresses</td>
<td>Name: virtual-machine.meirg.co.il (For example, <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#ip-addressing-eips" rel="noopener noreferrer">AWS Elastic IP</a>)<br>Value: 123.123.123.123</td>
</tr>
<tr>
<td>CNAME</td>
<td>Canonical name for other domain name</td>
<td>Name: meirg.co.il<br>Value: meirg-website.pages.dev (<a href="https://pages.cloudflare.com/" rel="noopener noreferrer">Cloudflare Pages)</a><br><br>Name: www.meirg.co.il (<a href="https://support.cloudflare.com/hc/en-us/articles/200172286-Configuring-URL-forwarding-or-redirects-with-Cloudflare-Page-Rules" rel="noopener noreferrer">Redirects to meirg.co.il</a>)<br>Value: meirg.co.il</td>
</tr>
<tr>
<td>TXT</td>
<td>Domain validation and authenticity</td>
<td>Name: meirg.co.il (<a href="https://support.google.com/a/answer/183895?hl=en" rel="noopener noreferrer">Google Domain Verification</a>)<br>Value: "google-site-verification=2NOO....XgotefAU"</td>
</tr>
<tr>
<td>MX</td>
<td colspan="2">Let's leave it as a mystery for now<br>(keep your Google Search gun down!)</td>
</tr>
</tbody>
</table></div>
<h2>
  <a name="plot" href="#plot">
  </a>
  Plot
</h2>

<p>I need to improve the email deliverability of outgoing emails. The request first came from the marketing expert of one of my customers, and he told me <em>"We need you for the DNS part."</em></p>

<p>Ok, I'm up for it; let's set up the DNS records and assist my customer in reaching out to his end-users.</p>

<p>But how can I make sure that I succeed? I mean, doing/learning stuff is fun, it really is, but how will I know if my changes impacted my <a href="https://www.sparkpost.com/resources/email-explained/email-sender-reputation/#:~:text=An%20email%20sender%20reputation%20is,an%20organization%20that%20sends%20email.&text=The%20higher%20the%20score%2C%20the,of%20recipients%20on%20their%20network.">email sender reputation</a>? How do I know if there's a better open/click rate for my emails?</p>

<p>The above questions are widespread when the need to send emails arises. That usually comes with many requirements, such as "unsubscribe mechanism", "group contacts by segments", "statistics of open/click", and the list goes on, depending on your marketing manager 😉</p>

<p>Developing a system that can measure open/click rate and handle email/contacts management will take ages to build...</p>

<p>So maybe I should ...</p>
<h2>
  <a name="use-professional-help" href="#use-professional-help">
  </a>
  Use professional help
</h2>

<p>Here comes <a href="https://www.activecampaign.com/glossary/email-service-provider">ESP</a> into play! ESP stands for Email Service Provider, and that means there are cloud providers out there who are willing to send emails on my behalf and enable me to manage the whole email delivery system in a one-stop-shop.</p>

<p>There are many ESPs out there such as <a href="https://workspace.google.com/products/gmail/">Google Workspace</a>, <a href="https://sendgrid.com/">SendGrid</a> and <a href="https://mailchimp.com">Mailchimp</a>. Each provider has its pros and cons, but the common ground is - <strong>they all send emails on behalf of your domain</strong>.</p>

<p>The difference usually comes when an ESP, like SendGrid, offers comprehensive services like <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#using-automated-security">Automated Security</a> which enabled you to purchase <a href="https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses">a dedicated IP</a> as a service (we'll get to that).</p>

<p>We covered ESPs, moving on to getting familiar with industry standards for improving email deliverability.</p>

<blockquote>
<p><strong>NOTE</strong>: I might mention SendGrid a lot during this blog post, though I'm not biased towards any ESP; SendGrid is simply the service I've been using recently, so it's easier for me to make references. Most ESPs offer a free/trial plan so you can explore their features and then decide, and I recommend evaluating at least two ESPs before picking one.</p>
</blockquote>
<h2>
  <a name="standards-for-better-email-delivery" href="#standards-for-better-email-delivery">
  </a>
  Standards For Better Email Delivery
</h2>

<p><a href="https://support.google.com/a/answer/10583557?hl=en&ref_topic=9061731">According to Google</a>, at least four standards should be implemented (in this order) </p>

<ol>
<li>SPF</li>
<li>DKIM</li>
<li>DMARC</li>
<li>(Optional) BIMI</li>
</ol>

<p>And, I'm adding <a href="https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses#what-are-dedicated-ip-addresses">A dedicated IP</a> to the mix.</p>

<p>Mail eXchangers check if the sender meets industry standards by querying its DNS record, and according to that, evaluate the sender's reputation. The sender evaluation process includes other methods, such as looking in <a href="https://multirbl.valli.org/lookup/meirg.co.il.html">https://multirbl.valli.org/</a> to see if the source domain (eventually IP) of the sender is marked as an "official spammer", that all it depends on the Mail eXchanger. The more standards the sender meets, the higher the chances the sender's email message will arrive at its target audience (receiver).</p>

<p>The illustration below is for the <em>SPF</em> record. Still, the same communication process is the same for all standards, where the Receiving Email Server (Mail eXchanger) validates the email sender's authenticity and reputation.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Oo0epkRf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Oo0epkRf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg" alt="spf_mail_flow" loading="lazy" width="800" height="323"></a></p>

<p>Image Source: <a href="https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg">https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg</a></p>
<h3>
  <a name="spf" href="#spf">
  </a>
  SPF
</h3>

<ul>
<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc7208">Sender Policy Framework</a>
</li>
<li>Remember with: <code>S</code> for "<strong>S</strong>ending emails"</li>
</ul>

<p>This record allows ESPs such as SendGrid, Gmail, Mailchimp to send emails on behalf of your domain. So if my domain name is <em>meirg.co.il</em> and I would like to send emails with Google Workspace, I need to add <a href="https://support.google.com/a/answer/10684623?hl=en">Google's SPF</a> record to my domain <em>meirg.co.il</em>.</p>

<p>And the funny thing about an <em>SPF Record</em>, that it's actually a <em>TXT Record</em>. Let me remind you that <em>TXT Records</em> are for "Domain validation and authenticity," so it's nothing more than adding a <em>TXT Record</em> and adding a value that is specific for the <em>SPF</em> standard.</p>

<p>Here's an example for setting up two <em>SPF</em> records, one for <a href="https://support.google.com/a/answer/10685031">Google Workspace</a> and the other for <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#before-you-begin:~:text=HOST/NAME">SendGrid's SPF</a>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code># Google Workspace
Type: TXT
Name: meirg.co.il
Value: v=spf1 include:_spf.google.com ~all

# Sendgrid
Type: TXT
Name: em123.meirg.co.il
Value: u12345678.wl123.sendgrid.net
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Notice the weird thing? <code>Google Workspace</code> has an <a href="https://dmarcian.com/spf-syntax-table/">SPF expression</a>, while <code>SendGrid</code> provides a <em>CNAME</em> as a value in the <em>TXT</em> record. My gut told me that the <em>CNAME</em> should eventually resolve to an <em>SPF expression</em>, so I checked it with <a href="https://tools.wordtothewise.com/authentication">Authentication @ tools.wordtothewise.com</a>.</p>

<p>I tested it by navigating to <code>https://tools.wordtothewise.com/dns/txt/em123.meirg.co.il</code>, which resolved in ... Drums ... <code>u12345678.wl123.sendgrid.net</code> as a <em>TXT</em> record which contains the following expression.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code># SendGrid's CNAME resolves to SPF expression
v=spf1 ip4:122.122.122.122 -all
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>It is quite a wonder that eventually, it's <code>ip4:122.122.122.122</code> and not a CNAME, as we saw in Google Workspace <code>include:_spf.google.com</code>. This wonder is called a <a href="https://postmarkapp.com/blog/how-to-check-your-ip-reputation#why-is-ip-reputation-important">dedicated IP</a>.</p>

<p>Declaring an <em>SPF Record</em>, or any other record that is related to mailing, usually comes with a complete guide on how to create it, check <a href="https://support.google.com/a/answer/10685031">Google Workspace Basic Setup for SPF</a> which also explains <a href="https://support.google.com/a/answer/10685031#:~:text=servers.mail.net">how to include multiple ESPs in a single SPF Record</a>.</p>

<h3>
  <a name="when-should-i-use-a-single-spf-expression" href="#when-should-i-use-a-single-spf-expression">
  </a>
  When should I use a single SPF expression?
</h3>

<p>Getting back to my previous example of Google Workspace and SendGrid; Luckily, SendGrid provides a particular <em>TXT Record</em>, which includes a unique subdomain, <em>em123</em>; this makes the setup is really nice since you don't modify existing with the fear of breaking something.</p>

<p>Assuming your ESP*<em>s</em>* required the <em>TXT Record</em> of <em>SPF</em> to be present in the root domain, e.g., <em>meirg.co.il</em>, you'll have to edit your existing <em>SPF expression</em> and add additional ESPs. For example, here's how you would write an <em>SPF expression</em> when using both Google Workspace and <a href="https://www.mailgun.com/">Mailgun</a>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code># Google Workspace + Mailgun
Type: TXT
Name: meirg.co.il
Value: v=spf1 include:_spf.google.com include:mailgun.org ~all
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<blockquote>
<p><strong>NOTE</strong>: Regarding which ESP you should choose (Google/SendGrid/Mailchimp/Mailgun, etc.), it depends on your needs. I use Google Workspace for receiving/sending emails on behalf of <em>human beings</em> who use <code>@meirg.co.il</code> and SendGrid for sending automated emails with my web application <code>@meirg.co.il</code>. By the way, <a href="https://mailchimp.">Mailchimp</a> is also excellent, I used it a long time ago, and I truly enjoyed it.</p>
</blockquote>

<h3>
  <a name="recap-on-spf" href="#recap-on-spf">
  </a>
  Recap on SPF
</h3>

<p>A <em>TXT</em> record that contains an <a href="https://dmarcian.com/spf-syntax-table/">SPF expression</a> or a <em>CNAME</em> that is eventually resolved to an <em>SPF expression</em>. The <em>SPF expression</em> contains an authorization policy about which service can send emails on your domain's behalf.</p>

<blockquote>
<p><strong>IMPORTANT</strong> Make sure you send emails from the same address that you've authenticated in the ESP (SendGrid, Google), for example, <strong>DO NOT TRY THE FOLLOWING</strong>, sending emails from <em><a href="mailto:no-reply@meirg.com">no-reply@meirg.com</a></em>. In contrast, my authenticated domain address is <em>meirg.co.il</em>. That can easily happen if you're using <a href="https://docs.sendgrid.com/ui/account-and-settings/api-keys">SendGrid - API keys to send emails</a> since the <em>FROM</em> field is not protected, the API call can "endure" anything you shove it.</p>
</blockquote>

<h3>
  <a name="dkim" href="#dkim">
  </a>
  DKIM
</h3>

<ul>
<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc6376">DomainKeys Identified Mail (Signatures)</a>
</li>
<li>Remember with: <code>K</code> for <strong>K</strong>eys.</li>
</ul>

<p>This one is going to be very short compared to <em>SPF</em> since we've already covered all basics,</p>

<p>I like to think about <em>DKIM</em> as the HTTPS of emails. So <em>DKIM</em> is a way for an email sender to <a href="https://support.google.com/a/answer/174124?hl=en">increase authenticity by adding a signature to the headers of an email message</a>.</p>

<blockquote>
<p>"...DKIM adds an encrypted signature to the header of all outgoing messages. Email servers (Mail eXchangers) that get signed messages use DKIM to decrypt the message header and verify the message was not changed after it was sent."</p>
</blockquote>

<p>Here's how the <em>DKIM</em> record looks for my domain <em>meirg.co.il</em>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>Type: TXT
Name: google._domainkey.meirg.co.il
Value: v=DKIM1; k=rsa; p=Ultra-Long-Key-PUBLIC-KEY-392-chars
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The subdomain <code>google._domainkey</code> was <a href="https://support.google.com/a/answer/174126?hl=en&ref_topic=2752442">generated by Google</a> for my domain <em>meirg.co.il</em>. After generating the <em>DKIM</em> record, I followed the instructions and authenticated my domain by adding a <em>TXT</em> record with the value provided by Google.</p>

<p>If I intend to use other ESPs, I can generate a subdomain per ESP, so <a href="https://docs.sendgrid.com/ui/account-and-settings/dkim-records#example-dkim-record-automated-security-off">for SendGrid, it'll be s1._domainkey</a>.</p>

<p>As you can see, the <code>*._domainkey</code> is the critical value, as that's the one that the Mail eXchanger is checking. So if a DNS record, such as <em>TXT</em> or <em>CNAME</em>, is named with <code>_domainkey</code>, you can classify it safely as <em>DKIM</em>. The <code>*._domainkey</code> prefix, such as <code>google</code> and <code>s1</code>, is called a selector. One domain can have multiple <em>DKIM</em> selectors when using various ESPs.</p>

<blockquote>
<p><strong>NOTE</strong>: Curious about my public key? Dig for it! <code>dig TXT google._domainkey.meirg.co.il</code></p>
</blockquote>

<h3>
  <a name="dmarc-here-comes-dmarc-tu-du-du-du" href="#dmarc-here-comes-dmarc-tu-du-du-du">
  </a>
  DMARC - Here comes D-MARC tu du du du
</h3>

<ul>
<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc7489">Domain-based Message Authentication, Reporting & Conformance</a>
</li>
<li>Remember with: <code>DM</code> "<strong>D</strong>omain <strong>M</strong>onitoring" and <code>D-MARC</code> like "the man(ager)"</li>
</ul>

<p>We covered <em>SPF</em> and <em>DKIM</em>, but how do we know that our email messages are authenticated with <em>SPF</em> and signed with <em>DKIM</em>? Is there a way to track down it down with numbers? There is.</p>

<p><a href="https://dmarc.org/">DMARC</a> is an email authentication standard - Meeting up this standard means your <em>SPF</em> and <em>DKIM</em> domain records are legit. How does it mean that they're legit, you ask?</p>

<ul>
<li>Once a day, a <a href="https://mxtoolbox.com/dmarc/details/what-do-dmarc-reports-look-like">DMARC Report</a> is sent to a predefined mailbox. The report contains pass/fail attempts of <em>SPF</em> and <em>DKIM</em>.</li>
<li>
<em>DMARC</em> has the <a href="https://dmarcian.com/policy-modes-quarantine-vs-reject/#:~:text=p=reject">reject policy</a>, so if a sender attempts to send an email and both <em>SPF</em> and <em>DKIM</em> checks didn't pass, the receiver (recipient) would not get the message. </li>
<li>Furthermore, <em>DMARC</em> helps to authenticate the sender's identity since <em>SPF</em> requires a <em>TXT</em> record to exist in the sender's domain containing valid domains or IPs (usually of an ESP), and a <em>TXT</em> (or <em>CNAME</em>) record for <em>DKIM</em> which includes a public key that was given to sender by the ESP.</li>
</ul>

<p>Here's how a <em>DMARC Record</em> looks like<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>Type: TXT
Name: _dmarc.meirg.co.il
Value: v=DMARC1; p=none; rua=mailto:meir+dmarc_agg@meirg.co.il, mailto:dmarc_agg@vali.email
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>The <code>p=none</code> is the declared policy, which is nothing. Having no policy at all is almost the same as not having a <em>DMARC</em> record. A proper <em>DMARC</em> record would be <code>p=reject</code>.</p>

<p>So why am I using <code>p=none</code>, you ask? Because I'm still not 100% sure that my outgoing email messages pass both <em>SPF</em> and <em>DKIM</em> by Mail eXchangers. Having <code>p=reject</code> would block my messages completely, so for testing purposes, start with <code>p=none</code>, and once you're sure that all your emails pass both <em>SPF</em> and <em>DKIM</em>, set the policy to <code>p=reject</code>.</p>

<p>Sounds great, but how can you check all that? It sounds tough.</p>

<p>See the <code>rua</code> key in the code snippet above; I added <code>+dmarc_agg</code> to my email address and <a href="https://support.google.com/mail/answer/6579?hl=en#zippy=%2Ccreate-a-filter">created a filter in Gmail</a>, so any message coming from <em><a href="mailto:meirg+dmarc_agg@meirg.co.il">meirg+dmarc_agg@meirg.co.il</a></em> is tagged as <code>dmarc-report</code>. Remember that I mentioned that a daily <em>DMARC</em> report is sent to a "predefined email address"? that is it.</p>

<p>But do I want to analyze <em>DMARC</em> reports on my own? Yup, you guessed it, there's an excellent service that can do that for free, and it's called  <a href="https://www.valimail.com/">ValiMail</a>. ValiMail gets the daily report and analyzes it by checking how many <em>SPF</em> and <em>DKIM</em> successes/failures occurred in the past 24 hours and presents the summary in a friendly dashboard.</p>

<p><a href="https://www.valimail.com/partners/">ValiMail are partnered with many known organizations</a>, such as Microsoft, Google, and SendGrid,  so I consider them a trusted vendor.</p>

<blockquote>
<p><strong>NOTE</strong>: The silent <code>dmarc_agg@vali.email</code> in the <code>rua</code> key points to ValiMail's mailbox.</p>
</blockquote>

<h2>
  <a name="bimi-requires-dmarc" href="#bimi-requires-dmarc">
  </a>
  BIMI - Requires DMARC
</h2>

<ul>
<li>Definition: <a href="https://tools.ietf.org/id/draft-blank-ietf-bimi-00.txt">Brand Indicators for Message Identification</a>
</li>
<li>Remember with: <strong>B</strong> for <strong>B</strong>ragging to our audience/receivers that we're a top-notch validated sender.</li>
</ul>

<p>Reminding you that <em>DMARC</em> has the "reject policy", so if an email sender sets it to <code>p=reject, pct=100</code> (or <code>p=quarantine</code>), <strong>ALL</strong> none qualifying emails (SPF+DKIM) will not be delivered. So, cool, who enforces it? <em>BIMI</em>! </p>

<p><a href="https://bimigroup.org/all-about-bimi/#:~:text=How%20do%20I%20Implement%20BIMI?">Qualifying for BIMI</a> requires registering a trademark in a known patent agency and then purchasing a Verified Mark Certificate (VMC) from <a href="https://www.digicert.com/tls-ssl/verified-mark-certificates">DigiCert</a> or <a href="https://www.entrust.com/digital-security/certificate-solutions/products/digital-certificates/verified-mark-certificates">Entrust</a> So, meeting the BIMI standard is not that simple.</p>

<p>And of course, it is possible to partially meet <a href="https://bimigroup.org/bimi-for-non-trademarked-logos/">BIMI for non-trademarked logos</a>. However, since <em>BIMI</em> is still not enforced or <a href="https://bimigroup.org/bimi-infographic/">widely recognized by Mail eXchangers</a>, I consider it a nice-to-have, and I'll get to it once I'll implement it once I get enough data from the <em>DMARC</em> reports.</p>

<p>To my feeling, it'll be easier to qualify today for <em>BIMI</em> than it will be in a few years. If you spot a fully certified <em>BIMI</em> email sender, it means it is ... Genuine and can be trusted.</p>

<h2>
  <a name="mysterious-mx" href="#mysterious-mx">
  </a>
  Mysterious MX
</h2>

<ul>
<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc974">Mail Exchanger</a>
</li>
<li>Remember with: Gmail is a Mail Exchanger, Google Workspace is an ESP</li>
</ul>

<p>Finally, we got to MX; in case you haven't noticed, I wrote "Mail eXchangers" each time I had to mention a mail exchanger. You've just learned that <em>MX Record</em> stands for <strong>M</strong>ail e*<em>X</em>*changers that are allowed to receive emails on your behalf.</p>

<p>Since <em>MX Records</em> are for receiving emails and not sending, see my <a href="https://stackoverflow.com/questions/46113231/receiving-email-is-not-working-in-amazon-ses/62452983#62452983">stackoverflow answer</a> on how to configure <em>MX Records</em> for <a href="https://aws.amazon.com/ses/">AWS Simple Email Service (SES)</a> and the things that I've learned during the process.</p>

<p>To see how an <em>MX Record</em> looks like, check mine with <a href="https://mxtoolbox.com/SuperTool.aspx?action=mx%3ameirg.co.il&run=toolpage">mxtoolbox.com</a>.</p>

<h2>
  <a name="gmail-is-a-mail-exchanger" href="#gmail-is-a-mail-exchanger">
  </a>
  Gmail is a Mail eXchanger
</h2>

<p>How do you send emails from your Gmail account if it's only receiving messages with a Mail eXchanger? </p>

<p>As part of being Gmail's client, you can send emails on behalf of <code>@gmail.com</code>. That is set behind the scenes by Gmail's engineers, so each time you send an email using Gmail's UI, or use <a href="https://developers.google.com/gmail/api">Gmail's API</a>, the emails that you send are signed with Gmail's signature, which includes <em>SPF</em>, <em>DKIM</em>, <em>DMARC</em>. That is why your emails are not marked as spam when you email your friends and family since most Mail Exchangers treat <code>@gmail.com</code> as a high reputation sender.</p>

<h2>
  <a name="strengthen-your-knowledge" href="#strengthen-your-knowledge">
  </a>
  Strengthen your knowledge
</h2>

<h3>
  <a name="name-all-the-standards-and-provide-a-short-description" href="#name-all-the-standards-and-provide-a-short-description">
  </a>
  Name all the standards and provide a short description
</h3>

<p>All records refer to the email sender's domain.</p>

<ol>
<li>
<strong>SPF</strong> - TXT record, which contains the allowed sources, domains or IPs, to send emails on behalf of an email sender.</li>
<li>
<strong>DKIM</strong> - TXT/CNAME record, which contains a key generated by an ESP. I consider <em>DKIM</em> an HTTPS mechanism for emails, which uses the <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography</a> to authenticate messages.</li>
<li>
<strong>DMARC</strong> - TXT record, which contains the receiver of the daily reports. This record is not just for setting the receiver, and it also means that Mail eXchangers will check this record and act according to the rules in it. So if <em>SPF</em> and <em>DKIM</em> is not set, some email messages might not arrive at their destination.</li>
<li>
<strong>BIMI</strong> - TXT record, which contains a URL to an SVG logo of the email sender, and a URL of the Verified Mark Certificate (VMC) that the email sender purchased. And of course, this is how email senders can <strong>b</strong>rag that they're legit in front of their customers.</li>
</ol>

<h3>
  <a name="how-do-i-check-if-my-domain-is-a-trusted-email-sender" href="#how-do-i-check-if-my-domain-is-a-trusted-email-sender">
  </a>
  How do I check if my domain is a trusted email sender?
</h3>

<p>Check if your DMARC record is valid with <a href="https://tools.wordtothewise.com">https://tools.wordtothewise.com</a>.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>https://tools.wordtothewise.com/dmarc/check/DOMAIN_NAME
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Hooray for Google Workspace customers - there's a dedicated online tool for checking whether your mailing DNS records are correctly set for Google Workspace ESP; here are my results <a href="https://toolbox.googleapps.com/apps/checkmx/check?domain=meirg.co.il&dkim_selector=">meirg.co.il - Google Check MX Status</a></p>

<blockquote>
<p><strong>IMPORTANT</strong>: Do not be fooled; Google Workspace's tool is valid only if you're checking Google as an ESP. If you use this service on a Sendgrid domain, it will show many errors.</p>
</blockquote>

<h3>
  <a name="how-do-i-read-a-dmarc-expression" href="#how-do-i-read-a-dmarc-expression">
  </a>
  How do I read a DMARC expression?
</h3>

<p>The syntax of how to read/write a <em>DMARC expression</em> can be found in <a href="https://datatracker.ietf.org/doc/html/rfc7489#section-6.3">RFC7489 - Domain-based Message Authentication, Reporting, and Conformance (DMARC)</a>. Another excellent source for understanding the syntax is <a href="https://support.google.com/a/answer/2466563?hl=en">Google's tutorial on the DMARC record format</a></p>

<p>Let's inspect <a href="https://tools.wordtothewise.com/dmarc/check/gmail.com">@gmail.com's DMARC record</a> together<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>v=DMARC1; p=none; sp=quarantine; rua=mailto:mailauth-reports@google.com
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<ul>
<li><p>p=none - all emails, regardless if they're validated with SPF+DKIM, can get to the receiver</p></li>
<li><p>sp=quarantine - all emails sent from subdomains, e.g. <code>subdomain.gmail.com</code> and are not signed with SPF+DKIM are marked as spam in the receiver's mailbox. <code>sp</code> stands for subdomain-policy and overrides <code>p</code> rules for subdomains.</p></li>
<li><p>rua=mailto - It appears that Gmail is handling their DMARC reports internally since the reporting address belongs to @google.com. So I guess they have their own "analyzing and monitoring DMARC reports" system, kewl.</p></li>
</ul>

<p>Inpsecting <a href="https://tools.wordtothewise.com/dmarc/check/yahoo.com">@yahoo.com's DMARC</a> record<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight plaintext"><code>v=DMARC1; p=reject; pct=100; rua=mailto:d@rua.agari.com; mailto:d@ruf.agari.com;
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<ul>
<li><p>p=reject - all emails that are not signed with SPF+DKIM are rejected.</p></li>
<li><p>pct=100 - the percentage of messages to apply the <code>p</code> policy. In this case, if it's not signed with SPF+DKIM, it's not getting to the receiver at all, very restrictive</p></li>
</ul>


<hr>

<p>It's fascinating to see how different enterprise-grade email senders are setting up their DMARC records. It might look like Gmail is very permissive with their <code>p=none</code> policy, but I'm sure they have a dedicated backend that filters out spam messages before they arrive at their customers' mailboxes.</p>

<h3>
  <a name="bonus-can-gmail-customers-check-the-senders-validity-in-the-ui" href="#bonus-can-gmail-customers-check-the-senders-validity-in-the-ui">
  </a>
  Bonus - Can Gmail customers check the sender's validity in the UI?
</h3>

<p>Yes, yes, YES!</p>

<p>Eventually, an email message contains text, and this text instructs the Mail eXchanger how to validate the message's sender, process referenced images to be shown in the UI, etc.</p>

<p>Gmail made it very easy to check, click the ellipsis, and then <strong>Show Original</strong>.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--fDB57GWW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m98pmz51gddg9yzm5cux.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--fDB57GWW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m98pmz51gddg9yzm5cux.png" alt="gmail-show-original-cloudflare" loading="lazy" width="880" height="514"></a></p>

<p>That results in a very long page that contains the whole email message, though Gmail made it very easy to track the important things, such as if <strong>DMARC</strong> is valid.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--V46OsjOB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1n99igk91x7uk0w7lex0.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--V46OsjOB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1n99igk91x7uk0w7lex0.png" alt="cloudflare-dmarc-check" loading="lazy" width="880" height="426"></a></p>

<p>After reading this blog post, you've just learned that checking <em>DMARC</em> is enough since it relies on both <em>SPF</em> and <em>DKIM</em>.</p>

<h2>
  <a name="dedicated-ip" href="#dedicated-ip">
  </a>
  Dedicated IP
</h2>

<p>Psst! Glad to see that you've read it all; This blog post is long enough, so here's a great resource that can help you decide whether to purchase a dedicated IP or not - <a href="https://www.m3aawg.org/sites/default/files/document/M3AAWG_Senders_BCP_Ver3-2015-02.pdf">3.4 Shared vs. Dedicated IPs, M3AAWG Sender Best Common Practices v3.0, Feb 2015</a>.</p>

<p>In short, if you're sending high volumes, <a href="https://sendgrid.com/resource/how-to-send-high-volume-email-sendgrids-smart-scaling-guide-2/#:~:text=Dedicated%20IPs">hundreds of thousands of emails a month</a>, then you should purchase a dedicated IP. I hate it when it all ends up with "it depends on your needs", but hey, that's true.</p>

<h2>
  <a name="final-words" href="#final-words">
  </a>
  Final Words
</h2>

<p>I admit that it was tough and felt like there's a lot to memorize, but once you truly understand how each components works, it's pretty nice and very not intimidating as it was. So enjoy setting up your mailing DNS records. That would be all.</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/unfor19/improving-email-deliverability-with-dns-records-38ep" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(e,t,a,n){return a.type_of="article",a.id=909385,a.title="Improving email deliverability with DNS records",a.description="As always, every day brings up new challenges, and today I faced one of my greatest fears - dealing...",a.readable_publish_date="Nov 26 '21",a.slug="improving-email-deliverability-with-dns-records-38ep",a.path="/unfor19/improving-email-deliverability-with-dns-records-38ep",a.url="https://dev.to/unfor19/improving-email-deliverability-with-dns-records-38ep",a.comments_count=0,a.public_reactions_count=4,a.collection_id=e,a.published_timestamp=t,a.positive_reactions_count=4,a.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--fay2oiYo--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yg8pl2zj6ioozm5jdw22.png",a.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--MDpi60BJ--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yg8pl2zj6ioozm5jdw22.png",a.canonical_url="https://meirg.co.il/2021/11/26/improving-email-deliverability-with-dns-records/",a.created_at="2021-11-25T23:18:26Z",a.edited_at="2021-12-01T22:57:15Z",a.crossposted_at=e,a.published_at=t,a.last_comment_at=t,a.reading_time_minutes=17,a.tag_list="tutorial, email, dns, network",a.tags=["tutorial","email","dns","network"],a.body_html='<p>As always, every day brings up new challenges, and today I faced one of my greatest fears - dealing with mailing DNS records.</p>\n\n<p>Up until today, I was only familiar with <em>A Record</em>, <em>CNAME Record</em>, and <em>TXT Record</em>. A while ago, I used the <em>MX Record</em> while setting up my mailbox for my domain, but I don\'t quite remember its purpose, but enough about me.</p>\n\n<p>Mail eXchangers, such as Gmail, Yahoo, Outlook, check the validity of incoming email messages. As part of the validation process, the Mail eXchanger queries the DNS records of the sender and evaluates the sender\'s reputation.</p>\n\n<p>The sender\'s reputation affects how the Mail eXchanger classifies the message and whether or not it should be marked as spam before it is delivered to the receiver. In some cases, the message is blocked entirely by the Mail eXchanger, and the receiver is unaware of it.</p>\n\n<h2>\n  <a name="the-reputation" href="#the-reputation">\n  </a>\n  The Reputation\n</h2>\n\n<p>There are many algorithms out there for evaluating an email sender\'s reputation. To put it on a scale, I classified the reputation level into four levels - <em>Very Low</em>, <em>Low</em>, <em>Standard</em>, and <em>Best</em>.</p>\n\n<h3>\n  <a name="very-low" href="#very-low">\n  </a>\n  Very Low\n</h3>\n\n<p>Blocked completely without even bothering the receiver, here are two common error messages that may appear in the ESP\'s logs if the sender\'s email has sent too many emails in a short period.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>421 4.7.0 [TS01] Messages from &lt;1.2.3.4&gt; temporarily deferred due to user complaints\n&lt;1.2.3.4&gt; ;see http://postmaster.yahoo.com/421-ts01.html\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>553 5.7.1 [BL21] Connections will not be accepted from 1.2.3.4,\n    because the ip is in Spamhaus\'s list; \nsee http://postmaster.yahoo.com/550-bl23.html\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p><a href="https://glockapps.com/blog/remove-ip-address-yahoo-blacklist/">Above snippets from - glockapps.com - How To Remove Your IP From Yahoo Blacklist – Yahoo Blacklist Checker<br>\n</a></p>\n\n<p>If there\'s a need to send large volumes of email messages, it is recommended to purchase a <a href="https://docs.sendgrid.com/ui/sending-email/warming-up-an-ip-address">dedicated IP with a warm-up mechanism</a>. The subject is broadly explained in the provided link, though in short, it\'s another method of identifying yourself as a trusted sender, by saying:</p>\n\n<blockquote>\n<p>"I own a unique IP address because I\'m confident that Mail eXchangers won\'t block me. I know that it\'s easy to block an IP address, so yeah, I\'m that confident."</p>\n</blockquote>\n<h3>\n  <a name="low-reputation" href="#low-reputation">\n  </a>\n  Low Reputation\n</h3>\n\n<p>Emails are marked as spam due to the low authenticity of the sender or previous reports of other users. But, most of the time, it\'s because the content of the message is not specific enough to the receiver.</p>\n\n<p>For example, Willy is a Gmail customer, and he is interested in computer science and surfing. Then, out of the blue, Willy receives an email message about a great body lotion for women. Though Willy may have subscribed to some cosmetics stores websites, if the message isn\'t specific enough, like "Hi Willy," then it <strong>might</strong> be marked as spam.</p>\n\n<p>Send the relevant content to the appropriate audience to avoid getting here.</p>\n<h3>\n  <a name="standard-reputation" href="#standard-reputation">\n  </a>\n  Standard Reputation\n</h3>\n\n<p>Email messages are getting to the client\'s mailbox as they should, though, in some Mail eXchangers such as Gmail, messages could move to the <a href="https://developers.google.com/gmail/promotab/faq#why_do_i_see_my_email_in_a_bundle_and_i_have_not_added_the_annotation">Promotions tab</a>, while it wasn\'t intended.</p>\n\n<blockquote>\n<p>"... Gmail will recommend emails based on previous user engagement, regardless of whether annotations are present."</p>\n</blockquote>\n<h3>\n  <a name="best-reputation" href="#best-reputation">\n  </a>\n  Best Reputation\n</h3>\n\n<p>Email messages are getting to the client\'s mailbox as the <strong>sender intended</strong>. </p>\n\n<p>Some businesses may want to get on Gmail\'s <a href="https://developers.google.com/gmail/promotab/overview">Promotions tab on purpose</a>; it all depends on the sender\'s needs.</p>\n\n\n<hr>\n\n<p>Are you ready to explore the dark depths of mailing DNS records? Let\'s go!</p>\n\n\n<hr>\n<h2>\n  <a name="baseline" href="#baseline">\n  </a>\n  Baseline\n</h2>\n\n<p>Previously, I mentioned that I\'m familiar with a few DNS records, but that doesn\'t mean that we\'re on the same page. So line up!</p>\n\n<div class="table-wrapper-paragraph"><table>\n<thead><tr>\n<th>Record Type</th>\n<th>Target</th>\n<th>Example Key Pair Values</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>A</td>\n<td>IP addresses</td>\n<td>Name: virtual-machine.meirg.co.il (For example, <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#ip-addressing-eips" rel="noopener noreferrer">AWS Elastic IP</a>)<br>Value: 123.123.123.123</td>\n</tr>\n<tr>\n<td>CNAME</td>\n<td>Canonical name for other domain name</td>\n<td>Name: meirg.co.il<br>Value: meirg-website.pages.dev (<a href="https://pages.cloudflare.com/" rel="noopener noreferrer">Cloudflare Pages)</a><br><br>Name: www.meirg.co.il (<a href="https://support.cloudflare.com/hc/en-us/articles/200172286-Configuring-URL-forwarding-or-redirects-with-Cloudflare-Page-Rules" rel="noopener noreferrer">Redirects to meirg.co.il</a>)<br>Value: meirg.co.il</td>\n</tr>\n<tr>\n<td>TXT</td>\n<td>Domain validation and authenticity</td>\n<td>Name: meirg.co.il (<a href="https://support.google.com/a/answer/183895?hl=en" rel="noopener noreferrer">Google Domain Verification</a>)<br>Value: "google-site-verification=2NOO....XgotefAU"</td>\n</tr>\n<tr>\n<td>MX</td>\n<td colspan="2">Let\'s leave it as a mystery for now<br>(keep your Google Search gun down!)</td>\n</tr>\n</tbody>\n</table></div>\n<h2>\n  <a name="plot" href="#plot">\n  </a>\n  Plot\n</h2>\n\n<p>I need to improve the email deliverability of outgoing emails. The request first came from the marketing expert of one of my customers, and he told me <em>"We need you for the DNS part."</em></p>\n\n<p>Ok, I\'m up for it; let\'s set up the DNS records and assist my customer in reaching out to his end-users.</p>\n\n<p>But how can I make sure that I succeed? I mean, doing/learning stuff is fun, it really is, but how will I know if my changes impacted my <a href="https://www.sparkpost.com/resources/email-explained/email-sender-reputation/#:~:text=An%20email%20sender%20reputation%20is,an%20organization%20that%20sends%20email.&amp;text=The%20higher%20the%20score%2C%20the,of%20recipients%20on%20their%20network.">email sender reputation</a>? How do I know if there\'s a better open/click rate for my emails?</p>\n\n<p>The above questions are widespread when the need to send emails arises. That usually comes with many requirements, such as "unsubscribe mechanism", "group contacts by segments", "statistics of open/click", and the list goes on, depending on your marketing manager 😉</p>\n\n<p>Developing a system that can measure open/click rate and handle email/contacts management will take ages to build...</p>\n\n<p>So maybe I should ...</p>\n<h2>\n  <a name="use-professional-help" href="#use-professional-help">\n  </a>\n  Use professional help\n</h2>\n\n<p>Here comes <a href="https://www.activecampaign.com/glossary/email-service-provider">ESP</a> into play! ESP stands for Email Service Provider, and that means there are cloud providers out there who are willing to send emails on my behalf and enable me to manage the whole email delivery system in a one-stop-shop.</p>\n\n<p>There are many ESPs out there such as <a href="https://workspace.google.com/products/gmail/">Google Workspace</a>, <a href="https://sendgrid.com/">SendGrid</a> and <a href="https://mailchimp.com">Mailchimp</a>. Each provider has its pros and cons, but the common ground is - <strong>they all send emails on behalf of your domain</strong>.</p>\n\n<p>The difference usually comes when an ESP, like SendGrid, offers comprehensive services like <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#using-automated-security">Automated Security</a> which enabled you to purchase <a href="https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses">a dedicated IP</a> as a service (we\'ll get to that).</p>\n\n<p>We covered ESPs, moving on to getting familiar with industry standards for improving email deliverability.</p>\n\n<blockquote>\n<p><strong>NOTE</strong>: I might mention SendGrid a lot during this blog post, though I\'m not biased towards any ESP; SendGrid is simply the service I\'ve been using recently, so it\'s easier for me to make references. Most ESPs offer a free/trial plan so you can explore their features and then decide, and I recommend evaluating at least two ESPs before picking one.</p>\n</blockquote>\n<h2>\n  <a name="standards-for-better-email-delivery" href="#standards-for-better-email-delivery">\n  </a>\n  Standards For Better Email Delivery\n</h2>\n\n<p><a href="https://support.google.com/a/answer/10583557?hl=en&amp;ref_topic=9061731">According to Google</a>, at least four standards should be implemented (in this order) </p>\n\n<ol>\n<li>SPF</li>\n<li>DKIM</li>\n<li>DMARC</li>\n<li>(Optional) BIMI</li>\n</ol>\n\n<p>And, I\'m adding <a href="https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses#what-are-dedicated-ip-addresses">A dedicated IP</a> to the mix.</p>\n\n<p>Mail eXchangers check if the sender meets industry standards by querying its DNS record, and according to that, evaluate the sender\'s reputation. The sender evaluation process includes other methods, such as looking in <a href="https://multirbl.valli.org/lookup/meirg.co.il.html">https://multirbl.valli.org/</a> to see if the source domain (eventually IP) of the sender is marked as an "official spammer", that all it depends on the Mail eXchanger. The more standards the sender meets, the higher the chances the sender\'s email message will arrive at its target audience (receiver).</p>\n\n<p>The illustration below is for the <em>SPF</em> record. Still, the same communication process is the same for all standards, where the Receiving Email Server (Mail eXchanger) validates the email sender\'s authenticity and reputation.</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Oo0epkRf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Oo0epkRf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg" alt="spf_mail_flow" loading="lazy" width="800" height="323"></a></p>\n\n<p>Image Source: <a href="https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg">https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg</a></p>\n<h3>\n  <a name="spf" href="#spf">\n  </a>\n  SPF\n</h3>\n\n<ul>\n<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc7208">Sender Policy Framework</a>\n</li>\n<li>Remember with: <code>S</code> for "<strong>S</strong>ending emails"</li>\n</ul>\n\n<p>This record allows ESPs such as SendGrid, Gmail, Mailchimp to send emails on behalf of your domain. So if my domain name is <em>meirg.co.il</em> and I would like to send emails with Google Workspace, I need to add <a href="https://support.google.com/a/answer/10684623?hl=en">Google\'s SPF</a> record to my domain <em>meirg.co.il</em>.</p>\n\n<p>And the funny thing about an <em>SPF Record</em>, that it\'s actually a <em>TXT Record</em>. Let me remind you that <em>TXT Records</em> are for "Domain validation and authenticity," so it\'s nothing more than adding a <em>TXT Record</em> and adding a value that is specific for the <em>SPF</em> standard.</p>\n\n<p>Here\'s an example for setting up two <em>SPF</em> records, one for <a href="https://support.google.com/a/answer/10685031">Google Workspace</a> and the other for <a href="https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#before-you-begin:~:text=HOST/NAME">SendGrid\'s SPF</a>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code># Google Workspace\nType: TXT\nName: meirg.co.il\nValue: v=spf1 include:_spf.google.com ~all\n\n# Sendgrid\nType: TXT\nName: em123.meirg.co.il\nValue: u12345678.wl123.sendgrid.net\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Notice the weird thing? <code>Google Workspace</code> has an <a href="https://dmarcian.com/spf-syntax-table/">SPF expression</a>, while <code>SendGrid</code> provides a <em>CNAME</em> as a value in the <em>TXT</em> record. My gut told me that the <em>CNAME</em> should eventually resolve to an <em>SPF expression</em>, so I checked it with <a href="https://tools.wordtothewise.com/authentication">Authentication @ tools.wordtothewise.com</a>.</p>\n\n<p>I tested it by navigating to <code>https://tools.wordtothewise.com/dns/txt/em123.meirg.co.il</code>, which resolved in ... Drums ... <code>u12345678.wl123.sendgrid.net</code> as a <em>TXT</em> record which contains the following expression.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code># SendGrid\'s CNAME resolves to SPF expression\nv=spf1 ip4:122.122.122.122 -all\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>It is quite a wonder that eventually, it\'s <code>ip4:122.122.122.122</code> and not a CNAME, as we saw in Google Workspace <code>include:_spf.google.com</code>. This wonder is called a <a href="https://postmarkapp.com/blog/how-to-check-your-ip-reputation#why-is-ip-reputation-important">dedicated IP</a>.</p>\n\n<p>Declaring an <em>SPF Record</em>, or any other record that is related to mailing, usually comes with a complete guide on how to create it, check <a href="https://support.google.com/a/answer/10685031">Google Workspace Basic Setup for SPF</a> which also explains <a href="https://support.google.com/a/answer/10685031#:~:text=servers.mail.net">how to include multiple ESPs in a single SPF Record</a>.</p>\n\n<h3>\n  <a name="when-should-i-use-a-single-spf-expression" href="#when-should-i-use-a-single-spf-expression">\n  </a>\n  When should I use a single SPF expression?\n</h3>\n\n<p>Getting back to my previous example of Google Workspace and SendGrid; Luckily, SendGrid provides a particular <em>TXT Record</em>, which includes a unique subdomain, <em>em123</em>; this makes the setup is really nice since you don\'t modify existing with the fear of breaking something.</p>\n\n<p>Assuming your ESP*<em>s</em>* required the <em>TXT Record</em> of <em>SPF</em> to be present in the root domain, e.g., <em>meirg.co.il</em>, you\'ll have to edit your existing <em>SPF expression</em> and add additional ESPs. For example, here\'s how you would write an <em>SPF expression</em> when using both Google Workspace and <a href="https://www.mailgun.com/">Mailgun</a>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code># Google Workspace + Mailgun\nType: TXT\nName: meirg.co.il\nValue: v=spf1 include:_spf.google.com include:mailgun.org ~all\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<blockquote>\n<p><strong>NOTE</strong>: Regarding which ESP you should choose (Google/SendGrid/Mailchimp/Mailgun, etc.), it depends on your needs. I use Google Workspace for receiving/sending emails on behalf of <em>human beings</em> who use <code>@meirg.co.il</code> and SendGrid for sending automated emails with my web application <code>@meirg.co.il</code>. By the way, <a href="https://mailchimp.">Mailchimp</a> is also excellent, I used it a long time ago, and I truly enjoyed it.</p>\n</blockquote>\n\n<h3>\n  <a name="recap-on-spf" href="#recap-on-spf">\n  </a>\n  Recap on SPF\n</h3>\n\n<p>A <em>TXT</em> record that contains an <a href="https://dmarcian.com/spf-syntax-table/">SPF expression</a> or a <em>CNAME</em> that is eventually resolved to an <em>SPF expression</em>. The <em>SPF expression</em> contains an authorization policy about which service can send emails on your domain\'s behalf.</p>\n\n<blockquote>\n<p><strong>IMPORTANT</strong> Make sure you send emails from the same address that you\'ve authenticated in the ESP (SendGrid, Google), for example, <strong>DO NOT TRY THE FOLLOWING</strong>, sending emails from <em><a href="mailto:no-reply@meirg.com">no-reply@meirg.com</a></em>. In contrast, my authenticated domain address is <em>meirg.co.il</em>. That can easily happen if you\'re using <a href="https://docs.sendgrid.com/ui/account-and-settings/api-keys">SendGrid - API keys to send emails</a> since the <em>FROM</em> field is not protected, the API call can "endure" anything you shove it.</p>\n</blockquote>\n\n<h3>\n  <a name="dkim" href="#dkim">\n  </a>\n  DKIM\n</h3>\n\n<ul>\n<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc6376">DomainKeys Identified Mail (Signatures)</a>\n</li>\n<li>Remember with: <code>K</code> for <strong>K</strong>eys.</li>\n</ul>\n\n<p>This one is going to be very short compared to <em>SPF</em> since we\'ve already covered all basics,</p>\n\n<p>I like to think about <em>DKIM</em> as the HTTPS of emails. So <em>DKIM</em> is a way for an email sender to <a href="https://support.google.com/a/answer/174124?hl=en">increase authenticity by adding a signature to the headers of an email message</a>.</p>\n\n<blockquote>\n<p>"...DKIM adds an encrypted signature to the header of all outgoing messages. Email servers (Mail eXchangers) that get signed messages use DKIM to decrypt the message header and verify the message was not changed after it was sent."</p>\n</blockquote>\n\n<p>Here\'s how the <em>DKIM</em> record looks for my domain <em>meirg.co.il</em>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>Type: TXT\nName: google._domainkey.meirg.co.il\nValue: v=DKIM1; k=rsa; p=Ultra-Long-Key-PUBLIC-KEY-392-chars\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The subdomain <code>google._domainkey</code> was <a href="https://support.google.com/a/answer/174126?hl=en&amp;ref_topic=2752442">generated by Google</a> for my domain <em>meirg.co.il</em>. After generating the <em>DKIM</em> record, I followed the instructions and authenticated my domain by adding a <em>TXT</em> record with the value provided by Google.</p>\n\n<p>If I intend to use other ESPs, I can generate a subdomain per ESP, so <a href="https://docs.sendgrid.com/ui/account-and-settings/dkim-records#example-dkim-record-automated-security-off">for SendGrid, it\'ll be s1._domainkey</a>.</p>\n\n<p>As you can see, the <code>*._domainkey</code> is the critical value, as that\'s the one that the Mail eXchanger is checking. So if a DNS record, such as <em>TXT</em> or <em>CNAME</em>, is named with <code>_domainkey</code>, you can classify it safely as <em>DKIM</em>. The <code>*._domainkey</code> prefix, such as <code>google</code> and <code>s1</code>, is called a selector. One domain can have multiple <em>DKIM</em> selectors when using various ESPs.</p>\n\n<blockquote>\n<p><strong>NOTE</strong>: Curious about my public key? Dig for it! <code>dig TXT google._domainkey.meirg.co.il</code></p>\n</blockquote>\n\n<h3>\n  <a name="dmarc-here-comes-dmarc-tu-du-du-du" href="#dmarc-here-comes-dmarc-tu-du-du-du">\n  </a>\n  DMARC - Here comes D-MARC tu du du du\n</h3>\n\n<ul>\n<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc7489">Domain-based Message Authentication, Reporting &amp; Conformance</a>\n</li>\n<li>Remember with: <code>DM</code> "<strong>D</strong>omain <strong>M</strong>onitoring" and <code>D-MARC</code> like "the man(ager)"</li>\n</ul>\n\n<p>We covered <em>SPF</em> and <em>DKIM</em>, but how do we know that our email messages are authenticated with <em>SPF</em> and signed with <em>DKIM</em>? Is there a way to track down it down with numbers? There is.</p>\n\n<p><a href="https://dmarc.org/">DMARC</a> is an email authentication standard - Meeting up this standard means your <em>SPF</em> and <em>DKIM</em> domain records are legit. How does it mean that they\'re legit, you ask?</p>\n\n<ul>\n<li>Once a day, a <a href="https://mxtoolbox.com/dmarc/details/what-do-dmarc-reports-look-like">DMARC Report</a> is sent to a predefined mailbox. The report contains pass/fail attempts of <em>SPF</em> and <em>DKIM</em>.</li>\n<li>\n<em>DMARC</em> has the <a href="https://dmarcian.com/policy-modes-quarantine-vs-reject/#:~:text=p=reject">reject policy</a>, so if a sender attempts to send an email and both <em>SPF</em> and <em>DKIM</em> checks didn\'t pass, the receiver (recipient) would not get the message. </li>\n<li>Furthermore, <em>DMARC</em> helps to authenticate the sender\'s identity since <em>SPF</em> requires a <em>TXT</em> record to exist in the sender\'s domain containing valid domains or IPs (usually of an ESP), and a <em>TXT</em> (or <em>CNAME</em>) record for <em>DKIM</em> which includes a public key that was given to sender by the ESP.</li>\n</ul>\n\n<p>Here\'s how a <em>DMARC Record</em> looks like<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>Type: TXT\nName: _dmarc.meirg.co.il\nValue: v=DMARC1; p=none; rua=mailto:meir+dmarc_agg@meirg.co.il, mailto:dmarc_agg@vali.email\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>The <code>p=none</code> is the declared policy, which is nothing. Having no policy at all is almost the same as not having a <em>DMARC</em> record. A proper <em>DMARC</em> record would be <code>p=reject</code>.</p>\n\n<p>So why am I using <code>p=none</code>, you ask? Because I\'m still not 100% sure that my outgoing email messages pass both <em>SPF</em> and <em>DKIM</em> by Mail eXchangers. Having <code>p=reject</code> would block my messages completely, so for testing purposes, start with <code>p=none</code>, and once you\'re sure that all your emails pass both <em>SPF</em> and <em>DKIM</em>, set the policy to <code>p=reject</code>.</p>\n\n<p>Sounds great, but how can you check all that? It sounds tough.</p>\n\n<p>See the <code>rua</code> key in the code snippet above; I added <code>+dmarc_agg</code> to my email address and <a href="https://support.google.com/mail/answer/6579?hl=en#zippy=%2Ccreate-a-filter">created a filter in Gmail</a>, so any message coming from <em><a href="mailto:meirg+dmarc_agg@meirg.co.il">meirg+dmarc_agg@meirg.co.il</a></em> is tagged as <code>dmarc-report</code>. Remember that I mentioned that a daily <em>DMARC</em> report is sent to a "predefined email address"? that is it.</p>\n\n<p>But do I want to analyze <em>DMARC</em> reports on my own? Yup, you guessed it, there\'s an excellent service that can do that for free, and it\'s called  <a href="https://www.valimail.com/">ValiMail</a>. ValiMail gets the daily report and analyzes it by checking how many <em>SPF</em> and <em>DKIM</em> successes/failures occurred in the past 24 hours and presents the summary in a friendly dashboard.</p>\n\n<p><a href="https://www.valimail.com/partners/">ValiMail are partnered with many known organizations</a>, such as Microsoft, Google, and SendGrid,  so I consider them a trusted vendor.</p>\n\n<blockquote>\n<p><strong>NOTE</strong>: The silent <code>dmarc_agg@vali.email</code> in the <code>rua</code> key points to ValiMail\'s mailbox.</p>\n</blockquote>\n\n<h2>\n  <a name="bimi-requires-dmarc" href="#bimi-requires-dmarc">\n  </a>\n  BIMI - Requires DMARC\n</h2>\n\n<ul>\n<li>Definition: <a href="https://tools.ietf.org/id/draft-blank-ietf-bimi-00.txt">Brand Indicators for Message Identification</a>\n</li>\n<li>Remember with: <strong>B</strong> for <strong>B</strong>ragging to our audience/receivers that we\'re a top-notch validated sender.</li>\n</ul>\n\n<p>Reminding you that <em>DMARC</em> has the "reject policy", so if an email sender sets it to <code>p=reject, pct=100</code> (or <code>p=quarantine</code>), <strong>ALL</strong> none qualifying emails (SPF+DKIM) will not be delivered. So, cool, who enforces it? <em>BIMI</em>! </p>\n\n<p><a href="https://bimigroup.org/all-about-bimi/#:~:text=How%20do%20I%20Implement%20BIMI?">Qualifying for BIMI</a> requires registering a trademark in a known patent agency and then purchasing a Verified Mark Certificate (VMC) from <a href="https://www.digicert.com/tls-ssl/verified-mark-certificates">DigiCert</a> or <a href="https://www.entrust.com/digital-security/certificate-solutions/products/digital-certificates/verified-mark-certificates">Entrust</a> So, meeting the BIMI standard is not that simple.</p>\n\n<p>And of course, it is possible to partially meet <a href="https://bimigroup.org/bimi-for-non-trademarked-logos/">BIMI for non-trademarked logos</a>. However, since <em>BIMI</em> is still not enforced or <a href="https://bimigroup.org/bimi-infographic/">widely recognized by Mail eXchangers</a>, I consider it a nice-to-have, and I\'ll get to it once I\'ll implement it once I get enough data from the <em>DMARC</em> reports.</p>\n\n<p>To my feeling, it\'ll be easier to qualify today for <em>BIMI</em> than it will be in a few years. If you spot a fully certified <em>BIMI</em> email sender, it means it is ... Genuine and can be trusted.</p>\n\n<h2>\n  <a name="mysterious-mx" href="#mysterious-mx">\n  </a>\n  Mysterious MX\n</h2>\n\n<ul>\n<li>Definition: <a href="https://datatracker.ietf.org/doc/html/rfc974">Mail Exchanger</a>\n</li>\n<li>Remember with: Gmail is a Mail Exchanger, Google Workspace is an ESP</li>\n</ul>\n\n<p>Finally, we got to MX; in case you haven\'t noticed, I wrote "Mail eXchangers" each time I had to mention a mail exchanger. You\'ve just learned that <em>MX Record</em> stands for <strong>M</strong>ail e*<em>X</em>*changers that are allowed to receive emails on your behalf.</p>\n\n<p>Since <em>MX Records</em> are for receiving emails and not sending, see my <a href="https://stackoverflow.com/questions/46113231/receiving-email-is-not-working-in-amazon-ses/62452983#62452983">stackoverflow answer</a> on how to configure <em>MX Records</em> for <a href="https://aws.amazon.com/ses/">AWS Simple Email Service (SES)</a> and the things that I\'ve learned during the process.</p>\n\n<p>To see how an <em>MX Record</em> looks like, check mine with <a href="https://mxtoolbox.com/SuperTool.aspx?action=mx%3ameirg.co.il&amp;run=toolpage">mxtoolbox.com</a>.</p>\n\n<h2>\n  <a name="gmail-is-a-mail-exchanger" href="#gmail-is-a-mail-exchanger">\n  </a>\n  Gmail is a Mail eXchanger\n</h2>\n\n<p>How do you send emails from your Gmail account if it\'s only receiving messages with a Mail eXchanger? </p>\n\n<p>As part of being Gmail\'s client, you can send emails on behalf of <code>@gmail.com</code>. That is set behind the scenes by Gmail\'s engineers, so each time you send an email using Gmail\'s UI, or use <a href="https://developers.google.com/gmail/api">Gmail\'s API</a>, the emails that you send are signed with Gmail\'s signature, which includes <em>SPF</em>, <em>DKIM</em>, <em>DMARC</em>. That is why your emails are not marked as spam when you email your friends and family since most Mail Exchangers treat <code>@gmail.com</code> as a high reputation sender.</p>\n\n<h2>\n  <a name="strengthen-your-knowledge" href="#strengthen-your-knowledge">\n  </a>\n  Strengthen your knowledge\n</h2>\n\n<h3>\n  <a name="name-all-the-standards-and-provide-a-short-description" href="#name-all-the-standards-and-provide-a-short-description">\n  </a>\n  Name all the standards and provide a short description\n</h3>\n\n<p>All records refer to the email sender\'s domain.</p>\n\n<ol>\n<li>\n<strong>SPF</strong> - TXT record, which contains the allowed sources, domains or IPs, to send emails on behalf of an email sender.</li>\n<li>\n<strong>DKIM</strong> - TXT/CNAME record, which contains a key generated by an ESP. I consider <em>DKIM</em> an HTTPS mechanism for emails, which uses the <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography</a> to authenticate messages.</li>\n<li>\n<strong>DMARC</strong> - TXT record, which contains the receiver of the daily reports. This record is not just for setting the receiver, and it also means that Mail eXchangers will check this record and act according to the rules in it. So if <em>SPF</em> and <em>DKIM</em> is not set, some email messages might not arrive at their destination.</li>\n<li>\n<strong>BIMI</strong> - TXT record, which contains a URL to an SVG logo of the email sender, and a URL of the Verified Mark Certificate (VMC) that the email sender purchased. And of course, this is how email senders can <strong>b</strong>rag that they\'re legit in front of their customers.</li>\n</ol>\n\n<h3>\n  <a name="how-do-i-check-if-my-domain-is-a-trusted-email-sender" href="#how-do-i-check-if-my-domain-is-a-trusted-email-sender">\n  </a>\n  How do I check if my domain is a trusted email sender?\n</h3>\n\n<p>Check if your DMARC record is valid with <a href="https://tools.wordtothewise.com">https://tools.wordtothewise.com</a>.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>https://tools.wordtothewise.com/dmarc/check/DOMAIN_NAME\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Hooray for Google Workspace customers - there\'s a dedicated online tool for checking whether your mailing DNS records are correctly set for Google Workspace ESP; here are my results <a href="https://toolbox.googleapps.com/apps/checkmx/check?domain=meirg.co.il&amp;dkim_selector=">meirg.co.il - Google Check MX Status</a></p>\n\n<blockquote>\n<p><strong>IMPORTANT</strong>: Do not be fooled; Google Workspace\'s tool is valid only if you\'re checking Google as an ESP. If you use this service on a Sendgrid domain, it will show many errors.</p>\n</blockquote>\n\n<h3>\n  <a name="how-do-i-read-a-dmarc-expression" href="#how-do-i-read-a-dmarc-expression">\n  </a>\n  How do I read a DMARC expression?\n</h3>\n\n<p>The syntax of how to read/write a <em>DMARC expression</em> can be found in <a href="https://datatracker.ietf.org/doc/html/rfc7489#section-6.3">RFC7489 - Domain-based Message Authentication, Reporting, and Conformance (DMARC)</a>. Another excellent source for understanding the syntax is <a href="https://support.google.com/a/answer/2466563?hl=en">Google\'s tutorial on the DMARC record format</a></p>\n\n<p>Let\'s inspect <a href="https://tools.wordtothewise.com/dmarc/check/gmail.com">@gmail.com\'s DMARC record</a> together<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>v=DMARC1; p=none; sp=quarantine; rua=mailto:mailauth-reports@google.com\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<ul>\n<li><p>p=none - all emails, regardless if they\'re validated with SPF+DKIM, can get to the receiver</p></li>\n<li><p>sp=quarantine - all emails sent from subdomains, e.g. <code>subdomain.gmail.com</code> and are not signed with SPF+DKIM are marked as spam in the receiver\'s mailbox. <code>sp</code> stands for subdomain-policy and overrides <code>p</code> rules for subdomains.</p></li>\n<li><p>rua=mailto - It appears that Gmail is handling their DMARC reports internally since the reporting address belongs to @google.com. So I guess they have their own "analyzing and monitoring DMARC reports" system, kewl.</p></li>\n</ul>\n\n<p>Inpsecting <a href="https://tools.wordtothewise.com/dmarc/check/yahoo.com">@yahoo.com\'s DMARC</a> record<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight plaintext"><code>v=DMARC1; p=reject; pct=100; rua=mailto:d@rua.agari.com; mailto:d@ruf.agari.com;\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<ul>\n<li><p>p=reject - all emails that are not signed with SPF+DKIM are rejected.</p></li>\n<li><p>pct=100 - the percentage of messages to apply the <code>p</code> policy. In this case, if it\'s not signed with SPF+DKIM, it\'s not getting to the receiver at all, very restrictive</p></li>\n</ul>\n\n\n<hr>\n\n<p>It\'s fascinating to see how different enterprise-grade email senders are setting up their DMARC records. It might look like Gmail is very permissive with their <code>p=none</code> policy, but I\'m sure they have a dedicated backend that filters out spam messages before they arrive at their customers\' mailboxes.</p>\n\n<h3>\n  <a name="bonus-can-gmail-customers-check-the-senders-validity-in-the-ui" href="#bonus-can-gmail-customers-check-the-senders-validity-in-the-ui">\n  </a>\n  Bonus - Can Gmail customers check the sender\'s validity in the UI?\n</h3>\n\n<p>Yes, yes, YES!</p>\n\n<p>Eventually, an email message contains text, and this text instructs the Mail eXchanger how to validate the message\'s sender, process referenced images to be shown in the UI, etc.</p>\n\n<p>Gmail made it very easy to check, click the ellipsis, and then <strong>Show Original</strong>.</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--fDB57GWW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m98pmz51gddg9yzm5cux.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--fDB57GWW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m98pmz51gddg9yzm5cux.png" alt="gmail-show-original-cloudflare" loading="lazy" width="880" height="514"></a></p>\n\n<p>That results in a very long page that contains the whole email message, though Gmail made it very easy to track the important things, such as if <strong>DMARC</strong> is valid.</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--V46OsjOB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1n99igk91x7uk0w7lex0.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--V46OsjOB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1n99igk91x7uk0w7lex0.png" alt="cloudflare-dmarc-check" loading="lazy" width="880" height="426"></a></p>\n\n<p>After reading this blog post, you\'ve just learned that checking <em>DMARC</em> is enough since it relies on both <em>SPF</em> and <em>DKIM</em>.</p>\n\n<h2>\n  <a name="dedicated-ip" href="#dedicated-ip">\n  </a>\n  Dedicated IP\n</h2>\n\n<p>Psst! Glad to see that you\'ve read it all; This blog post is long enough, so here\'s a great resource that can help you decide whether to purchase a dedicated IP or not - <a href="https://www.m3aawg.org/sites/default/files/document/M3AAWG_Senders_BCP_Ver3-2015-02.pdf">3.4 Shared vs. Dedicated IPs, M3AAWG Sender Best Common Practices v3.0, Feb 2015</a>.</p>\n\n<p>In short, if you\'re sending high volumes, <a href="https://sendgrid.com/resource/how-to-send-high-volume-email-sendgrids-smart-scaling-guide-2/#:~:text=Dedicated%20IPs">hundreds of thousands of emails a month</a>, then you should purchase a dedicated IP. I hate it when it all ends up with "it depends on your needs", but hey, that\'s true.</p>\n\n<h2>\n  <a name="final-words" href="#final-words">\n  </a>\n  Final Words\n</h2>\n\n<p>I admit that it was tough and felt like there\'s a lot to memorize, but once you truly understand how each components works, it\'s pretty nice and very not intimidating as it was. So enjoy setting up your mailing DNS records. That would be all.</p>\n\n',a.body_markdown="As always, every day brings up new challenges, and today I faced one of my greatest fears - dealing with mailing DNS records.\n\nUp until today, I was only familiar with *A Record*, *CNAME Record*, and *TXT Record*. A while ago, I used the *MX Record* while setting up my mailbox for my domain, but I don't quite remember its purpose, but enough about me.\n\nMail eXchangers, such as Gmail, Yahoo, Outlook, check the validity of incoming email messages. As part of the validation process, the Mail eXchanger queries the DNS records of the sender and evaluates the sender's reputation.\n\nThe sender's reputation affects how the Mail eXchanger classifies the message and whether or not it should be marked as spam before it is delivered to the receiver. In some cases, the message is blocked entirely by the Mail eXchanger, and the receiver is unaware of it.\n\n## The Reputation\n\nThere are many algorithms out there for evaluating an email sender's reputation. To put it on a scale, I classified the reputation level into four levels - *Very Low*, *Low*, *Standard*, and *Best*.\n\n### Very Low\n\nBlocked completely without even bothering the receiver, here are two common error messages that may appear in the ESP's logs if the sender's email has sent too many emails in a short period. \n\n```\n421 4.7.0 [TS01] Messages from <1.2.3.4> temporarily deferred due to user complaints\n<1.2.3.4> ;see http://postmaster.yahoo.com/421-ts01.html\n```\n```\n553 5.7.1 [BL21] Connections will not be accepted from 1.2.3.4,\n    because the ip is in Spamhaus's list; \nsee http://postmaster.yahoo.com/550-bl23.html\n```\n[Above snippets from - glockapps.com - How To Remove Your IP From Yahoo Blacklist – Yahoo Blacklist Checker\n](https://glockapps.com/blog/remove-ip-address-yahoo-blacklist/)\n\nIf there's a need to send large volumes of email messages, it is recommended to purchase a [dedicated IP with a warm-up mechanism](https://docs.sendgrid.com/ui/sending-email/warming-up-an-ip-address). The subject is broadly explained in the provided link, though in short, it's another method of identifying yourself as a trusted sender, by saying:\n\n> \"I own a unique IP address because I'm confident that Mail eXchangers won't block me. I know that it's easy to block an IP address, so yeah, I'm that confident.\"\n\n### Low Reputation\n\nEmails are marked as spam due to the low authenticity of the sender or previous reports of other users. But, most of the time, it's because the content of the message is not specific enough to the receiver.\n\nFor example, Willy is a Gmail customer, and he is interested in computer science and surfing. Then, out of the blue, Willy receives an email message about a great body lotion for women. Though Willy may have subscribed to some cosmetics stores websites, if the message isn't specific enough, like \"Hi Willy,\" then it **might** be marked as spam.\n\nSend the relevant content to the appropriate audience to avoid getting here.\n\n### Standard Reputation\n\nEmail messages are getting to the client's mailbox as they should, though, in some Mail eXchangers such as Gmail, messages could move to the [Promotions tab](https://developers.google.com/gmail/promotab/faq#why_do_i_see_my_email_in_a_bundle_and_i_have_not_added_the_annotation), while it wasn't intended.\n\n> \"... Gmail will recommend emails based on previous user engagement, regardless of whether annotations are present.\"\n\n### Best Reputation\n\nEmail messages are getting to the client's mailbox as the **sender intended**. \n\nSome businesses may want to get on Gmail's [Promotions tab on purpose](https://developers.google.com/gmail/promotab/overview); it all depends on the sender's needs.\n\n<hr>\n\nAre you ready to explore the dark depths of mailing DNS records? Let's go!\n\n<hr>\n\n## Baseline\n\nPreviously, I mentioned that I'm familiar with a few DNS records, but that doesn't mean that we're on the same page. So line up!\n\n<table><thead><tr><th>Record Type</th><th>Target</th><th>Example Key Pair Values</th></tr></thead><tbody><tr><td>A</td><td>IP addresses</td><td>Name: virtual-machine.meirg.co.il (For example, <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#ip-addressing-eips\" target=\"_blank\" rel=\"noopener noreferrer\">AWS Elastic IP</a>)<br>Value: 123.123.123.123</td></tr><tr><td>CNAME</td><td>Canonical name for other domain name</td><td>Name: meirg.co.il<br>Value: meirg-website.pages.dev (<a href=\"https://pages.cloudflare.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Cloudflare Pages)</a><br><br>Name: www.meirg.co.il (<a href=\"https://support.cloudflare.com/hc/en-us/articles/200172286-Configuring-URL-forwarding-or-redirects-with-Cloudflare-Page-Rules\" target=\"_blank\" rel=\"noopener noreferrer\">Redirects to meirg.co.il</a>)<br>Value: meirg.co.il</td></tr><tr><td>TXT</td><td>Domain validation and authenticity</td><td>Name: meirg.co.il (<a href=\"https://support.google.com/a/answer/183895?hl=en\" target=\"_blank\" rel=\"noopener noreferrer\">Google Domain Verification</a>)<br>Value: \"google-site-verification=2NOO....XgotefAU\"</td></tr><tr><td>MX</td><td colspan=\"2\">Let's leave it as a mystery for now<br>(keep your Google Search gun down!)</td></tr></tbody></table>\n\n## Plot\n\nI need to improve the email deliverability of outgoing emails. The request first came from the marketing expert of one of my customers, and he told me *\"We need you for the DNS part.\"*\n\nOk, I'm up for it; let's set up the DNS records and assist my customer in reaching out to his end-users.\n\nBut how can I make sure that I succeed? I mean, doing/learning stuff is fun, it really is, but how will I know if my changes impacted my [email sender reputation](https://www.sparkpost.com/resources/email-explained/email-sender-reputation/#:~:text=An%20email%20sender%20reputation%20is,an%20organization%20that%20sends%20email.&text=The%20higher%20the%20score%2C%20the,of%20recipients%20on%20their%20network.)? How do I know if there's a better open/click rate for my emails?\n\nThe above questions are widespread when the need to send emails arises. That usually comes with many requirements, such as \"unsubscribe mechanism\", \"group contacts by segments\", \"statistics of open/click\", and the list goes on, depending on your marketing manager 😉\n\nDeveloping a system that can measure open/click rate and handle email/contacts management will take ages to build...\n\nSo maybe I should ...\n\n## Use professional help\n\nHere comes [ESP](https://www.activecampaign.com/glossary/email-service-provider) into play! ESP stands for Email Service Provider, and that means there are cloud providers out there who are willing to send emails on my behalf and enable me to manage the whole email delivery system in a one-stop-shop.\n\nThere are many ESPs out there such as [Google Workspace](https://workspace.google.com/products/gmail/), [SendGrid](https://sendgrid.com/) and [Mailchimp](https://mailchimp.com). Each provider has its pros and cons, but the common ground is - **they all send emails on behalf of your domain**.\n\nThe difference usually comes when an ESP, like SendGrid, offers comprehensive services like [Automated Security](https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#using-automated-security) which enabled you to purchase [a dedicated IP](https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses) as a service (we'll get to that).\n\nWe covered ESPs, moving on to getting familiar with industry standards for improving email deliverability.\n\n> **NOTE**: I might mention SendGrid a lot during this blog post, though I'm not biased towards any ESP; SendGrid is simply the service I've been using recently, so it's easier for me to make references. Most ESPs offer a free/trial plan so you can explore their features and then decide, and I recommend evaluating at least two ESPs before picking one.\n\n## Standards For Better Email Delivery\n\n[According to Google](https://support.google.com/a/answer/10583557?hl=en&ref_topic=9061731), at least four standards should be implemented (in this order) \n\n1. SPF\n2. DKIM\n3. DMARC\n4. (Optional) BIMI\n\nAnd, I'm adding [A dedicated IP](https://docs.sendgrid.com/ui/account-and-settings/dedicated-ip-addresses#what-are-dedicated-ip-addresses) to the mix.\n\nMail eXchangers check if the sender meets industry standards by querying its DNS record, and according to that, evaluate the sender's reputation. The sender evaluation process includes other methods, such as looking in [https://multirbl.valli.org/](https://multirbl.valli.org/lookup/meirg.co.il.html) to see if the source domain (eventually IP) of the sender is marked as an \"official spammer\", that all it depends on the Mail eXchanger. The more standards the sender meets, the higher the chances the sender's email message will arrive at its target audience (receiver).\n\nThe illustration below is for the *SPF* record. Still, the same communication process is the same for all standards, where the Receiving Email Server (Mail eXchanger) validates the email sender's authenticity and reputation.\n\n![spf_mail_flow](https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg)\n\nImage Source: [https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg](https://twilio-cms-prod.s3.amazonaws.com/original_images/spf_mail_flow.jpeg)\n\n### SPF\n\n- Definition: [Sender Policy Framework](https://datatracker.ietf.org/doc/html/rfc7208)\n- Remember with: `S` for \"**S**ending emails\"\n\nThis record allows ESPs such as SendGrid, Gmail, Mailchimp to send emails on behalf of your domain. So if my domain name is *meirg.co.il* and I would like to send emails with Google Workspace, I need to add [Google's SPF](https://support.google.com/a/answer/10684623?hl=en) record to my domain *meirg.co.il*.\n\nAnd the funny thing about an *SPF Record*, that it's actually a *TXT Record*. Let me remind you that *TXT Records* are for \"Domain validation and authenticity,\" so it's nothing more than adding a *TXT Record* and adding a value that is specific for the *SPF* standard.\n\nHere's an example for setting up two *SPF* records, one for [Google Workspace](https://support.google.com/a/answer/10685031) and the other for [SendGrid's SPF](https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication#before-you-begin:~:text=HOST/NAME).\n\n```\n# Google Workspace\nType: TXT\nName: meirg.co.il\nValue: v=spf1 include:_spf.google.com ~all\n\n# Sendgrid\nType: TXT\nName: em123.meirg.co.il\nValue: u12345678.wl123.sendgrid.net\n```\n\nNotice the weird thing? `Google Workspace` has an [SPF expression](https://dmarcian.com/spf-syntax-table/), while `SendGrid` provides a *CNAME* as a value in the *TXT* record. My gut told me that the *CNAME* should eventually resolve to an *SPF expression*, so I checked it with [Authentication @ tools.wordtothewise.com](https://tools.wordtothewise.com/authentication).\n\nI tested it by navigating to `https://tools.wordtothewise.com/dns/txt/em123.meirg.co.il`, which resolved in ... Drums ... `u12345678.wl123.sendgrid.net` as a *TXT* record which contains the following expression.\n\n```\n# SendGrid's CNAME resolves to SPF expression\nv=spf1 ip4:122.122.122.122 -all\n```\n\nIt is quite a wonder that eventually, it's `ip4:122.122.122.122` and not a CNAME, as we saw in Google Workspace `include:_spf.google.com`. This wonder is called a [dedicated IP](https://postmarkapp.com/blog/how-to-check-your-ip-reputation#why-is-ip-reputation-important).\n\nDeclaring an *SPF Record*, or any other record that is related to mailing, usually comes with a complete guide on how to create it, check [Google Workspace Basic Setup for SPF](https://support.google.com/a/answer/10685031) which also explains [how to include multiple ESPs in a single SPF Record](https://support.google.com/a/answer/10685031#:~:text=servers.mail.net).\n\n### When should I use a single SPF expression?\n\nGetting back to my previous example of Google Workspace and SendGrid; Luckily, SendGrid provides a particular *TXT Record*, which includes a unique subdomain, *em123*; this makes the setup is really nice since you don't modify existing with the fear of breaking something.\n\nAssuming your ESP**s** required the *TXT Record* of *SPF* to be present in the root domain, e.g., *meirg.co.il*, you'll have to edit your existing *SPF expression* and add additional ESPs. For example, here's how you would write an *SPF expression* when using both Google Workspace and [Mailgun](https://www.mailgun.com/).\n\n```\n# Google Workspace + Mailgun\nType: TXT\nName: meirg.co.il\nValue: v=spf1 include:_spf.google.com include:mailgun.org ~all\n```\n\n> **NOTE**: Regarding which ESP you should choose (Google/SendGrid/Mailchimp/Mailgun, etc.), it depends on your needs. I use Google Workspace for receiving/sending emails on behalf of *human beings* who use `@meirg.co.il` and SendGrid for sending automated emails with my web application `@meirg.co.il`. By the way, [Mailchimp](https://mailchimp.) is also excellent, I used it a long time ago, and I truly enjoyed it.\n\n### Recap on SPF\n\nA *TXT* record that contains an [SPF expression](https://dmarcian.com/spf-syntax-table/) or a *CNAME* that is eventually resolved to an *SPF expression*. The *SPF expression* contains an authorization policy about which service can send emails on your domain's behalf.\n\n> **IMPORTANT** Make sure you send emails from the same address that you've authenticated in the ESP (SendGrid, Google), for example, **DO NOT TRY THE FOLLOWING**, sending emails from *no-reply@meirg.com*. In contrast, my authenticated domain address is *meirg.co.il*. That can easily happen if you're using [SendGrid - API keys to send emails](https://docs.sendgrid.com/ui/account-and-settings/api-keys) since the *FROM* field is not protected, the API call can \"endure\" anything you shove it.\n\n### DKIM\n\n- Definition: [DomainKeys Identified Mail (Signatures)](https://datatracker.ietf.org/doc/html/rfc6376)\n- Remember with: `K` for **K**eys.\n\nThis one is going to be very short compared to *SPF* since we've already covered all basics,\n\nI like to think about *DKIM* as the HTTPS of emails. So *DKIM* is a way for an email sender to [increase authenticity by adding a signature to the headers of an email message](https://support.google.com/a/answer/174124?hl=en).\n\n> \"...DKIM adds an encrypted signature to the header of all outgoing messages. Email servers (Mail eXchangers) that get signed messages use DKIM to decrypt the message header and verify the message was not changed after it was sent.\"\n\nHere's how the *DKIM* record looks for my domain *meirg.co.il*.\n\n```\nType: TXT\nName: google._domainkey.meirg.co.il\nValue: v=DKIM1; k=rsa; p=Ultra-Long-Key-PUBLIC-KEY-392-chars\n```\n\nThe subdomain `google._domainkey` was [generated by Google](https://support.google.com/a/answer/174126?hl=en&ref_topic=2752442) for my domain *meirg.co.il*. After generating the *DKIM* record, I followed the instructions and authenticated my domain by adding a *TXT* record with the value provided by Google.\n\nIf I intend to use other ESPs, I can generate a subdomain per ESP, so [for SendGrid, it'll be s1._domainkey](https://docs.sendgrid.com/ui/account-and-settings/dkim-records#example-dkim-record-automated-security-off).\n\nAs you can see, the `*._domainkey` is the critical value, as that's the one that the Mail eXchanger is checking. So if a DNS record, such as *TXT* or *CNAME*, is named with `_domainkey`, you can classify it safely as *DKIM*. The `*._domainkey` prefix, such as `google` and `s1`, is called a selector. One domain can have multiple *DKIM* selectors when using various ESPs.\n\n> **NOTE**: Curious about my public key? Dig for it! `dig TXT google._domainkey.meirg.co.il`\n\n### DMARC - Here comes D-MARC tu du du du\n\n- Definition: [Domain-based Message Authentication, Reporting & Conformance](https://datatracker.ietf.org/doc/html/rfc7489)\n- Remember with: `DM` \"**D**omain **M**onitoring\" and `D-MARC` like \"the man(ager)\"\n\nWe covered *SPF* and *DKIM*, but how do we know that our email messages are authenticated with *SPF* and signed with *DKIM*? Is there a way to track down it down with numbers? There is.\n\n[DMARC](https://dmarc.org/) is an email authentication standard - Meeting up this standard means your *SPF* and *DKIM* domain records are legit. How does it mean that they're legit, you ask?\n\n- Once a day, a [DMARC Report](https://mxtoolbox.com/dmarc/details/what-do-dmarc-reports-look-like) is sent to a predefined mailbox. The report contains pass/fail attempts of *SPF* and *DKIM*.\n- *DMARC* has the [reject policy](https://dmarcian.com/policy-modes-quarantine-vs-reject/#:~:text=p=reject), so if a sender attempts to send an email and both *SPF* and *DKIM* checks didn't pass, the receiver (recipient) would not get the message. \n- Furthermore, *DMARC* helps to authenticate the sender's identity since *SPF* requires a *TXT* record to exist in the sender's domain containing valid domains or IPs (usually of an ESP), and a *TXT* (or *CNAME*) record for *DKIM* which includes a public key that was given to sender by the ESP.\n\nHere's how a *DMARC Record* looks like\n\n```\nType: TXT\nName: _dmarc.meirg.co.il\nValue: v=DMARC1; p=none; rua=mailto:meir+dmarc_agg@meirg.co.il, mailto:dmarc_agg@vali.email\n```\n\nThe `p=none` is the declared policy, which is nothing. Having no policy at all is almost the same as not having a *DMARC* record. A proper *DMARC* record would be `p=reject`.\n\nSo why am I using `p=none`, you ask? Because I'm still not 100% sure that my outgoing email messages pass both *SPF* and *DKIM* by Mail eXchangers. Having `p=reject` would block my messages completely, so for testing purposes, start with `p=none`, and once you're sure that all your emails pass both *SPF* and *DKIM*, set the policy to `p=reject`.\n\nSounds great, but how can you check all that? It sounds tough.\n\nSee the `rua` key in the code snippet above; I added `+dmarc_agg` to my email address and [created a filter in Gmail](https://support.google.com/mail/answer/6579?hl=en#zippy=%2Ccreate-a-filter), so any message coming from *meirg+dmarc_agg@meirg.co.il* is tagged as `dmarc-report`. Remember that I mentioned that a daily *DMARC* report is sent to a \"predefined email address\"? that is it.\n\nBut do I want to analyze *DMARC* reports on my own? Yup, you guessed it, there's an excellent service that can do that for free, and it's called  [ValiMail](https://www.valimail.com/). ValiMail gets the daily report and analyzes it by checking how many *SPF* and *DKIM* successes/failures occurred in the past 24 hours and presents the summary in a friendly dashboard.\n\n[ValiMail are partnered with many known organizations](https://www.valimail.com/partners/), such as Microsoft, Google, and SendGrid,  so I consider them a trusted vendor.\n\n> **NOTE**: The silent `dmarc_agg@vali.email` in the `rua` key points to ValiMail's mailbox.\n\n## BIMI - Requires DMARC\n\n- Definition: [Brand Indicators for Message Identification](https://tools.ietf.org/id/draft-blank-ietf-bimi-00.txt)\n- Remember with: **B** for **B**ragging to our audience/receivers that we're a top-notch validated sender.\n\nReminding you that *DMARC* has the \"reject policy\", so if an email sender sets it to `p=reject, pct=100` (or `p=quarantine`), **ALL** none qualifying emails (SPF+DKIM) will not be delivered. So, cool, who enforces it? *BIMI*! \n\n[Qualifying for BIMI](https://bimigroup.org/all-about-bimi/#:~:text=How%20do%20I%20Implement%20BIMI?) requires registering a trademark in a known patent agency and then purchasing a Verified Mark Certificate (VMC) from [DigiCert](https://www.digicert.com/tls-ssl/verified-mark-certificates) or [Entrust](https://www.entrust.com/digital-security/certificate-solutions/products/digital-certificates/verified-mark-certificates) So, meeting the BIMI standard is not that simple.\n\nAnd of course, it is possible to partially meet [BIMI for non-trademarked logos](https://bimigroup.org/bimi-for-non-trademarked-logos/). However, since *BIMI* is still not enforced or [widely recognized by Mail eXchangers](https://bimigroup.org/bimi-infographic/), I consider it a nice-to-have, and I'll get to it once I'll implement it once I get enough data from the *DMARC* reports.\n\nTo my feeling, it'll be easier to qualify today for *BIMI* than it will be in a few years. If you spot a fully certified *BIMI* email sender, it means it is ... Genuine and can be trusted.\n\n## Mysterious MX\n\n- Definition: [Mail Exchanger](https://datatracker.ietf.org/doc/html/rfc974)\n- Remember with: Gmail is a Mail Exchanger, Google Workspace is an ESP\n\nFinally, we got to MX; in case you haven't noticed, I wrote \"Mail eXchangers\" each time I had to mention a mail exchanger. You've just learned that *MX Record* stands for **M**ail e**X**changers that are allowed to receive emails on your behalf.\n\nSince *MX Records* are for receiving emails and not sending, see my [stackoverflow answer](https://stackoverflow.com/questions/46113231/receiving-email-is-not-working-in-amazon-ses/62452983#62452983) on how to configure *MX Records* for [AWS Simple Email Service (SES)](https://aws.amazon.com/ses/) and the things that I've learned during the process.\n\nTo see how an *MX Record* looks like, check mine with [mxtoolbox.com](https://mxtoolbox.com/SuperTool.aspx?action=mx%3ameirg.co.il&run=toolpage).\n\n## Gmail is a Mail eXchanger\n\nHow do you send emails from your Gmail account if it's only receiving messages with a Mail eXchanger? \n\nAs part of being Gmail's client, you can send emails on behalf of `@gmail.com`. That is set behind the scenes by Gmail's engineers, so each time you send an email using Gmail's UI, or use [Gmail's API](https://developers.google.com/gmail/api), the emails that you send are signed with Gmail's signature, which includes *SPF*, *DKIM*, *DMARC*. That is why your emails are not marked as spam when you email your friends and family since most Mail Exchangers treat `@gmail.com` as a high reputation sender.\n\n## Strengthen your knowledge\n\n### Name all the standards and provide a short description\n\nAll records refer to the email sender's domain.\n\n1. **SPF** - TXT record, which contains the allowed sources, domains or IPs, to send emails on behalf of an email sender.\n1. **DKIM** - TXT/CNAME record, which contains a key generated by an ESP. I consider *DKIM* an HTTPS mechanism for emails, which uses the [public-key cryptography](https://en.wikipedia.org/wiki/Public-key_cryptography) to authenticate messages.\n1. **DMARC** - TXT record, which contains the receiver of the daily reports. This record is not just for setting the receiver, and it also means that Mail eXchangers will check this record and act according to the rules in it. So if *SPF* and *DKIM* is not set, some email messages might not arrive at their destination.\n1. **BIMI** - TXT record, which contains a URL to an SVG logo of the email sender, and a URL of the Verified Mark Certificate (VMC) that the email sender purchased. And of course, this is how email senders can **b**rag that they're legit in front of their customers.\n\n### How do I check if my domain is a trusted email sender?\n\nCheck if your DMARC record is valid with [https://tools.wordtothewise.com](https://tools.wordtothewise.com).\n\n```\nhttps://tools.wordtothewise.com/dmarc/check/DOMAIN_NAME\n```\n\nHooray for Google Workspace customers - there's a dedicated online tool for checking whether your mailing DNS records are correctly set for Google Workspace ESP; here are my results [meirg.co.il - Google Check MX Status](https://toolbox.googleapps.com/apps/checkmx/check?domain=meirg.co.il&dkim_selector=)\n\n> **IMPORTANT**: Do not be fooled; Google Workspace's tool is valid only if you're checking Google as an ESP. If you use this service on a Sendgrid domain, it will show many errors.\n\n### How do I read a DMARC expression?\n\nThe syntax of how to read/write a *DMARC expression* can be found in [RFC7489 - Domain-based Message Authentication, Reporting, and Conformance (DMARC)](https://datatracker.ietf.org/doc/html/rfc7489#section-6.3). Another excellent source for understanding the syntax is [Google's tutorial on the DMARC record format](https://support.google.com/a/answer/2466563?hl=en)\n\nLet's inspect [@gmail.com's DMARC record](https://tools.wordtothewise.com/dmarc/check/gmail.com) together \n\n```\nv=DMARC1; p=none; sp=quarantine; rua=mailto:mailauth-reports@google.com\n```\n\n- p=none - all emails, regardless if they're validated with SPF+DKIM, can get to the receiver\n\n- sp=quarantine - all emails sent from subdomains, e.g. `subdomain.gmail.com` and are not signed with SPF+DKIM are marked as spam in the receiver's mailbox. `sp` stands for subdomain-policy and overrides `p` rules for subdomains.\n\n- rua=mailto - It appears that Gmail is handling their DMARC reports internally since the reporting address belongs to @google.com. So I guess they have their own \"analyzing and monitoring DMARC reports\" system, kewl.\n\nInpsecting [@yahoo.com's DMARC](https://tools.wordtothewise.com/dmarc/check/yahoo.com) record\n\n```\nv=DMARC1; p=reject; pct=100; rua=mailto:d@rua.agari.com; mailto:d@ruf.agari.com;\n```\n\n- p=reject - all emails that are not signed with SPF+DKIM are rejected.\n\n- pct=100 - the percentage of messages to apply the `p` policy. In this case, if it's not signed with SPF+DKIM, it's not getting to the receiver at all, very restrictive\n\n<hr>\n\nIt's fascinating to see how different enterprise-grade email senders are setting up their DMARC records. It might look like Gmail is very permissive with their `p=none` policy, but I'm sure they have a dedicated backend that filters out spam messages before they arrive at their customers' mailboxes.\n\n### Bonus - Can Gmail customers check the sender's validity in the UI?\n\nYes, yes, YES!\n\nEventually, an email message contains text, and this text instructs the Mail eXchanger how to validate the message's sender, process referenced images to be shown in the UI, etc.\n\nGmail made it very easy to check, click the ellipsis, and then **Show Original**.\n\n![gmail-show-original-cloudflare](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m98pmz51gddg9yzm5cux.png)\n\nThat results in a very long page that contains the whole email message, though Gmail made it very easy to track the important things, such as if **DMARC** is valid.\n\n![cloudflare-dmarc-check](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1n99igk91x7uk0w7lex0.png)\n\nAfter reading this blog post, you've just learned that checking *DMARC* is enough since it relies on both *SPF* and *DKIM*.\n\n## Dedicated IP\n\nPsst! Glad to see that you've read it all; This blog post is long enough, so here's a great resource that can help you decide whether to purchase a dedicated IP or not - [3.4 Shared vs. Dedicated IPs, M3AAWG Sender Best Common Practices v3.0, Feb 2015](https://www.m3aawg.org/sites/default/files/document/M3AAWG_Senders_BCP_Ver3-2015-02.pdf).\n\nIn short, if you're sending high volumes, [hundreds of thousands of emails a month](https://sendgrid.com/resource/how-to-send-high-volume-email-sendgrids-smart-scaling-guide-2/#:~:text=Dedicated%20IPs), then you should purchase a dedicated IP. I hate it when it all ends up with \"it depends on your needs\", but hey, that's true.\n\n## Final Words\n\nI admit that it was tough and felt like there's a lot to memorize, but once you truly understand how each components works, it's pretty nice and very not intimidating as it was. So enjoy setting up your mailing DNS records. That would be all.",a.user={name:"Meir Gabay",username:n,twitter_username:"meirg23",github_username:n,website_url:"https://meirg.co.il",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--6MUD7Sfe--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/223096/957afc26-d94b-4152-bf5c-6f38d1c8f38e.jpeg",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--TQ-lS5Pd--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/223096/957afc26-d94b-4152-bf5c-6f38d1c8f38e.jpeg"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:a}},error:e,state:{currentArticle:a},serverRendered:!0,routePath:"/unfor19/909385",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:e}}}}(null,"2021-11-26T23:30:50Z",{},"unfor19")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
