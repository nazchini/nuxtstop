<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>How I built a Contentful App combined with Commerce.js (IV)</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Using Nuxt.js fetch() hook to build dev.to with a new look"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/nuxtstop/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap"><link rel="preload" href="/nuxtstop/_nuxt/f6e87fb.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/6474719.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/9b75090.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/18df600.js" as="script"><link rel="preload" href="/nuxtstop/_nuxt/dc9ce94.js" as="script"><style data-vue-ssr-id="c650fd98:0 af4684f0:0 a9c71758:0 dcafa518:0 4b9cec49:0 b093d766:0 9d98bcb4:0 6b6a11ea:0 0248ed80:0 ea8e4264:0">html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{border:0 solid #e0e0e0}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}button{background:0 0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}hr{border-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:inherit;opacity:.5}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:inherit;opacity:.5}input::placeholder,textarea::placeholder{color:inherit;opacity:.5}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;font-family:sans-serif}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;font-family:inherit;font-size:100%}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;overflow:auto;word-break:break-word;white-space:normal}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{height:100%;font-size:18px;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}@media(min-width:640px){html{font-size:20px}}body{height:100%;min-width:320px;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:400;line-height:1.5;color:#000;background-color:#eff4f7;-webkit-text-rendering:optimizeLegibility;text-rendering:optimizeLegibility;font-synthesis:none;font-kerning:normal;font-feature-settings:"normal","kern";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll}h1,h2,h3,h4,h5,h6{color:#000;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;font-feature-settings:"normal";line-height:1.2}pre{background:#29292e;border-radius:2px;overflow:auto;padding:1rem;color:#eff1f9;line-height:1.42em;font-size:13px}@media screen and (min-width:380px){pre{font-size:15px}}pre code{background:#29292e;color:#eff0f9;white-space:pre}div.highlight pre.highlight code{font-size:inherit;padding:0}div.inner-comment div.body div.highlight pre.highlight{background:#29292e}div.inner-comment div.body div.highlight pre.highlight code{font-size:inherit;white-space:inherit;background:inherit;color:inherit}.highlight .hll{background-color:#49483e}.highlight{background:#29292e;color:#f8f8f2}.highlight .c{color:grey}.highlight .err{text-shadow:0 0 7px #f9690e}.highlight .k{color:#f39c12}.highlight .l{color:plum}.highlight .n{color:#f8f8f2}.highlight .o{color:#f9690e}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .ch,.highlight .cm,.highlight .cp,.highlight .cpf,.highlight .cs{color:grey}.highlight .gd{color:#f9690e}.highlight .ge{font-style:italic}.highlight .gi{color:#7ed07e}.highlight .gs{font-weight:700}.highlight .gu{color:grey}.highlight .kc,.highlight .kd{color:#f39c12}.highlight .kn{color:#f9690e}.highlight .kp,.highlight .kr,.highlight .kt{color:#f39c12}.highlight .ld{color:#f2ca27}.highlight .m{color:plum}.highlight .s{color:#f2ca27}.highlight .na{color:#7ed07e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#7ed07e}.highlight .no{color:#f39c12}.highlight .nd{color:#7ed07e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#7ed07e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#7ed07e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f9690e}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f9690e}.highlight .w{color:#f8f8f2}.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:plum}.highlight .dl,.highlight .s2,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .sd{color:#f2ca27}.highlight .se{color:plum}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#f2ca27}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#7ed07e}.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#f8f8f2}.highlight .il{color:plum}.vue-content-placeholders-heading__img,.vue-content-placeholders-heading__subtitle,.vue-content-placeholders-heading__title,.vue-content-placeholders-img,.vue-content-placeholders-text__line{background:#bfcdec!important}.vue-content-placeholders-is-animated .vue-content-placeholders-heading__img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle:before,.vue-content-placeholders-is-animated .vue-content-placeholders-heading__title:before,.vue-content-placeholders-is-animated .vue-content-placeholders-img:before,.vue-content-placeholders-is-animated .vue-content-placeholders-text__line:before{background:linear-gradient(90deg,transparent 0,#d3ddf9 15%,transparent 30%)!important}header[data-v-27046cca]{max-width:1280px;margin:auto;padding:1rem;height:6rem;border-bottom:1px solid rgba(0,0,0,.2)}header .logo-wrapper[data-v-27046cca],header[data-v-27046cca]{display:flex;align-items:center;justify-content:space-between}header .logo-wrapper[data-v-27046cca]{margin:0 .5rem}header .logo-wrapper svg[data-v-27046cca]{width:3rem;height:100%}header .logo-wrapper .name-wrapper[data-v-27046cca]{margin-left:.6em}header .logo-wrapper .name-wrapper .subtitle[data-v-27046cca]{font-size:1rem}header .logo-wrapper .name-wrapper .app-name[data-v-27046cca]{font-weight:700;font-size:2.25rem;line-height:1.25}header nav[data-v-27046cca]{letter-spacing:-.025rem;font-weight:600;text-transform:uppercase}header nav ul[data-v-27046cca]{display:flex}header nav ul li[data-v-27046cca]{margin:0 .5rem}header nav ul li a[data-v-27046cca]{box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;padding:.25rem 1rem;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}header nav ul li a[data-v-27046cca]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header nav ul li a.nuxt-link-exact-active[data-v-27046cca]{cursor:default}header nav ul li a.nuxt-link-exact-active[data-v-27046cca],header nav ul li a[data-v-27046cca]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}.page-wrapper[data-v-10d06ee8]{max-width:1280px;margin:auto;padding:1rem}.article-content-wrapper[data-v-10d06ee8]{display:flex;flex-direction:column;align-items:center;margin:auto auto 2rem}@media(min-width:1024px){.article-content-wrapper[data-v-10d06ee8]{align-items:normal;flex-direction:row}}.article-content-wrapper .article-block[data-v-10d06ee8]{width:100%;max-width:880px}@media(min-width:1024px){.article-content-wrapper .article-block[data-v-10d06ee8]{margin-right:1rem;width:66.66666%;margin-bottom:2rem}}.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{max-width:880px;width:100%;position:relative}@media(min-width:1024px){.article-content-wrapper .aside-username-wrapper[data-v-10d06ee8]{display:block;width:33.33333%}}.article-content-wrapper .aside-username-wrapper .aside-username-block[data-v-10d06ee8]{position:-webkit-sticky;position:sticky;top:1rem}@media(min-width:1280px){.comments-block[data-v-10d06ee8]{margin:.5rem}}article[data-v-70afb46a]{padding:.5rem;border-radius:1rem}header h1[data-v-70afb46a],header[data-v-70afb46a]{margin-bottom:1rem}header h1[data-v-70afb46a]{font-size:2.25rem;letter-spacing:-.025rem}header .tags[data-v-70afb46a]{display:flex;flex-wrap:wrap;margin-bottom:1.5rem}header .tags .tag[data-v-70afb46a]{font-weight:500;line-height:1;padding:.5rem;margin:0 .5rem .5rem 0;border-radius:.25rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db}header .tags .tag[data-v-70afb46a]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}header .tags .tag[data-v-70afb46a]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}header .image-wrapper[data-v-70afb46a]{position:relative;padding-bottom:56.25%;background-color:#d4dfe8;margin-bottom:1.5rem;border-radius:.5rem;overflow:hidden}@media(min-width:834px){header .image-wrapper[data-v-70afb46a]{margin-bottom:1.5rem}}header .image-wrapper img[data-v-70afb46a]{position:absolute;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}header .meta[data-v-70afb46a]{line-height:1;font-size:.875rem;text-transform:uppercase;font-weight:500;letter-spacing:-.025rem;display:flex;align-items:center;justify-content:space-between}header .meta .scl[data-v-70afb46a]{display:flex}header .meta .scl span[data-v-70afb46a]{display:flex;align-items:center;margin-right:1rem}header .meta .scl span svg[data-v-70afb46a]{margin-right:.25rem}header .meta .scl .comments[data-v-70afb46a]{cursor:pointer}[data-v-70afb46a] .content .ltag__user{display:none}[data-v-70afb46a] .content iframe{max-width:100%}[data-v-70afb46a] .content h1{font-size:1.875rem}[data-v-70afb46a] .content h1,[data-v-70afb46a] .content h2{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h2{font-size:1.5rem}[data-v-70afb46a] .content h3{font-size:1.25rem}[data-v-70afb46a] .content h3,[data-v-70afb46a] .content h4{margin-top:2rem;margin-bottom:1rem;letter-spacing:-.025rem}[data-v-70afb46a] .content h4{font-size:1rem}[data-v-70afb46a] .content a{color:#6e87d2}[data-v-70afb46a] .content p{margin-bottom:1rem;line-height:1.4}[data-v-70afb46a] .content p code{background-color:#d2f3e1;border-radius:.25rem;padding:.25rem}[data-v-70afb46a] .content img{width:100%;border-radius:.5rem}[data-v-70afb46a] .content .highlight{margin-bottom:1rem;border-radius:.5rem}[data-v-70afb46a] .content ul{list-style:numeral;margin-bottom:1rem}[data-v-70afb46a] .content ul li p{margin-bottom:0}[data-v-70afb46a] .content ol{margin-bottom:1rem}aside[data-v-37984f8c]{padding:1rem;background-color:#dfe8ef;border-radius:1rem}aside .username-heading[data-v-37984f8c]{display:flex;margin-bottom:1rem}aside .username-heading[data-v-37984f8c]:hover{color:#6e87d2}aside .username-heading img[data-v-37984f8c]{width:3rem;height:3rem;border-radius:50%;margin-right:1rem}aside .username-heading .text[data-v-37984f8c]{display:flex;flex-direction:column;justify-content:center}aside .username-heading .text a[data-v-37984f8c]{line-height:1}aside .username-heading .text a[data-v-37984f8c]:first-child{font-size:1.25rem;font-weight:500;letter-spacing:-.025rem;margin-bottom:.25rem}aside .username-heading .text a[data-v-37984f8c]:last-child{color:#999;font-size:.875rem}aside .username-heading.loading[data-v-37984f8c]{display:block}aside .f-button[data-v-37984f8c]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}aside .f-button[data-v-37984f8c]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}aside .f-button[data-v-37984f8c]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}aside .info>div[data-v-37984f8c]{margin-bottom:.5rem}aside .info .title[data-v-37984f8c]{font-size:.666666rem;letter-spacing:-.0125rem;font-weight:500;color:#999;text-transform:uppercase;margin-bottom:.1rem}aside .info .content[data-v-37984f8c]{font-size:.875rem;line-height:1.4}.add-comment[data-v-8c4375bc]{display:block;width:100%;padding:.5rem;border-radius:.5rem;box-shadow:-4px -4px 8px #f8fafe,4px 4px 8px #ced2db;text-transform:uppercase;text-align:center;font-weight:600;letter-spacing:-.025rem;margin-bottom:1rem}.add-comment[data-v-8c4375bc]:hover{background:linear-gradient(135deg,rgba(0,0,0,.09),hsla(0,0%,100%,0))}.add-comment[data-v-8c4375bc]:active{background:0 0;box-shadow:inset -4px -4px 8px #f0f3f9,inset 4px 4px 8px #ced2db,inset -1px -1px 4px #8e8e8e}footer[data-v-22cb8fd0]{padding:2rem;text-align:center;display:flex;align-items:center;justify-content:center}footer span[data-v-22cb8fd0]{display:inline-block;line-height:1;text-transform:uppercase;letter-spacing:-.025rem;font-size:.75rem;font-weight:500}footer a svg[data-v-22cb8fd0]{width:3rem;height:3rem;margin:0 .5rem}footer a .nuxt-icon[data-v-22cb8fd0]{width:2.5rem;height:2.5rem;margin:0 .25rem}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div><header data-v-27046cca><a href="/nuxtstop/" class="logo-wrapper nuxt-link-active" data-v-27046cca><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-27046cca><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-27046cca></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-27046cca></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-27046cca></path></svg> <div class="name-wrapper" data-v-27046cca><span class="app-name" data-v-27046cca>Nuxtstop</span> <p class="subtitle" data-v-27046cca>For all things nuxt.js</p></div></a> <nav data-v-27046cca><ul data-v-27046cca><li data-v-27046cca><a href="/nuxtstop/" class="nuxt-link-active" data-v-27046cca>
          New
        </a></li><li data-v-27046cca><a href="/nuxtstop/top" data-v-27046cca>
          Top
        </a></li></ul></nav></header> <div class="page-wrapper" data-v-10d06ee8><div class="article-content-wrapper" data-v-10d06ee8><article data-fetch-key="data-v-70afb46a:0" class="article-block" data-v-70afb46a data-v-10d06ee8><header data-v-70afb46a><h1 data-v-70afb46a>How I built a Contentful App combined with Commerce.js (IV)</h1> <div class="tags" data-v-70afb46a><a href="/nuxtstop/t/contentful" class="tag" data-v-70afb46a>
          #contentful
        </a><a href="/nuxtstop/t/javascript" class="tag" data-v-70afb46a>
          #javascript
        </a><a href="/nuxtstop/t/cms" class="tag" data-v-70afb46a>
          #cms
        </a><a href="/nuxtstop/t/commmercejs" class="tag" data-v-70afb46a>
          #commmercejs
        </a></div> <div class="image-wrapper" data-v-70afb46a><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--j-tf2cu_--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u8ns5w0ukvatimn9gbac.jpg" alt="How I built a Contentful App combined with Commerce.js (IV)" data-v-70afb46a></div> <div class="meta" data-v-70afb46a><div class="scl" data-v-70afb46a><span data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M16.4444 3C14.6733 3 13.0333 3.94162 12 5.34C10.9667 3.94162 9.32667 3 7.55556 3C4.49222 3 2 5.52338 2 8.625C2 14.8024 11.0267 20.586 11.4122 20.829C11.5922 20.9426 11.7956 21 12 21C12.2044 21 12.4078 20.9426 12.5878 20.829C12.9733 20.586 22 14.8024 22 8.625C22 5.52338 19.5078 3 16.4444 3Z" fill="#FF0000" data-v-70afb46a data-v-70afb46a></path></svg>
            3
          </span> <span class="comments" data-v-70afb46a><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-70afb46a data-v-70afb46a><path d="M6.11765 22H4.94118L5.64706 21.05C6.11765 20.3969 6.41176 19.5656 6.58824 18.5563C3.64706 17.1906 2 14.6375 2 11.3125C2 6.20625 5.82353 3 12 3C18.1765 3 22 6.20625 22 11.3125C22 16.5375 18.2353 19.625 12 19.625H11.5882C10.6471 20.7531 9 22 6.11765 22ZM12 4.1875C6.47059 4.1875 3.17647 6.85937 3.17647 11.3125C3.17647 15.1125 5.47059 16.8938 7.41177 17.6656L7.82353 17.8437L7.76471 18.3187C7.64706 19.2687 7.47059 20.1 7.11765 20.8125C9.05882 20.575 10.1765 19.5656 10.8235 18.7344L11 18.4969H12C19.9412 18.4969 20.8235 13.5094 20.8235 11.3719C20.8235 6.85938 17.5294 4.1875 12 4.1875Z" fill="black" data-v-70afb46a data-v-70afb46a></path></svg>
            0
          </span></div> <time data-v-70afb46a>Oct 8 '21</time></div></header> <div class="content" data-v-70afb46a><h2>
  <a name="the-road-so-far" href="#the-road-so-far">
  </a>
  The road so far...
</h2>

<p>It's time folks! The end of our journey through a Contentful App is here.<br>
We have gathered a lot of information in the first three parts. We have seen the theory behind it, we understood the why for all of this and we saw an integration between Contentful and a third-party platform like Commerce.js.</p>

<p>Now it's time to connects all the pieces and finally see our main customization, which is the reason why I'm here writing stuff on a monitor 😂.</p>

<p>In this final episode, we are going to see our customized entry field. Our focus will be the research and selection of a product from Commerce.js.</p>

<p>And with a little bit of sadness in my eyes, let's start our last take 🙁 🥺 😢.</p>

<hr>
<h2>
  <a name="the-concept" href="#the-concept">
  </a>
  The Concept
</h2>

<p>So what do we want to build? For our field, we want to choose which type of URL to save: Product, Category or Content Page.<br>
Based on this choice, we open a modal showing all the related entries, in our use case, all the products from Commerce.js.<br>
After the user selects a product, we save our field with some info. Since this field is of type JSON, we can structure it as we want and the user will see a card preview of the selected product and not the JSON Object itself.</p>

<hr>
<h2>
  <a name="initial-setup" href="#initial-setup">
  </a>
  Initial Setup
</h2>

<p>Inside our project, I created a lib folder where I'm going to save few files with constants and utility methods.<br>
 </p>
<h3>
  <a name="constants" href="#constants">
  </a>
  Constants
</h3>

<p>Our App has multiple purposes even if our focus is on the <em>URL + product</em> behavior.<br>
I have defined few constants to separate these logics.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">APPEARANCE_TYPES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">URL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used in this demo</span>
  <span class="na">PRODUCT</span><span class="p">:</span> <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">PRODUCTS</span><span class="p">:</span> <span class="dl">"</span><span class="s2">products</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">CATEGORY</span><span class="p">:</span> <span class="dl">"</span><span class="s2">category</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">CATEGORIES</span><span class="p">:</span> <span class="dl">"</span><span class="s2">categories</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">TYPES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">PRODUCT</span><span class="p">:</span> <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used in this demo</span>
  <span class="na">CATEGORY</span><span class="p">:</span> <span class="dl">"</span><span class="s2">category</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">PAGE</span><span class="p">:</span> <span class="dl">"</span><span class="s2">page</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p> </p>

<h3>
  <a name="utilities" href="#utilities">
  </a>
  Utilities
</h3>

<p>After that, we create some utility methods that will be used in the upcoming sections.<br>
First, we need a function that retrieves a specific product from Commerce.js:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="nx">Commerce</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getProduct</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span>
  <span class="nx">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">productId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">successCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=></span> <span class="k">void</span><span class="p">,</span>
  <span class="nx">failCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=></span> <span class="k">void</span>
<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span> <span class="o">|</span> <span class="kr">any</span><span class="o">></span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">commerce</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Commerce</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">commerce</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">successCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">product</span><span class="p">;</span>
    <span class="nx">successCB</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">failCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
    <span class="nx">failCB</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>and then we need the function that retrieves all the products:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight typescript"><code><span class="k">import</span> <span class="nx">Commerce</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCollection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/features/products</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getProducts</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span>
  <span class="nx">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">successCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">products</span><span class="p">:</span> <span class="nx">ProductCollection</span><span class="p">)</span> <span class="o">=></span> <span class="k">void</span><span class="p">,</span>
  <span class="nx">failCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=></span> <span class="k">void</span>
<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ProductCollection</span> <span class="o">|</span> <span class="kr">any</span><span class="o">></span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">commerce</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Commerce</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">commerce</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">successCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">products</span><span class="p">;</span>
    <span class="nx">successCB</span><span class="p">(</span><span class="nx">products</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">failCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
    <span class="nx">failCB</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Both methods expect an API key as input and if you have read part 3 of this series, you know where it will come from 😉.</p>


<hr>

<h2>
  <a name="custom-components" href="#custom-components">
  </a>
  Custom components
</h2>

<p>We are not limited to using the files provided by Contentful, we can also create our own.<br>
 </p>
<h3>
  <a name="product-card" href="#product-card">
  </a>
  Product Card
</h3>

<p>The Product Card Component will be used both in the modal when we are looking for products to select, and also after the selection to show a nice UI instead of the JSON object saved on Contentful.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Card</span><span class="p">,</span>
  <span class="nx">IconButton</span><span class="p">,</span>
  <span class="nx">Flex</span><span class="p">,</span>
  <span class="nx">Tag</span><span class="p">,</span>
  <span class="nx">Heading</span><span class="p">,</span>
  <span class="nx">HelpText</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">IProductCard</span> <span class="p">{</span>
  <span class="nl">product</span><span class="p">?:</span> <span class="nx">Product</span><span class="p">;</span>
  <span class="nl">showTag</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">onClickCard</span><span class="p">?:</span> <span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=></span> <span class="k">void</span><span class="p">;</span>
  <span class="nl">onClickIcon</span><span class="p">?:</span> <span class="p">()</span> <span class="o">=></span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">ProductCard</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IProductCard</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">product</span><span class="p">,</span> <span class="nx">showTag</span><span class="p">,</span> <span class="nx">onClickCard</span><span class="p">,</span> <span class="nx">onClickIcon</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">product</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Card</span>
      <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>
        <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100%</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">boxSizing</span><span class="p">:</span> <span class="dl">"</span><span class="s2">border-box</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">relative</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">})</span><span class="si">}</span>
      <span class="si">{</span><span class="p">...(</span><span class="nx">onClickCard</span> <span class="o">&&</span> <span class="p">{</span> <span class="na">onClick</span><span class="p">:</span> <span class="p">()</span> <span class="o">=></span> <span class="nx">onClickCard</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">})</span><span class="si">}</span>
    <span class="p">></span>
      <span class="si">{</span><span class="nx">onClickIcon</span> <span class="o">&&</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">IconButton</span>
          <span class="na">iconProps</span><span class="p">=</span><span class="si">{</span><span class="p">{</span> <span class="na">icon</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Close</span><span class="dl">"</span> <span class="p">}</span><span class="si">}</span>
          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>
          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>
            <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">absolute</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">top</span><span class="p">:</span> <span class="dl">"</span><span class="s2">3px</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">right</span><span class="p">:</span> <span class="dl">"</span><span class="s2">3px</span><span class="dl">"</span><span class="p">,</span>
          <span class="p">})</span><span class="si">}</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">onClickIcon</span><span class="si">}</span>
        <span class="p">/></span>
      <span class="p">)</span><span class="si">}</span>
      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">alignItems</span><span class="p">=</span><span class="s">"center"</span><span class="p">></span>
        <span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">media</span> <span class="o">&&</span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginRight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px</span><span class="dl">"</span><span class="p">,</span> <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100px</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span><span class="p">></span>
            <span class="p">&lt;</span><span class="nt">img</span>
              <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">maxWidth</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100%</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>
              <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">media</span><span class="p">.</span><span class="nx">source</span><span class="si">}</span>
              <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>
            <span class="p">/></span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
        <span class="p">)</span><span class="si">}</span>
        <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">flexDirection</span><span class="p">=</span><span class="s">"column"</span><span class="p">></span>
          <span class="si">{</span><span class="nx">showTag</span> <span class="o">&&</span> <span class="p">&lt;</span><span class="nc">Tag</span><span class="p">></span>product<span class="p">&lt;/</span><span class="nc">Tag</span><span class="p">></span><span class="si">}</span>
          <span class="p">&lt;</span><span class="nc">Heading</span><span class="p">></span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="p">&lt;/</span><span class="nc">Heading</span><span class="p">></span>
          <span class="p">&lt;</span><span class="nc">HelpText</span>
            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>
              <span class="na">fontStyle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">italic</span><span class="dl">"</span><span class="p">,</span>
              <span class="na">fontSize</span><span class="p">:</span> <span class="dl">"</span><span class="s2">12px</span><span class="dl">"</span><span class="p">,</span>
              <span class="na">marginBottom</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">})</span><span class="si">}</span>
          <span class="p">></span>
            SKU: <span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sku</span><span class="si">}</span>
          <span class="p">&lt;/</span><span class="nc">HelpText</span><span class="p">></span>
        <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">></span>
      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">></span>
    <span class="p">&lt;/</span><span class="nc">Card</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are importing some UI components from Forma36 and a Product type definition from Commerce.js.<br>
Our custom IProductCard interface defines the properties available for the component:</p>

<ul>
<li>
<em><strong>product</strong></em>: this is the prop containing the whole product data coming from Commerce.js.</li>
<li>
<em><strong>showTag</strong></em>: this flag shows a tag that identifies this card as a product (this will be more clear later).</li>
<li>
<em><strong>onClickCard</strong></em>: this optional callback is used inside the products modal when the user selects a product. The function passes the product prop as a parameter.</li>
<li>
<em><strong>onClickIcon</strong></em>: this callback, when defined, shows an 'x' icon on the top right corner and is used when we want to clear our selection.</li>
</ul>

<p>This card will have two possible layouts which we can see below:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ngK8xYiY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lb779gtl69yukg5hv7ot.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ngK8xYiY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lb779gtl69yukg5hv7ot.png" alt="Product Card - Modal UI" loading="lazy" width="880" height="140"></a></p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--VgSyymZu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yuakxz13hewuvx2miqpk.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--VgSyymZu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yuakxz13hewuvx2miqpk.png" alt="Product Card - Selected UI" loading="lazy" width="880" height="150"></a></p>

<p>The first one will be used inside the modal, the second in place of the JSON object when the product is already selected.<br>
 </p>
<h3>
  <a name="product-wrapper" href="#product-wrapper">
  </a>
  Product Wrapper
</h3>

<p>This component will be used inside the Dialog/Modal Location. It will contain all the products coming from Commerce.js.<br>
Here the customer can click on a single card and select the product.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Grid</span><span class="p">,</span> <span class="nx">GridItem</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span><span class="p">,</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getProducts</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCollection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/features/products</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">IProductWrapper</span> <span class="p">{</span>
  <span class="nl">publicKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">onSelectProduct</span><span class="p">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="p">{</span> <span class="nl">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">url</span><span class="p">:</span> <span class="kr">string</span> <span class="p">})</span> <span class="o">=></span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">ProductWrapper</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IProductWrapper</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span><span class="p">,</span> <span class="nx">onSelectProduct</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">productCollection</span><span class="p">,</span> <span class="nx">setProductCollection</span><span class="p">]</span> <span class="o">=</span>
    <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">ProductCollection</span><span class="o">></span><span class="p">();</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">getProducts</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">setProductCollection</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">]);</span>
  <span class="kd">const</span> <span class="nx">onClickCard</span> <span class="o">=</span> <span class="p">(</span><span class="na">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">onSelectProduct</span><span class="p">({</span>
      <span class="na">id</span><span class="p">:</span> <span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s2">`/p/</span><span class="p">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">permalink</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">};</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">productCollection</span><span class="p">)</span> <span class="k">return</span> <span class="p">&lt;</span><span class="nt">p</span><span class="p">></span>Loading...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">>;</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Grid</span> <span class="na">columns</span><span class="p">=</span><span class="si">{</span><span class="mi">3</span><span class="si">}</span> <span class="na">rowGap</span><span class="p">=</span><span class="s">"spacingS"</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span><span class="p">></span>
      <span class="si">{</span><span class="nx">productCollection</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">product</span><span class="p">)</span> <span class="o">=></span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">GridItem</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">></span>
          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickCard</span><span class="p">=</span><span class="si">{</span><span class="nx">onClickCard</span><span class="si">}</span> <span class="p">/></span>
        <span class="p">&lt;/</span><span class="nc">GridItem</span><span class="p">></span>
      <span class="p">))</span><span class="si">}</span>
    <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>As usual, we are using UI components from Forma36, in this case, Grid and GridItem. We are using also the previous <em>Product Card</em> component in order to show all our dummy products.<br>
If we look at the available props, we have:</p>

<ul>
<li>
<em><strong>publicKey</strong></em>: this is the key used to call Commerce.js.</li>
<li>
<em><strong>onSelectProduct</strong></em>: this is the callback that will be called when the user clicks the card. It accepts an object as parameter. This object contains the data structure that will be saved on Contentful.</li>
</ul>

<p>The component, thanks to the public key, calls Commerce.js with our utility method and saves products inside <em>productCollection</em> inner state. While is waiting for a response from Commerce.js, the component shows a simple <em><em>Loading...</em></em> paragraph to inform the reader.<br>
We can see the UI below:</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--EjrxEpnO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8bhd97kbv6s99rivx7ij.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--EjrxEpnO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8bhd97kbv6s99rivx7ij.png" alt="Product Wrapper - Base UI" loading="lazy" width="880" height="182"></a></p>

<blockquote>
<p><em>This is a simple demo with a simple UI and few products. Of course, if we want to do some improvements we could add an input field to search products and maybe also pagination if your Product Catalog is huge.<br>
The only limit is your imagination (and your Business requirements/plan</em> 😂<em>)</em></p>
</blockquote>

<p> </p>
<h3>
  <a name="url-appearance-field" href="#url-appearance-field">
  </a>
  Url Appearance Field
</h3>

<p>This is definitely the most complex component of the entire app.<br>
This UI is rendered only when our instance parameter is set to 'URL'.<br>
I'm going to analyze the file in the detail.<br>
 </p>
<h4>
  <a name="url-appearance-field-imports" href="#url-appearance-field-imports">
  </a>
  Url Appearance Field: imports
</h4>


<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Flex</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">,</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getProduct</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/field-editor-shared</span><span class="dl">"</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>This is pretty clear, we are importing  UI components, utilities, typescript types...🥱😪<br>
 </p>
<h4>
  <a name="url-appearance-field-props-interface" href="#url-appearance-field-props-interface">
  </a>
  Url Appearance Field: props interface
</h4>


<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kr">interface</span> <span class="nx">IUrlAppearanceField</span> <span class="p">{</span>
  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>


<p>The interface is simple, we are expecting, as a prop, the SDK related to the field provided by Contentful.<br>
 </p>
<h4>
  <a name="url-appearance-field-react-hooks" href="#url-appearance-field-react-hooks">
  </a>
  Url Appearance Field: react hooks
</h4>

<p>Here we are extracting the Commerce.js public key from our <code>parameters.installation</code> and we are defining some react hooks.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">sdk</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">innerValue</span><span class="p">,</span> <span class="nx">setInnerValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">product</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">></span><span class="p">();</span>

<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">innerValue</span><span class="p">?.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">getProduct</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">]);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We have two useState hooks: the first is an inner state containing the value saved on Contentful, extracted with the <em>getValue</em> function provided by the SDK. The second contains the Commerce.js product.<br>
The useEffect hook is called every time the innerValue changes and also on first load. The hook checks if the saved value is of type 'product' and if so, we call Commerce.js retrieving the full product, passing the <em>innerValue.id</em> which contains the id of a specific product.<br>
 </p>
<h4>
  <a name="url-appearance-field-the-ui" href="#url-appearance-field-the-ui">
  </a>
  Url Appearance Field: the UI
</h4>

<p>Let's jump to the return statement:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;></span>
      <span class="si">{</span><span class="nx">product</span> <span class="o">&&</span> <span class="p">(</span>
        <span class="p">&lt;></span>
          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">showTag</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickIcon</span><span class="p">=</span><span class="si">{</span><span class="nx">clearValue</span><span class="si">}</span> <span class="p">/></span>
          <span class="p">&lt;</span><span class="nt">div</span>
            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>
              <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span><span class="p">,</span>
              <span class="na">borderTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid #cfd9e0</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">})</span><span class="si">}</span>
          <span class="p">/></span>
        <span class="p">&lt;/></span>
      <span class="p">)</span><span class="si">}</span>
      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginTop</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">innerValue</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span> <span class="p">})</span><span class="si">}</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nc">Button</span>
          <span class="na">icon</span><span class="p">=</span><span class="s">"ShoppingCart"</span>
          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>
          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginLeft</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2rem</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=></span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span><span class="si">}</span>
        <span class="p">></span>
          Choose a Product
        <span class="p">&lt;/</span><span class="nc">Button</span><span class="p">></span>
      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">></span>
    <span class="p">&lt;/></span>
  <span class="p">);</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are showing a <em>Product Card</em> and a separator when the user selects or has already selected a product.<br>
The component has the showTag attribute set to true and the onClickIcon callback defined with a 'clearValue' function.<br>
Finally, we have a Forma36 Button with a cart icon and a callback on the onClick event that opens a Dialog of type 'product'.<br>
We can see the UI in the following screenshots:<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Km134CU5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89tatf2o1dg98qal4xha.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Km134CU5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89tatf2o1dg98qal4xha.png" alt="Url Appearance Field | base UI" loading="lazy" width="880" height="127"></a></p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--c4Ogz46o--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u4lq3foxi9u7m8hjols3.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--c4Ogz46o--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u4lq3foxi9u7m8hjols3.png" alt="Url Appearance Field | product selected" loading="lazy" width="880" height="277"></a></p>

<p>As mentioned a million times 😅 we are focusing only on the product selection, the complete UI would instead be like this:<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--2uBrD_SG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0abrt4b95r2pmyb3dna.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--2uBrD_SG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0abrt4b95r2pmyb3dna.png" alt="Url Appearance Field | complete UI" loading="lazy" width="880" height="281"></a></p>

<p>The light blue product badge lets the user understand immediately which type of URL has been saved on the field.<br>
 </p>
<h4>
  <a name="url-appearance-field-clearvalue-callback" href="#url-appearance-field-clearvalue-callback">
  </a>
  Url Appearance Field: clearValue callback
</h4>

<p>The clearValue function lets the user clear his selection by clicking on the 'x' icon on the card.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">clearValue</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">setProduct</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
  <span class="nx">setInnerValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
  <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We are cleaning our react states and we are using the <em>setValue</em> function provided by the SDK in order to reset the value also for Contentful.<br>
 </p>
<h4>
  <a name="url-appearance-field-opendialog-callback" href="#url-appearance-field-opendialog-callback">
  </a>
  Url Appearance Field: openDialog callback
</h4>

<p>The openDialog function is the core of the component.<br>
It lets you open the Contentful Modal with the <code>dialogs.openCurrentApp</code> method passing few parameters. Basically, this function moves the focus of your app into the Dialog Location.<br>
Since is a Promise, it waits until you close the modal and after that, you have access to a response object.<br>
If you remember, in the Product Wrapper component we defined an object composed of an id, type and URL. This is the object received from the Promise when we select a product (if we click on the x of the modal we receive an undefined object).<br>
Let's see the implementation:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">openDialog</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="kd">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">dialogs</span><span class="p">.</span><span class="nx">openCurrentApp</span><span class="p">({</span>
      <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">top</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">minHeight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">75vh</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fullWidth</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">shouldCloseOnOverlayClick</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">allowHeightOverflow</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s2">`Search </span><span class="p">${</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">CATEGORY</span> <span class="p">?</span> <span class="dl">"</span><span class="s2"> Categories</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Products</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="na">appearance</span><span class="p">:</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span><span class="p">,</span> <span class="kd">type</span> <span class="p">},</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">setInnerValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
      <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>As you can see, if the res object is defined, it means that we have selected a product and we are saving this object into our react state but also into Contentful through the SDK.<br>
</p><details>
  <summary>Here you can see the entire code related to the product</summary>
  <br>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Flex</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">,</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">getProduct</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/field-editor-shared</span><span class="dl">"</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">IFieldUrl</span> <span class="p">{</span>
  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">UrlAppearanceField</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IFieldUrl</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">sdk</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">innerValue</span><span class="p">,</span> <span class="nx">setInnerValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">product</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">></span><span class="p">();</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">innerValue</span><span class="p">?.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">getProduct</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">]);</span>

  <span class="kd">const</span> <span class="nx">openDialog</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">dialogs</span><span class="p">.</span><span class="nx">openCurrentApp</span><span class="p">({</span>
      <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">top</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">minHeight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">75vh</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fullWidth</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">shouldCloseOnOverlayClick</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">allowHeightOverflow</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s2">`Search </span><span class="p">${</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">CATEGORY</span> <span class="p">?</span> <span class="dl">"</span><span class="s2"> Categories</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Products</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="na">appearance</span><span class="p">:</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span><span class="p">,</span> <span class="kd">type</span> <span class="p">},</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">setInnerValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
      <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">clearValue</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">setProduct</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
    <span class="nx">setInnerValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
    <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;></span>
      <span class="si">{</span><span class="nx">product</span> <span class="o">&&</span> <span class="p">(</span>
        <span class="p">&lt;></span>
          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">showTag</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickIcon</span><span class="p">=</span><span class="si">{</span><span class="nx">clearValue</span><span class="si">}</span> <span class="p">/></span>
          <span class="p">&lt;</span><span class="nt">div</span>
            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>
              <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span><span class="p">,</span>
              <span class="na">borderTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid #cfd9e0</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">})</span><span class="si">}</span>
          <span class="p">/></span>
        <span class="p">&lt;/></span>
      <span class="p">)</span><span class="si">}</span>
      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginTop</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">innerValue</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span> <span class="p">})</span><span class="si">}</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nc">Button</span>
          <span class="na">icon</span><span class="p">=</span><span class="s">"ShoppingCart"</span>
          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>
          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginLeft</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2rem</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=></span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span><span class="si">}</span>
        <span class="p">></span>
          Choose a Product
        <span class="p">&lt;/</span><span class="nc">Button</span><span class="p">></span>
      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">></span>
    <span class="p">&lt;/></span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



</details>
<p></p>


<hr>

<h2>
  <a name="connecting-dots" href="#connecting-dots">
  </a>
  Connecting dots
</h2>

<p>Now is the time to connect all the pieces of the puzzle.<br>
In the previous section, we saw all our custom implementation and now we need to use the locations provided by Contentful and finish our implementation.</p>

<p>Our focus is on the <code>Dialog.tsx</code> and <code>Field.tsx</code> files. Let's start with the Modal.<br>
 </p>
<h3>
  <a name="dialog-location" href="#dialog-location">
  </a>
  Dialog Location
</h3>

<p>This file is used when we call the <code>dialogs.openCurrentApp</code> function that we saw previously.<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ModalContent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">DialogExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/app-sdk</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductWrapper</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductWrapper</span><span class="dl">"</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">DialogProps</span> <span class="p">{</span>
  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">DialogExtensionSDK</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">Dialog</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">DialogProps</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="kd">type</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">invocation</span><span class="p">;</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;></span>
      <span class="p">&lt;</span><span class="nc">ModalContent</span><span class="p">></span>
        <span class="si">{</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span> <span class="o">&&</span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nc">ProductWrapper</span>
            <span class="na">publicKey</span><span class="p">=</span><span class="si">{</span><span class="nx">publicKey</span><span class="si">}</span>
            <span class="na">onSelectProduct</span><span class="p">=</span><span class="si">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">close</span><span class="si">}</span>
          <span class="p">/></span>
        <span class="p">)</span><span class="si">}</span>
        <span class="si">{</span><span class="cm">/* {type === TYPES.CATEGORY && (
          &lt;CategoryWrapper
            publicKey={publicKey}
            onSelectCategory={props.sdk.close}
          />
        )} */</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nc">ModalContent</span><span class="p">></span>
    <span class="p">&lt;/></span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Dialog</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>We have a specific Typescript type definition for the SDK which is now <code>DialogExtensionSDK</code>. With this SDK, inside the <code>parameters.invocation</code> we have access to the type attribute that we passed when we called the modal. This attribute lets us know what type of content to provide to the modal as you can see in the return statement.<br>
To our <em>Product Wrapper</em> component, we are passing also the <code>close</code> SDK callback that we'll be used when we select a product passing back the object to save on Contentful.<br>
 </p>
<h3>
  <a name="field-location" href="#field-location">
  </a>
  Field Location
</h3>

<p>Based on our instance parameter 'type' we render a UI or another, in our demo will be always the <em>URL Appearance Field</em><br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/app-sdk</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UrlAppearanceField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./UrlAppearanceField</span><span class="dl">"</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">FieldProps</span> <span class="p">{</span>
  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">Field</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">FieldProps</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">const</span> <span class="na">instanceProps</span><span class="p">:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">instance</span><span class="p">;</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=></span> <span class="p">{</span>
    <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">startAutoResizer</span><span class="p">();</span>
    <span class="k">return</span> <span class="p">()</span> <span class="o">=></span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">stopAutoResizer</span><span class="p">();</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">props</span><span class="p">]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;></span>
      <span class="si">{</span><span class="nx">instanceProps</span><span class="p">.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span> <span class="o">&&</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">UrlAppearanceField</span> <span class="na">sdk</span><span class="p">=</span><span class="si">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="si">}</span> <span class="p">/></span>
      <span class="p">)</span><span class="si">}</span>
      <span class="si">{</span><span class="cm">/*
        {instanceProps.type === APPEARANCE_TYPES.PRODUCT && (
          &lt;ProductAppearanceField sdk={props.sdk} />
        )}
        {instanceProps.type === APPEARANCE_TYPES.PRODUCTS && (
          &lt;ProductsAppearanceField sdk={props.sdk} />
        )}
        {instanceProps.type === APPEARANCE_TYPES.CATEGORY && (
          &lt;CategoryAppearanceField sdk={props.sdk} />
        )}
        {instanceProps.type === APPEARANCE_TYPES.CATEGORIES && (
          &lt;CategoriesAppearanceField sdk={props.sdk} />
        )}
      */</span><span class="si">}</span>
    <span class="p">&lt;/></span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Field</span><span class="p">;</span>
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Here, the only thing that I want to clarify is the useEffect hook. We are using the <code>window.startAutoResizer</code> feature. This function updates the height of the iframe every time something happens (for example when we select or remove the product card). Doing this, we have always our wrapper height updated with no white spaces or scrollbars.</p>


<hr>

<h2>
  <a name="little-demo" href="#little-demo">
  </a>
  Little Demo
</h2>

<p>This is it, we finally completed our app 🥳 🥳 🥳.<br>
Here you can see a little demo:<br>
<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--_IPdoFqd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0h3azpahcqw5vip1hdqe.gif" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--_IPdoFqd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0h3azpahcqw5vip1hdqe.gif" alt="Demo" loading="lazy" width="800" height="447" data-animated="true"></a><br>
Here instead the snapshot of the entry where you can see what is saved on Contentful:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"space"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Space"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxx"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35MgIumMobPVc9qnCH0Xa0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Entry"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-10-02T16:55:24.957Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-10-03T10:11:46.157Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"environment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"website"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"revision"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ContentType"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testCommerceSelector"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prod_RqEv5xXO2d5Zz4"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/p/shoe05"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>




<hr>

<h2>
  <a name="deploying-the-app" href="#deploying-the-app">
  </a>
  Deploying the app
</h2>

<p>Of course is not over yet 😉. We need to deploy our application, otherwise will be available only for us and with a local environment running.<br>
Since our app is very small we don't need an external provider, we can deploy the app directly on Contentful, the process is pretty simple.<br>
In our package.json file, we have scripts that build and upload the app for us.<br>
The commands to run on the terminal are:<br>
</p>

<div class="highlight js-code-highlight">
<pre class="highlight shell"><code>npm run build
npm run upload
</code></pre>
<div class="highlight__panel js-actions-panel">
<div class="highlight__panel-action js-fullscreen-code-action">
    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>
    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>
</svg>

    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>
    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>
</svg>

</div>
</div>
</div>



<p>Follow the instructions of the script and when finished we can see on Contentful our uploaded app.</p>

<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--sPJWQfji--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ajka0ikn7t6g0xcddrb6.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--sPJWQfji--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ajka0ikn7t6g0xcddrb6.png" alt="App Deployed" loading="lazy" width="880" height="413"></a></p>

<p>As you can see now the frontend is not anymore our local environment but is hosted by Contentful 😎.</p>


<hr>

<h2>
  <a name="a-step-further" href="#a-step-further">
  </a>
  A step further...
</h2>

<p>It's not part of this series but I want to mention one further step that we can and should do for our app.<br>
As we have seen, data about the product saved on Contentful, is minimal: product code and the permalink, nothing else. All other information for the product card is gathered in real-time by calling Commerce.js.<br>
But what happens if a permalink changes or worse, the product on Commerce.js is deleted? Our website or mobile app that depends on Contentful data, can lead to a broken page.</p>

<p>Commerce.js provides a set of <a href="https://commercejs.com/docs/guides/webhooks/">webhooks</a> that we can configure. For example, there is a specific webhook when the product has been updated or another one if is deleted.<br>
For each one, we need to provide a URL that Commerce.js can call every time something happens.</p>

<p>My demo website uses my Contentful data. It's built with <a href="https://nextjs.org/">Next.js</a> and deployed on <a href="https://vercel.com/">Vercel</a> and I defined few <a href="https://nextjs.org/docs/api-routes/introduction">API routes</a> that listen to Commerce.js webhooks.<br>
Every time a product changes, my API route receives the updated product from Commerce.js and thanks to the Contentful <a href="https://www.contentful.com/developers/docs/references/content-management-api/">Content Management API</a> I can update my content with the updated data or skip if nothing that I care about is changed.</p>

<p>Or for example, If I don't want to update my content automatically, when I receive the updated product I can send a notification and hopefully (😆) there will be someone that will update manually the broken link(s) on Contentful.</p>


<hr>

<h2>
  <a name="conclusion" href="#conclusion">
  </a>
  Conclusion...
</h2>

<p>Wow...what a journey 🤯...probably not the best way to start my 'blog career' with a 4 articles series but it was fun, so much fun 😁.<br>
Hope you enjoyed it too and if you are still here reading thank you very much, I appreciate it 🙇🏻‍♂️.<br>
Now you can leave or drop a comment or a like or a follow or whatever 😆...<br>
And if with 'the road so far...' at the beginning of this page you get which TV series I'm referring to, <em>carry on</em>, drop another comment below and let me know.</p>

<p>See ya 🤙 💪</p>

</div></article> <div class="aside-username-wrapper" data-v-10d06ee8><aside class="aside-username-block" data-v-37984f8c data-v-10d06ee8><div class="username-heading loading" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-heading" data-v-37984f8c><div class="vue-content-placeholders-heading__img"></div> <div class="vue-content-placeholders-heading__content"><div class="vue-content-placeholders-heading__title"></div> <div class="vue-content-placeholders-heading__subtitle"></div></div></div></div></div> <div class="info" data-v-37984f8c><div class="vue-content-placeholders vue-content-placeholders-is-animated" data-v-37984f8c><div class="vue-content-placeholders-text" data-v-37984f8c><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div><div class="vue-content-placeholders-text__line"></div></div></div></div></aside></div></div> <div class="comments-block" data-v-8c4375bc data-v-10d06ee8><!----> <a href="https://dev.to/wiommi/how-i-built-a-contentful-app-combined-with-commerce-js-iv-4nli" target="_blank" rel="nofollow noopener noreferer" class="add-comment" data-v-8c4375bc>
    Add comment
  </a></div></div> <footer data-v-22cb8fd0><span data-v-22cb8fd0>Built with</span> <a href="https://nuxtjs.org" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nuxt-icon" data-v-22cb8fd0 data-v-22cb8fd0><path d="M13.5599 8.54348L12.8055 9.87164L10.2257 5.3282L2.306 19.274H7.66815C7.66815 20.0075 8.25298 20.6021 8.97441 20.6021H2.306C1.83937 20.6021 1.40822 20.3489 1.17494 19.9379C0.941664 19.527 0.941687 19.0208 1.175 18.6099L9.09469 4.66412C9.32802 4.25316 9.75926 4 10.226 4C10.6926 4 11.1239 4.25316 11.3572 4.66412L13.5599 8.54348V8.54348Z" fill="#00C58E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M19.2769 18.6099L14.3143 9.87165L13.5599 8.54348L12.8055 9.87165L7.84343 18.6099C7.61011 19.0208 7.61009 19.527 7.84337 19.9379C8.07665 20.3489 8.50779 20.6021 8.97443 20.6021H18.1443C18.611 20.6021 19.0424 20.3491 19.2758 19.9382C19.5092 19.5272 19.5092 19.0209 19.2758 18.6099H19.2769ZM8.97443 19.274L13.5599 11.1998L18.1443 19.274H8.97443H8.97443Z" fill="#2F495E" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M22.825 19.938C22.5917 20.3489 22.1606 20.6021 21.694 20.6021H18.1443C18.8657 20.6021 19.4505 20.0075 19.4505 19.274H21.6913L15.3331 8.07696L14.3142 9.87164L13.5599 8.54348L14.2021 7.41287C14.4354 7.00192 14.8667 6.74875 15.3334 6.74875C15.8001 6.74875 16.2313 7.00192 16.4646 7.41287L22.825 18.6099C23.0583 19.0208 23.0583 19.5271 22.825 19.938V19.938Z" fill="#108775" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a> <span data-v-22cb8fd0>&</span> <a href="https://docs.dev.to/api" rel="nofollow noopener" target="_blank" data-v-22cb8fd0><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-22cb8fd0 data-v-22cb8fd0><path d="M1.5726 5.13748C1.42945 5.20622 1.2411 5.36661 1.15822 5.48117C1 5.69503 1 5.74849 1 11.8739C1 17.9993 1 18.0528 1.15822 18.2667C1.2411 18.3812 1.42945 18.5416 1.5726 18.6104C1.8137 18.7402 2.46164 18.7478 12 18.7478C21.5384 18.7478 22.1863 18.7402 22.4274 18.6104C22.5706 18.5416 22.7589 18.3812 22.8418 18.2667C23 18.0528 23 17.9993 23 11.8739C23 5.74849 23 5.69503 22.8418 5.48117C22.7589 5.36661 22.5706 5.20622 22.4274 5.13748C22.1863 5.00764 21.5384 5 12 5C2.46164 5 1.8137 5.00764 1.5726 5.13748ZM7.7055 8.2613C8.0822 8.45989 8.59454 9.0098 8.77536 9.40694C8.89589 9.66664 8.91095 9.94922 8.91095 12.0649C8.91095 14.3104 8.90344 14.4478 8.75275 14.7839C8.51919 15.288 8.16506 15.6546 7.68288 15.899C7.26096 16.1052 7.22328 16.1128 5.7315 16.1358L4.20206 16.1663V12.1031V8.04744L5.80684 8.07035C7.27602 8.09327 7.42672 8.10854 7.7055 8.2613ZM13.6952 8.89521V9.73538H12.4521H11.2089V10.4991V11.2629H11.9623H12.7158V12.1031V12.9432H11.9623H11.2089V13.707V14.4708H12.4521H13.6952V15.3109V16.151H12C10.1315 16.151 10.0411 16.1358 9.67191 15.6928L9.47603 15.4484V12.1336C9.47603 8.46752 9.46851 8.49807 9.95069 8.20783C10.1692 8.07035 10.3425 8.05508 11.9473 8.05508H13.6952V8.89521ZM16.5658 10.3769C16.8897 11.6295 17.1685 12.6912 17.176 12.7293C17.1911 12.7675 17.4699 11.7441 17.8014 10.461C18.1254 9.17017 18.4343 8.1009 18.4795 8.08563C18.5247 8.06271 18.9541 8.06271 19.4288 8.07035L20.3028 8.09327L19.376 11.6219C18.8713 13.5542 18.4117 15.2269 18.3664 15.3261C18.0123 16.0135 17.274 16.3343 16.7164 16.0441C16.4528 15.899 16.0911 15.4865 15.9705 15.1887C15.9254 15.0665 15.4884 13.4549 15.0062 11.6142C14.524 9.76593 14.1171 8.20783 14.0945 8.15437C14.0644 8.07035 14.2301 8.05508 15.0212 8.07035L15.9856 8.09327L16.5658 10.3769Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path><path d="M5.93491 12.103V14.4707H6.27394C6.66574 14.4707 7.01983 14.3103 7.1404 14.0965C7.18559 14.0048 7.21575 13.2105 7.21575 12.0648V10.1783L6.99725 9.95683C6.80133 9.76591 6.71847 9.73535 6.35683 9.73535H5.93491V12.103Z" fill="black" data-v-22cb8fd0 data-v-22cb8fd0></path></svg></a></footer></div></div></div><script>window.__NUXT__=function(s,a,n,p,l){return n.type_of="article",n.id=840069,n.title="How I built a Contentful App combined with Commerce.js (IV)",n.description="The road so far...   It's time folks! The end of our journey through a Contentful App is...",n.readable_publish_date="Oct 8 '21",n.slug="how-i-built-a-contentful-app-combined-with-commerce-js-iv-4nli",n.path="/wiommi/how-i-built-a-contentful-app-combined-with-commerce-js-iv-4nli",n.url=p,n.comments_count=0,n.public_reactions_count=3,n.collection_id=14452,n.published_timestamp=a,n.positive_reactions_count=3,n.cover_image="https://res.cloudinary.com/practicaldev/image/fetch/s--j-tf2cu_--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u8ns5w0ukvatimn9gbac.jpg",n.social_image="https://res.cloudinary.com/practicaldev/image/fetch/s--oAWBh4e4--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u8ns5w0ukvatimn9gbac.jpg",n.canonical_url=p,n.created_at="2021-09-25T09:31:27Z",n.edited_at=s,n.crossposted_at=s,n.published_at=a,n.last_comment_at=a,n.reading_time_minutes=12,n.tag_list="contentful, javascript, cms, commmercejs",n.tags=["contentful","javascript","cms","commmercejs"],n.body_html='<h2>\n  <a name="the-road-so-far" href="#the-road-so-far">\n  </a>\n  The road so far...\n</h2>\n\n<p>It\'s time folks! The end of our journey through a Contentful App is here.<br>\nWe have gathered a lot of information in the first three parts. We have seen the theory behind it, we understood the why for all of this and we saw an integration between Contentful and a third-party platform like Commerce.js.</p>\n\n<p>Now it\'s time to connects all the pieces and finally see our main customization, which is the reason why I\'m here writing stuff on a monitor 😂.</p>\n\n<p>In this final episode, we are going to see our customized entry field. Our focus will be the research and selection of a product from Commerce.js.</p>\n\n<p>And with a little bit of sadness in my eyes, let\'s start our last take 🙁 🥺 😢.</p>\n\n<hr>\n<h2>\n  <a name="the-concept" href="#the-concept">\n  </a>\n  The Concept\n</h2>\n\n<p>So what do we want to build? For our field, we want to choose which type of URL to save: Product, Category or Content Page.<br>\nBased on this choice, we open a modal showing all the related entries, in our use case, all the products from Commerce.js.<br>\nAfter the user selects a product, we save our field with some info. Since this field is of type JSON, we can structure it as we want and the user will see a card preview of the selected product and not the JSON Object itself.</p>\n\n<hr>\n<h2>\n  <a name="initial-setup" href="#initial-setup">\n  </a>\n  Initial Setup\n</h2>\n\n<p>Inside our project, I created a lib folder where I\'m going to save few files with constants and utility methods.<br>\n </p>\n<h3>\n  <a name="constants" href="#constants">\n  </a>\n  Constants\n</h3>\n\n<p>Our App has multiple purposes even if our focus is on the <em>URL + product</em> behavior.<br>\nI have defined few constants to separate these logics.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">APPEARANCE_TYPES</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">URL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used in this demo</span>\n  <span class="na">PRODUCT</span><span class="p">:</span> <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">,</span>\n  <span class="na">PRODUCTS</span><span class="p">:</span> <span class="dl">"</span><span class="s2">products</span><span class="dl">"</span><span class="p">,</span>\n  <span class="na">CATEGORY</span><span class="p">:</span> <span class="dl">"</span><span class="s2">category</span><span class="dl">"</span><span class="p">,</span>\n  <span class="na">CATEGORIES</span><span class="p">:</span> <span class="dl">"</span><span class="s2">categories</span><span class="dl">"</span><span class="p">,</span>\n<span class="p">};</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">TYPES</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="na">PRODUCT</span><span class="p">:</span> <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// used in this demo</span>\n  <span class="na">CATEGORY</span><span class="p">:</span> <span class="dl">"</span><span class="s2">category</span><span class="dl">"</span><span class="p">,</span>\n  <span class="na">PAGE</span><span class="p">:</span> <span class="dl">"</span><span class="s2">page</span><span class="dl">"</span><span class="p">,</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p> </p>\n\n<h3>\n  <a name="utilities" href="#utilities">\n  </a>\n  Utilities\n</h3>\n\n<p>After that, we create some utility methods that will be used in the upcoming sections.<br>\nFirst, we need a function that retrieves a specific product from Commerce.js:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="nx">Commerce</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">getProduct</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span>\n  <span class="nx">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>\n  <span class="nx">productId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>\n  <span class="nx">successCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">,</span>\n  <span class="nx">failCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>\n<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span> <span class="o">|</span> <span class="kr">any</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">try</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">commerce</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Commerce</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>\n    <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">commerce</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>\n    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">successCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">product</span><span class="p">;</span>\n    <span class="nx">successCB</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>\n  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>\n    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">failCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>\n    <span class="nx">failCB</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>and then we need the function that retrieves all the products:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight typescript"><code><span class="k">import</span> <span class="nx">Commerce</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCollection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/features/products</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">getProducts</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span>\n  <span class="nx">apiKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>\n  <span class="nx">successCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">products</span><span class="p">:</span> <span class="nx">ProductCollection</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">,</span>\n  <span class="nx">failCB</span><span class="p">?:</span> <span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>\n<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ProductCollection</span> <span class="o">|</span> <span class="kr">any</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">try</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">commerce</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Commerce</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>\n    <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">commerce</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>\n    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">successCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">products</span><span class="p">;</span>\n    <span class="nx">successCB</span><span class="p">(</span><span class="nx">products</span><span class="p">);</span>\n  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>\n    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">failCB</span><span class="p">)</span> <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>\n    <span class="nx">failCB</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Both methods expect an API key as input and if you have read part 3 of this series, you know where it will come from 😉.</p>\n\n\n<hr>\n\n<h2>\n  <a name="custom-components" href="#custom-components">\n  </a>\n  Custom components\n</h2>\n\n<p>We are not limited to using the files provided by Contentful, we can also create our own.<br>\n </p>\n<h3>\n  <a name="product-card" href="#product-card">\n  </a>\n  Product Card\n</h3>\n\n<p>The Product Card Component will be used both in the modal when we are looking for products to select, and also after the selection to show a nice UI instead of the JSON object saved on Contentful.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span>\n  <span class="nx">Card</span><span class="p">,</span>\n  <span class="nx">IconButton</span><span class="p">,</span>\n  <span class="nx">Flex</span><span class="p">,</span>\n  <span class="nx">Tag</span><span class="p">,</span>\n  <span class="nx">Heading</span><span class="p">,</span>\n  <span class="nx">HelpText</span><span class="p">,</span>\n<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="kr">interface</span> <span class="nx">IProductCard</span> <span class="p">{</span>\n  <span class="nl">product</span><span class="p">?:</span> <span class="nx">Product</span><span class="p">;</span>\n  <span class="nl">showTag</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>\n  <span class="nl">onClickCard</span><span class="p">?:</span> <span class="p">(</span><span class="nx">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n  <span class="nl">onClickIcon</span><span class="p">?:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">ProductCard</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IProductCard</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">product</span><span class="p">,</span> <span class="nx">showTag</span><span class="p">,</span> <span class="nx">onClickCard</span><span class="p">,</span> <span class="nx">onClickIcon</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>\n\n  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">product</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nc">Card</span>\n      <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>\n        <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100%</span><span class="dl">"</span><span class="p">,</span>\n        <span class="na">boxSizing</span><span class="p">:</span> <span class="dl">"</span><span class="s2">border-box</span><span class="dl">"</span><span class="p">,</span>\n        <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">relative</span><span class="dl">"</span><span class="p">,</span>\n      <span class="p">})</span><span class="si">}</span>\n      <span class="si">{</span><span class="p">...(</span><span class="nx">onClickCard</span> <span class="o">&amp;&amp;</span> <span class="p">{</span> <span class="na">onClick</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">onClickCard</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">})</span><span class="si">}</span>\n    <span class="p">&gt;</span>\n      <span class="si">{</span><span class="nx">onClickIcon</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n        <span class="p">&lt;</span><span class="nc">IconButton</span>\n          <span class="na">iconProps</span><span class="p">=</span><span class="si">{</span><span class="p">{</span> <span class="na">icon</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Close</span><span class="dl">"</span> <span class="p">}</span><span class="si">}</span>\n          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>\n          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>\n            <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">absolute</span><span class="dl">"</span><span class="p">,</span>\n            <span class="na">top</span><span class="p">:</span> <span class="dl">"</span><span class="s2">3px</span><span class="dl">"</span><span class="p">,</span>\n            <span class="na">right</span><span class="p">:</span> <span class="dl">"</span><span class="s2">3px</span><span class="dl">"</span><span class="p">,</span>\n          <span class="p">})</span><span class="si">}</span>\n          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">onClickIcon</span><span class="si">}</span>\n        <span class="p">/&gt;</span>\n      <span class="p">)</span><span class="si">}</span>\n      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">alignItems</span><span class="p">=</span><span class="s">"center"</span><span class="p">&gt;</span>\n        <span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">media</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginRight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px</span><span class="dl">"</span><span class="p">,</span> <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100px</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span><span class="p">&gt;</span>\n            <span class="p">&lt;</span><span class="nt">img</span>\n              <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">maxWidth</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100%</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>\n              <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">media</span><span class="p">.</span><span class="nx">source</span><span class="si">}</span>\n              <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>\n            <span class="p">/&gt;</span>\n          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n        <span class="p">)</span><span class="si">}</span>\n        <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">flexDirection</span><span class="p">=</span><span class="s">"column"</span><span class="p">&gt;</span>\n          <span class="si">{</span><span class="nx">showTag</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nc">Tag</span><span class="p">&gt;</span>product<span class="p">&lt;/</span><span class="nc">Tag</span><span class="p">&gt;</span><span class="si">}</span>\n          <span class="p">&lt;</span><span class="nc">Heading</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="p">&lt;/</span><span class="nc">Heading</span><span class="p">&gt;</span>\n          <span class="p">&lt;</span><span class="nc">HelpText</span>\n            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>\n              <span class="na">fontStyle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">italic</span><span class="dl">"</span><span class="p">,</span>\n              <span class="na">fontSize</span><span class="p">:</span> <span class="dl">"</span><span class="s2">12px</span><span class="dl">"</span><span class="p">,</span>\n              <span class="na">marginBottom</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span>\n            <span class="p">})</span><span class="si">}</span>\n          <span class="p">&gt;</span>\n            SKU: <span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">sku</span><span class="si">}</span>\n          <span class="p">&lt;/</span><span class="nc">HelpText</span><span class="p">&gt;</span>\n        <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">&gt;</span>\n      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">&gt;</span>\n    <span class="p">&lt;/</span><span class="nc">Card</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are importing some UI components from Forma36 and a Product type definition from Commerce.js.<br>\nOur custom IProductCard interface defines the properties available for the component:</p>\n\n<ul>\n<li>\n<em><strong>product</strong></em>: this is the prop containing the whole product data coming from Commerce.js.</li>\n<li>\n<em><strong>showTag</strong></em>: this flag shows a tag that identifies this card as a product (this will be more clear later).</li>\n<li>\n<em><strong>onClickCard</strong></em>: this optional callback is used inside the products modal when the user selects a product. The function passes the product prop as a parameter.</li>\n<li>\n<em><strong>onClickIcon</strong></em>: this callback, when defined, shows an \'x\' icon on the top right corner and is used when we want to clear our selection.</li>\n</ul>\n\n<p>This card will have two possible layouts which we can see below:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ngK8xYiY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lb779gtl69yukg5hv7ot.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ngK8xYiY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lb779gtl69yukg5hv7ot.png" alt="Product Card - Modal UI" loading="lazy" width="880" height="140"></a></p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--VgSyymZu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yuakxz13hewuvx2miqpk.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--VgSyymZu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yuakxz13hewuvx2miqpk.png" alt="Product Card - Selected UI" loading="lazy" width="880" height="150"></a></p>\n\n<p>The first one will be used inside the modal, the second in place of the JSON object when the product is already selected.<br>\n </p>\n<h3>\n  <a name="product-wrapper" href="#product-wrapper">\n  </a>\n  Product Wrapper\n</h3>\n\n<p>This component will be used inside the Dialog/Modal Location. It will contain all the products coming from Commerce.js.<br>\nHere the customer can click on a single card and select the product.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Grid</span><span class="p">,</span> <span class="nx">GridItem</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span><span class="p">,</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">getProducts</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCollection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/features/products</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="kr">interface</span> <span class="nx">IProductWrapper</span> <span class="p">{</span>\n  <span class="nl">publicKey</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>\n  <span class="nl">onSelectProduct</span><span class="p">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="p">{</span> <span class="nl">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">url</span><span class="p">:</span> <span class="kr">string</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">ProductWrapper</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IProductWrapper</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span><span class="p">,</span> <span class="nx">onSelectProduct</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">productCollection</span><span class="p">,</span> <span class="nx">setProductCollection</span><span class="p">]</span> <span class="o">=</span>\n    <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">ProductCollection</span><span class="o">&gt;</span><span class="p">();</span>\n  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">getProducts</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">setProductCollection</span><span class="p">);</span>\n  <span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">]);</span>\n  <span class="kd">const</span> <span class="nx">onClickCard</span> <span class="o">=</span> <span class="p">(</span><span class="na">product</span><span class="p">:</span> <span class="nx">Product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">onSelectProduct</span><span class="p">({</span>\n      <span class="na">id</span><span class="p">:</span> <span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>\n      <span class="na">type</span><span class="p">:</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">,</span>\n      <span class="na">url</span><span class="p">:</span> <span class="s2">`/p/</span><span class="p">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">permalink</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>\n    <span class="p">});</span>\n  <span class="p">};</span>\n  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">productCollection</span><span class="p">)</span> <span class="k">return</span> <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Loading...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;;</span>\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;</span><span class="nc">Grid</span> <span class="na">columns</span><span class="p">=</span><span class="si">{</span><span class="mi">3</span><span class="si">}</span> <span class="na">rowGap</span><span class="p">=</span><span class="s">"spacingS"</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span><span class="p">&gt;</span>\n      <span class="si">{</span><span class="nx">productCollection</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">product</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>\n        <span class="p">&lt;</span><span class="nc">GridItem</span> <span class="na">key</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">&gt;</span>\n          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickCard</span><span class="p">=</span><span class="si">{</span><span class="nx">onClickCard</span><span class="si">}</span> <span class="p">/&gt;</span>\n        <span class="p">&lt;/</span><span class="nc">GridItem</span><span class="p">&gt;</span>\n      <span class="p">))</span><span class="si">}</span>\n    <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>As usual, we are using UI components from Forma36, in this case, Grid and GridItem. We are using also the previous <em>Product Card</em> component in order to show all our dummy products.<br>\nIf we look at the available props, we have:</p>\n\n<ul>\n<li>\n<em><strong>publicKey</strong></em>: this is the key used to call Commerce.js.</li>\n<li>\n<em><strong>onSelectProduct</strong></em>: this is the callback that will be called when the user clicks the card. It accepts an object as parameter. This object contains the data structure that will be saved on Contentful.</li>\n</ul>\n\n<p>The component, thanks to the public key, calls Commerce.js with our utility method and saves products inside <em>productCollection</em> inner state. While is waiting for a response from Commerce.js, the component shows a simple <em><em>Loading...</em></em> paragraph to inform the reader.<br>\nWe can see the UI below:</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--EjrxEpnO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8bhd97kbv6s99rivx7ij.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--EjrxEpnO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8bhd97kbv6s99rivx7ij.png" alt="Product Wrapper - Base UI" loading="lazy" width="880" height="182"></a></p>\n\n<blockquote>\n<p><em>This is a simple demo with a simple UI and few products. Of course, if we want to do some improvements we could add an input field to search products and maybe also pagination if your Product Catalog is huge.<br>\nThe only limit is your imagination (and your Business requirements/plan</em> 😂<em>)</em></p>\n</blockquote>\n\n<p> </p>\n<h3>\n  <a name="url-appearance-field" href="#url-appearance-field">\n  </a>\n  Url Appearance Field\n</h3>\n\n<p>This is definitely the most complex component of the entire app.<br>\nThis UI is rendered only when our instance parameter is set to \'URL\'.<br>\nI\'m going to analyze the file in the detail.<br>\n </p>\n<h4>\n  <a name="url-appearance-field-imports" href="#url-appearance-field-imports">\n  </a>\n  Url Appearance Field: imports\n</h4>\n\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Flex</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">,</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">getProduct</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/field-editor-shared</span><span class="dl">"</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>This is pretty clear, we are importing  UI components, utilities, typescript types...🥱😪<br>\n </p>\n<h4>\n  <a name="url-appearance-field-props-interface" href="#url-appearance-field-props-interface">\n  </a>\n  Url Appearance Field: props interface\n</h4>\n\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kr">interface</span> <span class="nx">IUrlAppearanceField</span> <span class="p">{</span>\n  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>\n<span class="p">}</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n<p>The interface is simple, we are expecting, as a prop, the SDK related to the field provided by Contentful.<br>\n </p>\n<h4>\n  <a name="url-appearance-field-react-hooks" href="#url-appearance-field-react-hooks">\n  </a>\n  Url Appearance Field: react hooks\n</h4>\n\n<p>Here we are extracting the Commerce.js public key from our <code>parameters.installation</code> and we are defining some react hooks.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">sdk</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>\n<span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>\n<span class="kd">const</span> <span class="p">[</span><span class="nx">innerValue</span><span class="p">,</span> <span class="nx">setInnerValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>\n<span class="kd">const</span> <span class="p">[</span><span class="nx">product</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span><span class="p">();</span>\n\n<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">if</span> <span class="p">(</span><span class="nx">innerValue</span><span class="p">?.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span> <span class="p">{</span>\n    <span class="nx">getProduct</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">]);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We have two useState hooks: the first is an inner state containing the value saved on Contentful, extracted with the <em>getValue</em> function provided by the SDK. The second contains the Commerce.js product.<br>\nThe useEffect hook is called every time the innerValue changes and also on first load. The hook checks if the saved value is of type \'product\' and if so, we call Commerce.js retrieving the full product, passing the <em>innerValue.id</em> which contains the id of a specific product.<br>\n </p>\n<h4>\n  <a name="url-appearance-field-the-ui" href="#url-appearance-field-the-ui">\n  </a>\n  Url Appearance Field: the UI\n</h4>\n\n<p>Let\'s jump to the return statement:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;&gt;</span>\n      <span class="si">{</span><span class="nx">product</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n        <span class="p">&lt;&gt;</span>\n          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">showTag</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickIcon</span><span class="p">=</span><span class="si">{</span><span class="nx">clearValue</span><span class="si">}</span> <span class="p">/&gt;</span>\n          <span class="p">&lt;</span><span class="nt">div</span>\n            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>\n              <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span><span class="p">,</span>\n              <span class="na">borderTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid #cfd9e0</span><span class="dl">"</span><span class="p">,</span>\n            <span class="p">})</span><span class="si">}</span>\n          <span class="p">/&gt;</span>\n        <span class="p">&lt;/&gt;</span>\n      <span class="p">)</span><span class="si">}</span>\n      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginTop</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">innerValue</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span> <span class="p">})</span><span class="si">}</span><span class="p">&gt;</span>\n        <span class="p">&lt;</span><span class="nc">Button</span>\n          <span class="na">icon</span><span class="p">=</span><span class="s">"ShoppingCart"</span>\n          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>\n          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginLeft</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2rem</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>\n          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span><span class="si">}</span>\n        <span class="p">&gt;</span>\n          Choose a Product\n        <span class="p">&lt;/</span><span class="nc">Button</span><span class="p">&gt;</span>\n      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">&gt;</span>\n    <span class="p">&lt;/&gt;</span>\n  <span class="p">);</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are showing a <em>Product Card</em> and a separator when the user selects or has already selected a product.<br>\nThe component has the showTag attribute set to true and the onClickIcon callback defined with a \'clearValue\' function.<br>\nFinally, we have a Forma36 Button with a cart icon and a callback on the onClick event that opens a Dialog of type \'product\'.<br>\nWe can see the UI in the following screenshots:<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--Km134CU5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89tatf2o1dg98qal4xha.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Km134CU5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89tatf2o1dg98qal4xha.png" alt="Url Appearance Field | base UI" loading="lazy" width="880" height="127"></a></p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--c4Ogz46o--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u4lq3foxi9u7m8hjols3.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--c4Ogz46o--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u4lq3foxi9u7m8hjols3.png" alt="Url Appearance Field | product selected" loading="lazy" width="880" height="277"></a></p>\n\n<p>As mentioned a million times 😅 we are focusing only on the product selection, the complete UI would instead be like this:<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--2uBrD_SG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0abrt4b95r2pmyb3dna.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--2uBrD_SG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0abrt4b95r2pmyb3dna.png" alt="Url Appearance Field | complete UI" loading="lazy" width="880" height="281"></a></p>\n\n<p>The light blue product badge lets the user understand immediately which type of URL has been saved on the field.<br>\n </p>\n<h4>\n  <a name="url-appearance-field-clearvalue-callback" href="#url-appearance-field-clearvalue-callback">\n  </a>\n  Url Appearance Field: clearValue callback\n</h4>\n\n<p>The clearValue function lets the user clear his selection by clicking on the \'x\' icon on the card.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">clearValue</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">setProduct</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n  <span class="nx">setInnerValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n  <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We are cleaning our react states and we are using the <em>setValue</em> function provided by the SDK in order to reset the value also for Contentful.<br>\n </p>\n<h4>\n  <a name="url-appearance-field-opendialog-callback" href="#url-appearance-field-opendialog-callback">\n  </a>\n  Url Appearance Field: openDialog callback\n</h4>\n\n<p>The openDialog function is the core of the component.<br>\nIt lets you open the Contentful Modal with the <code>dialogs.openCurrentApp</code> method passing few parameters. Basically, this function moves the focus of your app into the Dialog Location.<br>\nSince is a Promise, it waits until you close the modal and after that, you have access to a response object.<br>\nIf you remember, in the Product Wrapper component we defined an object composed of an id, type and URL. This is the object received from the Promise when we select a product (if we click on the x of the modal we receive an undefined object).<br>\nLet\'s see the implementation:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="kd">const</span> <span class="nx">openDialog</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="kd">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">dialogs</span><span class="p">.</span><span class="nx">openCurrentApp</span><span class="p">({</span>\n      <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">top</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">minHeight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">75vh</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fullWidth</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">shouldCloseOnOverlayClick</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n      <span class="na">allowHeightOverflow</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n      <span class="na">title</span><span class="p">:</span> <span class="s2">`Search </span><span class="p">${</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">CATEGORY</span> <span class="p">?</span> <span class="dl">"</span><span class="s2"> Categories</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Products</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>\n      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="na">appearance</span><span class="p">:</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span><span class="p">,</span> <span class="kd">type</span> <span class="p">},</span>\n    <span class="p">});</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>\n      <span class="nx">setInnerValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>\n      <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>As you can see, if the res object is defined, it means that we have selected a product and we are saving this object into our react state but also into Contentful through the SDK.<br>\n<details>\n  <summary>Here you can see the entire code related to the product</summary>\n  <br>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">css</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">emotion</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Product</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@chec/commerce.js/types/product</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Flex</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">,</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">getProduct</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/commerce</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductCard</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductCard</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/field-editor-shared</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="kr">interface</span> <span class="nx">IFieldUrl</span> <span class="p">{</span>\n  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="k">export</span> <span class="kd">const</span> <span class="nx">UrlAppearanceField</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">IFieldUrl</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">sdk</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">innerValue</span><span class="p">,</span> <span class="nx">setInnerValue</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>\n  <span class="kd">const</span> <span class="p">[</span><span class="nx">product</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span><span class="p">();</span>\n\n  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">innerValue</span><span class="p">?.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span> <span class="p">{</span>\n      <span class="nx">getProduct</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">setProduct</span><span class="p">);</span>\n    <span class="p">}</span>\n  <span class="p">},</span> <span class="p">[</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">innerValue</span><span class="p">]);</span>\n\n  <span class="kd">const</span> <span class="nx">openDialog</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">dialogs</span><span class="p">.</span><span class="nx">openCurrentApp</span><span class="p">({</span>\n      <span class="na">position</span><span class="p">:</span> <span class="dl">"</span><span class="s2">top</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">minHeight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">75vh</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fullWidth</span><span class="dl">"</span><span class="p">,</span>\n      <span class="na">shouldCloseOnOverlayClick</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n      <span class="na">allowHeightOverflow</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>\n      <span class="na">title</span><span class="p">:</span> <span class="s2">`Search </span><span class="p">${</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">CATEGORY</span> <span class="p">?</span> <span class="dl">"</span><span class="s2"> Categories</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Products</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>\n      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span> <span class="na">appearance</span><span class="p">:</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span><span class="p">,</span> <span class="kd">type</span> <span class="p">},</span>\n    <span class="p">});</span>\n    <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>\n      <span class="nx">setInnerValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>\n      <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>\n    <span class="p">}</span>\n  <span class="p">};</span>\n\n  <span class="kd">const</span> <span class="nx">clearValue</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">setProduct</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n    <span class="nx">setInnerValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n    <span class="nx">sdk</span><span class="p">.</span><span class="nx">field</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>\n  <span class="p">};</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;&gt;</span>\n      <span class="si">{</span><span class="nx">product</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n        <span class="p">&lt;&gt;</span>\n          <span class="p">&lt;</span><span class="nc">ProductCard</span> <span class="na">showTag</span> <span class="na">product</span><span class="p">=</span><span class="si">{</span><span class="nx">product</span><span class="si">}</span> <span class="na">onClickIcon</span><span class="p">=</span><span class="si">{</span><span class="nx">clearValue</span><span class="si">}</span> <span class="p">/&gt;</span>\n          <span class="p">&lt;</span><span class="nt">div</span>\n            <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span>\n              <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px 0</span><span class="dl">"</span><span class="p">,</span>\n              <span class="na">borderTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid #cfd9e0</span><span class="dl">"</span><span class="p">,</span>\n            <span class="p">})</span><span class="si">}</span>\n          <span class="p">/&gt;</span>\n        <span class="p">&lt;/&gt;</span>\n      <span class="p">)</span><span class="si">}</span>\n      <span class="p">&lt;</span><span class="nc">Flex</span> <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginTop</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">innerValue</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">}</span><span class="s2">`</span> <span class="p">})</span><span class="si">}</span><span class="p">&gt;</span>\n        <span class="p">&lt;</span><span class="nc">Button</span>\n          <span class="na">icon</span><span class="p">=</span><span class="s">"ShoppingCart"</span>\n          <span class="na">buttonType</span><span class="p">=</span><span class="s">"muted"</span>\n          <span class="na">className</span><span class="p">=</span><span class="si">{</span><span class="nx">css</span><span class="p">({</span> <span class="na">marginLeft</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10px</span><span class="dl">"</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="dl">"</span><span class="s2">2rem</span><span class="dl">"</span> <span class="p">})</span><span class="si">}</span>\n          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span><span class="p">)</span><span class="si">}</span>\n        <span class="p">&gt;</span>\n          Choose a Product\n        <span class="p">&lt;/</span><span class="nc">Button</span><span class="p">&gt;</span>\n      <span class="p">&lt;/</span><span class="nc">Flex</span><span class="p">&gt;</span>\n    <span class="p">&lt;/&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n</details>\n</p>\n\n\n<hr>\n\n<h2>\n  <a name="connecting-dots" href="#connecting-dots">\n  </a>\n  Connecting dots\n</h2>\n\n<p>Now is the time to connect all the pieces of the puzzle.<br>\nIn the previous section, we saw all our custom implementation and now we need to use the locations provided by Contentful and finish our implementation.</p>\n\n<p>Our focus is on the <code>Dialog.tsx</code> and <code>Field.tsx</code> files. Let\'s start with the Modal.<br>\n </p>\n<h3>\n  <a name="dialog-location" href="#dialog-location">\n  </a>\n  Dialog Location\n</h3>\n\n<p>This file is used when we call the <code>dialogs.openCurrentApp</code> function that we saw previously.<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ModalContent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/forma-36-react-components</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">DialogExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/app-sdk</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">ProductWrapper</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./ProductWrapper</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="kr">interface</span> <span class="nx">DialogProps</span> <span class="p">{</span>\n  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">DialogExtensionSDK</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="kd">const</span> <span class="nx">Dialog</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">DialogProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="kd">type</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">invocation</span><span class="p">;</span>\n  <span class="kd">const</span> <span class="p">{</span> <span class="nx">publicKey</span> <span class="p">}:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">installation</span><span class="p">;</span>\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;&gt;</span>\n      <span class="p">&lt;</span><span class="nc">ModalContent</span><span class="p">&gt;</span>\n        <span class="si">{</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">TYPES</span><span class="p">.</span><span class="nx">PRODUCT</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n          <span class="p">&lt;</span><span class="nc">ProductWrapper</span>\n            <span class="na">publicKey</span><span class="p">=</span><span class="si">{</span><span class="nx">publicKey</span><span class="si">}</span>\n            <span class="na">onSelectProduct</span><span class="p">=</span><span class="si">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">close</span><span class="si">}</span>\n          <span class="p">/&gt;</span>\n        <span class="p">)</span><span class="si">}</span>\n        <span class="si">{</span><span class="cm">/* {type === TYPES.CATEGORY &amp;&amp; (\n          &lt;CategoryWrapper\n            publicKey={publicKey}\n            onSelectCategory={props.sdk.close}\n          /&gt;\n        )} */</span><span class="si">}</span>\n      <span class="p">&lt;/</span><span class="nc">ModalContent</span><span class="p">&gt;</span>\n    <span class="p">&lt;/&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">Dialog</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>We have a specific Typescript type definition for the SDK which is now <code>DialogExtensionSDK</code>. With this SDK, inside the <code>parameters.invocation</code> we have access to the type attribute that we passed when we called the modal. This attribute lets us know what type of content to provide to the modal as you can see in the return statement.<br>\nTo our <em>Product Wrapper</em> component, we are passing also the <code>close</code> SDK callback that we\'ll be used when we select a product passing back the object to save on Contentful.<br>\n </p>\n<h3>\n  <a name="field-location" href="#field-location">\n  </a>\n  Field Location\n</h3>\n\n<p>Based on our instance parameter \'type\' we render a UI or another, in our demo will be always the <em>URL Appearance Field</em><br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight tsx"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">FieldExtensionSDK</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@contentful/app-sdk</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">APPEARANCE_TYPES</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/Constants</span><span class="dl">"</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">UrlAppearanceField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./UrlAppearanceField</span><span class="dl">"</span><span class="p">;</span>\n\n<span class="kr">interface</span> <span class="nx">FieldProps</span> <span class="p">{</span>\n  <span class="nl">sdk</span><span class="p">:</span> <span class="nx">FieldExtensionSDK</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="kd">const</span> <span class="nx">Field</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">:</span> <span class="nx">FieldProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="kd">const</span> <span class="na">instanceProps</span><span class="p">:</span> <span class="kr">any</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">instance</span><span class="p">;</span>\n  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">startAutoResizer</span><span class="p">();</span>\n    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">stopAutoResizer</span><span class="p">();</span>\n  <span class="p">},</span> <span class="p">[</span><span class="nx">props</span><span class="p">]);</span>\n\n  <span class="k">return</span> <span class="p">(</span>\n    <span class="p">&lt;&gt;</span>\n      <span class="si">{</span><span class="nx">instanceProps</span><span class="p">.</span><span class="kd">type</span> <span class="o">===</span> <span class="nx">APPEARANCE_TYPES</span><span class="p">.</span><span class="nx">URL</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>\n        <span class="p">&lt;</span><span class="nc">UrlAppearanceField</span> <span class="na">sdk</span><span class="p">=</span><span class="si">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">sdk</span><span class="si">}</span> <span class="p">/&gt;</span>\n      <span class="p">)</span><span class="si">}</span>\n      <span class="si">{</span><span class="cm">/*\n        {instanceProps.type === APPEARANCE_TYPES.PRODUCT &amp;&amp; (\n          &lt;ProductAppearanceField sdk={props.sdk} /&gt;\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.PRODUCTS &amp;&amp; (\n          &lt;ProductsAppearanceField sdk={props.sdk} /&gt;\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.CATEGORY &amp;&amp; (\n          &lt;CategoryAppearanceField sdk={props.sdk} /&gt;\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.CATEGORIES &amp;&amp; (\n          &lt;CategoriesAppearanceField sdk={props.sdk} /&gt;\n        )}\n      */</span><span class="si">}</span>\n    <span class="p">&lt;/&gt;</span>\n  <span class="p">);</span>\n<span class="p">};</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">Field</span><span class="p">;</span>\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Here, the only thing that I want to clarify is the useEffect hook. We are using the <code>window.startAutoResizer</code> feature. This function updates the height of the iframe every time something happens (for example when we select or remove the product card). Doing this, we have always our wrapper height updated with no white spaces or scrollbars.</p>\n\n\n<hr>\n\n<h2>\n  <a name="little-demo" href="#little-demo">\n  </a>\n  Little Demo\n</h2>\n\n<p>This is it, we finally completed our app 🥳 🥳 🥳.<br>\nHere you can see a little demo:<br>\n<a href="https://res.cloudinary.com/practicaldev/image/fetch/s--_IPdoFqd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0h3azpahcqw5vip1hdqe.gif" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--_IPdoFqd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0h3azpahcqw5vip1hdqe.gif" alt="Demo" loading="lazy" width="800" height="447" data-animated="true"></a><br>\nHere instead the snapshot of the entry where you can see what is saved on Contentful:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight json"><code><span class="p">{</span><span class="w">\n    </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n        </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">\n    </span><span class="p">},</span><span class="w">\n    </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n        </span><span class="nl">"space"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Space"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxx"</span><span class="w">\n            </span><span class="p">}</span><span class="w">\n        </span><span class="p">},</span><span class="w">\n        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35MgIumMobPVc9qnCH0Xa0"</span><span class="p">,</span><span class="w">\n        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Entry"</span><span class="p">,</span><span class="w">\n        </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-10-02T16:55:24.957Z"</span><span class="p">,</span><span class="w">\n        </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-10-03T10:11:46.157Z"</span><span class="p">,</span><span class="w">\n        </span><span class="nl">"environment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"website"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="w">\n            </span><span class="p">}</span><span class="w">\n        </span><span class="p">},</span><span class="w">\n        </span><span class="nl">"revision"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">\n        </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n            </span><span class="nl">"sys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"linkType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ContentType"</span><span class="p">,</span><span class="w">\n                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testCommerceSelector"</span><span class="w">\n            </span><span class="p">}</span><span class="w">\n        </span><span class="p">},</span><span class="w">\n        </span><span class="nl">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="w">\n    </span><span class="p">},</span><span class="w">\n    </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prod_RqEv5xXO2d5Zz4"</span><span class="p">,</span><span class="w">\n            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"product"</span><span class="p">,</span><span class="w">\n            </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/p/shoe05"</span><span class="w">\n        </span><span class="p">}</span><span class="w">\n    </span><span class="p">}</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n\n<hr>\n\n<h2>\n  <a name="deploying-the-app" href="#deploying-the-app">\n  </a>\n  Deploying the app\n</h2>\n\n<p>Of course is not over yet 😉. We need to deploy our application, otherwise will be available only for us and with a local environment running.<br>\nSince our app is very small we don\'t need an external provider, we can deploy the app directly on Contentful, the process is pretty simple.<br>\nIn our package.json file, we have scripts that build and upload the app for us.<br>\nThe commands to run on the terminal are:<br>\n</p>\n\n<div class="highlight js-code-highlight">\n<pre class="highlight shell"><code>npm run build\nnpm run upload\n</code></pre>\n<div class="highlight__panel js-actions-panel">\n<div class="highlight__panel-action js-fullscreen-code-action">\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title>\n    <path d="M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z"></path>\n</svg>\n\n    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewbox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title>\n    <path d="M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z"></path>\n</svg>\n\n</div>\n</div>\n</div>\n\n\n\n<p>Follow the instructions of the script and when finished we can see on Contentful our uploaded app.</p>\n\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--sPJWQfji--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ajka0ikn7t6g0xcddrb6.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--sPJWQfji--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ajka0ikn7t6g0xcddrb6.png" alt="App Deployed" loading="lazy" width="880" height="413"></a></p>\n\n<p>As you can see now the frontend is not anymore our local environment but is hosted by Contentful 😎.</p>\n\n\n<hr>\n\n<h2>\n  <a name="a-step-further" href="#a-step-further">\n  </a>\n  A step further...\n</h2>\n\n<p>It\'s not part of this series but I want to mention one further step that we can and should do for our app.<br>\nAs we have seen, data about the product saved on Contentful, is minimal: product code and the permalink, nothing else. All other information for the product card is gathered in real-time by calling Commerce.js.<br>\nBut what happens if a permalink changes or worse, the product on Commerce.js is deleted? Our website or mobile app that depends on Contentful data, can lead to a broken page.</p>\n\n<p>Commerce.js provides a set of <a href="https://commercejs.com/docs/guides/webhooks/">webhooks</a> that we can configure. For example, there is a specific webhook when the product has been updated or another one if is deleted.<br>\nFor each one, we need to provide a URL that Commerce.js can call every time something happens.</p>\n\n<p>My demo website uses my Contentful data. It\'s built with <a href="https://nextjs.org/">Next.js</a> and deployed on <a href="https://vercel.com/">Vercel</a> and I defined few <a href="https://nextjs.org/docs/api-routes/introduction">API routes</a> that listen to Commerce.js webhooks.<br>\nEvery time a product changes, my API route receives the updated product from Commerce.js and thanks to the Contentful <a href="https://www.contentful.com/developers/docs/references/content-management-api/">Content Management API</a> I can update my content with the updated data or skip if nothing that I care about is changed.</p>\n\n<p>Or for example, If I don\'t want to update my content automatically, when I receive the updated product I can send a notification and hopefully (😆) there will be someone that will update manually the broken link(s) on Contentful.</p>\n\n\n<hr>\n\n<h2>\n  <a name="conclusion" href="#conclusion">\n  </a>\n  Conclusion...\n</h2>\n\n<p>Wow...what a journey 🤯...probably not the best way to start my \'blog career\' with a 4 articles series but it was fun, so much fun 😁.<br>\nHope you enjoyed it too and if you are still here reading thank you very much, I appreciate it 🙇🏻‍♂️.<br>\nNow you can leave or drop a comment or a like or a follow or whatever 😆...<br>\nAnd if with \'the road so far...\' at the beginning of this page you get which TV series I\'m referring to, <em>carry on</em>, drop another comment below and let me know.</p>\n\n<p>See ya 🤙 💪</p>\n\n',n.body_markdown='##The road so far...\n\nIt\'s time folks! The end of our journey through a Contentful App is here.\nWe have gathered a lot of information in the first three parts. We have seen the theory behind it, we understood the why for all of this and we saw an integration between Contentful and a third-party platform like Commerce.js.\n\nNow it\'s time to connects all the pieces and finally see our main customization, which is the reason why I\'m here writing stuff on a monitor 😂.\n\nIn this final episode, we are going to see our customized entry field. Our focus will be the research and selection of a product from Commerce.js.\n\nAnd with a little bit of sadness in my eyes, let\'s start our last take 🙁 🥺 😢.\n\n---\n\n##The Concept\nSo what do we want to build? For our field, we want to choose which type of URL to save: Product, Category or Content Page.\nBased on this choice, we open a modal showing all the related entries, in our use case, all the products from Commerce.js.\nAfter the user selects a product, we save our field with some info. Since this field is of type JSON, we can structure it as we want and the user will see a card preview of the selected product and not the JSON Object itself.\n\n---\n\n##Initial Setup\nInside our project, I created a lib folder where I\'m going to save few files with constants and utility methods.\n&nbsp;\n###Constants\nOur App has multiple purposes even if our focus is on the _URL + product_ behavior.\nI have defined few constants to separate these logics.\n\n```ts\nexport const APPEARANCE_TYPES = {\n  URL: "url", // used in this demo\n  PRODUCT: "product",\n  PRODUCTS: "products",\n  CATEGORY: "category",\n  CATEGORIES: "categories",\n};\n\nexport const TYPES = {\n  PRODUCT: "product", // used in this demo\n  CATEGORY: "category",\n  PAGE: "page",\n};\n```\n&nbsp;\n###Utilities\nAfter that, we create some utility methods that will be used in the upcoming sections.\nFirst, we need a function that retrieves a specific product from Commerce.js:\n```ts\nimport Commerce from "@chec/commerce.js";\nimport { Product } from "@chec/commerce.js/types/product";\n\nexport const getProduct = async (\n  apiKey: string,\n  productId: string,\n  successCB?: (product: Product) => void,\n  failCB?: (e: any) => void\n): Promise<Product | any> => {\n  try {\n    const commerce = new Commerce(apiKey);\n    const product = await commerce.products.retrieve(productId);\n    if (!successCB) return product;\n    successCB(product);\n  } catch (e) {\n    console.error(e);\n    if (!failCB) return e;\n    failCB(e);\n  }\n};\n```\nand then we need the function that retrieves all the products:\n```ts\nimport Commerce from "@chec/commerce.js";\nimport { ProductCollection } from "@chec/commerce.js/features/products";\n\nexport const getProducts = async (\n  apiKey: string,\n  successCB?: (products: ProductCollection) => void,\n  failCB?: (e: any) => void\n): Promise<ProductCollection | any> => {\n  try {\n    const commerce = new Commerce(apiKey);\n    const products = await commerce.products.list();\n    if (!successCB) return products;\n    successCB(products);\n  } catch (e) {\n    console.error(e);\n    if (!failCB) return e;\n    failCB(e);\n  }\n};\n```\nBoth methods expect an API key as input and if you have read part 3 of this series, you know where it will come from 😉.\n\n---\n\n##Custom components\nWe are not limited to using the files provided by Contentful, we can also create our own.\n&nbsp;\n###Product Card\nThe Product Card Component will be used both in the modal when we are looking for products to select, and also after the selection to show a nice UI instead of the JSON object saved on Contentful.\n\n```tsx\nimport { css } from "emotion";\nimport { Product } from "@chec/commerce.js/types/product";\nimport {\n  Card,\n  IconButton,\n  Flex,\n  Tag,\n  Heading,\n  HelpText,\n} from "@contentful/forma-36-react-components";\n\ninterface IProductCard {\n  product?: Product;\n  showTag?: boolean;\n  onClickCard?: (product: Product) => void;\n  onClickIcon?: () => void;\n}\n\nexport const ProductCard = (props: IProductCard) => {\n  const { product, showTag, onClickCard, onClickIcon } = props;\n\n  if (!product) return null;\n\n  return (\n    <Card\n      className={css({\n        height: "100%",\n        boxSizing: "border-box",\n        position: "relative",\n      })}\n      {...(onClickCard && { onClick: () => onClickCard(product) })}\n    >\n      {onClickIcon && (\n        <IconButton\n          iconProps={{ icon: "Close" }}\n          buttonType="muted"\n          className={css({\n            position: "absolute",\n            top: "3px",\n            right: "3px",\n          })}\n          onClick={onClickIcon}\n        />\n      )}\n      <Flex alignItems="center">\n        {product.media && (\n          <div className={css({ marginRight: "20px", width: "100px" })}>\n            <img\n              className={css({ maxWidth: "100%" })}\n              src={product.media.source}\n              alt={product.name}\n            />\n          </div>\n        )}\n        <Flex flexDirection="column">\n          {showTag && <Tag>product</Tag>}\n          <Heading>{product.name}</Heading>\n          <HelpText\n            className={css({\n              fontStyle: "italic",\n              fontSize: "12px",\n              marginBottom: "10px",\n            })}\n          >\n            SKU: {product.sku}\n          </HelpText>\n        </Flex>\n      </Flex>\n    </Card>\n  );\n};\n```\nWe are importing some UI components from Forma36 and a Product type definition from Commerce.js.\nOur custom IProductCard interface defines the properties available for the component:\n\n- _**product**_: this is the prop containing the whole product data coming from Commerce.js.\n- _**showTag**_: this flag shows a tag that identifies this card as a product (this will be more clear later).\n- _**onClickCard**_: this optional callback is used inside the products modal when the user selects a product. The function passes the product prop as a parameter.\n- _**onClickIcon**_: this callback, when defined, shows an \'x\' icon on the top right corner and is used when we want to clear our selection.\n\nThis card will have two possible layouts which we can see below:\n\n![Product Card - Modal UI](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lb779gtl69yukg5hv7ot.png)\n\n![Product Card - Selected UI](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yuakxz13hewuvx2miqpk.png)\n\nThe first one will be used inside the modal, the second in place of the JSON object when the product is already selected.\n&nbsp;\n###Product Wrapper\nThis component will be used inside the Dialog/Modal Location. It will contain all the products coming from Commerce.js.\nHere the customer can click on a single card and select the product.\n\n```tsx\nimport { css } from "emotion";\nimport { Grid, GridItem } from "@contentful/forma-36-react-components";\nimport { useEffect, useState } from "react";\nimport { getProducts } from "../lib/commerce";\nimport { ProductCollection } from "@chec/commerce.js/features/products";\nimport { Product } from "@chec/commerce.js/types/product";\nimport { ProductCard } from "./ProductCard";\nimport { TYPES } from "../lib/Constants";\n\ninterface IProductWrapper {\n  publicKey: string;\n  onSelectProduct: (data: { id: string; type: string; url: string }) => void;\n}\n\nexport const ProductWrapper = (props: IProductWrapper) => {\n  const { publicKey, onSelectProduct } = props;\n  const [productCollection, setProductCollection] =\n    useState<ProductCollection>();\n  useEffect(() => {\n    getProducts(publicKey, setProductCollection);\n  }, [publicKey]);\n  const onClickCard = (product: Product) => {\n    onSelectProduct({\n      id: product.id,\n      type: TYPES.PRODUCT,\n      url: `/p/${product.permalink}`,\n    });\n  };\n  if (!productCollection) return <p>Loading...</p>;\n  return (\n    <Grid columns={3} rowGap="spacingS" className={css({ margin: "20px 0" })}>\n      {productCollection.data.map((product) => (\n        <GridItem key={product.id}>\n          <ProductCard product={product} onClickCard={onClickCard} />\n        </GridItem>\n      ))}\n    </Grid>\n  );\n};\n```\nAs usual, we are using UI components from Forma36, in this case, Grid and GridItem. We are using also the previous _Product Card_ component in order to show all our dummy products.\nIf we look at the available props, we have:\n\n- _**publicKey**_: this is the key used to call Commerce.js.\n- _**onSelectProduct**_: this is the callback that will be called when the user clicks the card. It accepts an object as parameter. This object contains the data structure that will be saved on Contentful.\n\nThe component, thanks to the public key, calls Commerce.js with our utility method and saves products inside _productCollection_ inner state. While is waiting for a response from Commerce.js, the component shows a simple _*Loading...*_ paragraph to inform the reader.\nWe can see the UI below:\n\n![Product Wrapper - Base UI](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8bhd97kbv6s99rivx7ij.png)\n\n> _This is a simple demo with a simple UI and few products. Of course, if we want to do some improvements we could add an input field to search products and maybe also pagination if your Product Catalog is huge.\nThe only limit is your imagination (and your Business requirements/plan_ 😂_)_\n\n&nbsp;\n###Url Appearance Field\nThis is definitely the most complex component of the entire app.\nThis UI is rendered only when our instance parameter is set to \'URL\'.\nI\'m going to analyze the file in the detail.\n&nbsp;\n####Url Appearance Field: imports\n```tsx\nimport { useState, useEffect } from "react";\nimport { css } from "emotion";\nimport { Product } from "@chec/commerce.js/types/product";\nimport { Flex, Button } from "@contentful/forma-36-react-components";\nimport { APPEARANCE_TYPES, TYPES } from "../lib/Constants";\nimport { getProduct } from "../lib/commerce";\nimport { ProductCard } from "./ProductCard";\nimport { FieldExtensionSDK } from "@contentful/field-editor-shared";\n```\nThis is pretty clear, we are importing  UI components, utilities, typescript types...🥱😪\n&nbsp;\n####Url Appearance Field: props interface\n```tsx\ninterface IUrlAppearanceField {\n  sdk: FieldExtensionSDK;\n}\n```\nThe interface is simple, we are expecting, as a prop, the SDK related to the field provided by Contentful.\n&nbsp;\n####Url Appearance Field: react hooks\nHere we are extracting the Commerce.js public key from our `parameters.installation` and we are defining some react hooks.\n```tsx\nconst { sdk } = props;\nconst { publicKey }: any = sdk.parameters.installation;\nconst [innerValue, setInnerValue] = useState(sdk.field.getValue());\nconst [product, setProduct] = useState<Product>();\n\nuseEffect(() => {\n  if (innerValue?.type === TYPES.PRODUCT) {\n    getProduct(publicKey, innerValue.id, setProduct);\n  }\n}, [publicKey, innerValue]);\n```\nWe have two useState hooks: the first is an inner state containing the value saved on Contentful, extracted with the _getValue_ function provided by the SDK. The second contains the Commerce.js product.\nThe useEffect hook is called every time the innerValue changes and also on first load. The hook checks if the saved value is of type \'product\' and if so, we call Commerce.js retrieving the full product, passing the _innerValue.id_ which contains the id of a specific product.\n&nbsp;\n####Url Appearance Field: the UI\nLet\'s jump to the return statement:\n```tsx\nreturn (\n    <>\n      {product && (\n        <>\n          <ProductCard showTag product={product} onClickIcon={clearValue} />\n          <div\n            className={css({\n              margin: "20px 0",\n              borderTop: "1px solid #cfd9e0",\n            })}\n          />\n        </>\n      )}\n      <Flex className={css({ marginTop: `${innerValue ? "0" : "10px"}` })}>\n        <Button\n          icon="ShoppingCart"\n          buttonType="muted"\n          className={css({ marginLeft: "10px", height: "2rem" })}\n          onClick={() => openDialog(TYPES.PRODUCT)}\n        >\n          Choose a Product\n        </Button>\n      </Flex>\n    </>\n  );\n```\nWe are showing a _Product Card_ and a separator when the user selects or has already selected a product.\nThe component has the showTag attribute set to true and the onClickIcon callback defined with a \'clearValue\' function.\nFinally, we have a Forma36 Button with a cart icon and a callback on the onClick event that opens a Dialog of type \'product\'.\nWe can see the UI in the following screenshots:\n![Url Appearance Field | base UI](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89tatf2o1dg98qal4xha.png)\n\n![Url Appearance Field | product selected](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/u4lq3foxi9u7m8hjols3.png)\n\nAs mentioned a million times 😅 we are focusing only on the product selection, the complete UI would instead be like this:\n![Url Appearance Field | complete UI](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0abrt4b95r2pmyb3dna.png)\n\nThe light blue product badge lets the user understand immediately which type of URL has been saved on the field.\n&nbsp;\n####Url Appearance Field: clearValue callback\nThe clearValue function lets the user clear his selection by clicking on the \'x\' icon on the card.\n```tsx\nconst clearValue = () => {\n  setProduct(undefined);\n  setInnerValue(undefined);\n  sdk.field.setValue(undefined);\n};\n```\nWe are cleaning our react states and we are using the _setValue_ function provided by the SDK in order to reset the value also for Contentful.\n&nbsp;\n####Url Appearance Field: openDialog callback\nThe openDialog function is the core of the component.\nIt lets you open the Contentful Modal with the `dialogs.openCurrentApp` method passing few parameters. Basically, this function moves the focus of your app into the Dialog Location.\nSince is a Promise, it waits until you close the modal and after that, you have access to a response object.\nIf you remember, in the Product Wrapper component we defined an object composed of an id, type and URL. This is the object received from the Promise when we select a product (if we click on the x of the modal we receive an undefined object).\nLet\'s see the implementation:\n```tsx\nconst openDialog = async (type: string) => {\n    const res = await sdk.dialogs.openCurrentApp({\n      position: "top",\n      minHeight: "75vh",\n      width: "fullWidth",\n      shouldCloseOnOverlayClick: true,\n      allowHeightOverflow: true,\n      title: `Search ${type === TYPES.CATEGORY ? " Categories" : "Products"}`,\n      parameters: { appearance: APPEARANCE_TYPES.URL, type },\n    });\n    if (res) {\n      setInnerValue(res);\n      sdk.field.setValue(res);\n    }\n  };\n```\nAs you can see, if the res object is defined, it means that we have selected a product and we are saving this object into our react state but also into Contentful through the SDK.\n{% details Here you can see the entire code related to the product %}\n```tsx\nimport { useState, useEffect } from "react";\nimport { css } from "emotion";\nimport { Product } from "@chec/commerce.js/types/product";\nimport { Flex, Button } from "@contentful/forma-36-react-components";\nimport { APPEARANCE_TYPES, TYPES } from "../lib/Constants";\nimport { getProduct } from "../lib/commerce";\nimport { ProductCard } from "./ProductCard";\nimport { FieldExtensionSDK } from "@contentful/field-editor-shared";\n\ninterface IFieldUrl {\n  sdk: FieldExtensionSDK;\n}\n\nexport const UrlAppearanceField = (props: IFieldUrl) => {\n  const { sdk } = props;\n  const { publicKey }: any = sdk.parameters.installation;\n  const [innerValue, setInnerValue] = useState(sdk.field.getValue());\n  const [product, setProduct] = useState<Product>();\n\n  useEffect(() => {\n    if (innerValue?.type === TYPES.PRODUCT) {\n      getProduct(publicKey, innerValue.id, setProduct);\n    }\n  }, [publicKey, innerValue]);\n\n  const openDialog = async (type: string) => {\n    const res = await sdk.dialogs.openCurrentApp({\n      position: "top",\n      minHeight: "75vh",\n      width: "fullWidth",\n      shouldCloseOnOverlayClick: true,\n      allowHeightOverflow: true,\n      title: `Search ${type === TYPES.CATEGORY ? " Categories" : "Products"}`,\n      parameters: { appearance: APPEARANCE_TYPES.URL, type },\n    });\n    if (res) {\n      setInnerValue(res);\n      sdk.field.setValue(res);\n    }\n  };\n\n  const clearValue = () => {\n    setProduct(undefined);\n    setInnerValue(undefined);\n    sdk.field.setValue(undefined);\n  };\n\n  return (\n    <>\n      {product && (\n        <>\n          <ProductCard showTag product={product} onClickIcon={clearValue} />\n          <div\n            className={css({\n              margin: "20px 0",\n              borderTop: "1px solid #cfd9e0",\n            })}\n          />\n        </>\n      )}\n      <Flex className={css({ marginTop: `${innerValue ? "0" : "10px"}` })}>\n        <Button\n          icon="ShoppingCart"\n          buttonType="muted"\n          className={css({ marginLeft: "10px", height: "2rem" })}\n          onClick={() => openDialog(TYPES.PRODUCT)}\n        >\n          Choose a Product\n        </Button>\n      </Flex>\n    </>\n  );\n};\n```\n{% enddetails %}\n\n---\n\n##Connecting dots\nNow is the time to connect all the pieces of the puzzle.\nIn the previous section, we saw all our custom implementation and now we need to use the locations provided by Contentful and finish our implementation.\n\nOur focus is on the `Dialog.tsx` and `Field.tsx` files. Let\'s start with the Modal.\n&nbsp;\n###Dialog Location\nThis file is used when we call the `dialogs.openCurrentApp` function that we saw previously.\n```tsx\nimport { ModalContent } from "@contentful/forma-36-react-components";\nimport { DialogExtensionSDK } from "@contentful/app-sdk";\nimport { TYPES } from "../lib/Constants";\nimport { ProductWrapper } from "./ProductWrapper";\n\ninterface DialogProps {\n  sdk: DialogExtensionSDK;\n}\n\nconst Dialog = (props: DialogProps) => {\n  const { type }: any = props.sdk.parameters.invocation;\n  const { publicKey }: any = props.sdk.parameters.installation;\n  return (\n    <>\n      <ModalContent>\n        {type === TYPES.PRODUCT && (\n          <ProductWrapper\n            publicKey={publicKey}\n            onSelectProduct={props.sdk.close}\n          />\n        )}\n        {/* {type === TYPES.CATEGORY && (\n          <CategoryWrapper\n            publicKey={publicKey}\n            onSelectCategory={props.sdk.close}\n          />\n        )} */}\n      </ModalContent>\n    </>\n  );\n};\n\nexport default Dialog;\n```\nWe have a specific Typescript type definition for the SDK which is now `DialogExtensionSDK`. With this SDK, inside the `parameters.invocation` we have access to the type attribute that we passed when we called the modal. This attribute lets us know what type of content to provide to the modal as you can see in the return statement.\nTo our _Product Wrapper_ component, we are passing also the `close` SDK callback that we\'ll be used when we select a product passing back the object to save on Contentful.\n&nbsp;\n###Field Location\nBased on our instance parameter \'type\' we render a UI or another, in our demo will be always the _URL Appearance Field_\n```tsx\nimport { useEffect } from "react";\nimport { FieldExtensionSDK } from "@contentful/app-sdk";\nimport { APPEARANCE_TYPES } from "../lib/Constants";\nimport { UrlAppearanceField } from "./UrlAppearanceField";\n\ninterface FieldProps {\n  sdk: FieldExtensionSDK;\n}\n\nconst Field = (props: FieldProps) => {\n  const instanceProps: any = props.sdk.parameters.instance;\n  useEffect(() => {\n    props.sdk.window.startAutoResizer();\n    return () => props.sdk.window.stopAutoResizer();\n  }, [props]);\n\n  return (\n    <>\n      {instanceProps.type === APPEARANCE_TYPES.URL && (\n        <UrlAppearanceField sdk={props.sdk} />\n      )}\n      {/*\n        {instanceProps.type === APPEARANCE_TYPES.PRODUCT && (\n          <ProductAppearanceField sdk={props.sdk} />\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.PRODUCTS && (\n          <ProductsAppearanceField sdk={props.sdk} />\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.CATEGORY && (\n          <CategoryAppearanceField sdk={props.sdk} />\n        )}\n        {instanceProps.type === APPEARANCE_TYPES.CATEGORIES && (\n          <CategoriesAppearanceField sdk={props.sdk} />\n        )}\n      */}\n    </>\n  );\n};\n\nexport default Field;\n```\nHere, the only thing that I want to clarify is the useEffect hook. We are using the `window.startAutoResizer` feature. This function updates the height of the iframe every time something happens (for example when we select or remove the product card). Doing this, we have always our wrapper height updated with no white spaces or scrollbars.\n\n---\n\n##Little Demo\nThis is it, we finally completed our app 🥳 🥳 🥳.\nHere you can see a little demo:\n![Demo](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0h3azpahcqw5vip1hdqe.gif)\nHere instead the snapshot of the entry where you can see what is saved on Contentful:\n```json\n{\n    "metadata": {\n        "tags": []\n    },\n    "sys": {\n        "space": {\n            "sys": {\n                "type": "Link",\n                "linkType": "Space",\n                "id": "xxx"\n            }\n        },\n        "id": "35MgIumMobPVc9qnCH0Xa0",\n        "type": "Entry",\n        "createdAt": "2021-10-02T16:55:24.957Z",\n        "updatedAt": "2021-10-03T10:11:46.157Z",\n        "environment": {\n            "sys": {\n                "id": "website",\n                "type": "Link",\n                "linkType": "Environment"\n            }\n        },\n        "revision": 5,\n        "contentType": {\n            "sys": {\n                "type": "Link",\n                "linkType": "ContentType",\n                "id": "testCommerceSelector"\n            }\n        },\n        "locale": "en-US"\n    },\n    "fields": {\n        "url": {\n            "id": "prod_RqEv5xXO2d5Zz4",\n            "type": "product",\n            "url": "/p/shoe05"\n        }\n    }\n}\n```\n\n---\n\n##Deploying the app\nOf course is not over yet 😉. We need to deploy our application, otherwise will be available only for us and with a local environment running.\nSince our app is very small we don\'t need an external provider, we can deploy the app directly on Contentful, the process is pretty simple.\nIn our package.json file, we have scripts that build and upload the app for us.\nThe commands to run on the terminal are:\n\n```sh\nnpm run build\nnpm run upload\n```\n\nFollow the instructions of the script and when finished we can see on Contentful our uploaded app.\n\n![App Deployed](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ajka0ikn7t6g0xcddrb6.png)\n\nAs you can see now the frontend is not anymore our local environment but is hosted by Contentful 😎.\n\n---\n\n##A step further...\nIt\'s not part of this series but I want to mention one further step that we can and should do for our app.\nAs we have seen, data about the product saved on Contentful, is minimal: product code and the permalink, nothing else. All other information for the product card is gathered in real-time by calling Commerce.js.\nBut what happens if a permalink changes or worse, the product on Commerce.js is deleted? Our website or mobile app that depends on Contentful data, can lead to a broken page.\n\nCommerce.js provides a set of [webhooks](https://commercejs.com/docs/guides/webhooks/) that we can configure. For example, there is a specific webhook when the product has been updated or another one if is deleted.\nFor each one, we need to provide a URL that Commerce.js can call every time something happens.\n\n\nMy demo website uses my Contentful data. It\'s built with [Next.js](https://nextjs.org/) and deployed on [Vercel](https://vercel.com/) and I defined few [API routes](https://nextjs.org/docs/api-routes/introduction) that listen to Commerce.js webhooks.\nEvery time a product changes, my API route receives the updated product from Commerce.js and thanks to the Contentful [Content Management API](https://www.contentful.com/developers/docs/references/content-management-api/) I can update my content with the updated data or skip if nothing that I care about is changed.\n\nOr for example, If I don\'t want to update my content automatically, when I receive the updated product I can send a notification and hopefully (😆) there will be someone that will update manually the broken link(s) on Contentful.\n\n---\n\n##Conclusion...\nWow...what a journey 🤯...probably not the best way to start my \'blog career\' with a 4 articles series but it was fun, so much fun 😁.\nHope you enjoyed it too and if you are still here reading thank you very much, I appreciate it 🙇🏻‍♂️.\nNow you can leave or drop a comment or a like or a follow or whatever 😆...\nAnd if with \'the road so far...\' at the beginning of this page you get which TV series I\'m referring to, _carry on_, drop another comment below and let me know.\n\nSee ya 🤙 💪',n.user={name:"William Iommi",username:l,twitter_username:l,github_username:s,website_url:"https://williamiommi.me",profile_image:"https://res.cloudinary.com/practicaldev/image/fetch/s--aNc39sgo--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/213388/1ed286d5-8e6e-4e43-a84b-3ffcee3853f2.png",profile_image_90:"https://res.cloudinary.com/practicaldev/image/fetch/s--YxFIeWUT--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/213388/1ed286d5-8e6e-4e43-a84b-3ffcee3853f2.png"},{layout:"default",data:[{}],fetch:{"data-v-70afb46a:0":{article:n}},error:s,state:{currentArticle:n},serverRendered:!0,routePath:"/wiommi/840069",config:{_app:{basePath:"/nuxtstop/",assetsPath:"/nuxtstop/_nuxt/",cdnURL:s}}}}(null,"2021-10-08T18:28:46Z",{},"https://dev.to/wiommi/how-i-built-a-contentful-app-combined-with-commerce-js-iv-4nli","wiommi")</script><script src="/nuxtstop/_nuxt/f6e87fb.js" defer></script><script src="/nuxtstop/_nuxt/dc9ce94.js" defer></script><script src="/nuxtstop/_nuxt/6474719.js" defer></script><script src="/nuxtstop/_nuxt/9b75090.js" defer></script><script src="/nuxtstop/_nuxt/18df600.js" defer></script>
  </body>
</html>
